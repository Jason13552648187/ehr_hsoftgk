{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\orm-sign-org\\main-grid\\main-grid-base.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\orm-sign-org\\main-grid\\main-grid-base.vue","mtime":1630509411139},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHsgVnVlLCBDb21wb25lbnQsIFByb3AsIFByb3ZpZGUsIEVtaXQsIFdhdGNoLCBNb2RlbCxJbmplY3QgfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJzsKaW1wb3J0IHsgQ3JlYXRlRWxlbWVudCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IFN1YmplY3QsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnOwppbXBvcnQgeyBDb250cm9sSW50ZXJmYWNlIH0gZnJvbSAnQC9pbnRlcmZhY2UvY29udHJvbCc7CmltcG9ydCB7IFVJQWN0aW9uVG9vbCxVdGlsIH0gZnJvbSAnQC91dGlscyc7CmltcG9ydCBOYXZEYXRhU2VydmljZSBmcm9tICdAL3NlcnZpY2UvYXBwL25hdmRhdGEtc2VydmljZSc7CmltcG9ydCBPcm1TaWduT3JnU2VydmljZSBmcm9tICdAL3NlcnZpY2Uvb3JtLXNpZ24tb3JnL29ybS1zaWduLW9yZy1zZXJ2aWNlJzsKaW1wb3J0IE1haW5TZXJ2aWNlIGZyb20gJy4vbWFpbi1ncmlkLXNlcnZpY2UnOwoKaW1wb3J0IENvZGVMaXN0U2VydmljZSBmcm9tICJAc2VydmljZS9hcHAvY29kZWxpc3Qtc2VydmljZSI7CmltcG9ydCB7IEZvcm1JdGVtTW9kZWwgfSBmcm9tICdAL21vZGVsL2Zvcm0tZGV0YWlsJzsKCgpAQ29tcG9uZW50KHsKICAgIGNvbXBvbmVudHM6IHsKICAgICAgCiAgICB9Cn0pCmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1haW5CYXNlIGV4dGVuZHMgVnVlIGltcGxlbWVudHMgQ29udHJvbEludGVyZmFjZSB7CgogICAgLyoqCiAgICAgKiDlkI3np7AKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIG5hbWU/OiBzdHJpbmc7CgogICAgLyoqCiAgICAgKiDop4blm77pgJrorq/lr7nosaEKICAgICAqCiAgICAgKiBAdHlwZSB7U3ViamVjdDxWaWV3U3RhdGU+fQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIHZpZXdTdGF0ZSE6IFN1YmplY3Q8Vmlld1N0YXRlPjsKCiAgICAvKioKICAgICAqIOW6lOeUqOS4iuS4i+aWhwogICAgICoKICAgICAqIEB0eXBlIHsqfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIGNvbnRleHQ6IGFueTsKCiAgICAvKioKICAgICAqIOinhuWbvuWPguaVsAogICAgICoKICAgICAqIEB0eXBlIHsqfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIHZpZXdwYXJhbXM6IGFueTsKCiAgICAvKioKICAgICAqIOinhuWbvueKtuaAgeS6i+S7tgogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEB0eXBlIHsoU3Vic2NyaXB0aW9uIHwgdW5kZWZpbmVkKX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgdmlld1N0YXRlRXZlbnQ6IFN1YnNjcmlwdGlvbiB8IHVuZGVmaW5lZDsKCiAgICAvKioKICAgICAqIOiOt+WPlumDqOS7tuexu+WeiwogICAgICoKICAgICAqIEByZXR1cm5zIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldENvbnRyb2xUeXBlKCk6IHN0cmluZyB7CiAgICAgICAgcmV0dXJuICdHUklEJwogICAgfQoKCgogICAgLyoqCiAgICAgKiDorqHmlbDlmajmnI3liqHlr7nosaHpm4blkIgKICAgICAqCiAgICAgKiBAdHlwZSB7QXJyYXk8Kj59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLyAgICAKICAgIHB1YmxpYyBjb3VudGVyU2VydmljZUFycmF5OkFycmF5PGFueT4gPSBbXTsKCiAgICAvKioKICAgICAqIOW7uuaehOmDqOS7tuacjeWKoeWvueixoQogICAgICoKICAgICAqIEB0eXBlIHtNYWluU2VydmljZX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgc2VydmljZTogTWFpblNlcnZpY2UgPSBuZXcgTWFpblNlcnZpY2UoeyAkc3RvcmU6IHRoaXMuJHN0b3JlIH0pOwoKICAgIC8qKgogICAgICog5a6e5L2T5pyN5Yqh5a+56LGhCiAgICAgKgogICAgICogQHR5cGUge09ybVNpZ25PcmdTZXJ2aWNlfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBhcHBFbnRpdHlTZXJ2aWNlOiBPcm1TaWduT3JnU2VydmljZSA9IG5ldyBPcm1TaWduT3JnU2VydmljZSh7ICRzdG9yZTogdGhpcy4kc3RvcmUgfSk7CiAgICAKCgogICAgLyoqCiAgICAgKiDlhbPpl63op4blm74KICAgICAqCiAgICAgKiBAcGFyYW0ge2FueX0gYXJncwogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBjbG9zZVZpZXcoYXJnczogYW55KTogdm9pZCB7CiAgICAgICAgbGV0IF90aGlzOiBhbnkgPSB0aGlzOwogICAgICAgIF90aGlzLiRlbWl0KCdjbG9zZXZpZXcnLCBbYXJnc10pOwogICAgfQoKICAgIC8qKgogICAgICogIOiuoeaVsOWZqOWIt+aWsAogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgY291bnRlclJlZnJlc2goKXsKICAgICAgICBjb25zdCBfdGhpczphbnkgPXRoaXM7CiAgICAgICAgaWYoX3RoaXMuY291bnRlclNlcnZpY2VBcnJheSAmJiBfdGhpcy5jb3VudGVyU2VydmljZUFycmF5Lmxlbmd0aCA+MCl7CiAgICAgICAgICAgIF90aGlzLmNvdW50ZXJTZXJ2aWNlQXJyYXkuZm9yRWFjaCgoaXRlbTphbnkpID0+ewogICAgICAgICAgICAgICAgaWYoaXRlbS5yZWZyZXNoRGF0YSAmJiBpdGVtLnJlZnJlc2hEYXRhIGluc3RhbmNlb2YgRnVuY3Rpb24pewogICAgICAgICAgICAgICAgICAgIGl0ZW0ucmVmcmVzaERhdGEoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9CgoKICAgIC8qKgogICAgICog5Luj56CB6KGo5pyN5Yqh5a+56LGhCiAgICAgKgogICAgICogQHR5cGUge0NvZGVMaXN0U2VydmljZX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovICAKICAgIHB1YmxpYyBjb2RlTGlzdFNlcnZpY2U6Q29kZUxpc3RTZXJ2aWNlID0gbmV3IENvZGVMaXN0U2VydmljZSh7ICRzdG9yZTogdGhpcy4kc3RvcmUgfSk7CgogICAgLyoqCiAgICAgKiDojrflj5blpJrpobnmlbDmja4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7YW55W119CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldERhdGFzKCk6IGFueVtdIHsKICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25zOwogICAgfQoKICAgIC8qKgogICAgICog6I635Y+W5Y2V6aG55qCRCiAgICAgKgogICAgICogQHJldHVybnMgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldERhdGEoKTogYW55IHsKICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25zWzBdOwogICAgfQoKCiAgICAvKioKICAgICAqIOaYvuekuuWkhOeQhuaPkOekugogICAgICoKICAgICAqIEB0eXBlIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKHsgZGVmYXVsdDogdHJ1ZSB9KSBwdWJsaWMgc2hvd0J1c3lJbmRpY2F0b3I/OiBib29sZWFuOwoKICAgIC8qKgogICAgICog6YOo5Lu26KGM5Li6LS11cGRhdGUKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIHVwZGF0ZUFjdGlvbiE6IHN0cmluZzsKICAgIAogICAgLyoqCiAgICAgKiDpg6jku7booYzkuLotLWZldGNoCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBmZXRjaEFjdGlvbiE6IHN0cmluZzsKICAgIAogICAgLyoqCiAgICAgKiDpg6jku7booYzkuLotLXJlbW92ZQogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgcmVtb3ZlQWN0aW9uITogc3RyaW5nOwogICAgCiAgICAvKioKICAgICAqIOmDqOS7tuihjOS4ui0tbG9hZAogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgbG9hZEFjdGlvbiE6IHN0cmluZzsKICAgIAogICAgLyoqCiAgICAgKiDpg6jku7booYzkuLotLWxvYWRkcmFmdAogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgbG9hZGRyYWZ0QWN0aW9uITogc3RyaW5nOwogICAgCiAgICAvKioKICAgICAqIOmDqOS7tuihjOS4ui0tY3JlYXRlCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBjcmVhdGVBY3Rpb24hOiBzdHJpbmc7CgogICAgLyoqCiAgICAgKiDlvZPliY3pobUKICAgICAqCiAgICAgKiBAdHlwZSB7bnVtYmVyfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBjdXJQYWdlOiBudW1iZXIgPSAxOwoKICAgIC8qKgogICAgICog5pWw5o2uCiAgICAgKgogICAgICogQHR5cGUge2FueVtdfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBpdGVtczogYW55W10gPSBbXTsKCiAgICAvKioKICAgICAqIOaYr+WQpuaUr+aMgeWIhumhtQogICAgICoKICAgICAqIEB0eXBlIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBpc0VuYWJsZVBhZ2luZ0JhcjogYm9vbGVhbiA9IHRydWU7CgogICAgLyoqCiAgICAgKiDmmK/lkKbnpoHnlKjmjpLluo8KICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgaXNOb1NvcnQ6IGJvb2xlYW4gPSBmYWxzZTsKCiAgICAvKioKICAgICAqIOaOkuW6j+aWueWQkQogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIG1pbm9yU29ydERpcjogc3RyaW5nID0gJyc7CgogICAgLyoqCiAgICAgKiDmjpLluo/lrZfmrrUKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBtaW5vclNvcnRQU0RFRjogc3RyaW5nID0gJyc7CgogICAgLyoqCiAgICAgKiDliIbpobXmnaHmlbAKICAgICAqCiAgICAgKiBAdHlwZSB7bnVtYmVyfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBsaW1pdDogbnVtYmVyID0gMjA7CgogICAgLyoqCiAgICAgKiDmmK/lkKbmmL7npLrmoIfpopgKICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgaXNIaWRlSGVhZGVyOiBib29sZWFuID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiDmmK/lkKbpu5jorqTpgInkuK3nrKzkuIDmnaHmlbDmja4KICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCh7IGRlZmF1bHQ6IGZhbHNlIH0pIHB1YmxpYyBpc1NlbGVjdEZpcnN0RGVmYXVsdCE6IGJvb2xlYW47CgogICAgLyoqCiAgICAgKiDmmK/lkKbljZXpgIkKICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBpc1NpbmdsZVNlbGVjdD86IGJvb2xlYW47CgogICAgLyoqCiAgICAgKiDpgInkuK3mlbDmja7lrZfnrKbkuLIKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIHNlbGVjdGVkRGF0YT86IHN0cmluZzsKCiAgICAvKioKICAgICAqIOmAieS4reWAvOWPmOWMlgogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsCiAgICAgKiBAcGFyYW0geyp9IG9sZFZhbAogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBXYXRjaCgnc2VsZWN0ZWREYXRhJykKICAgIHB1YmxpYyBvblZhbHVlQ2hhbmdlKG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSkgewogICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgIGlmKHRoaXMuc2VsZWN0ZWREYXRhKXsKICAgICAgICAgICAgY29uc3QgcmVmczogYW55ID0gdGhpcy4kcmVmczsKICAgICAgICAgICAgaWYgKHJlZnMubXVsdGlwbGVUYWJsZSkgewogICAgICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICAgICAgICBKU09OLnBhcnNlKHRoaXMuc2VsZWN0ZWREYXRhKS5mb3JFYWNoKChzZWxlY3Rpb246YW55KT0+ewogICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZEl0ZW0gPSB0aGlzLml0ZW1zLmZpbmQoKGl0ZW06YW55KT0+ewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0uc3Jma2V5LCBzZWxlY3Rpb24uc3Jma2V5KTsKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICBpZihzZWxlY3RlZEl0ZW0pewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJvd0NsaWNrKHNlbGVjdGVkSXRlbSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiDooajmoLzooYzmlbDmja7pu5jorqTmv4DmtLvmqKHlvI8KICAgICAqIDAg5LiN5r+A5rS7CiAgICAgKiAxIOWNleWHu+a/gOa0uwogICAgICogMiDlj4zlh7vmv4DmtLsKICAgICAqCiAgICAgKiBAdHlwZSB7KG51bWJlciB8IDAgfCAxIHwgMil9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3Aoe2RlZmF1bHQ6IDJ9KSBwdWJsaWMgZ3JpZFJvd0FjdGl2ZU1vZGUhOiBudW1iZXI7CgogICAgLyoqCiAgICAgKiDmmK/lkKblvIDlkK/ooYznvJbovpEKICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCh7ZGVmYXVsdDogZmFsc2V9KSBwdWJsaWMgaXNPcGVuRWRpdCE6IGJvb2xlYW47CgogICAgLyoqCiAgICAgKiDlrp7pmYXmmK/lkKblvIDlkK/ooYznvJbovpEKICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgYWN0dWFsSXNPcGVuRWRpdDogYm9vbGVhbiA9IHRoaXMuaXNPcGVuRWRpdDsKCiAgICAvKioKICAgICAqIOaAu+adoeaVsAogICAgICoKICAgICAqIEB0eXBlIHtudW1iZXJ9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHRvdGFscm93OiBudW1iZXIgPSAwOwoKICAgIC8qKgogICAgICog6YCJ5Lit6KGM5pWw5o2uCiAgICAgKgogICAgICogQHR5cGUge2FueVtdfQogICAgICogQG1lbWJlcm9mIE1haW4KICAgICAqLwogICAgcHVibGljIHNlbGVjdGlvbnM6IGFueVtdID0gW107CgogICAgLyoqCiAgICAgKiDmi6bmiKrooYzpgInkuK0KICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluCiAgICAgKi8KICAgIHB1YmxpYyBzdG9wUm93Q2xpY2s6IGJvb2xlYW4gPSBmYWxzZTsKCgoKCiAgICAvKioKICAgICAqIOihqOagvOaYr+WQpuaYvuekugogICAgICoKICAgICAqIEB0eXBlIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBpc0Rpc3BsYXk6Ym9vbGVhbiA9IHRydWU7CgogICAgLyoqCiAgICAgKiDpg6jku7bliLfmlrAKICAgICAqCiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHJlZnJlc2goYXJnczogYW55W10pOiB2b2lkIHsKICAgICAgICB0aGlzLmxvYWQoKTsKICAgIH0KCiAgICAvKioKICAgICog6YCJ6aG55qGG5YiX5a69CiAgICAqCiAgICAqIEB0eXBlIHtudW1iZXJ9CiAgICAqIEBtZW1iZXJvZiBBcHBJbmRleAogICAgKi8KICAgIHB1YmxpYyBjaGVja2JveENvbFdpZHRoOiBudW1iZXIgPSAzNDsKCiAgICAvKioKICAgICAqIOaYr+WQpuWFgeiuuOaLluWKqOWIl+WuvQogICAgICoKICAgICAqIEB0eXBlIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIEFwcEVtYmVkUGlja2VyCiAgICAgKi8KICAgIHB1YmxpYyBpc0RyYWdlbmRDb2w6IGJvb2xlYW4gPSBmYWxzZTsKCiAgICAvKioKICAgICAqIOaJgOacieWIl+aIkOWRmAogICAgICoKICAgICAqIEB0eXBlIHthbnlbXX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgYWxsQ29sdW1uczogYW55W10gPSBbCiAgICAgICAgewogICAgICAgICAgICBuYW1lOiAnb3Jtc2lnbm9yZ25hbWUnLAogICAgICAgICAgICBsYWJlbDogJ+azleS6uuS4u+S9k+e7hOe7hycsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5vcm1zaWdub3JnLm1haW5fZ3JpZC5jb2x1bW5zLm9ybXNpZ25vcmduYW1lJywKICAgICAgICAgICAgc2hvdzogdHJ1ZSwKICAgICAgICAgICAgdXRpbDogJ1BYJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBuYW1lOiAnb3JnY29kZScsCiAgICAgICAgICAgIGxhYmVsOiAn57uE57uH57yW5Y+3JywKICAgICAgICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLm9ybXNpZ25vcmcubWFpbl9ncmlkLmNvbHVtbnMub3JnY29kZScsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgXQoKICAgIC8qKgogICAgICog6KGo5qC85qih5Z6L6ZuG5ZCICiAgICAgKgogICAgICogQHR5cGUgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdyaWRJdGVtc01vZGVsOiBhbnlbXSA9IFtdOwoKICAgIC8qKgogICAgICog6I635Y+W6KGo5qC86KGM5qih5Z6LCiAgICAgKgogICAgICogQHR5cGUgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldEdyaWRSb3dNb2RlbCgpewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBvcmdjb2RlOiBuZXcgRm9ybUl0ZW1Nb2RlbCgpLAogICAgICAgICAgb3Jtc2lnbm9yZ25hbWU6IG5ldyBGb3JtSXRlbU1vZGVsKCksCiAgICAgICAgICBzcmZrZXk6IG5ldyBGb3JtSXRlbU1vZGVsKCksCiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog5bGe5oCn5YC86KeE5YiZCiAgICAgKgogICAgICogQHR5cGUgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHJ1bGVzOiBhbnkgPSB7CiAgICAgICAgb3JnY29kZTogWwogICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+e7hOe7h+e8luWPtyDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LAogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn57uE57uH57yW5Y+3IOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LAogICAgICAgIF0sCiAgICAgICAgb3Jtc2lnbm9yZ25hbWU6IFsKICAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB2YWxpZGF0b3I6IChydWxlOmFueSwgdmFsdWU6YW55LCBjYWxsYmFjazphbnkpID0+IHsgcmV0dXJuIChydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikpID8gZmFsc2UgOiB0cnVlO30sIG1lc3NhZ2U6ICfms5XkurrkuLvkvZPnu4Tnu4cg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2NoYW5nZScgfSwKICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+azleS6uuS4u+S9k+e7hOe7hyDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwKICAgICAgICBdLAogICAgICAgIHNyZmtleTogWwogICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+azleS6uuS4u+S9k+agh+ivhiDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LAogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn5rOV5Lq65Li75L2T5qCH6K+GIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LAogICAgICAgIF0sCiAgICB9CgogICAgLyoqCiAgICAgKiDooajmoLzooYznvJbovpHpobnmoKHpqowKICAgICAqCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHkg5bGe5oCn5ZCNCiAgICAgKiBAcGFyYW0geyp9IGRhdGEg6KGM5pWw5o2uCiAgICAgKiBAcGFyYW0ge251bWJlcn0gcm93SW5kZXgg6KGM57Si5byVCiAgICAgKiBAcmV0dXJucyBQcm9taXNlPGFueT4KICAgICAqIAogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyB2YWxpZGF0ZShwcm9wZXJ0eTpzdHJpbmcsIGRhdGE6YW55LCByb3dJbmRleDpudW1iZXIpOlByb21pc2U8YW55PnsKICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICAgICAgICB0aGlzLiR1dGlsLnZhbGlkYXRlSXRlbShwcm9wZXJ0eSxkYXRhLHRoaXMucnVsZXMpLnRoZW4oKCk9PnsKICAgICAgICAgICAgICAgIHRoaXMuZ3JpZEl0ZW1zTW9kZWxbcm93SW5kZXhdW3Byb3BlcnR5XS5zZXRFcnJvcihudWxsKTsKICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgICAgIH0pLmNhdGNoKCh7IGVycm9ycywgZmllbGRzIH0pID0+IHsKICAgICAgICAgICAgICAgIHRoaXMuZ3JpZEl0ZW1zTW9kZWxbcm93SW5kZXhdW3Byb3BlcnR5XS5zZXRFcnJvcihlcnJvcnNbMF0ubWVzc2FnZSk7CiAgICAgICAgICAgICAgICByZXNvbHZlKGZhbHNlKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDmoKHpqozmiYDmnInkv67mlLnov4fnmoTnvJbovpHpobkKICAgICAqCiAgICAgKiBAcmV0dXJucyBQcm9taXNlPGFueT4KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgYXN5bmMgdmFsaWRhdGVBbGwoKXsKICAgICAgICBsZXQgdmFsaWRhdGVTdGF0ZSA9IHRydWU7CiAgICAgICAgbGV0IGluZGV4ID0gLTE7CiAgICAgICAgZm9yKGxldCBpdGVtIG9mIHRoaXMuaXRlbXMpewogICAgICAgICAgaW5kZXgrKzsKICAgICAgICAgIGlmKGl0ZW0ucm93RGF0YVN0YXRlID09PSAiY3JlYXRlIiB8fCBpdGVtLnJvd0RhdGFTdGF0ZSA9PT0gInVwZGF0ZSIpewogICAgICAgICAgICBmb3IobGV0IHByb3BlcnR5IG9mIE9iamVjdC5rZXlzKHRoaXMucnVsZXMpKXsKICAgICAgICAgICAgICBpZighYXdhaXQgdGhpcy52YWxpZGF0ZShwcm9wZXJ0eSxpdGVtLGluZGV4KSl7CiAgICAgICAgICAgICAgICB2YWxpZGF0ZVN0YXRlID0gZmFsc2U7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB2YWxpZGF0ZVN0YXRlOwogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC85pWw5o2u5Yqg6L29CiAgICAgKgogICAgICogQHBhcmFtIHsqfSBbYXJnPXt9XQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBsb2FkKG9wdDogYW55ID0ge30sIHBhZ2VSZXNldDogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7CiAgICAgICAgaWYoIXRoaXMuZmV0Y2hBY3Rpb24pewogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICdPcm1TaWduT3JnUGlja3VwR3JpZFZpZXfop4blm77ooajmoLxmZXRjaEFjdGlvbuWPguaVsOacqumFjee9ricgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYocGFnZVJlc2V0KXsKICAgICAgICAgICAgdGhpcy5jdXJQYWdlID0gMTsKICAgICAgICB9CiAgICAgICAgY29uc3QgYXJnOiBhbnkgPSB7Li4ub3B0fTsKICAgICAgICBjb25zdCBwYWdlOiBhbnkgPSB7fTsKICAgICAgICBpZiAodGhpcy5pc0VuYWJsZVBhZ2luZ0JhcikgewogICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsgcGFnZTogdGhpcy5jdXJQYWdlLTEsIHNpemU6IHRoaXMubGltaXQgfSk7CiAgICAgICAgfQogICAgICAgIC8vIOiuvue9ruaOkuW6jwogICAgICAgIGlmICghdGhpcy5pc05vU29ydCAmJiAhT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0RGlyLCAnJykgJiYgIU9iamVjdC5pcyh0aGlzLm1pbm9yU29ydFBTREVGLCAnJykpIHsKICAgICAgICAgICAgY29uc3Qgc29ydDogc3RyaW5nID0gdGhpcy5taW5vclNvcnRQU0RFRisiLCIrdGhpcy5taW5vclNvcnREaXI7CiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFnZSwgeyBzb3J0OiBzb3J0IH0pOwogICAgICAgIH0KICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgcGFnZSk7CiAgICAgICAgY29uc3QgcGFyZW50ZGF0YTogYW55ID0ge307CiAgICAgICAgdGhpcy4kZW1pdCgnYmVmb3JlbG9hZCcsIHBhcmVudGRhdGEpOwogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCBwYXJlbnRkYXRhKTsKICAgICAgICBsZXQgdGVtcFZpZXdQYXJhbXM6YW55ID0gcGFyZW50ZGF0YS52aWV3cGFyYW1zP3BhcmVudGRhdGEudmlld3BhcmFtczp7fTsKICAgICAgICBPYmplY3QuYXNzaWduKHRlbXBWaWV3UGFyYW1zLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy52aWV3cGFyYW1zKSkpOwogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLHt2aWV3cGFyYW1zOnRlbXBWaWV3UGFyYW1zfSk7CiAgICAgICAgY29uc3QgcG9zdDogUHJvbWlzZTxhbnk+ID0gdGhpcy5zZXJ2aWNlLnNlYXJjaCh0aGlzLmZldGNoQWN0aW9uLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGFyZywgdGhpcy5zaG93QnVzeUluZGljYXRvcik7CiAgICAgICAgcG9zdC50aGVuKChyZXNwb25zZTogYW55KSA9PiB7CiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JNZXNzYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiByZXNwb25zZS5lcnJvck1lc3NhZ2UgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgZGF0YTogYW55ID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgdGhpcy50b3RhbHJvdyA9IHJlc3BvbnNlLnRvdGFsOwogICAgICAgICAgICB0aGlzLml0ZW1zID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgIC8vIOa4heepunNlbGVjdGlvbnMsZ3JpZEl0ZW1zTW9kZWwKICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgICAgIHRoaXMuZ3JpZEl0ZW1zTW9kZWwgPSBbXTsKICAgICAgICAgICAgdGhpcy5pdGVtcy5mb3JFYWNoKCgpPT57dGhpcy5ncmlkSXRlbXNNb2RlbC5wdXNoKHRoaXMuZ2V0R3JpZFJvd01vZGVsKCkpfSk7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2xvYWQnLCB0aGlzLml0ZW1zKTsKICAgICAgICAgICAgLy8g6K6+572u6buY6K6k6YCJ5LitCiAgICAgICAgICAgIGxldCBfdGhpcyA9IHRoaXM7CiAgICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICAgICAgaWYoX3RoaXMuaXNTZWxlY3RGaXJzdERlZmF1bHQpewogICAgICAgICAgICAgICAgICBfdGhpcy5yb3dDbGljayhfdGhpcy5pdGVtc1swXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZihfdGhpcy5zZWxlY3RlZERhdGEpewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlZnM6IGFueSA9IF90aGlzLiRyZWZzOwogICAgICAgICAgICAgICAgICAgIGlmIChyZWZzLm11bHRpcGxlVGFibGUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICAgICAgICAgICAgICAgIEpTT04ucGFyc2UoX3RoaXMuc2VsZWN0ZWREYXRhKS5mb3JFYWNoKChzZWxlY3Rpb246YW55KT0+ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNlbGVjdGVkSXRlbSA9IF90aGlzLml0ZW1zLmZpbmQoKGl0ZW06YW55KT0+ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBPYmplY3QuaXMoaXRlbS5zcmZrZXksIHNlbGVjdGlvbi5zcmZrZXkpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihzZWxlY3RlZEl0ZW0pewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnJvd0NsaWNrKHNlbGVjdGVkSXRlbSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSwgMzAwKTsKICAgICAgICB9KS5jYXRjaCgocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6IHJlc3BvbnNlLmVycm9yTWVzc2FnZSB9KTsKICAgICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIOWIoOmZpAogICAgICoKICAgICAqIEBwYXJhbSB7YW55W119IGRhdGFzCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBhc3luYyByZW1vdmUoZGF0YXM6IGFueVtdKTogUHJvbWlzZTxhbnk+IHsKICAgICAgICBpZighdGhpcy5yZW1vdmVBY3Rpb24pewogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICdPcm1TaWduT3JnUGlja3VwR3JpZFZpZXfop4blm77ooajmoLxyZW1vdmVBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCBfZGF0YXM6YW55W10gPSBbXTsKICAgICAgICBkYXRhcy5mb3JFYWNoKChyZWNvcmQ6IGFueSwgaW5kZXg6IG51bWJlcikgPT4gewogICAgICAgICAgICBpZiAoT2JqZWN0LmlzKHJlY29yZC5zcmZ1ZiwiMCIpKSB7CiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLnNvbWUoKHZhbDogYW55LCBudW06IG51bWJlcikgPT57CiAgICAgICAgICAgICAgICAgICAgaWYoSlNPTi5zdHJpbmdpZnkodmFsKSA9PSBKU09OLnN0cmluZ2lmeShyZWNvcmQpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5zcGxpY2UobnVtLDEpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyaWRJdGVtc01vZGVsLnNwbGljZShudW0sMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOyAKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgIF9kYXRhcy5wdXNoKGRhdGFzW2luZGV4XSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBpZiAoX2RhdGFzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCBkYXRhSW5mbyA9ICcnOwogICAgICAgIF9kYXRhcy5mb3JFYWNoKChyZWNvcmQ6IGFueSwgaW5kZXg6IG51bWJlcikgPT4gewogICAgICAgICAgICBsZXQgc3JmbWFqb3J0ZXh0ID0gcmVjb3JkLm9ybXNpZ25vcmduYW1lOwogICAgICAgICAgICBpZiAoaW5kZXggPCA1KSB7CiAgICAgICAgICAgICAgICBpZiAoIU9iamVjdC5pcyhkYXRhSW5mbywgJycpKSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YUluZm8gKz0gJ+OAgSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkYXRhSW5mbyArPSBzcmZtYWpvcnRleHQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaWYgKF9kYXRhcy5sZW5ndGggPCA1KSB7CiAgICAgICAgICAgIGRhdGFJbmZvID0gZGF0YUluZm8gKyAnIOWFsScgKyBfZGF0YXMubGVuZ3RoICsgJ+adoeaVsOaNric7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGF0YUluZm8gPSBkYXRhSW5mbyArICcuLi4nICsgJyDlhbEnICsgX2RhdGFzLmxlbmd0aCArICfmnaHmlbDmja4nOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVtb3ZlRGF0YSA9ICgpID0+IHsKICAgICAgICAgICAgbGV0IGtleXM6IGFueVtdID0gW107CiAgICAgICAgICAgIF9kYXRhcy5mb3JFYWNoKChkYXRhOiBhbnkpID0+IHsKICAgICAgICAgICAgICAgIGtleXMucHVzaChkYXRhLnNyZmtleSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsZXQgX3JlbW92ZUFjdGlvbiA9IGtleXMubGVuZ3RoID4gMSA/ICdyZW1vdmVCYXRjaCcgOiB0aGlzLnJlbW92ZUFjdGlvbiA7CiAgICAgICAgICAgIGxldCBfa2V5cyA9IGtleXMubGVuZ3RoID4gMSA/IGtleXMgOiBrZXlzWzBdIDsKICAgICAgICAgICAgY29uc3QgY29udGV4dDphbnkgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpOwogICAgICAgICAgICBjb25zdCBwb3N0OiBQcm9taXNlPGFueT4gPSB0aGlzLnNlcnZpY2UuZGVsZXRlKF9yZW1vdmVBY3Rpb24sT2JqZWN0LmFzc2lnbihjb250ZXh0LHsgb3Jtc2lnbm9yZzogX2tleXMgfSksT2JqZWN0LmFzc2lnbih7IG9ybXNpZ25vcmc6IF9rZXlzIH0se3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSksIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmU6IGFueSwgcmVqZWN0OiBhbnkpID0+IHsKICAgICAgICAgICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICcnLCBkZXNjOiAn5Yig6Zmk5pWw5o2u5aSx6LSlLCcgKyByZXNwb25zZS5pbmZvIH0pOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLnN1Y2Nlc3MoeyB0aXRsZTogJycsIGRlc2M6ICfliKDpmaTmiJDlip8hJyB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy/liKDpmaRpdGVtc+S4reW3suWIoOmZpOeahOmhuQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuaXRlbXMpOwogICAgICAgICAgICAgICAgICAgIF9kYXRhcy5mb3JFYWNoKChkYXRhOiBhbnkpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5zb21lKChpdGVtOmFueSxpbmRleDpudW1iZXIpPT57CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihPYmplY3QuaXMoaXRlbS5zcmZrZXksZGF0YS5zcmZrZXkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLnNwbGljZShpbmRleCwxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyaWRJdGVtc01vZGVsLnNwbGljZShpbmRleCwxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbHJvdyAtPSBfZGF0YXMubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3JlbW92ZScsIG51bGwpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn57O757uf5byC5bi4JyB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZGF0YUluZm8gPSBkYXRhSW5mby5yZXBsYWNlKC9bbnVsbF0vZywgJycpLnJlcGxhY2UoL1t1bmRlZmluZWRdL2csICcnKTsKICAgICAgICB0aGlzLiRNb2RhbC5jb25maXJtKHsKICAgICAgICAgICAgdGl0bGU6ICforablkYonLAogICAgICAgICAgICBjb250ZW50OiAn56Gu6K6k6KaB5Yig6ZmkICcgKyBkYXRhSW5mbyArICfvvIzliKDpmaTmk43kvZzlsIbkuI3lj6/mgaLlpI3vvJ8nLAogICAgICAgICAgICBvbk9rOiAoKSA9PiB7CiAgICAgICAgICAgICAgICByZW1vdmVEYXRhKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7IH0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gcmVtb3ZlRGF0YTsKICAgIH0KCgogICAgLyoqCiAgICAgKiDmibnph4/mt7vliqAKICAgICAqCiAgICAgKiBAcGFyYW0geyp9IFthcmc9e31dCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGFkZEJhdGNoKGFyZzogYW55ID0ge30pOiB2b2lkIHsKICAgICAgICBpZighdGhpcy5mZXRjaEFjdGlvbil7CiAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ09ybVNpZ25PcmdQaWNrdXBHcmlkVmlld+inhuWbvuihqOagvGZldGNoQWN0aW9u5Y+C5pWw5pyq6YWN572uJyB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZighYXJnKXsKICAgICAgICAgICAgYXJnID0ge307CiAgICAgICAgfQogICAgICAgIGNvbnNvbGUuZXJyb3IoIuaJuemHj+a3u+WKoOacquWunueOsCIpOwogICAgfQoKICAgIC8qKgogICAgICog5pWw5o2u5a+85YWlCiAgICAgKgogICAgICogQHBhcmFtIHsqfSBkYXRhCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgIHB1YmxpYyBpbXBvcnRFeGNlbChkYXRhOmFueSA9e30pOnZvaWR7CiAgICAgICAgLy/lr7zlhaVleGNlbAogICAgICAgIGNvbnN0IGltcG9ydERhdGFNb2RlbDphbnkgPXsKICAgICAgICB9CiAgICAgICAgaWYoT2JqZWN0LmtleXMoaW1wb3J0RGF0YU1vZGVsKS5sZW5ndGggPT0gMCl7CiAgICAgICAgICAgIHRoaXMuJE5vdGljZS53YXJuaW5nKHsgJ3RpdGxlJzogKHRoaXMuJHQoImFwcC51dGlsdmlldy53YXJuaW5nIikgYXMgc3RyaW5nKSwgJ2Rlc2MnOiAodGhpcy4kdCgiYXBwLnV0aWx2aWV3LmluZm8iKSBhcyBzdHJpbmcpIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IHZpZXc6YW55ID17CiAgICAgICAgICAgIHZpZXduYW1lOiAnYXBwLWRhdGEtdXBsb2FkJywKICAgICAgICAgICAgdGl0bGU6IHRoaXMuJHQoImFwcC51dGlsdmlldy5pbXBvcnR2aWV3IiksCiAgICAgICAgICAgIHdpZHRoOiA5MDAsCiAgICAgICAgICAgIGhlaWdodDogNzAwCiAgICAgICAgfQogICAgICAgIGxldCBjb250YWluZXI6IFN1YmplY3Q8YW55PiA9IHRoaXMuJGFwcG1vZGFsLm9wZW5Nb2RhbCh2aWV3LCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBpbXBvcnREYXRhTW9kZWwpOwogICAgICAgIGNvbnRhaW5lci5zdWJzY3JpYmUoKHJlc3VsdDogYW55KSA9PiB7CiAgICAgICAgICBpZihPYmplY3QuaXMocmVzdWx0LnJldCwnT0snKSl7CiAgICAgICAgICAgIHRoaXMucmVmcmVzaChyZXN1bHQuZGF0YXMpOwogICAgICAgICAgfQogICAgICB9KTsKICAgIH0KCgogICAgLyoqCiAgICAgKiDmlbDmja7lr7zlh7oKICAgICAqCiAgICAgKiBAcGFyYW0geyp9IGRhdGEKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgZXhwb3J0RXhjZWwoZGF0YTogYW55ID0ge30pOiB2b2lkIHsKICAgICAgICAvLyDlr7zlh7pFeGNlbAogICAgICAgIGNvbnN0IGRvRXhwb3J0ID0gYXN5bmMgKF9kYXRhOmFueSkgPT4gewogICAgICAgICAgICBjb25zdCB0SGVhZGVyOiBBcnJheTxhbnk+ID0gW107CiAgICAgICAgICAgIGNvbnN0IGZpbHRlclZhbDogQXJyYXk8YW55PiA9IFtdOwogICAgICAgICAgICB0aGlzLmFsbENvbHVtbnMuZm9yRWFjaCgoaXRlbTogYW55KSA9PiB7CiAgICAgICAgICAgICAgaXRlbS5zaG93ICYmIGl0ZW0ubGFiZWwgPyB0SGVhZGVyLnB1c2godGhpcy4kdChpdGVtLmxhbmd0YWcpKSA6ICIiOwogICAgICAgICAgICAgIGl0ZW0uc2hvdyAmJiBpdGVtLm5hbWUgPyBmaWx0ZXJWYWwucHVzaChpdGVtLm5hbWUpIDogIiI7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5mb3JtYXRFeGNlbERhdGEoZmlsdGVyVmFsLCBfZGF0YSk7CiAgICAgICAgICAgIHRoaXMuJGV4cG9ydC5leHBvcnRFeGNlbCgpLnRoZW4oKGV4Y2VsOmFueSk9PnsKICAgICAgICAgICAgICAgIGV4Y2VsLmV4cG9ydF9qc29uX3RvX2V4Y2VsKHsKICAgICAgICAgICAgICAgICAgaGVhZGVyOiB0SGVhZGVyLCAvL+ihqOWktCDlv4XloasKICAgICAgICAgICAgICAgICAgZGF0YSwgLy/lhbfkvZPmlbDmja4g5b+F5aGrCiAgICAgICAgICAgICAgICAgIGZpbGVuYW1lOiAi5rOV5Lq65Li75L2T6KGoIiwgLy/pnZ7lv4XloasKICAgICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLCAvL+mdnuW/heWhqwogICAgICAgICAgICAgICAgICBib29rVHlwZTogInhsc3giIC8v6Z2e5b+F5aGrCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7IAogICAgICAgIH07CiAgICAgICAgY29uc3QgcGFnZTogYW55ID0ge307CiAgICAgICAgLy8g6K6+572ucGFnZe+8jHNpemUKICAgICAgICBpZiAoT2JqZWN0LmlzKGRhdGEudHlwZSwgJ21heFJvd0NvdW50JykpIHsKICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihwYWdlLCB7IHBhZ2U6IDAsIHNpemU6IGRhdGEubWF4Um93Q291bnQgfSk7CiAgICAgICAgfSBlbHNlIGlmIChPYmplY3QuaXMoZGF0YS50eXBlLCAnYWN0aXZhdGVkUGFnZScpKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBkb0V4cG9ydChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuaXRlbXMpKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vIOiuvue9ruaOkuW6jwogICAgICAgIGlmICghdGhpcy5pc05vU29ydCAmJiAhT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0RGlyLCAnJykgJiYgIU9iamVjdC5pcyh0aGlzLm1pbm9yU29ydFBTREVGLCAnJykpIHsKICAgICAgICAgIGNvbnN0IHNvcnQ6IHN0cmluZyA9IHRoaXMubWlub3JTb3J0UFNERUYrIiwiK3RoaXMubWlub3JTb3J0RGlyOwogICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsgc29ydDogc29ydCB9KTsKICAgICAgICB9CiAgICAgICAgY29uc3QgYXJnOiBhbnkgPSB7fTsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgcGFnZSk7CiAgICAgICAgLy8g6I635Y+WcXVlcnks5pCc57Si6KGo5Y2V77yMdmlld3BhcmFtc+etieeItuaVsOaNrgogICAgICAgIGNvbnN0IHBhcmVudGRhdGE6IGFueSA9IHt9OwogICAgICAgIHRoaXMuJGVtaXQoJ2JlZm9yZWxvYWQnLCBwYXJlbnRkYXRhKTsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgcGFyZW50ZGF0YSk7CiAgICAgICAgY29uc3QgcG9zdDogUHJvbWlzZTxhbnk+ID0gdGhpcy5zZXJ2aWNlLnNlYXJjaCh0aGlzLmZldGNoQWN0aW9uLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGFyZywgdGhpcy5zaG93QnVzeUluZGljYXRvcik7CiAgICAgICAgcG9zdC50aGVuKChyZXNwb25zZTogYW55KSA9PiB7CiAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAnJywgZGVzYzogJ+aVsOaNruWvvOWHuuWksei0pSwnICsgcmVzcG9uc2UuaW5mbyB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgZG9FeHBvcnQoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhKSkpOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICB9KS5jYXRjaCgocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJycsIGRlc2M6ICfmlbDmja7lr7zlh7rlpLHotKUnIH0pOwogICAgICAgIH0pOwogICAgfQoKCiAgICAvKioKICAgICAqIOWvvOWHuuaVsOaNruagvOW8j+WMlgogICAgICogCiAgICAgKiBAcGFyYW0geyp9IGZpbHRlclZhbAogICAgICogQHBhcmFtIHsqfSBqc29uRGF0YQogICAgICogQHJldHVybnMge1tdfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBhc3luYyBmb3JtYXRFeGNlbERhdGEoZmlsdGVyVmFsOmFueSwganNvbkRhdGE6YW55KSB7CiAgICAgICAgbGV0IGNvZGVsaXN0Q29sdW1uczpBcnJheTxhbnk+ID0gWwogICAgICAgIF07CiAgICAgICAgbGV0IF90aGlzID0gdGhpczsKICAgICAgICBmb3IgKGNvbnN0IGNvZGVsaXN0IG9mIGNvZGVsaXN0Q29sdW1ucykgewogICAgICAgICAgLy8g5Yqo5oCB5Luj56CB6KGo5aSE55CGCiAgICAgICAgICBpZiAoT2JqZWN0LmlzKGNvZGVsaXN0LmNvZGVsaXN0VHlwZSwgIkRZTkFNSUMiKSkgewogICAgICAgICAgICAgIGxldCBpdGVtcyA9IGF3YWl0IF90aGlzLmNvZGVMaXN0U2VydmljZS5nZXRJdGVtcyhjb2RlbGlzdC5zcmZrZXkpOwogICAgICAgICAgICAgIGpzb25EYXRhLmZvckVhY2goKHJvdzphbnkpPT57CiAgICAgICAgICAgICAgICAgIHJvd1tjb2RlbGlzdC5uYW1lXSA9IF90aGlzLmdldENvZGVsaXN0VmFsdWUoaXRlbXMsIHJvd1tjb2RlbGlzdC5uYW1lXSwgY29kZWxpc3QpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgLy8g6Z2Z5oCB5aSE55CGCiAgICAgICAgICB9IGVsc2UgaWYoT2JqZWN0LmlzKGNvZGVsaXN0LmNvZGVsaXN0VHlwZSwgIlNUQVRJQyIpKXsKICAgICAgICAgICAgICBsZXQgaXRlbXMgPSBhd2FpdCBfdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDb2RlTGlzdEl0ZW1zKGNvZGVsaXN0LnNyZmtleSk7CiAgICAgICAgICAgICAganNvbkRhdGEuZm9yRWFjaCgocm93OmFueSk9PnsKICAgICAgICAgICAgICAgICAgcm93W2NvZGVsaXN0Lm5hbWVdID0gX3RoaXMuZ2V0Q29kZWxpc3RWYWx1ZShpdGVtcywgcm93W2NvZGVsaXN0Lm5hbWVdLCBjb2RlbGlzdCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBqc29uRGF0YS5tYXAoKHY6YW55KSA9PiBmaWx0ZXJWYWwubWFwKChqOmFueSkgPT4gdltqXSkpCiAgICB9ICAgCgoKICAgIC8qKgogICAgICog6Kej5p6Q5Luj56CB6KGo5ZKMdmxhdWXvvIzorr7nva5pdGVtcwogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBwYXJhbSB7YW55W119IGl0ZW1zIOS7o+eggeihqOaVsOaNrgogICAgICogQHBhcmFtIHsqfSB2YWx1ZQogICAgICogQHJldHVybnMgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldENvZGVsaXN0VmFsdWUoaXRlbXM6IGFueVtdLCB2YWx1ZTogYW55LCBjb2RlbGlzdDogYW55LCl7CiAgICAgICAgaWYoIXZhbHVlKXsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHQoJ2NvZGVsaXN0LicrY29kZWxpc3Quc3Jma2V5KycuZW1wdHknKTsKICAgICAgICB9CiAgICAgICAgaWYgKGl0ZW1zKSB7CiAgICAgICAgICAgIGxldCByZXN1bHQ6YW55ID0gW107CiAgICAgICAgICAgIGlmKE9iamVjdC5pcyhjb2RlbGlzdC5yZW5kZXJNb2RlLCJudW1iZXIiKSl7CiAgICAgICAgICAgICAgICBpdGVtcy5tYXAoKF9pdGVtOiBhbnksIGluZGV4OiBudW1iZXIpPT57CiAgICAgICAgICAgICAgICAgICAgY29uc3QgblZhbHVlID0gcGFyc2VJbnQoKHZhbHVlIGFzIGFueSksIDEwKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2RldmFsdWUgPSBfaXRlbS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBpZigocGFyc2VJbnQoY29kZXZhbHVlLCAxMCkgJiBuVmFsdWUpID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKF9pdGVtKTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZihPYmplY3QuaXMoY29kZWxpc3QucmVuZGVyTW9kZSwic3RyaW5nIikpewogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlWYWx1ZTogQXJyYXk8YW55PiA9ICh2YWx1ZSBhcyBhbnkpLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKTsKICAgICAgICAgICAgICAgIGFycmF5VmFsdWUubWFwKCh2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goW10pOwogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZXM6IGFueVtdID0gT2JqZWN0LmlzKHRoaXMuJHV0aWwudHlwZU9mKHZhbHVlKSwgJ251bWJlcicpID8gW3ZhbHVlXSA6IFsuLi4odmFsdWUgYXMgYW55KS5zcGxpdChjb2RlbGlzdC52YWx1ZVNlcGFyYXRvcildOwogICAgICAgICAgICAgICAgICAgIHZhbHVlcy5tYXAoKHZhbDphbnkgLG51bTogbnVtYmVyKT0+ewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5nZXRJdGVtKGl0ZW1zLCB2YWwsIGNvZGVsaXN0KTsgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0pewogICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtpbmRleF0ucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbGV0IHZhbHVlczogYW55W10gPSBPYmplY3QuaXModGhpcy4kdXRpbC50eXBlT2YodmFsdWUpLCAnbnVtYmVyJykgPyBbdmFsdWVdIDogWy4uLih2YWx1ZSBhcyBhbnkpLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKV07CiAgICAgICAgICAgICAgICB2YWx1ZXMubWFwKCh2YWx1ZTphbnkgLGluZGV4OiBudW1iZXIpPT57CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZ2V0SXRlbShpdGVtcywgdmFsdWUsIGNvZGVsaXN0KTsgCiAgICAgICAgICAgICAgICAgICAgaWYoaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g6K6+572uaXRlbXMKICAgICAgICAgICAgaWYocmVzdWx0Lmxlbmd0aCAhPSAwKXsKICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmpvaW4oY29kZWxpc3QudmFsdWVTZXBhcmF0b3IpOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5bku6PnoIHpobkKICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAcGFyYW0ge2FueVtdfSBpdGVtcwogICAgICogQHBhcmFtIHsqfSB2YWx1ZQogICAgICogQHJldHVybnMgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldEl0ZW0oaXRlbXM6IGFueVtdLCB2YWx1ZTogYW55LCBjb2RlbGlzdDogYW55KTogYW55IHsKICAgICAgICBjb25zdCBhcnI6IEFycmF5PGFueT4gPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiB7cmV0dXJuIGl0ZW0udmFsdWUgPT0gdmFsdWV9KTsKICAgICAgICBpZiAoYXJyLmxlbmd0aCAhPT0gMSkgewogICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgICBpZihPYmplY3QuaXMoY29kZWxpc3QuY29kZWxpc3RUeXBlLCdTVEFUSUMnKSl7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiR0KCdjb2RlbGlzdC4nK2NvZGVsaXN0LnNyZmtleSsnLicrYXJyWzBdLnZhbHVlKTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgcmV0dXJuIGFyclswXS50ZXh0OwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIOeUn+WRveWRqOacnwogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgY3JlYXRlZCgpOiB2b2lkIHsKICAgICAgICB0aGlzLmFmdGVyQ3JlYXRlZCgpOwogICAgfQoKICAgIC8qKgogICAgICog5omn6KGMY3JlYXRlZOWQjueahOmAu+i+kQogICAgICoKICAgICAqICBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLyAgICAKICAgIHB1YmxpYyBhZnRlckNyZWF0ZWQoKXsKICAgICAgICB0aGlzLnNldENvbFN0YXRlKCk7CiAgICAgICAgaWYgKHRoaXMudmlld1N0YXRlKSB7CiAgICAgICAgICAgIHRoaXMudmlld1N0YXRlRXZlbnQgPSB0aGlzLnZpZXdTdGF0ZS5zdWJzY3JpYmUoKHsgdGFnLCBhY3Rpb24sIGRhdGEgfSkgPT4gewogICAgICAgICAgICAgICAgaWYgKCFPYmplY3QuaXModGFnLCB0aGlzLm5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKE9iamVjdC5pcygnbG9hZCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdyZW1vdmUnLCBhY3Rpb24pKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdzYXZlJywgYWN0aW9uKSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZShkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogdnVlIOeUn+WRveWRqOacnwogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgZGVzdHJveWVkKCkgewogICAgICAgIHRoaXMuYWZ0ZXJEZXN0cm95KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiDmiafooYxkZXN0cm95ZWTlkI7nmoTpgLvovpEKICAgICAqCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGFmdGVyRGVzdHJveSgpIHsKICAgICAgICBpZiAodGhpcy52aWV3U3RhdGVFdmVudCkgewogICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZUV2ZW50LnVuc3Vic2NyaWJlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog6I635Y+W6YCJ5Lit6KGM6IOh5pWw5o2uCiAgICAgKgogICAgICogQHJldHVybnMge2FueVtdfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBnZXRTZWxlY3Rpb24oKTogYW55W10gewogICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiDooYzlj4zlh7vkuovku7YKICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHJvd0RCTENsaWNrKCRldmVudDogYW55KTogdm9pZCB7CiAgICAgICAgaWYgKCEkZXZlbnQgfHwgdGhpcy5hY3R1YWxJc09wZW5FZGl0IHx8IE9iamVjdC5pcyh0aGlzLmdyaWRSb3dBY3RpdmVNb2RlLDApKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSgkZXZlbnQpKSk7CgogICAgICAgIGNvbnN0IHJlZnM6IGFueSA9IHRoaXMuJHJlZnM7CiAgICAgICAgaWYgKHJlZnMubXVsdGlwbGVUYWJsZSkgewogICAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUuY2xlYXJTZWxlY3Rpb24oKTsKICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbigkZXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kZW1pdCgncm93ZGJsY2xpY2snLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiDlpI3pgInmoYbmlbDmja7pgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHNlbGVjdCgkZXZlbnQ6IGFueSk6IHZvaWQgewogICAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gWy4uLkpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoJGV2ZW50KSldOwogICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiDlpI3pgInmoYbmlbDmja7lhajpg6jpgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBzZWxlY3RBbGwoJGV2ZW50OiBhbnkpOiB2b2lkIHsKICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFsuLi5KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KCRldmVudCkpXTsKICAgICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgfQoKICAgIAogICAgLyoqCiAgICAgKiDooYzljZXlh7vpgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHJvd0NsaWNrKCRldmVudDogYW55LCBpZkFsd2F5czogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7CiAgICAgICAgaWYgKCFpZkFsd2F5cyAmJiAoISRldmVudCB8fCB0aGlzLmFjdHVhbElzT3BlbkVkaXQpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYodGhpcy5zdG9wUm93Q2xpY2spIHsKICAgICAgICAgICAgdGhpcy5zdG9wUm93Q2xpY2sgPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZih0aGlzLmlzU2luZ2xlU2VsZWN0KXsKICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgfQogICAgICAgIC8vIOW3sumAieS4reWImeWIoOmZpO+8jOayoemAieS4reWImea3u+WKoAogICAgICAgIGxldCBzZWxlY3RJbmRleCA9IHRoaXMuc2VsZWN0aW9ucy5maW5kSW5kZXgoKGl0ZW06YW55KT0+ewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0ub3Jtc2lnbm9yZywkZXZlbnQub3Jtc2lnbm9yZyk7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKE9iamVjdC5pcyhzZWxlY3RJbmRleCwtMSkpewogICAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSgkZXZlbnQpKSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5zcGxpY2Uoc2VsZWN0SW5kZXgsMSk7CiAgICAgICAgfQoKICAgICAgICBjb25zdCByZWZzOiBhbnkgPSB0aGlzLiRyZWZzOwogICAgICAgIGlmIChyZWZzLm11bHRpcGxlVGFibGUpIHsKICAgICAgICAgICAgaWYodGhpcy5pc1NpbmdsZVNlbGVjdCl7CiAgICAgICAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUuY2xlYXJTZWxlY3Rpb24oKTsKICAgICAgICAgICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS5zZXRDdXJyZW50Um93KCRldmVudCk7CiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbigkZXZlbnQpOyAKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgdGhpcy4kZW1pdCgnc2VsZWN0aW9uY2hhbmdlJywgdGhpcy5zZWxlY3Rpb25zKTsKICAgIH0KCgogICAgLyoqCiAgICAgKiDpobXpnaLlj5jljJYKICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHBhZ2VPbkNoYW5nZSgkZXZlbnQ6IGFueSk6IHZvaWQgewogICAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCRldmVudCA9PT0gdGhpcy5jdXJQYWdlKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5jdXJQYWdlID0gJGV2ZW50OwogICAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDliIbpobXmnaHmlbDlj5jljJYKICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIG9uUGFnZVNpemVDaGFuZ2UoJGV2ZW50OiBhbnkpOiB2b2lkIHsKICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICgkZXZlbnQgPT09IHRoaXMubGltaXQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmxpbWl0ID0gJGV2ZW50OwogICAgICAgIGlmICh0aGlzLmN1clBhZ2UgPT09IDEpIHsKICAgICAgICAgICAgdGhpcy5sb2FkKHt9KTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiDliIbpobXliLfmlrAKICAgICAqCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHBhZ2VSZWZyZXNoKCk6IHZvaWQgewogICAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDmjpLluo/lj5jljJYKICAgICAqCiAgICAgKiBAcGFyYW0ge3sgY29sdW1uOiBhbnksIHByb3A6IGFueSwgb3JkZXI6IGFueSB9fSB7IGNvbHVtbiwgcHJvcCwgb3JkZXIgfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBvblNvcnRDaGFuZ2UoeyBjb2x1bW4sIHByb3AsIG9yZGVyIH06IHsgY29sdW1uOiBhbnksIHByb3A6IGFueSwgb3JkZXI6IGFueSB9KTogdm9pZCB7CiAgICAgICAgY29uc3QgZGlyID0gT2JqZWN0LmlzKG9yZGVyLCAnYXNjZW5kaW5nJykgPyAnYXNjJyA6IE9iamVjdC5pcyhvcmRlciwgJ2Rlc2NlbmRpbmcnKSA/ICdkZXNjJyA6ICcnOwogICAgICAgIGlmIChPYmplY3QuaXMoZGlyLCB0aGlzLm1pbm9yU29ydERpcikgJiYgT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0UFNERUYsIHByb3ApKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5taW5vclNvcnREaXIgPSBkaXI7CiAgICAgICAgdGhpcy5taW5vclNvcnRQU0RFRiA9IHByb3AgPyBwcm9wIDogJyc7CiAgICAgICAgdGhpcy5sb2FkKHt9KTsKICAgIH0KCiAgICAvKioKICAgICAqIOihqOagvOihjOmAieS4reagt+W8jwogICAgICoKICAgICAqIEBwYXJhbSB7eyByb3c6IGFueSwgcm93SW5kZXg6IGFueSB9fSB7IHJvdywgcm93SW5kZXggfQogICAgICogQHJldHVybnMge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgb25Sb3dDbGFzc05hbWUoeyByb3csIHJvd0luZGV4IH06IHsgcm93OiBhbnksIHJvd0luZGV4OiBhbnkgfSk6IHN0cmluZyB7CiAgICAgICAgY29uc3QgaW5kZXggPSB0aGlzLnNlbGVjdGlvbnMuZmluZEluZGV4KChzZWxlY3Q6IGFueSkgPT4gT2JqZWN0LmlzKHNlbGVjdC5zcmZrZXksIHJvdy5zcmZrZXkpKTsKICAgICAgICByZXR1cm4gaW5kZXggIT09IC0xID8gJ2dyaWQtcm93LXNlbGVjdCcgOiAnJzsKICAgIH0KCgoKICAgIC8qKgogICAgICog55WM6Z2i6KGM5Li6CiAgICAgKgogICAgICogQHBhcmFtIHsqfSByb3cKICAgICAqIEBwYXJhbSB7Kn0gdGFnCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KCXB1YmxpYyB1aUFjdGlvbihyb3c6IGFueSwgdGFnOiBhbnksICRldmVudDogYW55KSB7CiAgICAgICAgLy8gdGhpcy5yb3dDbGljayhyb3csIHRydWUpOwogICAgICAgICRldmVudC5zdG9wUHJvcGFnYXRpb24oKTsKICAgIH0KCiAgICAvKioKICAgICAqIOiuvue9ruWIl+eKtuaAgQogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgc2V0Q29sU3RhdGUoKSB7CgkJY29uc3QgX2RhdGE6IGFueSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdvcm1zaWdub3JnX21haW5fZ3JpZCcpOwoJCWlmIChfZGF0YSkgewoJCQlsZXQgY29sdW1ucyA9IEpTT04ucGFyc2UoX2RhdGEpOwoJCQljb2x1bW5zLmZvckVhY2goKGNvbDogYW55KSA9PiB7CgkJCQlsZXQgY29sdW1uID0gdGhpcy5hbGxDb2x1bW5zLmZpbmQoKGl0ZW0pID0+IE9iamVjdC5pcyhjb2wubmFtZSwgaXRlbS5uYW1lKSk7CgkJCQlpZiAoY29sdW1uKSB7CgkJCQkJT2JqZWN0LmFzc2lnbihjb2x1bW4sIGNvbCk7CgkJCQl9CgkJCX0pOwoJCX0KICAgIH0KCiAgICAvKioKICAgICAqIOWIl+WPmOWMlgogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgb25Db2xDaGFuZ2UoKSB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ29ybXNpZ25vcmdfbWFpbl9ncmlkJywgSlNPTi5zdHJpbmdpZnkodGhpcy5hbGxDb2x1bW5zKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5bliJfnirbmgIEKICAgICAqCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZQogICAgICogQHJldHVybnMge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldENvbHVtblN0YXRlKG5hbWU6IHN0cmluZyk6IGJvb2xlYW4gewogICAgICAgIGxldCBjb2x1bW4gPSB0aGlzLmFsbENvbHVtbnMuZmluZCgoY29sOiBhbnkpID0+CiAgICAgICAgICAgIE9iamVjdC5pcyhuYW1lLCBjb2wubmFtZSkKICAgICAgICApOwogICAgICAgIHJldHVybiBjb2x1bW4uc2hvdyA/IHRydWUgOiBmYWxzZTsKICAgIH0KCiAgICAvKioKICAgICAqIOihqOagvOWIl+aYr+WQpuiHqumAguW6lOW4g+WxgAogICAgICoKICAgICAqIEByZWFkb25seQogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgZ2V0IGFkYXB0aXZlU3RhdGUoKTogYm9vbGVhbiB7CiAgICAgICAgcmV0dXJuICF0aGlzLmFsbENvbHVtbnMuZmluZCgoY29sdW1uOiBhbnkpID0+IGNvbHVtbi5zaG93ICYmIE9iamVjdC5pcyhjb2x1bW4udXRpbCwgJ1NUQVInKSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDkv53lrZgKICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgYXN5bmMgc2F2ZShhcmdzOiBhbnlbXSwgcGFyYW1zPzogYW55LCAkZXZlbnQ/OiBhbnksIHhEYXRhPzogYW55KXsKICAgICAgICBsZXQgX3RoaXMgPSB0aGlzOwogICAgICAgIGlmKCFhd2FpdCB0aGlzLnZhbGlkYXRlQWxsKCkpewogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICflgLzop4TliJnmoKHpqozlvILluLgnIH0pOwogICAgICAgICAgICByZXR1cm4gW107CiAgICAgICAgfQogICAgICAgIGxldCBzdWNjZXNzSXRlbXM6YW55ID0gW107CiAgICAgICAgbGV0IGVycm9ySXRlbXM6YW55ID0gW107CiAgICAgICAgbGV0IGVycm9yTWVzc2FnZTphbnkgPSBbXTsKICAgICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgX3RoaXMuaXRlbXMpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGlmKE9iamVjdC5pcyhpdGVtLnJvd0RhdGFTdGF0ZSwgJ2NyZWF0ZScpKXsKICAgICAgICAgICAgICAgICAgICBpZighdGhpcy5jcmVhdGVBY3Rpb24pewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICdPcm1TaWduT3JnUGlja3VwR3JpZFZpZXfop4blm77ooajmoLxjcmVhdGVBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihpdGVtLHt2aWV3cGFyYW1zOnRoaXMudmlld3BhcmFtc30pOwogICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5zZXJ2aWNlLmFkZCh0aGlzLmNyZWF0ZUFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSxpdGVtLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NJdGVtcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9ZWxzZSBpZihPYmplY3QuaXMoaXRlbS5yb3dEYXRhU3RhdGUsICd1cGRhdGUnKSl7CiAgICAgICAgICAgICAgICAgICAgaWYoIXRoaXMudXBkYXRlQWN0aW9uKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAnT3JtU2lnbk9yZ1BpY2t1cEdyaWRWaWV36KeG5Zu+6KGo5qC8dXBkYXRlQWN0aW9u5Y+C5pWw5pyq6YWN572uJyB9KTsKICAgICAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihpdGVtLHt2aWV3cGFyYW1zOnRoaXMudmlld3BhcmFtc30pOwogICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtLm9ybXNpZ25vcmcpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmNvbnRleHQse29ybXNpZ25vcmc6aXRlbS5vcm1zaWdub3JnfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5zZXJ2aWNlLmFkZCh0aGlzLnVwZGF0ZUFjdGlvbixKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLGl0ZW0sIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzSXRlbXMucHVzaChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmRhdGEpKSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgZXJyb3JJdGVtcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaXRlbSkpKTsKICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZS5wdXNoKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLiRlbWl0KCdzYXZlJywgc3VjY2Vzc0l0ZW1zKTsKICAgICAgICB0aGlzLnJlZnJlc2goW10pOwogICAgICAgIGlmKGVycm9ySXRlbXMubGVuZ3RoID09PSAwKXsKICAgICAgICAgICAgdGhpcy4kTm90aWNlLnN1Y2Nlc3MoeyB0aXRsZTogJycsIGRlc2M6ICfkv53lrZjmiJDlip8hJyB9KTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgIGVycm9ySXRlbXMuZm9yRWFjaCgoaXRlbTphbnksaW5kZXg6bnVtYmVyKT0+ewogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+S/neWtmOWksei0pScsIGRlc2M6IGl0ZW0ubWFqb3JlbnRpdHluYW1lKyfkv53lrZjlpLHotKXvvIEnIH0pOwogICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yTWVzc2FnZVtpbmRleF0pOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHJldHVybiBzdWNjZXNzSXRlbXM7CiAgICB9CgogICAgLyoqCiAgICAgKiDmlrDlu7rooYwKICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIG5ld1JvdyhhcmdzOiBhbnlbXSwgcGFyYW1zPzogYW55LCAkZXZlbnQ/OiBhbnksIHhEYXRhPzogYW55KTogdm9pZCB7CiAgICAgICAgaWYoIXRoaXMubG9hZGRyYWZ0QWN0aW9uKXsKICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAnT3JtU2lnbk9yZ1BpY2t1cEdyaWRWaWV36KeG5Zu+6KGo5qC8bG9hZGRyYWZ0QWN0aW9u5Y+C5pWw5pyq6YWN572uJyB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsZXQgX3RoaXMgPSB0aGlzOwogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnc1swXSx7dmlld3BhcmFtczp0aGlzLnZpZXdwYXJhbXN9KTsKICAgICAgICBsZXQgcG9zdDogUHJvbWlzZTxhbnk+ID0gdGhpcy5zZXJ2aWNlLmxvYWREcmFmdCh0aGlzLmxvYWRkcmFmdEFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSwgYXJnc1swXSwgdGhpcy5zaG93QnVzeUluZGljYXRvcik7CiAgICAgICAgcG9zdC50aGVuKChyZXNwb25zZTogYW55KSA9PiB7CiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JNZXNzYWdlKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiByZXNwb25zZS5lcnJvck1lc3NhZ2UgfSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIHRoaXMuY3JlYXRlRGVmYXVsdChkYXRhKTsKICAgICAgICAgICAgZGF0YS5yb3dEYXRhU3RhdGUgPSAiY3JlYXRlIjsKICAgICAgICAgICAgX3RoaXMuaXRlbXMucHVzaChkYXRhKTsKICAgICAgICAgICAgX3RoaXMuZ3JpZEl0ZW1zTW9kZWwucHVzaChfdGhpcy5nZXRHcmlkUm93TW9kZWwoKSk7CiAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICfns7vnu5/lvILluLgnIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDooajmoLznvJbovpHpobnlgLzlj5jmm7QKICAgICAqICAKICAgICAqIEBwYXJhbSByb3cg6KGM5pWw5o2uCiAgICAgKiBAcGFyYW0ge3sgbmFtZTogc3RyaW5nLCB2YWx1ZTogYW55IH19ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIG9uR3JpZEl0ZW1WYWx1ZUNoYW5nZShyb3c6IGFueSwkZXZlbnQ6IHsgbmFtZTogc3RyaW5nLCB2YWx1ZTogYW55IH0scm93SW5kZXg6IG51bWJlcik6IHZvaWQgewogICAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCEkZXZlbnQubmFtZSB8fCBPYmplY3QuaXMoJGV2ZW50Lm5hbWUsICcnKSB8fCAhcm93Lmhhc093blByb3BlcnR5KCRldmVudC5uYW1lKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHJvd1skZXZlbnQubmFtZV0gPSAkZXZlbnQudmFsdWU7CiAgICAgICAgdGhpcy5ncmlkRWRpdEl0ZW1DaGFuZ2Uocm93LCAkZXZlbnQubmFtZSwgJGV2ZW50LnZhbHVlLCByb3dJbmRleCk7CiAgICB9CgogICAgLyoqCiAgICAgKiDooajmoLznvJbovpHpobnlgLzlj5jljJYKICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAcGFyYW0gcm93IOihjOaVsOaNrgogICAgICogQHBhcmFtIHByb3BlcnR5IOWIl+e8lui+kemhueWQjQogICAgICogQHBhcmFtIHJvdyDliJfnvJbovpHpobnlgLwKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBncmlkRWRpdEl0ZW1DaGFuZ2Uocm93OiBhbnksIHByb3BlcnR5OiBzdHJpbmcsIHZhbHVlOiBhbnksIHJvd0luZGV4OiBudW1iZXIpewogICAgICAgIHJvdy5yb3dEYXRhU3RhdGUgPSByb3cucm93RGF0YVN0YXRlID8gcm93LnJvd0RhdGFTdGF0ZSA6ICJ1cGRhdGUiIDsKICAgICAgICB0aGlzLnZhbGlkYXRlKHByb3BlcnR5LHJvdyxyb3dJbmRleCk7CiAgICB9CgogICAgLyoqCiAgICAgKiDooajmoLznvJbovpHpobnmm7TmlrAKICAgICAqCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbW9kZSDnlYzpnaLooYzkuLrlkI3np7AKICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dIOivt+axguaVsOaNrgogICAgICogQHBhcmFtIHtzdHJpbmdbXX0gdXBkYXRlRGV0YWlscyDmm7TmlrDpobkKICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Nob3dsb2FkaW5nXSDmmK/lkKbmmL7npLrliqDovb3nirbmgIEKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyB1cGRhdGVHcmlkRWRpdEl0ZW0obW9kZTogc3RyaW5nLCBkYXRhOiBhbnkgPSB7fSwgdXBkYXRlRGV0YWlsczogc3RyaW5nW10sIHNob3dsb2FkaW5nPzogYm9vbGVhbik6IHZvaWQgewogICAgICAgIGlmICghbW9kZSB8fCAobW9kZSAmJiBPYmplY3QuaXMobW9kZSwgJycpKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGNvbnN0IGFyZzogYW55ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcse3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSk7CiAgICAgICAgY29uc3QgcG9zdDogUHJvbWlzZTxhbnk+ID0gdGhpcy5zZXJ2aWNlLmZyb250TG9naWMobW9kZSxKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLGFyZywgc2hvd2xvYWRpbmcpOwogICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICfooajljZXpobnmm7TmlrDlpLHotKUnIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IF9kYXRhOiBhbnkgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICBpZighX2RhdGEpewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHVwZGF0ZURldGFpbHMuZm9yRWFjaCgobmFtZTogc3RyaW5nKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAoIV9kYXRhLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZGF0YVtuYW1lXSA9IF9kYXRhW25hbWVdOwogICAgICAgICAgICB9KTsKICAgICAgICB9KS5jYXRjaCgocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ+ezu+e7n+W8guW4uCcgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIOiOt+WPluWvueW6lOihjGNsYXNzCiAgICAgKgogICAgICogQHBhcmFtIHsqfSAkYXJncyByb3cg6KGM5pWw5o2u77yMcm93SW5kZXgg6KGM57Si5byVCiAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgZ2V0Um93Q2xhc3NOYW1lKGFyZ3M6e3JvdzogYW55LHJvd0luZGV4OiBudW1iZXJ9KXsKICAgICAgICBsZXQgaXNTZWxlY3RlZCA9IHRoaXMuc2VsZWN0aW9ucy5zb21lKChpdGVtOmFueSk9PnsKICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhpdGVtLm9ybXNpZ25vcmcsYXJncy5yb3cub3Jtc2lnbm9yZyk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGlzU2VsZWN0ZWQgPyAiZ3JpZC1zZWxlY3RlZC1yb3ciIDogIiI7CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5blr7nlupTliJdjbGFzcwogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGFyZ3Mgcm93IOihjOaVsOaNru+8jGNvbHVtbiDliJfmlbDmja7vvIxyb3dJbmRleCDooYzntKLlvJXvvIzliJfntKLlvJUKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBnZXRDZWxsQ2xhc3NOYW1lKGFyZ3M6e3JvdzogYW55LCBjb2x1bW46IGFueSwgcm93SW5kZXg6IG51bWJlciwgY29sdW1uSW5kZXg6bnVtYmVyfSl7CiAgICAgICAgbGV0IGhhc1Jvd0VkaXQ6YW55ID0gewogICAgICAgICAgJ29ybXNpZ25vcmduYW1lJzpmYWxzZSwKICAgICAgICAgICdvcmdjb2RlJzpmYWxzZSwKICAgICAgICB9CiAgICAgICAgcmV0dXJuICggaGFzUm93RWRpdFthcmdzLmNvbHVtbi5wcm9wZXJ0eV0gJiYgdGhpcy5hY3R1YWxJc09wZW5FZGl0ICkgPyAiZWRpdC1jZWxsIiA6ICJpbmZvLWNlbGwiOwogICAgfQoKICAgIC8qKgogICAgICog5paw5bu66buY6K6k5YC8CiAgICAgKiBAcGFyYW0geyp9ICByb3cg6KGM5pWw5o2uCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGNyZWF0ZURlZmF1bHQocm93OiBhbnkpeyAgICAgICAgICAgICAgICAgICAgCiAgICB9Cn0K"},null]}