{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-person\\gzdq-grid\\gzdq-grid-base.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-person\\gzdq-grid\\gzdq-grid-base.vue","mtime":1630509411864},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCmltcG9ydCB7IFZ1ZSwgQ29tcG9uZW50LCBQcm9wLCBQcm92aWRlLCBFbWl0LCBXYXRjaCwgTW9kZWwsSW5qZWN0IH0gZnJvbSAndnVlLXByb3BlcnR5LWRlY29yYXRvcic7CmltcG9ydCB7IENyZWF0ZUVsZW1lbnQgfSBmcm9tICd2dWUnOwppbXBvcnQgeyBTdWJqZWN0LCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJzsKaW1wb3J0IHsgQ29udHJvbEludGVyZmFjZSB9IGZyb20gJ0AvaW50ZXJmYWNlL2NvbnRyb2wnOwppbXBvcnQgeyBVSUFjdGlvblRvb2wsVXRpbCB9IGZyb20gJ0AvdXRpbHMnOwppbXBvcnQgTmF2RGF0YVNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL2FwcC9uYXZkYXRhLXNlcnZpY2UnOwppbXBvcnQgUGltUGVyc29uU2VydmljZSBmcm9tICdAL3NlcnZpY2UvcGltLXBlcnNvbi9waW0tcGVyc29uLXNlcnZpY2UnOwppbXBvcnQgR1pEUVNlcnZpY2UgZnJvbSAnLi9nemRxLWdyaWQtc2VydmljZSc7CgppbXBvcnQgQ29kZUxpc3RTZXJ2aWNlIGZyb20gIkBzZXJ2aWNlL2FwcC9jb2RlbGlzdC1zZXJ2aWNlIjsKaW1wb3J0IHsgRm9ybUl0ZW1Nb2RlbCB9IGZyb20gJ0AvbW9kZWwvZm9ybS1kZXRhaWwnOwoKCkBDb21wb25lbnQoewogICAgY29tcG9uZW50czogewogICAgICAKICAgIH0KfSkKZXhwb3J0IGRlZmF1bHQgY2xhc3MgR1pEUUJhc2UgZXh0ZW5kcyBWdWUgaW1wbGVtZW50cyBDb250cm9sSW50ZXJmYWNlIHsKCiAgICAvKioKICAgICAqIOWQjeensAogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgbmFtZT86IHN0cmluZzsKCiAgICAvKioKICAgICAqIOinhuWbvumAmuiur+WvueixoQogICAgICoKICAgICAqIEB0eXBlIHtTdWJqZWN0PFZpZXdTdGF0ZT59CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgdmlld1N0YXRlITogU3ViamVjdDxWaWV3U3RhdGU+OwoKICAgIC8qKgogICAgICog5bqU55So5LiK5LiL5paHCiAgICAgKgogICAgICogQHR5cGUgeyp9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgY29udGV4dDogYW55OwoKICAgIC8qKgogICAgICog6KeG5Zu+5Y+C5pWwCiAgICAgKgogICAgICogQHR5cGUgeyp9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgdmlld3BhcmFtczogYW55OwoKICAgIC8qKgogICAgICog6KeG5Zu+54q25oCB5LqL5Lu2CiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQHR5cGUgeyhTdWJzY3JpcHRpb24gfCB1bmRlZmluZWQpfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyB2aWV3U3RhdGVFdmVudDogU3Vic2NyaXB0aW9uIHwgdW5kZWZpbmVkOwoKICAgIC8qKgogICAgICog6I635Y+W6YOo5Lu257G75Z6LCiAgICAgKgogICAgICogQHJldHVybnMge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgZ2V0Q29udHJvbFR5cGUoKTogc3RyaW5nIHsKICAgICAgICByZXR1cm4gJ0dSSUQnCiAgICB9CgoKCiAgICAvKioKICAgICAqIOiuoeaVsOWZqOacjeWKoeWvueixoembhuWQiAogICAgICoKICAgICAqIEB0eXBlIHtBcnJheTwqPn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovICAgIAogICAgcHVibGljIGNvdW50ZXJTZXJ2aWNlQXJyYXk6QXJyYXk8YW55PiA9IFtdOwoKICAgIC8qKgogICAgICog5bu65p6E6YOo5Lu25pyN5Yqh5a+56LGhCiAgICAgKgogICAgICogQHR5cGUge0daRFFTZXJ2aWNlfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBzZXJ2aWNlOiBHWkRRU2VydmljZSA9IG5ldyBHWkRRU2VydmljZSh7ICRzdG9yZTogdGhpcy4kc3RvcmUgfSk7CgogICAgLyoqCiAgICAgKiDlrp7kvZPmnI3liqHlr7nosaEKICAgICAqCiAgICAgKiBAdHlwZSB7UGltUGVyc29uU2VydmljZX0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgYXBwRW50aXR5U2VydmljZTogUGltUGVyc29uU2VydmljZSA9IG5ldyBQaW1QZXJzb25TZXJ2aWNlKHsgJHN0b3JlOiB0aGlzLiRzdG9yZSB9KTsKICAgIAoKCiAgICAvKioKICAgICAqIOWFs+mXreinhuWbvgogICAgICoKICAgICAqIEBwYXJhbSB7YW55fSBhcmdzCiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGNsb3NlVmlldyhhcmdzOiBhbnkpOiB2b2lkIHsKICAgICAgICBsZXQgX3RoaXM6IGFueSA9IHRoaXM7CiAgICAgICAgX3RoaXMuJGVtaXQoJ2Nsb3NldmlldycsIFthcmdzXSk7CiAgICB9CgogICAgLyoqCiAgICAgKiAg6K6h5pWw5Zmo5Yi35pawCiAgICAgKgogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBjb3VudGVyUmVmcmVzaCgpewogICAgICAgIGNvbnN0IF90aGlzOmFueSA9dGhpczsKICAgICAgICBpZihfdGhpcy5jb3VudGVyU2VydmljZUFycmF5ICYmIF90aGlzLmNvdW50ZXJTZXJ2aWNlQXJyYXkubGVuZ3RoID4wKXsKICAgICAgICAgICAgX3RoaXMuY291bnRlclNlcnZpY2VBcnJheS5mb3JFYWNoKChpdGVtOmFueSkgPT57CiAgICAgICAgICAgICAgICBpZihpdGVtLnJlZnJlc2hEYXRhICYmIGl0ZW0ucmVmcmVzaERhdGEgaW5zdGFuY2VvZiBGdW5jdGlvbil7CiAgICAgICAgICAgICAgICAgICAgaXRlbS5yZWZyZXNoRGF0YSgpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0KICAgIH0KCgogICAgLyoqCiAgICAgKiDku6PnoIHooajmnI3liqHlr7nosaEKICAgICAqCiAgICAgKiBAdHlwZSB7Q29kZUxpc3RTZXJ2aWNlfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8gIAogICAgcHVibGljIGNvZGVMaXN0U2VydmljZTpDb2RlTGlzdFNlcnZpY2UgPSBuZXcgQ29kZUxpc3RTZXJ2aWNlKHsgJHN0b3JlOiB0aGlzLiRzdG9yZSB9KTsKCiAgICAvKioKICAgICAqIOiOt+WPluWkmumhueaVsOaNrgogICAgICoKICAgICAqIEByZXR1cm5zIHthbnlbXX0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgZ2V0RGF0YXMoKTogYW55W10gewogICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5bljZXpobnmoJEKICAgICAqCiAgICAgKiBAcmV0dXJucyB7Kn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgZ2V0RGF0YSgpOiBhbnkgewogICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbnNbMF07CiAgICB9CgogICAgLyoqCiAgICAgKiDmiZPlvIDmlrDlu7rmlbDmja7op4blm74KICAgICAqCiAgICAgKiBAdHlwZSB7YW55fQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIG5ld2RhdGE6IGFueTsKICAgIC8qKgogICAgICog5omT5byA57yW6L6R5pWw5o2u6KeG5Zu+CiAgICAgKgogICAgICogQHR5cGUge2FueX0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBvcGVuZGF0YTogYW55OwoKICAgIC8qKgogICAgICog5pi+56S65aSE55CG5o+Q56S6CiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3AoeyBkZWZhdWx0OiB0cnVlIH0pIHB1YmxpYyBzaG93QnVzeUluZGljYXRvcj86IGJvb2xlYW47CgogICAgLyoqCiAgICAgKiDpg6jku7booYzkuLotLXVwZGF0ZQogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgdXBkYXRlQWN0aW9uITogc3RyaW5nOwogICAgCiAgICAvKioKICAgICAqIOmDqOS7tuihjOS4ui0tZmV0Y2gKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIGZldGNoQWN0aW9uITogc3RyaW5nOwogICAgCiAgICAvKioKICAgICAqIOmDqOS7tuihjOS4ui0tcmVtb3ZlCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyByZW1vdmVBY3Rpb24hOiBzdHJpbmc7CiAgICAKICAgIC8qKgogICAgICog6YOo5Lu26KGM5Li6LS1sb2FkCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBsb2FkQWN0aW9uITogc3RyaW5nOwogICAgCiAgICAvKioKICAgICAqIOmDqOS7tuihjOS4ui0tbG9hZGRyYWZ0CiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBsb2FkZHJhZnRBY3Rpb24hOiBzdHJpbmc7CiAgICAKICAgIC8qKgogICAgICog6YOo5Lu26KGM5Li6LS1jcmVhdGUKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIGNyZWF0ZUFjdGlvbiE6IHN0cmluZzsKCiAgICAvKioKICAgICAqIOW9k+WJjemhtQogICAgICoKICAgICAqIEB0eXBlIHtudW1iZXJ9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGN1clBhZ2U6IG51bWJlciA9IDE7CgogICAgLyoqCiAgICAgKiDmlbDmja4KICAgICAqCiAgICAgKiBAdHlwZSB7YW55W119CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGl0ZW1zOiBhbnlbXSA9IFtdOwoKICAgIC8qKgogICAgICog5piv5ZCm5pSv5oyB5YiG6aG1CiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGlzRW5hYmxlUGFnaW5nQmFyOiBib29sZWFuID0gdHJ1ZTsKCiAgICAvKioKICAgICAqIOaYr+WQpuemgeeUqOaOkuW6jwogICAgICoKICAgICAqIEB0eXBlIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBpc05vU29ydDogYm9vbGVhbiA9IGZhbHNlOwoKICAgIC8qKgogICAgICog5o6S5bqP5pa55ZCRCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgbWlub3JTb3J0RGlyOiBzdHJpbmcgPSAnREVTQyc7CgogICAgLyoqCiAgICAgKiDmjpLluo/lrZfmrrUKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBtaW5vclNvcnRQU0RFRjogc3RyaW5nID0gJ2d6anNzaic7CgogICAgLyoqCiAgICAgKiDliIbpobXmnaHmlbAKICAgICAqCiAgICAgKiBAdHlwZSB7bnVtYmVyfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBsaW1pdDogbnVtYmVyID0gMTAwOwoKICAgIC8qKgogICAgICog5piv5ZCm5pi+56S65qCH6aKYCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGlzSGlkZUhlYWRlcjogYm9vbGVhbiA9IGZhbHNlOwoKICAgIC8qKgogICAgICog5piv5ZCm6buY6K6k6YCJ5Lit56ys5LiA5p2h5pWw5o2uCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3AoeyBkZWZhdWx0OiBmYWxzZSB9KSBwdWJsaWMgaXNTZWxlY3RGaXJzdERlZmF1bHQhOiBib29sZWFuOwoKICAgIC8qKgogICAgICog5piv5ZCm5Y2V6YCJCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgaXNTaW5nbGVTZWxlY3Q/OiBib29sZWFuOwoKICAgIC8qKgogICAgICog6YCJ5Lit5pWw5o2u5a2X56ym5LiyCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBzZWxlY3RlZERhdGE/OiBzdHJpbmc7CgogICAgLyoqCiAgICAgKiDpgInkuK3lgLzlj5jljJYKICAgICAqCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbAogICAgICogQHBhcmFtIHsqfSBvbGRWYWwKICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBAV2F0Y2goJ3NlbGVjdGVkRGF0YScpCiAgICBwdWJsaWMgb25WYWx1ZUNoYW5nZShuZXdWYWw6IGFueSwgb2xkVmFsOiBhbnkpIHsKICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTsKICAgICAgICBpZih0aGlzLnNlbGVjdGVkRGF0YSl7CiAgICAgICAgICAgIGNvbnN0IHJlZnM6IGFueSA9IHRoaXMuJHJlZnM7CiAgICAgICAgICAgIGlmIChyZWZzLm11bHRpcGxlVGFibGUpIHsKICAgICAgICAgICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS5jbGVhclNlbGVjdGlvbigpOwogICAgICAgICAgICAgICAgSlNPTi5wYXJzZSh0aGlzLnNlbGVjdGVkRGF0YSkuZm9yRWFjaCgoc2VsZWN0aW9uOmFueSk9PnsKICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRJdGVtID0gdGhpcy5pdGVtcy5maW5kKChpdGVtOmFueSk9PnsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhpdGVtLnNyZmtleSwgc2VsZWN0aW9uLnNyZmtleSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3dDbGljayhzZWxlY3RlZEl0ZW0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC86KGM5pWw5o2u6buY6K6k5r+A5rS75qih5byPCiAgICAgKiAwIOS4jea/gOa0uwogICAgICogMSDljZXlh7vmv4DmtLsKICAgICAqIDIg5Y+M5Ye75r+A5rS7CiAgICAgKgogICAgICogQHR5cGUgeyhudW1iZXIgfCAwIHwgMSB8IDIpfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIEBQcm9wKHtkZWZhdWx0OiAyfSkgcHVibGljIGdyaWRSb3dBY3RpdmVNb2RlITogbnVtYmVyOwoKICAgIC8qKgogICAgICog5piv5ZCm5byA5ZCv6KGM57yW6L6RCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgQFByb3Aoe2RlZmF1bHQ6IGZhbHNlfSkgcHVibGljIGlzT3BlbkVkaXQhOiBib29sZWFuOwoKICAgIC8qKgogICAgICog5a6e6ZmF5piv5ZCm5byA5ZCv6KGM57yW6L6RCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGFjdHVhbElzT3BlbkVkaXQ6IGJvb2xlYW4gPSB0aGlzLmlzT3BlbkVkaXQ7CgogICAgLyoqCiAgICAgKiDmgLvmnaHmlbAKICAgICAqCiAgICAgKiBAdHlwZSB7bnVtYmVyfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyB0b3RhbHJvdzogbnVtYmVyID0gMDsKCiAgICAvKioKICAgICAqIOmAieS4reihjOaVsOaNrgogICAgICoKICAgICAqIEB0eXBlIHthbnlbXX0KICAgICAqIEBtZW1iZXJvZiBNYWluCiAgICAgKi8KICAgIHB1YmxpYyBzZWxlY3Rpb25zOiBhbnlbXSA9IFtdOwoKICAgIC8qKgogICAgICog5oum5oiq6KGM6YCJ5LitCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbgogICAgICovCiAgICBwdWJsaWMgc3RvcFJvd0NsaWNrOiBib29sZWFuID0gZmFsc2U7CgoKCgogICAgLyoqCiAgICAgKiDooajmoLzmmK/lkKbmmL7npLoKICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgaXNEaXNwbGF5OmJvb2xlYW4gPSB0cnVlOwoKICAgIC8qKgogICAgICog6YOo5Lu25Yi35pawCiAgICAgKgogICAgICogQHBhcmFtIHthbnlbXX0gYXJncwogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyByZWZyZXNoKGFyZ3M6IGFueVtdKTogdm9pZCB7CiAgICAgICAgdGhpcy5sb2FkKCk7CiAgICB9CgogICAgLyoqCiAgICAqIOmAiemhueahhuWIl+WuvQogICAgKgogICAgKiBAdHlwZSB7bnVtYmVyfQogICAgKiBAbWVtYmVyb2YgQXBwSW5kZXgKICAgICovCiAgICBwdWJsaWMgY2hlY2tib3hDb2xXaWR0aDogbnVtYmVyID0gMzQ7CgogICAgLyoqCiAgICAgKiDmmK/lkKblhYHorrjmi5bliqjliJflrr0KICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBBcHBFbWJlZFBpY2tlcgogICAgICovCiAgICBwdWJsaWMgaXNEcmFnZW5kQ29sOiBib29sZWFuID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiDmiYDmnInliJfmiJDlkZgKICAgICAqCiAgICAgKiBAdHlwZSB7YW55W119CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGFsbENvbHVtbnM6IGFueVtdID0gWwogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ3lnYmgnLAogICAgICAgICAgICBsYWJlbDogJ+WRmOW3pee8luWPtycsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24uZ3pkcV9ncmlkLmNvbHVtbnMueWdiaCcsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ3BpbXBlcnNvbm5hbWUnLAogICAgICAgICAgICBsYWJlbDogJ+WRmOW3peWnk+WQjScsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24uZ3pkcV9ncmlkLmNvbHVtbnMucGltcGVyc29ubmFtZScsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ3lnenQnLAogICAgICAgICAgICBsYWJlbDogJ+WRmOW3peeKtuaAgScsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24uZ3pkcV9ncmlkLmNvbHVtbnMueWd6dCcsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ2d6enQnLAogICAgICAgICAgICBsYWJlbDogJ+aMguiBjOeKtuaAgScsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24uZ3pkcV9ncmlkLmNvbHVtbnMuZ3p6dCcsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ2d6enonLAogICAgICAgICAgICBsYWJlbDogJ+aMguiBjOe7hOe7hycsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24uZ3pkcV9ncmlkLmNvbHVtbnMuZ3p6eicsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ2d6Ym0nLAogICAgICAgICAgICBsYWJlbDogJ+aMguiBjOmDqOmXqCcsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24uZ3pkcV9ncmlkLmNvbHVtbnMuZ3pibScsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdweCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ2d6a3NzaicsCiAgICAgICAgICAgIGxhYmVsOiAn5oyC6IGM5byA5aeL5pe26Ze0JywKICAgICAgICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbXBlcnNvbi5nemRxX2dyaWQuY29sdW1ucy5nemtzc2onLAogICAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgICB1dGlsOiAncHgnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICdnempzc2onLAogICAgICAgICAgICBsYWJlbDogJ+aMguiBjOe7k+adn+aXtumXtCcsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24uZ3pkcV9ncmlkLmNvbHVtbnMuZ3pqc3NqJywKICAgICAgICAgICAgc2hvdzogdHJ1ZSwKICAgICAgICAgICAgdXRpbDogJ1BYJwogICAgICAgIH0sCiAgICBdCgogICAgLyoqCiAgICAgKiDooajmoLzmqKHlnovpm4blkIgKICAgICAqCiAgICAgKiBAdHlwZSB7Kn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgZ3JpZEl0ZW1zTW9kZWw6IGFueVtdID0gW107CgogICAgLyoqCiAgICAgKiDojrflj5booajmoLzooYzmqKHlnosKICAgICAqCiAgICAgKiBAdHlwZSB7Kn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgZ2V0R3JpZFJvd01vZGVsKCl7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgIHNyZmtleTogbmV3IEZvcm1JdGVtTW9kZWwoKSwKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiDlsZ7mgKflgLzop4TliJkKICAgICAqCiAgICAgKiBAdHlwZSB7Kn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgcnVsZXM6IGFueSA9IHsKICAgICAgICBzcmZrZXk6IFsKICAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB2YWxpZGF0b3I6IChydWxlOmFueSwgdmFsdWU6YW55LCBjYWxsYmFjazphbnkpID0+IHsgcmV0dXJuIChydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikpID8gZmFsc2UgOiB0cnVlO30sIG1lc3NhZ2U6ICfkurrlkZjkv6Hmga/moIfor4Yg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2NoYW5nZScgfSwKICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+S6uuWRmOS/oeaBr+agh+ivhiDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwKICAgICAgICBdLAogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC86KGM57yW6L6R6aG55qCh6aqMCiAgICAgKgogICAgICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5IOWxnuaAp+WQjQogICAgICogQHBhcmFtIHsqfSBkYXRhIOihjOaVsOaNrgogICAgICogQHBhcmFtIHtudW1iZXJ9IHJvd0luZGV4IOihjOe0ouW8lQogICAgICogQHJldHVybnMgUHJvbWlzZTxhbnk+CiAgICAgKiAKICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgdmFsaWRhdGUocHJvcGVydHk6c3RyaW5nLCBkYXRhOmFueSwgcm93SW5kZXg6bnVtYmVyKTpQcm9taXNlPGFueT57CiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICAgICAgdGhpcy4kdXRpbC52YWxpZGF0ZUl0ZW0ocHJvcGVydHksZGF0YSx0aGlzLnJ1bGVzKS50aGVuKCgpPT57CiAgICAgICAgICAgICAgICB0aGlzLmdyaWRJdGVtc01vZGVsW3Jvd0luZGV4XVtwcm9wZXJ0eV0uc2V0RXJyb3IobnVsbCk7CiAgICAgICAgICAgICAgICByZXNvbHZlKHRydWUpOwogICAgICAgICAgICB9KS5jYXRjaCgoeyBlcnJvcnMsIGZpZWxkcyB9KSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmdyaWRJdGVtc01vZGVsW3Jvd0luZGV4XVtwcm9wZXJ0eV0uc2V0RXJyb3IoZXJyb3JzWzBdLm1lc3NhZ2UpOwogICAgICAgICAgICAgICAgcmVzb2x2ZShmYWxzZSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICog5qCh6aqM5omA5pyJ5L+u5pS56L+H55qE57yW6L6R6aG5CiAgICAgKgogICAgICogQHJldHVybnMgUHJvbWlzZTxhbnk+CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGFzeW5jIHZhbGlkYXRlQWxsKCl7CiAgICAgICAgbGV0IHZhbGlkYXRlU3RhdGUgPSB0cnVlOwogICAgICAgIGxldCBpbmRleCA9IC0xOwogICAgICAgIGZvcihsZXQgaXRlbSBvZiB0aGlzLml0ZW1zKXsKICAgICAgICAgIGluZGV4Kys7CiAgICAgICAgICBpZihpdGVtLnJvd0RhdGFTdGF0ZSA9PT0gImNyZWF0ZSIgfHwgaXRlbS5yb3dEYXRhU3RhdGUgPT09ICJ1cGRhdGUiKXsKICAgICAgICAgICAgZm9yKGxldCBwcm9wZXJ0eSBvZiBPYmplY3Qua2V5cyh0aGlzLnJ1bGVzKSl7CiAgICAgICAgICAgICAgaWYoIWF3YWl0IHRoaXMudmFsaWRhdGUocHJvcGVydHksaXRlbSxpbmRleCkpewogICAgICAgICAgICAgICAgdmFsaWRhdGVTdGF0ZSA9IGZhbHNlOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdmFsaWRhdGVTdGF0ZTsKICAgIH0KCiAgICAvKioKICAgICAqIOihqOagvOaVsOaNruWKoOi9vQogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gW2FyZz17fV0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgbG9hZChvcHQ6IGFueSA9IHt9LCBwYWdlUmVzZXQ6IGJvb2xlYW4gPSBmYWxzZSk6IHZvaWQgewogICAgICAgIGlmKCF0aGlzLmZldGNoQWN0aW9uKXsKICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAnUElNUEVSU09OR1pSWUhNQ0dyaWRWaWV36KeG5Zu+6KGo5qC8ZmV0Y2hBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmKHBhZ2VSZXNldCl7CiAgICAgICAgICAgIHRoaXMuY3VyUGFnZSA9IDE7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGFyZzogYW55ID0gey4uLm9wdH07CiAgICAgICAgY29uc3QgcGFnZTogYW55ID0ge307CiAgICAgICAgaWYgKHRoaXMuaXNFbmFibGVQYWdpbmdCYXIpIHsKICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihwYWdlLCB7IHBhZ2U6IHRoaXMuY3VyUGFnZS0xLCBzaXplOiB0aGlzLmxpbWl0IH0pOwogICAgICAgIH0KICAgICAgICAvLyDorr7nva7mjpLluo8KICAgICAgICBpZiAoIXRoaXMuaXNOb1NvcnQgJiYgIU9iamVjdC5pcyh0aGlzLm1pbm9yU29ydERpciwgJycpICYmICFPYmplY3QuaXModGhpcy5taW5vclNvcnRQU0RFRiwgJycpKSB7CiAgICAgICAgICAgIGNvbnN0IHNvcnQ6IHN0cmluZyA9IHRoaXMubWlub3JTb3J0UFNERUYrIiwiK3RoaXMubWlub3JTb3J0RGlyOwogICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsgc29ydDogc29ydCB9KTsKICAgICAgICB9CiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHBhZ2UpOwogICAgICAgIGNvbnN0IHBhcmVudGRhdGE6IGFueSA9IHt9OwogICAgICAgIHRoaXMuJGVtaXQoJ2JlZm9yZWxvYWQnLCBwYXJlbnRkYXRhKTsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgcGFyZW50ZGF0YSk7CiAgICAgICAgbGV0IHRlbXBWaWV3UGFyYW1zOmFueSA9IHBhcmVudGRhdGEudmlld3BhcmFtcz9wYXJlbnRkYXRhLnZpZXdwYXJhbXM6e307CiAgICAgICAgT2JqZWN0LmFzc2lnbih0ZW1wVmlld1BhcmFtcyxKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMudmlld3BhcmFtcykpKTsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZyx7dmlld3BhcmFtczp0ZW1wVmlld1BhcmFtc30pOwogICAgICAgIGNvbnN0IHBvc3Q6IFByb21pc2U8YW55PiA9IHRoaXMuc2VydmljZS5zZWFyY2godGhpcy5mZXRjaEFjdGlvbixKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBhcmcsIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN0YXR1cyB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yTWVzc2FnZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogcmVzcG9uc2UuZXJyb3JNZXNzYWdlIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IGRhdGE6IGFueSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIHRoaXMudG90YWxyb3cgPSByZXNwb25zZS50b3RhbDsKICAgICAgICAgICAgdGhpcy5pdGVtcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgICAgICAvLyDmuIXnqbpzZWxlY3Rpb25zLGdyaWRJdGVtc01vZGVsCiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgICAgICB0aGlzLmdyaWRJdGVtc01vZGVsID0gW107CiAgICAgICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaCgoKT0+e3RoaXMuZ3JpZEl0ZW1zTW9kZWwucHVzaCh0aGlzLmdldEdyaWRSb3dNb2RlbCgpKX0pOwogICAgICAgICAgICB0aGlzLiRlbWl0KCdsb2FkJywgdGhpcy5pdGVtcyk7CiAgICAgICAgICAgIC8vIOiuvue9rum7mOiupOmAieS4rQogICAgICAgICAgICBsZXQgX3RoaXMgPSB0aGlzOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGlmKF90aGlzLmlzU2VsZWN0Rmlyc3REZWZhdWx0KXsKICAgICAgICAgICAgICAgICAgX3RoaXMucm93Q2xpY2soX3RoaXMuaXRlbXNbMF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoX3RoaXMuc2VsZWN0ZWREYXRhKXsKICAgICAgICAgICAgICAgICAgICBjb25zdCByZWZzOiBhbnkgPSBfdGhpcy4kcmVmczsKICAgICAgICAgICAgICAgICAgICBpZiAocmVmcy5tdWx0aXBsZVRhYmxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS5jbGVhclNlbGVjdGlvbigpOwogICAgICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKF90aGlzLnNlbGVjdGVkRGF0YSkuZm9yRWFjaCgoc2VsZWN0aW9uOmFueSk9PnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZEl0ZW0gPSBfdGhpcy5pdGVtcy5maW5kKChpdGVtOmFueSk9PnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0uc3Jma2V5LCBzZWxlY3Rpb24uc3Jma2V5KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yb3dDbGljayhzZWxlY3RlZEl0ZW0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiByZXNwb25zZS5lcnJvck1lc3NhZ2UgfSk7CiAgICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDliKDpmaQKICAgICAqCiAgICAgKiBAcGFyYW0ge2FueVtdfSBkYXRhcwogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgYXN5bmMgcmVtb3ZlKGRhdGFzOiBhbnlbXSk6IFByb21pc2U8YW55PiB7CiAgICAgICAgaWYoIXRoaXMucmVtb3ZlQWN0aW9uKXsKICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAnUElNUEVSU09OR1pSWUhNQ0dyaWRWaWV36KeG5Zu+6KGo5qC8cmVtb3ZlQWN0aW9u5Y+C5pWw5pyq6YWN572uJyB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsZXQgX2RhdGFzOmFueVtdID0gW107CiAgICAgICAgZGF0YXMuZm9yRWFjaCgocmVjb3JkOiBhbnksIGluZGV4OiBudW1iZXIpID0+IHsKICAgICAgICAgICAgaWYgKE9iamVjdC5pcyhyZWNvcmQuc3JmdWYsIjAiKSkgewogICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5zb21lKCh2YWw6IGFueSwgbnVtOiBudW1iZXIpID0+ewogICAgICAgICAgICAgICAgICAgIGlmKEpTT04uc3RyaW5naWZ5KHZhbCkgPT0gSlNPTi5zdHJpbmdpZnkocmVjb3JkKSl7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMuc3BsaWNlKG51bSwxKTsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ncmlkSXRlbXNNb2RlbC5zcGxpY2UobnVtLDEpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsgCiAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICBfZGF0YXMucHVzaChkYXRhc1tpbmRleF0pOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgaWYgKF9kYXRhcy5sZW5ndGggPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBsZXQgZGF0YUluZm8gPSAnJzsKICAgICAgICBfZGF0YXMuZm9yRWFjaCgocmVjb3JkOiBhbnksIGluZGV4OiBudW1iZXIpID0+IHsKICAgICAgICAgICAgbGV0IHNyZm1ham9ydGV4dCA9IHJlY29yZC5waW1wZXJzb25uYW1lOwogICAgICAgICAgICBpZiAoaW5kZXggPCA1KSB7CiAgICAgICAgICAgICAgICBpZiAoIU9iamVjdC5pcyhkYXRhSW5mbywgJycpKSB7CiAgICAgICAgICAgICAgICAgICAgZGF0YUluZm8gKz0gJ+OAgSc7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkYXRhSW5mbyArPSBzcmZtYWpvcnRleHQ7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgaWYgKF9kYXRhcy5sZW5ndGggPCA1KSB7CiAgICAgICAgICAgIGRhdGFJbmZvID0gZGF0YUluZm8gKyAnIOWFsScgKyBfZGF0YXMubGVuZ3RoICsgJ+adoeaVsOaNric7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZGF0YUluZm8gPSBkYXRhSW5mbyArICcuLi4nICsgJyDlhbEnICsgX2RhdGFzLmxlbmd0aCArICfmnaHmlbDmja4nOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVtb3ZlRGF0YSA9ICgpID0+IHsKICAgICAgICAgICAgbGV0IGtleXM6IGFueVtdID0gW107CiAgICAgICAgICAgIF9kYXRhcy5mb3JFYWNoKChkYXRhOiBhbnkpID0+IHsKICAgICAgICAgICAgICAgIGtleXMucHVzaChkYXRhLnNyZmtleSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBsZXQgX3JlbW92ZUFjdGlvbiA9IGtleXMubGVuZ3RoID4gMSA/ICdyZW1vdmVCYXRjaCcgOiB0aGlzLnJlbW92ZUFjdGlvbiA7CiAgICAgICAgICAgIGxldCBfa2V5cyA9IGtleXMubGVuZ3RoID4gMSA/IGtleXMgOiBrZXlzWzBdIDsKICAgICAgICAgICAgY29uc3QgY29udGV4dDphbnkgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpOwogICAgICAgICAgICBjb25zdCBwb3N0OiBQcm9taXNlPGFueT4gPSB0aGlzLnNlcnZpY2UuZGVsZXRlKF9yZW1vdmVBY3Rpb24sT2JqZWN0LmFzc2lnbihjb250ZXh0LHsgcGltcGVyc29uOiBfa2V5cyB9KSxPYmplY3QuYXNzaWduKHsgcGltcGVyc29uOiBfa2V5cyB9LHt2aWV3cGFyYW1zOnRoaXMudmlld3BhcmFtc30pLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlOiBhbnksIHJlamVjdDogYW55KSA9PiB7CiAgICAgICAgICAgICAgICBwb3N0LnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAnJywgZGVzYzogJ+WIoOmZpOaVsOaNruWksei0pSwnICsgcmVzcG9uc2UuaW5mbyB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5zdWNjZXNzKHsgdGl0bGU6ICcnLCBkZXNjOiAn5Yig6Zmk5oiQ5YqfIScgfSk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIC8v5Yig6ZmkaXRlbXPkuK3lt7LliKDpmaTnmoTpobkKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLml0ZW1zKTsKICAgICAgICAgICAgICAgICAgICBfZGF0YXMuZm9yRWFjaCgoZGF0YTogYW55KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbXMuc29tZSgoaXRlbTphbnksaW5kZXg6bnVtYmVyKT0+ewogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoT2JqZWN0LmlzKGl0ZW0uc3Jma2V5LGRhdGEuc3Jma2V5KSl7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5zcGxpY2UoaW5kZXgsMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5ncmlkSXRlbXNNb2RlbC5zcGxpY2UoaW5kZXgsMSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHRoaXMudG90YWxyb3cgLT0gX2RhdGFzLmxlbmd0aDsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdyZW1vdmUnLCBudWxsKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTsKICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7CiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ+ezu+e7n+W8guW4uCcgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGRhdGFJbmZvID0gZGF0YUluZm8ucmVwbGFjZSgvW251bGxdL2csICcnKS5yZXBsYWNlKC9bdW5kZWZpbmVkXS9nLCAnJyk7CiAgICAgICAgdGhpcy4kTW9kYWwuY29uZmlybSh7CiAgICAgICAgICAgIHRpdGxlOiAn6K2m5ZGKJywKICAgICAgICAgICAgY29udGVudDogJ+ehruiupOimgeWIoOmZpCAnICsgZGF0YUluZm8gKyAn77yM5Yig6Zmk5pON5L2c5bCG5LiN5Y+v5oGi5aSN77yfJywKICAgICAgICAgICAgb25PazogKCkgPT4gewogICAgICAgICAgICAgICAgcmVtb3ZlRGF0YSgpOwogICAgICAgICAgICB9LAogICAgICAgICAgICBvbkNhbmNlbDogKCkgPT4geyB9CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHJlbW92ZURhdGE7CiAgICB9CgoKICAgIC8qKgogICAgICog5om56YeP5re75YqgCiAgICAgKgogICAgICogQHBhcmFtIHsqfSBbYXJnPXt9XQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBhZGRCYXRjaChhcmc6IGFueSA9IHt9KTogdm9pZCB7CiAgICAgICAgaWYoIXRoaXMuZmV0Y2hBY3Rpb24pewogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICdQSU1QRVJTT05HWlJZSE1DR3JpZFZpZXfop4blm77ooajmoLxmZXRjaEFjdGlvbuWPguaVsOacqumFjee9ricgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYoIWFyZyl7CiAgICAgICAgICAgIGFyZyA9IHt9OwogICAgICAgIH0KICAgICAgICBjb25zb2xlLmVycm9yKCLmibnph4/mt7vliqDmnKrlrp7njrAiKTsKICAgIH0KCiAgICAvKioKICAgICAqIOaVsOaNruWvvOWFpQogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gZGF0YQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgICBwdWJsaWMgaW1wb3J0RXhjZWwoZGF0YTphbnkgPXt9KTp2b2lkewogICAgICAgIC8v5a+85YWlZXhjZWwKICAgICAgICBjb25zdCBpbXBvcnREYXRhTW9kZWw6YW55ID17CiAgICAgICAgfQogICAgICAgIGlmKE9iamVjdC5rZXlzKGltcG9ydERhdGFNb2RlbCkubGVuZ3RoID09IDApewogICAgICAgICAgICB0aGlzLiROb3RpY2Uud2FybmluZyh7ICd0aXRsZSc6ICh0aGlzLiR0KCJhcHAudXRpbHZpZXcud2FybmluZyIpIGFzIHN0cmluZyksICdkZXNjJzogKHRoaXMuJHQoImFwcC51dGlsdmlldy5pbmZvIikgYXMgc3RyaW5nKSB9KTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCB2aWV3OmFueSA9ewogICAgICAgICAgICB2aWV3bmFtZTogJ2FwcC1kYXRhLXVwbG9hZCcsCiAgICAgICAgICAgIHRpdGxlOiB0aGlzLiR0KCJhcHAudXRpbHZpZXcuaW1wb3J0dmlldyIpLAogICAgICAgICAgICB3aWR0aDogOTAwLAogICAgICAgICAgICBoZWlnaHQ6IDcwMAogICAgICAgIH0KICAgICAgICBsZXQgY29udGFpbmVyOiBTdWJqZWN0PGFueT4gPSB0aGlzLiRhcHBtb2RhbC5vcGVuTW9kYWwodmlldywgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSwgaW1wb3J0RGF0YU1vZGVsKTsKICAgICAgICBjb250YWluZXIuc3Vic2NyaWJlKChyZXN1bHQ6IGFueSkgPT4gewogICAgICAgICAgaWYoT2JqZWN0LmlzKHJlc3VsdC5yZXQsJ09LJykpewogICAgICAgICAgICB0aGlzLnJlZnJlc2gocmVzdWx0LmRhdGFzKTsKICAgICAgICAgIH0KICAgICAgfSk7CiAgICB9CgoKICAgIC8qKgogICAgICog5pWw5o2u5a+85Ye6CiAgICAgKgogICAgICogQHBhcmFtIHsqfSBkYXRhCiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGV4cG9ydEV4Y2VsKGRhdGE6IGFueSA9IHt9KTogdm9pZCB7CiAgICAgICAgLy8g5a+85Ye6RXhjZWwKICAgICAgICBjb25zdCBkb0V4cG9ydCA9IGFzeW5jIChfZGF0YTphbnkpID0+IHsKICAgICAgICAgICAgY29uc3QgdEhlYWRlcjogQXJyYXk8YW55PiA9IFtdOwogICAgICAgICAgICBjb25zdCBmaWx0ZXJWYWw6IEFycmF5PGFueT4gPSBbXTsKICAgICAgICAgICAgdGhpcy5hbGxDb2x1bW5zLmZvckVhY2goKGl0ZW06IGFueSkgPT4gewogICAgICAgICAgICAgIGl0ZW0uc2hvdyAmJiBpdGVtLmxhYmVsID8gdEhlYWRlci5wdXNoKHRoaXMuJHQoaXRlbS5sYW5ndGFnKSkgOiAiIjsKICAgICAgICAgICAgICBpdGVtLnNob3cgJiYgaXRlbS5uYW1lID8gZmlsdGVyVmFsLnB1c2goaXRlbS5uYW1lKSA6ICIiOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMuZm9ybWF0RXhjZWxEYXRhKGZpbHRlclZhbCwgX2RhdGEpOwogICAgICAgICAgICB0aGlzLiRleHBvcnQuZXhwb3J0RXhjZWwoKS50aGVuKChleGNlbDphbnkpPT57CiAgICAgICAgICAgICAgICBleGNlbC5leHBvcnRfanNvbl90b19leGNlbCh7CiAgICAgICAgICAgICAgICAgIGhlYWRlcjogdEhlYWRlciwgLy/ooajlpLQg5b+F5aGrCiAgICAgICAgICAgICAgICAgIGRhdGEsIC8v5YW35L2T5pWw5o2uIOW/heWhqwogICAgICAgICAgICAgICAgICBmaWxlbmFtZTogIuS6uuWRmOS/oeaBr+ihqCIsIC8v6Z2e5b+F5aGrCiAgICAgICAgICAgICAgICAgIGF1dG9XaWR0aDogdHJ1ZSwgLy/pnZ7lv4XloasKICAgICAgICAgICAgICAgICAgYm9va1R5cGU6ICJ4bHN4IiAvL+mdnuW/heWhqwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOyAKICAgICAgICB9OwogICAgICAgIGNvbnN0IHBhZ2U6IGFueSA9IHt9OwogICAgICAgIC8vIOiuvue9rnBhZ2XvvIxzaXplCiAgICAgICAgaWYgKE9iamVjdC5pcyhkYXRhLnR5cGUsICdtYXhSb3dDb3VudCcpKSB7CiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFnZSwgeyBwYWdlOiAwLCBzaXplOiBkYXRhLm1heFJvd0NvdW50IH0pOwogICAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmlzKGRhdGEudHlwZSwgJ2FjdGl2YXRlZFBhZ2UnKSkgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgZG9FeHBvcnQoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLml0ZW1zKSkpOwogICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyDorr7nva7mjpLluo8KICAgICAgICBpZiAoIXRoaXMuaXNOb1NvcnQgJiYgIU9iamVjdC5pcyh0aGlzLm1pbm9yU29ydERpciwgJycpICYmICFPYmplY3QuaXModGhpcy5taW5vclNvcnRQU0RFRiwgJycpKSB7CiAgICAgICAgICBjb25zdCBzb3J0OiBzdHJpbmcgPSB0aGlzLm1pbm9yU29ydFBTREVGKyIsIit0aGlzLm1pbm9yU29ydERpcjsKICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihwYWdlLCB7IHNvcnQ6IHNvcnQgfSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGFyZzogYW55ID0ge307CiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHBhZ2UpOwogICAgICAgIC8vIOiOt+WPlnF1ZXJ5LOaQnOe0ouihqOWNle+8jHZpZXdwYXJhbXPnrYnniLbmlbDmja4KICAgICAgICBjb25zdCBwYXJlbnRkYXRhOiBhbnkgPSB7fTsKICAgICAgICB0aGlzLiRlbWl0KCdiZWZvcmVsb2FkJywgcGFyZW50ZGF0YSk7CiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHBhcmVudGRhdGEpOwogICAgICAgIGNvbnN0IHBvc3Q6IFByb21pc2U8YW55PiA9IHRoaXMuc2VydmljZS5zZWFyY2godGhpcy5mZXRjaEFjdGlvbixKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBhcmcsIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJycsIGRlc2M6ICfmlbDmja7lr7zlh7rlpLHotKUsJyArIHJlc3BvbnNlLmluZm8gfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGRvRXhwb3J0KEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICcnLCBkZXNjOiAn5pWw5o2u5a+85Ye65aSx6LSlJyB9KTsKICAgICAgICB9KTsKICAgIH0KCgogICAgLyoqCiAgICAgKiDlr7zlh7rmlbDmja7moLzlvI/ljJYKICAgICAqIAogICAgICogQHBhcmFtIHsqfSBmaWx0ZXJWYWwKICAgICAqIEBwYXJhbSB7Kn0ganNvbkRhdGEKICAgICAqIEByZXR1cm5zIHtbXX0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgYXN5bmMgZm9ybWF0RXhjZWxEYXRhKGZpbHRlclZhbDphbnksIGpzb25EYXRhOmFueSkgewogICAgICAgIGxldCBjb2RlbGlzdENvbHVtbnM6QXJyYXk8YW55PiA9IFsKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ3lnenQnLAogICAgICAgICAgICBzcmZrZXk6ICdFaHJDb2RlTGlzdDAwMTQnLAogICAgICAgICAgICBjb2RlbGlzdFR5cGUgOiAnRFlOQU1JQycsCiAgICAgICAgICAgIHJlbmRlck1vZGU6ICdvdGhlcicsCiAgICAgICAgICAgIHRleHRTZXBhcmF0b3I6ICfjgIEnLAogICAgICAgICAgICB2YWx1ZVNlcGFyYXRvcjogJywnLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ2d6enQnLAogICAgICAgICAgICBzcmZrZXk6ICdFaHJDb2RlTGlzdDAyMjgnLAogICAgICAgICAgICBjb2RlbGlzdFR5cGUgOiAnU1RBVElDJywKICAgICAgICAgICAgcmVuZGVyTW9kZTogJ290aGVyJywKICAgICAgICAgICAgdGV4dFNlcGFyYXRvcjogJ+OAgScsCiAgICAgICAgICAgIHZhbHVlU2VwYXJhdG9yOiAnLCcsCiAgICAgICAgICB9LAogICAgICAgIF07CiAgICAgICAgbGV0IF90aGlzID0gdGhpczsKICAgICAgICBmb3IgKGNvbnN0IGNvZGVsaXN0IG9mIGNvZGVsaXN0Q29sdW1ucykgewogICAgICAgICAgLy8g5Yqo5oCB5Luj56CB6KGo5aSE55CGCiAgICAgICAgICBpZiAoT2JqZWN0LmlzKGNvZGVsaXN0LmNvZGVsaXN0VHlwZSwgIkRZTkFNSUMiKSkgewogICAgICAgICAgICAgIGxldCBpdGVtcyA9IGF3YWl0IF90aGlzLmNvZGVMaXN0U2VydmljZS5nZXRJdGVtcyhjb2RlbGlzdC5zcmZrZXkpOwogICAgICAgICAgICAgIGpzb25EYXRhLmZvckVhY2goKHJvdzphbnkpPT57CiAgICAgICAgICAgICAgICAgIHJvd1tjb2RlbGlzdC5uYW1lXSA9IF90aGlzLmdldENvZGVsaXN0VmFsdWUoaXRlbXMsIHJvd1tjb2RlbGlzdC5uYW1lXSwgY29kZWxpc3QpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgLy8g6Z2Z5oCB5aSE55CGCiAgICAgICAgICB9IGVsc2UgaWYoT2JqZWN0LmlzKGNvZGVsaXN0LmNvZGVsaXN0VHlwZSwgIlNUQVRJQyIpKXsKICAgICAgICAgICAgICBsZXQgaXRlbXMgPSBhd2FpdCBfdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDb2RlTGlzdEl0ZW1zKGNvZGVsaXN0LnNyZmtleSk7CiAgICAgICAgICAgICAganNvbkRhdGEuZm9yRWFjaCgocm93OmFueSk9PnsKICAgICAgICAgICAgICAgICAgcm93W2NvZGVsaXN0Lm5hbWVdID0gX3RoaXMuZ2V0Q29kZWxpc3RWYWx1ZShpdGVtcywgcm93W2NvZGVsaXN0Lm5hbWVdLCBjb2RlbGlzdCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBqc29uRGF0YS5tYXAoKHY6YW55KSA9PiBmaWx0ZXJWYWwubWFwKChqOmFueSkgPT4gdltqXSkpCiAgICB9ICAgCgoKICAgIC8qKgogICAgICog6Kej5p6Q5Luj56CB6KGo5ZKMdmxhdWXvvIzorr7nva5pdGVtcwogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBwYXJhbSB7YW55W119IGl0ZW1zIOS7o+eggeihqOaVsOaNrgogICAgICogQHBhcmFtIHsqfSB2YWx1ZQogICAgICogQHJldHVybnMgeyp9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGdldENvZGVsaXN0VmFsdWUoaXRlbXM6IGFueVtdLCB2YWx1ZTogYW55LCBjb2RlbGlzdDogYW55LCl7CiAgICAgICAgaWYoIXZhbHVlKXsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHQoJ2NvZGVsaXN0LicrY29kZWxpc3Quc3Jma2V5KycuZW1wdHknKTsKICAgICAgICB9CiAgICAgICAgaWYgKGl0ZW1zKSB7CiAgICAgICAgICAgIGxldCByZXN1bHQ6YW55ID0gW107CiAgICAgICAgICAgIGlmKE9iamVjdC5pcyhjb2RlbGlzdC5yZW5kZXJNb2RlLCJudW1iZXIiKSl7CiAgICAgICAgICAgICAgICBpdGVtcy5tYXAoKF9pdGVtOiBhbnksIGluZGV4OiBudW1iZXIpPT57CiAgICAgICAgICAgICAgICAgICAgY29uc3QgblZhbHVlID0gcGFyc2VJbnQoKHZhbHVlIGFzIGFueSksIDEwKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2RldmFsdWUgPSBfaXRlbS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBpZigocGFyc2VJbnQoY29kZXZhbHVlLCAxMCkgJiBuVmFsdWUpID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKF9pdGVtKTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZihPYmplY3QuaXMoY29kZWxpc3QucmVuZGVyTW9kZSwic3RyaW5nIikpewogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlWYWx1ZTogQXJyYXk8YW55PiA9ICh2YWx1ZSBhcyBhbnkpLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKTsKICAgICAgICAgICAgICAgIGFycmF5VmFsdWUubWFwKCh2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goW10pOwogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZXM6IGFueVtdID0gT2JqZWN0LmlzKHRoaXMuJHV0aWwudHlwZU9mKHZhbHVlKSwgJ251bWJlcicpID8gW3ZhbHVlXSA6IFsuLi4odmFsdWUgYXMgYW55KS5zcGxpdChjb2RlbGlzdC52YWx1ZVNlcGFyYXRvcildOwogICAgICAgICAgICAgICAgICAgIHZhbHVlcy5tYXAoKHZhbDphbnkgLG51bTogbnVtYmVyKT0+ewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5nZXRJdGVtKGl0ZW1zLCB2YWwsIGNvZGVsaXN0KTsgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0pewogICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtpbmRleF0ucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbGV0IHZhbHVlczogYW55W10gPSBPYmplY3QuaXModGhpcy4kdXRpbC50eXBlT2YodmFsdWUpLCAnbnVtYmVyJykgPyBbdmFsdWVdIDogWy4uLih2YWx1ZSBhcyBhbnkpLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKV07CiAgICAgICAgICAgICAgICB2YWx1ZXMubWFwKCh2YWx1ZTphbnkgLGluZGV4OiBudW1iZXIpPT57CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZ2V0SXRlbShpdGVtcywgdmFsdWUsIGNvZGVsaXN0KTsgCiAgICAgICAgICAgICAgICAgICAgaWYoaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g6K6+572uaXRlbXMKICAgICAgICAgICAgaWYocmVzdWx0Lmxlbmd0aCAhPSAwKXsKICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmpvaW4oY29kZWxpc3QudmFsdWVTZXBhcmF0b3IpOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5bku6PnoIHpobkKICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAcGFyYW0ge2FueVtdfSBpdGVtcwogICAgICogQHBhcmFtIHsqfSB2YWx1ZQogICAgICogQHJldHVybnMgeyp9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGdldEl0ZW0oaXRlbXM6IGFueVtdLCB2YWx1ZTogYW55LCBjb2RlbGlzdDogYW55KTogYW55IHsKICAgICAgICBjb25zdCBhcnI6IEFycmF5PGFueT4gPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiB7cmV0dXJuIGl0ZW0udmFsdWUgPT0gdmFsdWV9KTsKICAgICAgICBpZiAoYXJyLmxlbmd0aCAhPT0gMSkgewogICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgICBpZihPYmplY3QuaXMoY29kZWxpc3QuY29kZWxpc3RUeXBlLCdTVEFUSUMnKSl7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiR0KCdjb2RlbGlzdC4nK2NvZGVsaXN0LnNyZmtleSsnLicrYXJyWzBdLnZhbHVlKTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgcmV0dXJuIGFyclswXS50ZXh0OwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIOeUn+WRveWRqOacnwogICAgICoKICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgY3JlYXRlZCgpOiB2b2lkIHsKICAgICAgICB0aGlzLmFmdGVyQ3JlYXRlZCgpOwogICAgfQoKICAgIC8qKgogICAgICog5omn6KGMY3JlYXRlZOWQjueahOmAu+i+kQogICAgICoKICAgICAqICBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLyAgICAKICAgIHB1YmxpYyBhZnRlckNyZWF0ZWQoKXsKICAgICAgICB0aGlzLnNldENvbFN0YXRlKCk7CiAgICAgICAgaWYgKHRoaXMudmlld1N0YXRlKSB7CiAgICAgICAgICAgIHRoaXMudmlld1N0YXRlRXZlbnQgPSB0aGlzLnZpZXdTdGF0ZS5zdWJzY3JpYmUoKHsgdGFnLCBhY3Rpb24sIGRhdGEgfSkgPT4gewogICAgICAgICAgICAgICAgaWYgKCFPYmplY3QuaXModGFnLCB0aGlzLm5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKE9iamVjdC5pcygnbG9hZCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdyZW1vdmUnLCBhY3Rpb24pKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdzYXZlJywgYWN0aW9uKSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZShkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogdnVlIOeUn+WRveWRqOacnwogICAgICoKICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgZGVzdHJveWVkKCkgewogICAgICAgIHRoaXMuYWZ0ZXJEZXN0cm95KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiDmiafooYxkZXN0cm95ZWTlkI7nmoTpgLvovpEKICAgICAqCiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGFmdGVyRGVzdHJveSgpIHsKICAgICAgICBpZiAodGhpcy52aWV3U3RhdGVFdmVudCkgewogICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZUV2ZW50LnVuc3Vic2NyaWJlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog6I635Y+W6YCJ5Lit6KGM6IOh5pWw5o2uCiAgICAgKgogICAgICogQHJldHVybnMge2FueVtdfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBnZXRTZWxlY3Rpb24oKTogYW55W10gewogICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiDooYzlj4zlh7vkuovku7YKICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIHJvd0RCTENsaWNrKCRldmVudDogYW55KTogdm9pZCB7CiAgICAgICAgaWYgKCEkZXZlbnQgfHwgdGhpcy5hY3R1YWxJc09wZW5FZGl0IHx8IE9iamVjdC5pcyh0aGlzLmdyaWRSb3dBY3RpdmVNb2RlLDApKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSgkZXZlbnQpKSk7CgogICAgICAgIGNvbnN0IHJlZnM6IGFueSA9IHRoaXMuJHJlZnM7CiAgICAgICAgaWYgKHJlZnMubXVsdGlwbGVUYWJsZSkgewogICAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUuY2xlYXJTZWxlY3Rpb24oKTsKICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbigkZXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kZW1pdCgncm93ZGJsY2xpY2snLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiDlpI3pgInmoYbmlbDmja7pgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIHNlbGVjdCgkZXZlbnQ6IGFueSk6IHZvaWQgewogICAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gWy4uLkpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoJGV2ZW50KSldOwogICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiDlpI3pgInmoYbmlbDmja7lhajpg6jpgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBzZWxlY3RBbGwoJGV2ZW50OiBhbnkpOiB2b2lkIHsKICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFsuLi5KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KCRldmVudCkpXTsKICAgICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgfQoKICAgIAogICAgLyoqCiAgICAgKiDooYzljZXlh7vpgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIHJvd0NsaWNrKCRldmVudDogYW55LCBpZkFsd2F5czogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7CiAgICAgICAgaWYgKCFpZkFsd2F5cyAmJiAoISRldmVudCB8fCB0aGlzLmFjdHVhbElzT3BlbkVkaXQpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYodGhpcy5zdG9wUm93Q2xpY2spIHsKICAgICAgICAgICAgdGhpcy5zdG9wUm93Q2xpY2sgPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZih0aGlzLmlzU2luZ2xlU2VsZWN0KXsKICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgfQogICAgICAgIC8vIOW3sumAieS4reWImeWIoOmZpO+8jOayoemAieS4reWImea3u+WKoAogICAgICAgIGxldCBzZWxlY3RJbmRleCA9IHRoaXMuc2VsZWN0aW9ucy5maW5kSW5kZXgoKGl0ZW06YW55KT0+ewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0ucGltcGVyc29uLCRldmVudC5waW1wZXJzb24pOwogICAgICAgIH0pOwogICAgICAgIGlmIChPYmplY3QuaXMoc2VsZWN0SW5kZXgsLTEpKXsKICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoJGV2ZW50KSkpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMuc3BsaWNlKHNlbGVjdEluZGV4LDEpOwogICAgICAgIH0KCiAgICAgICAgY29uc3QgcmVmczogYW55ID0gdGhpcy4kcmVmczsKICAgICAgICBpZiAocmVmcy5tdWx0aXBsZVRhYmxlKSB7CiAgICAgICAgICAgIGlmKHRoaXMuaXNTaW5nbGVTZWxlY3QpewogICAgICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUuc2V0Q3VycmVudFJvdygkZXZlbnQpOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS50b2dnbGVSb3dTZWxlY3Rpb24oJGV2ZW50KTsgCiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CgoKICAgIC8qKgogICAgICog6aG16Z2i5Y+Y5YyWCiAgICAgKgogICAgICogQHBhcmFtIHsqfSAkZXZlbnQKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBwYWdlT25DaGFuZ2UoJGV2ZW50OiBhbnkpOiB2b2lkIHsKICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICgkZXZlbnQgPT09IHRoaXMuY3VyUGFnZSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuY3VyUGFnZSA9ICRldmVudDsKICAgICAgICB0aGlzLmxvYWQoe30pOwogICAgfQoKICAgIC8qKgogICAgICog5YiG6aG15p2h5pWw5Y+Y5YyWCiAgICAgKgogICAgICogQHBhcmFtIHsqfSAkZXZlbnQKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBvblBhZ2VTaXplQ2hhbmdlKCRldmVudDogYW55KTogdm9pZCB7CiAgICAgICAgaWYgKCEkZXZlbnQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoJGV2ZW50ID09PSB0aGlzLmxpbWl0KSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5saW1pdCA9ICRldmVudDsKICAgICAgICBpZiAodGhpcy5jdXJQYWdlID09PSAxKSB7CiAgICAgICAgICAgIHRoaXMubG9hZCh7fSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog5YiG6aG15Yi35pawCiAgICAgKgogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBwYWdlUmVmcmVzaCgpOiB2b2lkIHsKICAgICAgICB0aGlzLmxvYWQoe30pOwogICAgfQoKICAgIC8qKgogICAgICog5o6S5bqP5Y+Y5YyWCiAgICAgKgogICAgICogQHBhcmFtIHt7IGNvbHVtbjogYW55LCBwcm9wOiBhbnksIG9yZGVyOiBhbnkgfX0geyBjb2x1bW4sIHByb3AsIG9yZGVyIH0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgb25Tb3J0Q2hhbmdlKHsgY29sdW1uLCBwcm9wLCBvcmRlciB9OiB7IGNvbHVtbjogYW55LCBwcm9wOiBhbnksIG9yZGVyOiBhbnkgfSk6IHZvaWQgewogICAgICAgIGNvbnN0IGRpciA9IE9iamVjdC5pcyhvcmRlciwgJ2FzY2VuZGluZycpID8gJ2FzYycgOiBPYmplY3QuaXMob3JkZXIsICdkZXNjZW5kaW5nJykgPyAnZGVzYycgOiAnJzsKICAgICAgICBpZiAoT2JqZWN0LmlzKGRpciwgdGhpcy5taW5vclNvcnREaXIpICYmIE9iamVjdC5pcyh0aGlzLm1pbm9yU29ydFBTREVGLCBwcm9wKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMubWlub3JTb3J0RGlyID0gZGlyOwogICAgICAgIHRoaXMubWlub3JTb3J0UFNERUYgPSBwcm9wID8gcHJvcCA6ICcnOwogICAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDooajmoLzooYzpgInkuK3moLflvI8KICAgICAqCiAgICAgKiBAcGFyYW0ge3sgcm93OiBhbnksIHJvd0luZGV4OiBhbnkgfX0geyByb3csIHJvd0luZGV4IH0KICAgICAqIEByZXR1cm5zIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIG9uUm93Q2xhc3NOYW1lKHsgcm93LCByb3dJbmRleCB9OiB7IHJvdzogYW55LCByb3dJbmRleDogYW55IH0pOiBzdHJpbmcgewogICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5zZWxlY3Rpb25zLmZpbmRJbmRleCgoc2VsZWN0OiBhbnkpID0+IE9iamVjdC5pcyhzZWxlY3Quc3Jma2V5LCByb3cuc3Jma2V5KSk7CiAgICAgICAgcmV0dXJuIGluZGV4ICE9PSAtMSA/ICdncmlkLXJvdy1zZWxlY3QnIDogJyc7CiAgICB9CgoKCiAgICAvKioKICAgICAqIOeVjOmdouihjOS4ugogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gcm93CiAgICAgKiBAcGFyYW0geyp9IHRhZwogICAgICogQHBhcmFtIHsqfSAkZXZlbnQKICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCglwdWJsaWMgdWlBY3Rpb24ocm93OiBhbnksIHRhZzogYW55LCAkZXZlbnQ6IGFueSkgewogICAgICAgIC8vIHRoaXMucm93Q2xpY2socm93LCB0cnVlKTsKICAgICAgICAkZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9CgogICAgLyoqCiAgICAgKiDorr7nva7liJfnirbmgIEKICAgICAqCiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIHNldENvbFN0YXRlKCkgewoJCWNvbnN0IF9kYXRhOiBhbnkgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncGltcGVyc29uX2d6ZHFfZ3JpZCcpOwoJCWlmIChfZGF0YSkgewoJCQlsZXQgY29sdW1ucyA9IEpTT04ucGFyc2UoX2RhdGEpOwoJCQljb2x1bW5zLmZvckVhY2goKGNvbDogYW55KSA9PiB7CgkJCQlsZXQgY29sdW1uID0gdGhpcy5hbGxDb2x1bW5zLmZpbmQoKGl0ZW0pID0+IE9iamVjdC5pcyhjb2wubmFtZSwgaXRlbS5uYW1lKSk7CgkJCQlpZiAoY29sdW1uKSB7CgkJCQkJT2JqZWN0LmFzc2lnbihjb2x1bW4sIGNvbCk7CgkJCQl9CgkJCX0pOwoJCX0KICAgIH0KCiAgICAvKioKICAgICAqIOWIl+WPmOWMlgogICAgICoKICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgb25Db2xDaGFuZ2UoKSB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BpbXBlcnNvbl9nemRxX2dyaWQnLCBKU09OLnN0cmluZ2lmeSh0aGlzLmFsbENvbHVtbnMpKTsKICAgIH0KCiAgICAvKioKICAgICAqIOiOt+WPluWIl+eKtuaAgQogICAgICoKICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lCiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgZ2V0Q29sdW1uU3RhdGUobmFtZTogc3RyaW5nKTogYm9vbGVhbiB7CiAgICAgICAgbGV0IGNvbHVtbiA9IHRoaXMuYWxsQ29sdW1ucy5maW5kKChjb2w6IGFueSkgPT4KICAgICAgICAgICAgT2JqZWN0LmlzKG5hbWUsIGNvbC5uYW1lKQogICAgICAgICk7CiAgICAgICAgcmV0dXJuIGNvbHVtbi5zaG93ID8gdHJ1ZSA6IGZhbHNlOwogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC85YiX5piv5ZCm6Ieq6YCC5bqU5biD5bGACiAgICAgKgogICAgICogQHJlYWRvbmx5CiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBnZXQgYWRhcHRpdmVTdGF0ZSgpOiBib29sZWFuIHsKICAgICAgICByZXR1cm4gIXRoaXMuYWxsQ29sdW1ucy5maW5kKChjb2x1bW46IGFueSkgPT4gY29sdW1uLnNob3cgJiYgT2JqZWN0LmlzKGNvbHVtbi51dGlsLCAnU1RBUicpKTsKICAgIH0KCiAgICAvKioKICAgICAqIOS/neWtmAogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50CiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBhc3luYyBzYXZlKGFyZ3M6IGFueVtdLCBwYXJhbXM/OiBhbnksICRldmVudD86IGFueSwgeERhdGE/OiBhbnkpewogICAgICAgIGxldCBfdGhpcyA9IHRoaXM7CiAgICAgICAgaWYoIWF3YWl0IHRoaXMudmFsaWRhdGVBbGwoKSl7CiAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ+WAvOinhOWImeagoemqjOW8guW4uCcgfSk7CiAgICAgICAgICAgIHJldHVybiBbXTsKICAgICAgICB9CiAgICAgICAgbGV0IHN1Y2Nlc3NJdGVtczphbnkgPSBbXTsKICAgICAgICBsZXQgZXJyb3JJdGVtczphbnkgPSBbXTsKICAgICAgICBsZXQgZXJyb3JNZXNzYWdlOmFueSA9IFtdOwogICAgICAgIGZvciAoY29uc3QgaXRlbSBvZiBfdGhpcy5pdGVtcykgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgaWYoT2JqZWN0LmlzKGl0ZW0ucm93RGF0YVN0YXRlLCAnY3JlYXRlJykpewogICAgICAgICAgICAgICAgICAgIGlmKCF0aGlzLmNyZWF0ZUFjdGlvbil7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ1BJTVBFUlNPTkdaUllITUNHcmlkVmlld+inhuWbvuihqOagvGNyZWF0ZUFjdGlvbuWPguaVsOacqumFjee9ricgfSk7CiAgICAgICAgICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGl0ZW0se3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSk7CiAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnNlcnZpY2UuYWRkKHRoaXMuY3JlYXRlQWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLGl0ZW0sIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICAgICAgICAgICAgICAgICAgc3VjY2Vzc0l0ZW1zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhKSkpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH1lbHNlIGlmKE9iamVjdC5pcyhpdGVtLnJvd0RhdGFTdGF0ZSwgJ3VwZGF0ZScpKXsKICAgICAgICAgICAgICAgICAgICBpZighdGhpcy51cGRhdGVBY3Rpb24pewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICdQSU1QRVJTT05HWlJZSE1DR3JpZFZpZXfop4blm77ooajmoLx1cGRhdGVBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGl0ZW0se3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0ucGltcGVyc29uKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb250ZXh0LHtwaW1wZXJzb246aXRlbS5waW1wZXJzb259KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnNlcnZpY2UuYWRkKHRoaXMudXBkYXRlQWN0aW9uLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksaXRlbSwgdGhpcy5zaG93QnVzeUluZGljYXRvcik7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NJdGVtcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBlcnJvckl0ZW1zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShpdGVtKSkpOwogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlLnB1c2goZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRoaXMuJGVtaXQoJ3NhdmUnLCBzdWNjZXNzSXRlbXMpOwogICAgICAgIHRoaXMucmVmcmVzaChbXSk7CiAgICAgICAgaWYoZXJyb3JJdGVtcy5sZW5ndGggPT09IDApewogICAgICAgICAgICB0aGlzLiROb3RpY2Uuc3VjY2Vzcyh7IHRpdGxlOiAnJywgZGVzYzogJ+S/neWtmOaIkOWKnyEnIH0pOwogICAgICAgIH1lbHNlewogICAgICAgICAgZXJyb3JJdGVtcy5mb3JFYWNoKChpdGVtOmFueSxpbmRleDpudW1iZXIpPT57CiAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn5L+d5a2Y5aSx6LSlJywgZGVzYzogaXRlbS5tYWpvcmVudGl0eW5hbWUrJ+S/neWtmOWksei0pe+8gScgfSk7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JNZXNzYWdlW2luZGV4XSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN1Y2Nlc3NJdGVtczsKICAgIH0KCiAgICAvKioKICAgICAqIOaWsOW7uuihjAogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50CiAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgbmV3Um93KGFyZ3M6IGFueVtdLCBwYXJhbXM/OiBhbnksICRldmVudD86IGFueSwgeERhdGE/OiBhbnkpOiB2b2lkIHsKICAgICAgICBpZighdGhpcy5sb2FkZHJhZnRBY3Rpb24pewogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICdQSU1QRVJTT05HWlJZSE1DR3JpZFZpZXfop4blm77ooajmoLxsb2FkZHJhZnRBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCBfdGhpcyA9IHRoaXM7CiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmdzWzBdLHt2aWV3cGFyYW1zOnRoaXMudmlld3BhcmFtc30pOwogICAgICAgIGxldCBwb3N0OiBQcm9taXNlPGFueT4gPSB0aGlzLnNlcnZpY2UubG9hZERyYWZ0KHRoaXMubG9hZGRyYWZ0QWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBhcmdzWzBdLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgICBwb3N0LnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5zdGF0dXMgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvck1lc3NhZ2UpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6IHJlc3BvbnNlLmVycm9yTWVzc2FnZSB9KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgdGhpcy5jcmVhdGVEZWZhdWx0KGRhdGEpOwogICAgICAgICAgICBkYXRhLnJvd0RhdGFTdGF0ZSA9ICJjcmVhdGUiOwogICAgICAgICAgICBfdGhpcy5pdGVtcy5wdXNoKGRhdGEpOwogICAgICAgICAgICBfdGhpcy5ncmlkSXRlbXNNb2RlbC5wdXNoKF90aGlzLmdldEdyaWRSb3dNb2RlbCgpKTsKICAgICAgICB9KS5jYXRjaCgocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ+ezu+e7n+W8guW4uCcgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIOihqOagvOe8lui+kemhueWAvOWPmOabtAogICAgICogIAogICAgICogQHBhcmFtIHJvdyDooYzmlbDmja4KICAgICAqIEBwYXJhbSB7eyBuYW1lOiBzdHJpbmcsIHZhbHVlOiBhbnkgfX0gJGV2ZW50CiAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAqIEBtZW1iZXJvZiBHWkRRQmFzZQogICAgICovCiAgICBwdWJsaWMgb25HcmlkSXRlbVZhbHVlQ2hhbmdlKHJvdzogYW55LCRldmVudDogeyBuYW1lOiBzdHJpbmcsIHZhbHVlOiBhbnkgfSxyb3dJbmRleDogbnVtYmVyKTogdm9pZCB7CiAgICAgICAgaWYgKCEkZXZlbnQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoISRldmVudC5uYW1lIHx8IE9iamVjdC5pcygkZXZlbnQubmFtZSwgJycpIHx8ICFyb3cuaGFzT3duUHJvcGVydHkoJGV2ZW50Lm5hbWUpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgcm93WyRldmVudC5uYW1lXSA9ICRldmVudC52YWx1ZTsKICAgICAgICB0aGlzLmdyaWRFZGl0SXRlbUNoYW5nZShyb3csICRldmVudC5uYW1lLCAkZXZlbnQudmFsdWUsIHJvd0luZGV4KTsKICAgIH0KCiAgICAvKioKICAgICAqIOihqOagvOe8lui+kemhueWAvOWPmOWMlgogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBwYXJhbSByb3cg6KGM5pWw5o2uCiAgICAgKiBAcGFyYW0gcHJvcGVydHkg5YiX57yW6L6R6aG55ZCNCiAgICAgKiBAcGFyYW0gcm93IOWIl+e8lui+kemhueWAvAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGdyaWRFZGl0SXRlbUNoYW5nZShyb3c6IGFueSwgcHJvcGVydHk6IHN0cmluZywgdmFsdWU6IGFueSwgcm93SW5kZXg6IG51bWJlcil7CiAgICAgICAgcm93LnJvd0RhdGFTdGF0ZSA9IHJvdy5yb3dEYXRhU3RhdGUgPyByb3cucm93RGF0YVN0YXRlIDogInVwZGF0ZSIgOwogICAgICAgIHRoaXMudmFsaWRhdGUocHJvcGVydHkscm93LHJvd0luZGV4KTsKICAgIH0KCiAgICAvKioKICAgICAqIOihqOagvOe8lui+kemhueabtOaWsAogICAgICoKICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtb2RlIOeVjOmdouihjOS4uuWQjeensAogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0g6K+35rGC5pWw5o2uCiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSB1cGRhdGVEZXRhaWxzIOabtOaWsOmhuQogICAgICogQHBhcmFtIHtib29sZWFufSBbc2hvd2xvYWRpbmddIOaYr+WQpuaYvuekuuWKoOi9veeKtuaAgQogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIHVwZGF0ZUdyaWRFZGl0SXRlbShtb2RlOiBzdHJpbmcsIGRhdGE6IGFueSA9IHt9LCB1cGRhdGVEZXRhaWxzOiBzdHJpbmdbXSwgc2hvd2xvYWRpbmc/OiBib29sZWFuKTogdm9pZCB7CiAgICAgICAgaWYgKCFtb2RlIHx8IChtb2RlICYmIE9iamVjdC5pcyhtb2RlLCAnJykpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgYXJnOiBhbnkgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZyx7dmlld3BhcmFtczp0aGlzLnZpZXdwYXJhbXN9KTsKICAgICAgICBjb25zdCBwb3N0OiBQcm9taXNlPGFueT4gPSB0aGlzLnNlcnZpY2UuZnJvbnRMb2dpYyhtb2RlLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksYXJnLCBzaG93bG9hZGluZyk7CiAgICAgICAgcG9zdC50aGVuKChyZXNwb25zZTogYW55KSA9PiB7CiAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ+ihqOWNlemhueabtOaWsOWksei0pScgfSk7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc3QgX2RhdGE6IGFueSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIGlmKCFfZGF0YSl7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdXBkYXRlRGV0YWlscy5mb3JFYWNoKChuYW1lOiBzdHJpbmcpID0+IHsKICAgICAgICAgICAgICAgIGlmICghX2RhdGEuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBkYXRhW25hbWVdID0gX2RhdGFbbmFtZV07CiAgICAgICAgICAgIH0pOwogICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn57O757uf5byC5bi4JyB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICog6I635Y+W5a+55bqU6KGMY2xhc3MKICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRhcmdzIHJvdyDooYzmlbDmja7vvIxyb3dJbmRleCDooYzntKLlvJUKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBnZXRSb3dDbGFzc05hbWUoYXJnczp7cm93OiBhbnkscm93SW5kZXg6IG51bWJlcn0pewogICAgICAgIGxldCBpc1NlbGVjdGVkID0gdGhpcy5zZWxlY3Rpb25zLnNvbWUoKGl0ZW06YW55KT0+ewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0ucGltcGVyc29uLGFyZ3Mucm93LnBpbXBlcnNvbik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGlzU2VsZWN0ZWQgPyAiZ3JpZC1zZWxlY3RlZC1yb3ciIDogIiI7CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5blr7nlupTliJdjbGFzcwogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGFyZ3Mgcm93IOihjOaVsOaNru+8jGNvbHVtbiDliJfmlbDmja7vvIxyb3dJbmRleCDooYzntKLlvJXvvIzliJfntKLlvJUKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIEdaRFFCYXNlCiAgICAgKi8KICAgIHB1YmxpYyBnZXRDZWxsQ2xhc3NOYW1lKGFyZ3M6e3JvdzogYW55LCBjb2x1bW46IGFueSwgcm93SW5kZXg6IG51bWJlciwgY29sdW1uSW5kZXg6bnVtYmVyfSl7CiAgICAgICAgbGV0IGhhc1Jvd0VkaXQ6YW55ID0gewogICAgICAgICAgJ3lnYmgnOmZhbHNlLAogICAgICAgICAgJ3BpbXBlcnNvbm5hbWUnOmZhbHNlLAogICAgICAgICAgJ3lnenQnOmZhbHNlLAogICAgICAgICAgJ2d6enQnOmZhbHNlLAogICAgICAgICAgJ2d6enonOmZhbHNlLAogICAgICAgICAgJ2d6Ym0nOmZhbHNlLAogICAgICAgICAgJ2d6a3Nzaic6ZmFsc2UsCiAgICAgICAgICAnZ3pqc3NqJzpmYWxzZSwKICAgICAgICB9CiAgICAgICAgcmV0dXJuICggaGFzUm93RWRpdFthcmdzLmNvbHVtbi5wcm9wZXJ0eV0gJiYgdGhpcy5hY3R1YWxJc09wZW5FZGl0ICkgPyAiZWRpdC1jZWxsIiA6ICJpbmZvLWNlbGwiOwogICAgfQoKICAgIC8qKgogICAgICog5paw5bu66buY6K6k5YC8CiAgICAgKiBAcGFyYW0geyp9ICByb3cg6KGM5pWw5o2uCiAgICAgKiBAbWVtYmVyb2YgR1pEUUJhc2UKICAgICAqLwogICAgcHVibGljIGNyZWF0ZURlZmF1bHQocm93OiBhbnkpeyAgICAgICAgICAgICAgICAgICAgCiAgICB9Cn0K"},null]}