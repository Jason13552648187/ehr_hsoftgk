{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-work-history\\main-grid\\main-grid-base.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-work-history\\main-grid\\main-grid-base.vue","mtime":1630509413776},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKaW1wb3J0IHsgVnVlLCBDb21wb25lbnQsIFByb3AsIFByb3ZpZGUsIEVtaXQsIFdhdGNoLCBNb2RlbCxJbmplY3QgfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJzsKaW1wb3J0IHsgQ3JlYXRlRWxlbWVudCB9IGZyb20gJ3Z1ZSc7CmltcG9ydCB7IFN1YmplY3QsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnOwppbXBvcnQgeyBDb250cm9sSW50ZXJmYWNlIH0gZnJvbSAnQC9pbnRlcmZhY2UvY29udHJvbCc7CmltcG9ydCB7IFVJQWN0aW9uVG9vbCxVdGlsIH0gZnJvbSAnQC91dGlscyc7CmltcG9ydCBOYXZEYXRhU2VydmljZSBmcm9tICdAL3NlcnZpY2UvYXBwL25hdmRhdGEtc2VydmljZSc7CmltcG9ydCBQaW1Xb3JrSGlzdG9yeVNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL3BpbS13b3JrLWhpc3RvcnkvcGltLXdvcmstaGlzdG9yeS1zZXJ2aWNlJzsKaW1wb3J0IE1haW5TZXJ2aWNlIGZyb20gJy4vbWFpbi1ncmlkLXNlcnZpY2UnOwoKaW1wb3J0IENvZGVMaXN0U2VydmljZSBmcm9tICJAc2VydmljZS9hcHAvY29kZWxpc3Qtc2VydmljZSI7CmltcG9ydCB7IEZvcm1JdGVtTW9kZWwgfSBmcm9tICdAL21vZGVsL2Zvcm0tZGV0YWlsJzsKCgpAQ29tcG9uZW50KHsKICAgIGNvbXBvbmVudHM6IHsKICAgICAgCiAgICB9Cn0pCmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1haW5CYXNlIGV4dGVuZHMgVnVlIGltcGxlbWVudHMgQ29udHJvbEludGVyZmFjZSB7CgogICAgLyoqCiAgICAgKiDlkI3np7AKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIG5hbWU/OiBzdHJpbmc7CgogICAgLyoqCiAgICAgKiDop4blm77pgJrorq/lr7nosaEKICAgICAqCiAgICAgKiBAdHlwZSB7U3ViamVjdDxWaWV3U3RhdGU+fQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIHZpZXdTdGF0ZSE6IFN1YmplY3Q8Vmlld1N0YXRlPjsKCiAgICAvKioKICAgICAqIOW6lOeUqOS4iuS4i+aWhwogICAgICoKICAgICAqIEB0eXBlIHsqfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIGNvbnRleHQ6IGFueTsKCiAgICAvKioKICAgICAqIOinhuWbvuWPguaVsAogICAgICoKICAgICAqIEB0eXBlIHsqfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIHZpZXdwYXJhbXM6IGFueTsKCiAgICAvKioKICAgICAqIOinhuWbvueKtuaAgeS6i+S7tgogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEB0eXBlIHsoU3Vic2NyaXB0aW9uIHwgdW5kZWZpbmVkKX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgdmlld1N0YXRlRXZlbnQ6IFN1YnNjcmlwdGlvbiB8IHVuZGVmaW5lZDsKCiAgICAvKioKICAgICAqIOiOt+WPlumDqOS7tuexu+WeiwogICAgICoKICAgICAqIEByZXR1cm5zIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldENvbnRyb2xUeXBlKCk6IHN0cmluZyB7CiAgICAgICAgcmV0dXJuICdHUklEJwogICAgfQoKCgogICAgLyoqCiAgICAgKiDorqHmlbDlmajmnI3liqHlr7nosaHpm4blkIgKICAgICAqCiAgICAgKiBAdHlwZSB7QXJyYXk8Kj59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLyAgICAKICAgIHB1YmxpYyBjb3VudGVyU2VydmljZUFycmF5OkFycmF5PGFueT4gPSBbXTsKCiAgICAvKioKICAgICAqIOW7uuaehOmDqOS7tuacjeWKoeWvueixoQogICAgICoKICAgICAqIEB0eXBlIHtNYWluU2VydmljZX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgc2VydmljZTogTWFpblNlcnZpY2UgPSBuZXcgTWFpblNlcnZpY2UoeyAkc3RvcmU6IHRoaXMuJHN0b3JlIH0pOwoKICAgIC8qKgogICAgICog5a6e5L2T5pyN5Yqh5a+56LGhCiAgICAgKgogICAgICogQHR5cGUge1BpbVdvcmtIaXN0b3J5U2VydmljZX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgYXBwRW50aXR5U2VydmljZTogUGltV29ya0hpc3RvcnlTZXJ2aWNlID0gbmV3IFBpbVdvcmtIaXN0b3J5U2VydmljZSh7ICRzdG9yZTogdGhpcy4kc3RvcmUgfSk7CiAgICAKCgogICAgLyoqCiAgICAgKiDlhbPpl63op4blm74KICAgICAqCiAgICAgKiBAcGFyYW0ge2FueX0gYXJncwogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBjbG9zZVZpZXcoYXJnczogYW55KTogdm9pZCB7CiAgICAgICAgbGV0IF90aGlzOiBhbnkgPSB0aGlzOwogICAgICAgIF90aGlzLiRlbWl0KCdjbG9zZXZpZXcnLCBbYXJnc10pOwogICAgfQoKICAgIC8qKgogICAgICogIOiuoeaVsOWZqOWIt+aWsAogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgY291bnRlclJlZnJlc2goKXsKICAgICAgICBjb25zdCBfdGhpczphbnkgPXRoaXM7CiAgICAgICAgaWYoX3RoaXMuY291bnRlclNlcnZpY2VBcnJheSAmJiBfdGhpcy5jb3VudGVyU2VydmljZUFycmF5Lmxlbmd0aCA+MCl7CiAgICAgICAgICAgIF90aGlzLmNvdW50ZXJTZXJ2aWNlQXJyYXkuZm9yRWFjaCgoaXRlbTphbnkpID0+ewogICAgICAgICAgICAgICAgaWYoaXRlbS5yZWZyZXNoRGF0YSAmJiBpdGVtLnJlZnJlc2hEYXRhIGluc3RhbmNlb2YgRnVuY3Rpb24pewogICAgICAgICAgICAgICAgICAgIGl0ZW0ucmVmcmVzaERhdGEoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICB9CiAgICB9CgoKICAgIC8qKgogICAgICog5Luj56CB6KGo5pyN5Yqh5a+56LGhCiAgICAgKgogICAgICogQHR5cGUge0NvZGVMaXN0U2VydmljZX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovICAKICAgIHB1YmxpYyBjb2RlTGlzdFNlcnZpY2U6Q29kZUxpc3RTZXJ2aWNlID0gbmV3IENvZGVMaXN0U2VydmljZSh7ICRzdG9yZTogdGhpcy4kc3RvcmUgfSk7CgogICAgLyoqCiAgICAgKiDojrflj5blpJrpobnmlbDmja4KICAgICAqCiAgICAgKiBAcmV0dXJucyB7YW55W119CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldERhdGFzKCk6IGFueVtdIHsKICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25zOwogICAgfQoKICAgIC8qKgogICAgICog6I635Y+W5Y2V6aG55qCRCiAgICAgKgogICAgICogQHJldHVybnMgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldERhdGEoKTogYW55IHsKICAgICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25zWzBdOwogICAgfQoKICAgIC8qKgogICAgICog5omT5byA5paw5bu65pWw5o2u6KeG5Zu+CiAgICAgKgogICAgICogQHR5cGUge2FueX0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBuZXdkYXRhOiBhbnk7CiAgICAvKioKICAgICAqIOaJk+W8gOe8lui+keaVsOaNruinhuWbvgogICAgICoKICAgICAqIEB0eXBlIHthbnl9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgb3BlbmRhdGE6IGFueTsKCiAgICAvKioKICAgICAqIOaYvuekuuWkhOeQhuaPkOekugogICAgICoKICAgICAqIEB0eXBlIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKHsgZGVmYXVsdDogdHJ1ZSB9KSBwdWJsaWMgc2hvd0J1c3lJbmRpY2F0b3I/OiBib29sZWFuOwoKICAgIC8qKgogICAgICog6YOo5Lu26KGM5Li6LS11cGRhdGUKICAgICAqCiAgICAgKiBAdHlwZSB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKCkgcHVibGljIHVwZGF0ZUFjdGlvbiE6IHN0cmluZzsKICAgIAogICAgLyoqCiAgICAgKiDpg6jku7booYzkuLotLWZldGNoCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBmZXRjaEFjdGlvbiE6IHN0cmluZzsKICAgIAogICAgLyoqCiAgICAgKiDpg6jku7booYzkuLotLXJlbW92ZQogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgcmVtb3ZlQWN0aW9uITogc3RyaW5nOwogICAgCiAgICAvKioKICAgICAqIOmDqOS7tuihjOS4ui0tbG9hZAogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgbG9hZEFjdGlvbiE6IHN0cmluZzsKICAgIAogICAgLyoqCiAgICAgKiDpg6jku7booYzkuLotLWxvYWRkcmFmdAogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgbG9hZGRyYWZ0QWN0aW9uITogc3RyaW5nOwogICAgCiAgICAvKioKICAgICAqIOmDqOS7tuihjOS4ui0tY3JlYXRlCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBjcmVhdGVBY3Rpb24hOiBzdHJpbmc7CgogICAgLyoqCiAgICAgKiDlvZPliY3pobUKICAgICAqCiAgICAgKiBAdHlwZSB7bnVtYmVyfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBjdXJQYWdlOiBudW1iZXIgPSAxOwoKICAgIC8qKgogICAgICog5pWw5o2uCiAgICAgKgogICAgICogQHR5cGUge2FueVtdfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBpdGVtczogYW55W10gPSBbXTsKCiAgICAvKioKICAgICAqIOaYr+WQpuaUr+aMgeWIhumhtQogICAgICoKICAgICAqIEB0eXBlIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBpc0VuYWJsZVBhZ2luZ0JhcjogYm9vbGVhbiA9IHRydWU7CgogICAgLyoqCiAgICAgKiDmmK/lkKbnpoHnlKjmjpLluo8KICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgaXNOb1NvcnQ6IGJvb2xlYW4gPSBmYWxzZTsKCiAgICAvKioKICAgICAqIOaOkuW6j+aWueWQkQogICAgICoKICAgICAqIEB0eXBlIHtzdHJpbmd9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIG1pbm9yU29ydERpcjogc3RyaW5nID0gJ0RFU0MnOwoKICAgIC8qKgogICAgICog5o6S5bqP5a2X5q61CiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgbWlub3JTb3J0UFNERUY6IHN0cmluZyA9ICdyemtzc2onOwoKICAgIC8qKgogICAgICog5YiG6aG15p2h5pWwCiAgICAgKgogICAgICogQHR5cGUge251bWJlcn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgbGltaXQ6IG51bWJlciA9IDIwOwoKICAgIC8qKgogICAgICog5piv5ZCm5pi+56S65qCH6aKYCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGlzSGlkZUhlYWRlcjogYm9vbGVhbiA9IGZhbHNlOwoKICAgIC8qKgogICAgICog5piv5ZCm6buY6K6k6YCJ5Lit56ys5LiA5p2h5pWw5o2uCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoeyBkZWZhdWx0OiBmYWxzZSB9KSBwdWJsaWMgaXNTZWxlY3RGaXJzdERlZmF1bHQhOiBib29sZWFuOwoKICAgIC8qKgogICAgICog5piv5ZCm5Y2V6YCJCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3AoKSBwdWJsaWMgaXNTaW5nbGVTZWxlY3Q/OiBib29sZWFuOwoKICAgIC8qKgogICAgICog6YCJ5Lit5pWw5o2u5a2X56ym5LiyCiAgICAgKgogICAgICogQHR5cGUge3N0cmluZ30KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAUHJvcCgpIHB1YmxpYyBzZWxlY3RlZERhdGE/OiBzdHJpbmc7CgogICAgLyoqCiAgICAgKiDpgInkuK3lgLzlj5jljJYKICAgICAqCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbAogICAgICogQHBhcmFtIHsqfSBvbGRWYWwKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBAV2F0Y2goJ3NlbGVjdGVkRGF0YScpCiAgICBwdWJsaWMgb25WYWx1ZUNoYW5nZShuZXdWYWw6IGFueSwgb2xkVmFsOiBhbnkpIHsKICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTsKICAgICAgICBpZih0aGlzLnNlbGVjdGVkRGF0YSl7CiAgICAgICAgICAgIGNvbnN0IHJlZnM6IGFueSA9IHRoaXMuJHJlZnM7CiAgICAgICAgICAgIGlmIChyZWZzLm11bHRpcGxlVGFibGUpIHsKICAgICAgICAgICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS5jbGVhclNlbGVjdGlvbigpOwogICAgICAgICAgICAgICAgSlNPTi5wYXJzZSh0aGlzLnNlbGVjdGVkRGF0YSkuZm9yRWFjaCgoc2VsZWN0aW9uOmFueSk9PnsKICAgICAgICAgICAgICAgICAgICBsZXQgc2VsZWN0ZWRJdGVtID0gdGhpcy5pdGVtcy5maW5kKChpdGVtOmFueSk9PnsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhpdGVtLnNyZmtleSwgc2VsZWN0aW9uLnNyZmtleSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yb3dDbGljayhzZWxlY3RlZEl0ZW0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC86KGM5pWw5o2u6buY6K6k5r+A5rS75qih5byPCiAgICAgKiAwIOS4jea/gOa0uwogICAgICogMSDljZXlh7vmv4DmtLsKICAgICAqIDIg5Y+M5Ye75r+A5rS7CiAgICAgKgogICAgICogQHR5cGUgeyhudW1iZXIgfCAwIHwgMSB8IDIpfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIEBQcm9wKHtkZWZhdWx0OiAyfSkgcHVibGljIGdyaWRSb3dBY3RpdmVNb2RlITogbnVtYmVyOwoKICAgIC8qKgogICAgICog5piv5ZCm5byA5ZCv6KGM57yW6L6RCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgQFByb3Aoe2RlZmF1bHQ6IGZhbHNlfSkgcHVibGljIGlzT3BlbkVkaXQhOiBib29sZWFuOwoKICAgIC8qKgogICAgICog5a6e6ZmF5piv5ZCm5byA5ZCv6KGM57yW6L6RCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGFjdHVhbElzT3BlbkVkaXQ6IGJvb2xlYW4gPSB0aGlzLmlzT3BlbkVkaXQ7CgogICAgLyoqCiAgICAgKiDmgLvmnaHmlbAKICAgICAqCiAgICAgKiBAdHlwZSB7bnVtYmVyfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyB0b3RhbHJvdzogbnVtYmVyID0gMDsKCiAgICAvKioKICAgICAqIOmAieS4reihjOaVsOaNrgogICAgICoKICAgICAqIEB0eXBlIHthbnlbXX0KICAgICAqIEBtZW1iZXJvZiBNYWluCiAgICAgKi8KICAgIHB1YmxpYyBzZWxlY3Rpb25zOiBhbnlbXSA9IFtdOwoKICAgIC8qKgogICAgICog5oum5oiq6KGM6YCJ5LitCiAgICAgKgogICAgICogQHR5cGUge2Jvb2xlYW59CiAgICAgKiBAbWVtYmVyb2YgTWFpbgogICAgICovCiAgICBwdWJsaWMgc3RvcFJvd0NsaWNrOiBib29sZWFuID0gZmFsc2U7CgoKCgogICAgLyoqCiAgICAgKiDooajmoLzmmK/lkKbmmL7npLoKICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgaXNEaXNwbGF5OmJvb2xlYW4gPSB0cnVlOwoKICAgIC8qKgogICAgICog6YOo5Lu25Yi35pawCiAgICAgKgogICAgICogQHBhcmFtIHthbnlbXX0gYXJncwogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyByZWZyZXNoKGFyZ3M6IGFueVtdKTogdm9pZCB7CiAgICAgICAgdGhpcy5sb2FkKCk7CiAgICB9CgogICAgLyoqCiAgICAqIOmAiemhueahhuWIl+WuvQogICAgKgogICAgKiBAdHlwZSB7bnVtYmVyfQogICAgKiBAbWVtYmVyb2YgQXBwSW5kZXgKICAgICovCiAgICBwdWJsaWMgY2hlY2tib3hDb2xXaWR0aDogbnVtYmVyID0gMzQ7CgogICAgLyoqCiAgICAgKiDmmK/lkKblhYHorrjmi5bliqjliJflrr0KICAgICAqCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0KICAgICAqIEBtZW1iZXJvZiBBcHBFbWJlZFBpY2tlcgogICAgICovCiAgICBwdWJsaWMgaXNEcmFnZW5kQ29sOiBib29sZWFuID0gZmFsc2U7CgogICAgLyoqCiAgICAgKiDmiYDmnInliJfmiJDlkZgKICAgICAqCiAgICAgKiBAdHlwZSB7YW55W119CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGFsbENvbHVtbnM6IGFueVtdID0gWwogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ3J6a3NzaicsCiAgICAgICAgICAgIGxhYmVsOiAn5Lu76IGM5byA5aeL5pe26Ze0JywKICAgICAgICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbXdvcmtoaXN0b3J5Lm1haW5fZ3JpZC5jb2x1bW5zLnJ6a3NzaicsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ3J6anNzaicsCiAgICAgICAgICAgIGxhYmVsOiAn5Lu76IGM57uT5p2f5pe26Ze0JywKICAgICAgICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbXdvcmtoaXN0b3J5Lm1haW5fZ3JpZC5jb2x1bW5zLnJ6anNzaicsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ29ybW9yZ25hbWUnLAogICAgICAgICAgICBsYWJlbDogJ+W3peS9nOWNleS9jScsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW13b3JraGlzdG9yeS5tYWluX2dyaWQuY29sdW1ucy5vcm1vcmduYW1lJywKICAgICAgICAgICAgc2hvdzogdHJ1ZSwKICAgICAgICAgICAgdXRpbDogJ1BYJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBuYW1lOiAnb3Jtb3Jnc2VjdG9ybmFtZScsCiAgICAgICAgICAgIGxhYmVsOiAn6YOo6ZeoJywKICAgICAgICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbXdvcmtoaXN0b3J5Lm1haW5fZ3JpZC5jb2x1bW5zLm9ybW9yZ3NlY3Rvcm5hbWUnLAogICAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgICB1dGlsOiAnUFgnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICdvcm1kdXR5bmFtZScsCiAgICAgICAgICAgIGxhYmVsOiAn6IGM5YqhJywKICAgICAgICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbXdvcmtoaXN0b3J5Lm1haW5fZ3JpZC5jb2x1bW5zLm9ybWR1dHluYW1lJywKICAgICAgICAgICAgc2hvdzogdHJ1ZSwKICAgICAgICAgICAgdXRpbDogJ1BYJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgICBuYW1lOiAnb3JtcG9zdG5hbWUnLAogICAgICAgICAgICBsYWJlbDogJ+Wyl+S9jScsCiAgICAgICAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW13b3JraGlzdG9yeS5tYWluX2dyaWQuY29sdW1ucy5vcm1wb3N0bmFtZScsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgICAgbmFtZTogJ2NmcGx4JywKICAgICAgICAgICAgbGFiZWw6ICflhbzogYzlgJ/osIPnsbvlnosnLAogICAgICAgICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltd29ya2hpc3RvcnkubWFpbl9ncmlkLmNvbHVtbnMuY2ZwbHgnLAogICAgICAgICAgICBzaG93OiB0cnVlLAogICAgICAgICAgICB1dGlsOiAnUFgnCiAgICAgICAgfSwKICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICdleHBlcmllbmNlJywKICAgICAgICAgICAgbGFiZWw6ICfmmK/lkKbkuLvopoHnu4/ljoYnLAogICAgICAgICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltd29ya2hpc3RvcnkubWFpbl9ncmlkLmNvbHVtbnMuZXhwZXJpZW5jZScsCiAgICAgICAgICAgIHNob3c6IHRydWUsCiAgICAgICAgICAgIHV0aWw6ICdQWCcKICAgICAgICB9LAogICAgXQoKICAgIC8qKgogICAgICog6KGo5qC85qih5Z6L6ZuG5ZCICiAgICAgKgogICAgICogQHR5cGUgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdyaWRJdGVtc01vZGVsOiBhbnlbXSA9IFtdOwoKICAgIC8qKgogICAgICog6I635Y+W6KGo5qC86KGM5qih5Z6LCiAgICAgKgogICAgICogQHR5cGUgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldEdyaWRSb3dNb2RlbCgpewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBqbGN6ejogbmV3IEZvcm1JdGVtTW9kZWwoKSwKICAgICAgICAgIG9ybXBvc3RuYW1lOiBuZXcgRm9ybUl0ZW1Nb2RlbCgpLAogICAgICAgICAgcnprc3NqOiBuZXcgRm9ybUl0ZW1Nb2RlbCgpLAogICAgICAgICAgcGltcGVyc29uaWQ6IG5ldyBGb3JtSXRlbU1vZGVsKCksCiAgICAgICAgICBjZnBseDogbmV3IEZvcm1JdGVtTW9kZWwoKSwKICAgICAgICAgIGV4cGVyaWVuY2U6IG5ldyBGb3JtSXRlbU1vZGVsKCksCiAgICAgICAgICByempzc2o6IG5ldyBGb3JtSXRlbU1vZGVsKCksCiAgICAgICAgICBzcmZrZXk6IG5ldyBGb3JtSXRlbU1vZGVsKCksCiAgICAgICAgICBvcm1kdXR5bmFtZTogbmV3IEZvcm1JdGVtTW9kZWwoKSwKICAgICAgICAgIG9ybW9yZ3NlY3Rvcm5hbWU6IG5ldyBGb3JtSXRlbU1vZGVsKCksCiAgICAgICAgICBvcm1vcmduYW1lOiBuZXcgRm9ybUl0ZW1Nb2RlbCgpLAogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIOWxnuaAp+WAvOinhOWImQogICAgICoKICAgICAqIEB0eXBlIHsqfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBydWxlczogYW55ID0gewogICAgICAgIGpsY3p6OiBbCiAgICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn6K6w5b2V5pON5L2c6ICFIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB2YWxpZGF0b3I6IChydWxlOmFueSwgdmFsdWU6YW55LCBjYWxsYmFjazphbnkpID0+IHsgcmV0dXJuIChydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikpID8gZmFsc2UgOiB0cnVlO30sIG1lc3NhZ2U6ICforrDlvZXmk43kvZzogIUg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sCiAgICAgICAgXSwKICAgICAgICBvcm1wb3N0bmFtZTogWwogICAgICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn5bKX5L2NIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+Wyl+S9jSDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwKICAgICAgICBdLAogICAgICAgIHJ6a3NzajogWwogICAgICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn5Lu76IGM5byA5aeL5pe26Ze0IOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+S7u+iBjOW8gOWni+aXtumXtCDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwKICAgICAgICBdLAogICAgICAgIHBpbXBlcnNvbmlkOiBbCiAgICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn5Lq65ZGY5L+h5oGv5qCH6K+GIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB2YWxpZGF0b3I6IChydWxlOmFueSwgdmFsdWU6YW55LCBjYWxsYmFjazphbnkpID0+IHsgcmV0dXJuIChydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikpID8gZmFsc2UgOiB0cnVlO30sIG1lc3NhZ2U6ICfkurrlkZjkv6Hmga/moIfor4Yg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sCiAgICAgICAgXSwKICAgICAgICBjZnBseDogWwogICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+WFvOiBjOWAn+iwg+exu+WeiyDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LAogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn5YW86IGM5YCf6LCD57G75Z6LIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LAogICAgICAgIF0sCiAgICAgICAgZXhwZXJpZW5jZTogWwogICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+aYr+WQpuS4u+imgee7j+WOhiDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LAogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn5piv5ZCm5Li76KaB57uP5Y6GIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LAogICAgICAgIF0sCiAgICAgICAgcnpqc3NqOiBbCiAgICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn5Lu76IGM57uT5p2f5pe26Ze0IOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB2YWxpZGF0b3I6IChydWxlOmFueSwgdmFsdWU6YW55LCBjYWxsYmFjazphbnkpID0+IHsgcmV0dXJuIChydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikpID8gZmFsc2UgOiB0cnVlO30sIG1lc3NhZ2U6ICfku7vogYznu5PmnZ/ml7bpl7Qg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sCiAgICAgICAgXSwKICAgICAgICBzcmZrZXk6IFsKICAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB2YWxpZGF0b3I6IChydWxlOmFueSwgdmFsdWU6YW55LCBjYWxsYmFjazphbnkpID0+IHsgcmV0dXJuIChydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikpID8gZmFsc2UgOiB0cnVlO30sIG1lc3NhZ2U6ICflt6XkvZzlsaXljobmoIfor4Yg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2NoYW5nZScgfSwKICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+W3peS9nOWxpeWOhuagh+ivhiDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwKICAgICAgICBdLAogICAgICAgIG9ybWR1dHluYW1lOiBbCiAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCB2YWxpZGF0b3I6IChydWxlOmFueSwgdmFsdWU6YW55LCBjYWxsYmFjazphbnkpID0+IHsgcmV0dXJuIChydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikpID8gZmFsc2UgOiB0cnVlO30sIG1lc3NhZ2U6ICfogYzliqEg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2NoYW5nZScgfSwKICAgICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn6IGM5YqhIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LAogICAgICAgIF0sCiAgICAgICAgb3Jtb3Jnc2VjdG9ybmFtZTogWwogICAgICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgdmFsaWRhdG9yOiAocnVsZTphbnksIHZhbHVlOmFueSwgY2FsbGJhY2s6YW55KSA9PiB7IHJldHVybiAocnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpKSA/IGZhbHNlIDogdHJ1ZTt9LCBtZXNzYWdlOiAn6YOo6ZeoIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+mDqOmXqCDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwKICAgICAgICBdLAogICAgICAgIG9ybW9yZ25hbWU6IFsKICAgICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIHZhbGlkYXRvcjogKHJ1bGU6YW55LCB2YWx1ZTphbnksIGNhbGxiYWNrOmFueSkgPT4geyByZXR1cm4gKHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSkgPyBmYWxzZSA6IHRydWU7fSwgbWVzc2FnZTogJ+W3peS9nOWNleS9jSDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LAogICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCB2YWxpZGF0b3I6IChydWxlOmFueSwgdmFsdWU6YW55LCBjYWxsYmFjazphbnkpID0+IHsgcmV0dXJuIChydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikpID8gZmFsc2UgOiB0cnVlO30sIG1lc3NhZ2U6ICflt6XkvZzljZXkvY0g5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sCiAgICAgICAgXSwKICAgIH0KCiAgICAvKioKICAgICAqIOihqOagvOihjOe8lui+kemhueagoemqjAogICAgICoKICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eSDlsZ7mgKflkI0KICAgICAqIEBwYXJhbSB7Kn0gZGF0YSDooYzmlbDmja4KICAgICAqIEBwYXJhbSB7bnVtYmVyfSByb3dJbmRleCDooYzntKLlvJUKICAgICAqIEByZXR1cm5zIFByb21pc2U8YW55PgogICAgICogCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHZhbGlkYXRlKHByb3BlcnR5OnN0cmluZywgZGF0YTphbnksIHJvd0luZGV4Om51bWJlcik6UHJvbWlzZTxhbnk+ewogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgICAgICAgIHRoaXMuJHV0aWwudmFsaWRhdGVJdGVtKHByb3BlcnR5LGRhdGEsdGhpcy5ydWxlcykudGhlbigoKT0+ewogICAgICAgICAgICAgICAgdGhpcy5ncmlkSXRlbXNNb2RlbFtyb3dJbmRleF1bcHJvcGVydHldLnNldEVycm9yKG51bGwpOwogICAgICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICAgICAgfSkuY2F0Y2goKHsgZXJyb3JzLCBmaWVsZHMgfSkgPT4gewogICAgICAgICAgICAgICAgdGhpcy5ncmlkSXRlbXNNb2RlbFtyb3dJbmRleF1bcHJvcGVydHldLnNldEVycm9yKGVycm9yc1swXS5tZXNzYWdlKTsKICAgICAgICAgICAgICAgIHJlc29sdmUoZmFsc2UpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgIH0KCiAgICAvKioKICAgICAqIOagoemqjOaJgOacieS/ruaUuei/h+eahOe8lui+kemhuQogICAgICoKICAgICAqIEByZXR1cm5zIFByb21pc2U8YW55PgogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBhc3luYyB2YWxpZGF0ZUFsbCgpewogICAgICAgIGxldCB2YWxpZGF0ZVN0YXRlID0gdHJ1ZTsKICAgICAgICBsZXQgaW5kZXggPSAtMTsKICAgICAgICBmb3IobGV0IGl0ZW0gb2YgdGhpcy5pdGVtcyl7CiAgICAgICAgICBpbmRleCsrOwogICAgICAgICAgaWYoaXRlbS5yb3dEYXRhU3RhdGUgPT09ICJjcmVhdGUiIHx8IGl0ZW0ucm93RGF0YVN0YXRlID09PSAidXBkYXRlIil7CiAgICAgICAgICAgIGZvcihsZXQgcHJvcGVydHkgb2YgT2JqZWN0LmtleXModGhpcy5ydWxlcykpewogICAgICAgICAgICAgIGlmKCFhd2FpdCB0aGlzLnZhbGlkYXRlKHByb3BlcnR5LGl0ZW0saW5kZXgpKXsKICAgICAgICAgICAgICAgIHZhbGlkYXRlU3RhdGUgPSBmYWxzZTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbGlkYXRlU3RhdGU7CiAgICB9CgogICAgLyoqCiAgICAgKiDooajmoLzmlbDmja7liqDovb0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9IFthcmc9e31dCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGxvYWQob3B0OiBhbnkgPSB7fSwgcGFnZVJlc2V0OiBib29sZWFuID0gZmFsc2UpOiB2b2lkIHsKICAgICAgICBpZighdGhpcy5mZXRjaEFjdGlvbil7CiAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ1BJTVdPUktISVNUT1JZUGltV29ya0dyaWRWaWV36KeG5Zu+6KGo5qC8ZmV0Y2hBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmKHBhZ2VSZXNldCl7CiAgICAgICAgICAgIHRoaXMuY3VyUGFnZSA9IDE7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGFyZzogYW55ID0gey4uLm9wdH07CiAgICAgICAgY29uc3QgcGFnZTogYW55ID0ge307CiAgICAgICAgaWYgKHRoaXMuaXNFbmFibGVQYWdpbmdCYXIpIHsKICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihwYWdlLCB7IHBhZ2U6IHRoaXMuY3VyUGFnZS0xLCBzaXplOiB0aGlzLmxpbWl0IH0pOwogICAgICAgIH0KICAgICAgICAvLyDorr7nva7mjpLluo8KICAgICAgICBpZiAoIXRoaXMuaXNOb1NvcnQgJiYgIU9iamVjdC5pcyh0aGlzLm1pbm9yU29ydERpciwgJycpICYmICFPYmplY3QuaXModGhpcy5taW5vclNvcnRQU0RFRiwgJycpKSB7CiAgICAgICAgICAgIGNvbnN0IHNvcnQ6IHN0cmluZyA9IHRoaXMubWlub3JTb3J0UFNERUYrIiwiK3RoaXMubWlub3JTb3J0RGlyOwogICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsgc29ydDogc29ydCB9KTsKICAgICAgICB9CiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHBhZ2UpOwogICAgICAgIGNvbnN0IHBhcmVudGRhdGE6IGFueSA9IHt9OwogICAgICAgIHRoaXMuJGVtaXQoJ2JlZm9yZWxvYWQnLCBwYXJlbnRkYXRhKTsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgcGFyZW50ZGF0YSk7CiAgICAgICAgbGV0IHRlbXBWaWV3UGFyYW1zOmFueSA9IHBhcmVudGRhdGEudmlld3BhcmFtcz9wYXJlbnRkYXRhLnZpZXdwYXJhbXM6e307CiAgICAgICAgT2JqZWN0LmFzc2lnbih0ZW1wVmlld1BhcmFtcyxKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMudmlld3BhcmFtcykpKTsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZyx7dmlld3BhcmFtczp0ZW1wVmlld1BhcmFtc30pOwogICAgICAgIGNvbnN0IHBvc3Q6IFByb21pc2U8YW55PiA9IHRoaXMuc2VydmljZS5zZWFyY2godGhpcy5mZXRjaEFjdGlvbixKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBhcmcsIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN0YXR1cyB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yTWVzc2FnZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogcmVzcG9uc2UuZXJyb3JNZXNzYWdlIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IGRhdGE6IGFueSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIHRoaXMudG90YWxyb3cgPSByZXNwb25zZS50b3RhbDsKICAgICAgICAgICAgdGhpcy5pdGVtcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgICAgICAvLyDmuIXnqbpzZWxlY3Rpb25zLGdyaWRJdGVtc01vZGVsCiAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgICAgICB0aGlzLmdyaWRJdGVtc01vZGVsID0gW107CiAgICAgICAgICAgIHRoaXMuaXRlbXMuZm9yRWFjaCgoKT0+e3RoaXMuZ3JpZEl0ZW1zTW9kZWwucHVzaCh0aGlzLmdldEdyaWRSb3dNb2RlbCgpKX0pOwogICAgICAgICAgICB0aGlzLiRlbWl0KCdsb2FkJywgdGhpcy5pdGVtcyk7CiAgICAgICAgICAgIC8vIOiuvue9rum7mOiupOmAieS4rQogICAgICAgICAgICBsZXQgX3RoaXMgPSB0aGlzOwogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgICAgIGlmKF90aGlzLmlzU2VsZWN0Rmlyc3REZWZhdWx0KXsKICAgICAgICAgICAgICAgICAgX3RoaXMucm93Q2xpY2soX3RoaXMuaXRlbXNbMF0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYoX3RoaXMuc2VsZWN0ZWREYXRhKXsKICAgICAgICAgICAgICAgICAgICBjb25zdCByZWZzOiBhbnkgPSBfdGhpcy4kcmVmczsKICAgICAgICAgICAgICAgICAgICBpZiAocmVmcy5tdWx0aXBsZVRhYmxlKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS5jbGVhclNlbGVjdGlvbigpOwogICAgICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKF90aGlzLnNlbGVjdGVkRGF0YSkuZm9yRWFjaCgoc2VsZWN0aW9uOmFueSk9PnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZWxlY3RlZEl0ZW0gPSBfdGhpcy5pdGVtcy5maW5kKChpdGVtOmFueSk9PnsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0uc3Jma2V5LCBzZWxlY3Rpb24uc3Jma2V5KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2VsZWN0ZWRJdGVtKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5yb3dDbGljayhzZWxlY3RlZEl0ZW0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0sIDMwMCk7CiAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiByZXNwb25zZS5lcnJvck1lc3NhZ2UgfSk7CiAgICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDliKDpmaQKICAgICAqCiAgICAgKiBAcGFyYW0ge2FueVtdfSBkYXRhcwogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgYXN5bmMgcmVtb3ZlKGRhdGFzOiBhbnlbXSk6IFByb21pc2U8YW55PiB7CiAgICAgICAgaWYoIXRoaXMucmVtb3ZlQWN0aW9uKXsKICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAnUElNV09SS0hJU1RPUllQaW1Xb3JrR3JpZFZpZXfop4blm77ooajmoLxyZW1vdmVBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCBfZGF0YXM6YW55W10gPSBbXTsKICAgICAgICBkYXRhcy5mb3JFYWNoKChyZWNvcmQ6IGFueSwgaW5kZXg6IG51bWJlcikgPT4gewogICAgICAgICAgICBpZiAoT2JqZWN0LmlzKHJlY29yZC5zcmZ1ZiwiMCIpKSB7CiAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLnNvbWUoKHZhbDogYW55LCBudW06IG51bWJlcikgPT57CiAgICAgICAgICAgICAgICAgICAgaWYoSlNPTi5zdHJpbmdpZnkodmFsKSA9PSBKU09OLnN0cmluZ2lmeShyZWNvcmQpKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5zcGxpY2UobnVtLDEpOwogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyaWRJdGVtc01vZGVsLnNwbGljZShudW0sMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0pOyAKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgIF9kYXRhcy5wdXNoKGRhdGFzW2luZGV4XSk7CiAgICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBpZiAoX2RhdGFzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGxldCBkYXRhSW5mbyA9ICcnOwogICAgICAgIF9kYXRhcy5mb3JFYWNoKChyZWNvcmQ6IGFueSwgaW5kZXg6IG51bWJlcikgPT4gewogICAgICAgICAgICBsZXQgc3JmbWFqb3J0ZXh0ID0gcmVjb3JkLnBpbXdvcmtoaXN0b3J5bmFtZTsKICAgICAgICAgICAgaWYgKGluZGV4IDwgNSkgewogICAgICAgICAgICAgICAgaWYgKCFPYmplY3QuaXMoZGF0YUluZm8sICcnKSkgewogICAgICAgICAgICAgICAgICAgIGRhdGFJbmZvICs9ICfjgIEnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZGF0YUluZm8gKz0gc3JmbWFqb3J0ZXh0OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICAgIGlmIChfZGF0YXMubGVuZ3RoIDwgNSkgewogICAgICAgICAgICBkYXRhSW5mbyA9IGRhdGFJbmZvICsgJyDlhbEnICsgX2RhdGFzLmxlbmd0aCArICfmnaHmlbDmja4nOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGRhdGFJbmZvID0gZGF0YUluZm8gKyAnLi4uJyArICcg5YWxJyArIF9kYXRhcy5sZW5ndGggKyAn5p2h5pWw5o2uJzsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHJlbW92ZURhdGEgPSAoKSA9PiB7CiAgICAgICAgICAgIGxldCBrZXlzOiBhbnlbXSA9IFtdOwogICAgICAgICAgICBfZGF0YXMuZm9yRWFjaCgoZGF0YTogYW55KSA9PiB7CiAgICAgICAgICAgICAgICBrZXlzLnB1c2goZGF0YS5zcmZrZXkpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgbGV0IF9yZW1vdmVBY3Rpb24gPSBrZXlzLmxlbmd0aCA+IDEgPyAncmVtb3ZlQmF0Y2gnIDogdGhpcy5yZW1vdmVBY3Rpb24gOwogICAgICAgICAgICBsZXQgX2tleXMgPSBrZXlzLmxlbmd0aCA+IDEgPyBrZXlzIDoga2V5c1swXSA7CiAgICAgICAgICAgIGNvbnN0IGNvbnRleHQ6YW55ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKTsKICAgICAgICAgICAgY29uc3QgcG9zdDogUHJvbWlzZTxhbnk+ID0gdGhpcy5zZXJ2aWNlLmRlbGV0ZShfcmVtb3ZlQWN0aW9uLE9iamVjdC5hc3NpZ24oY29udGV4dCx7IHBpbXdvcmtoaXN0b3J5OiBfa2V5cyB9KSxPYmplY3QuYXNzaWduKHsgcGltd29ya2hpc3Rvcnk6IF9rZXlzIH0se3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSksIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmU6IGFueSwgcmVqZWN0OiBhbnkpID0+IHsKICAgICAgICAgICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICcnLCBkZXNjOiAn5Yig6Zmk5pWw5o2u5aSx6LSlLCcgKyByZXNwb25zZS5pbmZvIH0pOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLnN1Y2Nlc3MoeyB0aXRsZTogJycsIGRlc2M6ICfliKDpmaTmiJDlip8hJyB9KTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgLy/liKDpmaRpdGVtc+S4reW3suWIoOmZpOeahOmhuQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoaXMuaXRlbXMpOwogICAgICAgICAgICAgICAgICAgIF9kYXRhcy5mb3JFYWNoKChkYXRhOiBhbnkpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtcy5zb21lKChpdGVtOmFueSxpbmRleDpudW1iZXIpPT57CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihPYmplY3QuaXMoaXRlbS5zcmZrZXksZGF0YS5zcmZrZXkpKXsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1zLnNwbGljZShpbmRleCwxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdyaWRJdGVtc01vZGVsLnNwbGljZShpbmRleCwxKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdGhpcy50b3RhbHJvdyAtPSBfZGF0YXMubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3JlbW92ZScsIG51bGwpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn57O757uf5byC5bi4JyB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgZGF0YUluZm8gPSBkYXRhSW5mby5yZXBsYWNlKC9bbnVsbF0vZywgJycpLnJlcGxhY2UoL1t1bmRlZmluZWRdL2csICcnKTsKICAgICAgICB0aGlzLiRNb2RhbC5jb25maXJtKHsKICAgICAgICAgICAgdGl0bGU6ICforablkYonLAogICAgICAgICAgICBjb250ZW50OiAn56Gu6K6k6KaB5Yig6ZmkICcgKyBkYXRhSW5mbyArICfvvIzliKDpmaTmk43kvZzlsIbkuI3lj6/mgaLlpI3vvJ8nLAogICAgICAgICAgICBvbk9rOiAoKSA9PiB7CiAgICAgICAgICAgICAgICByZW1vdmVEYXRhKCk7CiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIG9uQ2FuY2VsOiAoKSA9PiB7IH0KICAgICAgICB9KTsKICAgICAgICByZXR1cm4gcmVtb3ZlRGF0YTsKICAgIH0KCgogICAgLyoqCiAgICAgKiDmibnph4/mt7vliqAKICAgICAqCiAgICAgKiBAcGFyYW0geyp9IFthcmc9e31dCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGFkZEJhdGNoKGFyZzogYW55ID0ge30pOiB2b2lkIHsKICAgICAgICBpZighdGhpcy5mZXRjaEFjdGlvbil7CiAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ1BJTVdPUktISVNUT1JZUGltV29ya0dyaWRWaWV36KeG5Zu+6KGo5qC8ZmV0Y2hBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmKCFhcmcpewogICAgICAgICAgICBhcmcgPSB7fTsKICAgICAgICB9CiAgICAgICAgY29uc29sZS5lcnJvcigi5om56YeP5re75Yqg5pyq5a6e546wIik7CiAgICB9CgogICAgLyoqCiAgICAgKiDmlbDmja7lr7zlhaUKICAgICAqCiAgICAgKiBAcGFyYW0geyp9IGRhdGEKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICAgcHVibGljIGltcG9ydEV4Y2VsKGRhdGE6YW55ID17fSk6dm9pZHsKICAgICAgICAvL+WvvOWFpWV4Y2VsCiAgICAgICAgY29uc3QgaW1wb3J0RGF0YU1vZGVsOmFueSA9ewogICAgICAgIH0KICAgICAgICBpZihPYmplY3Qua2V5cyhpbXBvcnREYXRhTW9kZWwpLmxlbmd0aCA9PSAwKXsKICAgICAgICAgICAgdGhpcy4kTm90aWNlLndhcm5pbmcoeyAndGl0bGUnOiAodGhpcy4kdCgiYXBwLnV0aWx2aWV3Lndhcm5pbmciKSBhcyBzdHJpbmcpLCAnZGVzYyc6ICh0aGlzLiR0KCJhcHAudXRpbHZpZXcuaW5mbyIpIGFzIHN0cmluZykgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgY29uc3QgdmlldzphbnkgPXsKICAgICAgICAgICAgdmlld25hbWU6ICdhcHAtZGF0YS11cGxvYWQnLAogICAgICAgICAgICB0aXRsZTogdGhpcy4kdCgiYXBwLnV0aWx2aWV3LmltcG9ydHZpZXciKSwKICAgICAgICAgICAgd2lkdGg6IDkwMCwKICAgICAgICAgICAgaGVpZ2h0OiA3MDAKICAgICAgICB9CiAgICAgICAgbGV0IGNvbnRhaW5lcjogU3ViamVjdDxhbnk+ID0gdGhpcy4kYXBwbW9kYWwub3Blbk1vZGFsKHZpZXcsIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGltcG9ydERhdGFNb2RlbCk7CiAgICAgICAgY29udGFpbmVyLnN1YnNjcmliZSgocmVzdWx0OiBhbnkpID0+IHsKICAgICAgICAgIGlmKE9iamVjdC5pcyhyZXN1bHQucmV0LCdPSycpKXsKICAgICAgICAgICAgdGhpcy5yZWZyZXNoKHJlc3VsdC5kYXRhcyk7CiAgICAgICAgICB9CiAgICAgIH0pOwogICAgfQoKCiAgICAvKioKICAgICAqIOaVsOaNruWvvOWHugogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gZGF0YQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBleHBvcnRFeGNlbChkYXRhOiBhbnkgPSB7fSk6IHZvaWQgewogICAgICAgIC8vIOWvvOWHukV4Y2VsCiAgICAgICAgY29uc3QgZG9FeHBvcnQgPSBhc3luYyAoX2RhdGE6YW55KSA9PiB7CiAgICAgICAgICAgIGNvbnN0IHRIZWFkZXI6IEFycmF5PGFueT4gPSBbXTsKICAgICAgICAgICAgY29uc3QgZmlsdGVyVmFsOiBBcnJheTxhbnk+ID0gW107CiAgICAgICAgICAgIHRoaXMuYWxsQ29sdW1ucy5mb3JFYWNoKChpdGVtOiBhbnkpID0+IHsKICAgICAgICAgICAgICBpdGVtLnNob3cgJiYgaXRlbS5sYWJlbCA/IHRIZWFkZXIucHVzaCh0aGlzLiR0KGl0ZW0ubGFuZ3RhZykpIDogIiI7CiAgICAgICAgICAgICAgaXRlbS5zaG93ICYmIGl0ZW0ubmFtZSA/IGZpbHRlclZhbC5wdXNoKGl0ZW0ubmFtZSkgOiAiIjsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0aGlzLmZvcm1hdEV4Y2VsRGF0YShmaWx0ZXJWYWwsIF9kYXRhKTsKICAgICAgICAgICAgdGhpcy4kZXhwb3J0LmV4cG9ydEV4Y2VsKCkudGhlbigoZXhjZWw6YW55KT0+ewogICAgICAgICAgICAgICAgZXhjZWwuZXhwb3J0X2pzb25fdG9fZXhjZWwoewogICAgICAgICAgICAgICAgICBoZWFkZXI6IHRIZWFkZXIsIC8v6KGo5aS0IOW/heWhqwogICAgICAgICAgICAgICAgICBkYXRhLCAvL+WFt+S9k+aVsOaNriDlv4XloasKICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6ICLlt6XkvZzlsaXljobooagiLCAvL+mdnuW/heWhqwogICAgICAgICAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsIC8v6Z2e5b+F5aGrCiAgICAgICAgICAgICAgICAgIGJvb2tUeXBlOiAieGxzeCIgLy/pnZ7lv4XloasKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsgCiAgICAgICAgfTsKICAgICAgICBjb25zdCBwYWdlOiBhbnkgPSB7fTsKICAgICAgICAvLyDorr7nva5wYWdl77yMc2l6ZQogICAgICAgIGlmIChPYmplY3QuaXMoZGF0YS50eXBlLCAnbWF4Um93Q291bnQnKSkgewogICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsgcGFnZTogMCwgc2l6ZTogZGF0YS5tYXhSb3dDb3VudCB9KTsKICAgICAgICB9IGVsc2UgaWYgKE9iamVjdC5pcyhkYXRhLnR5cGUsICdhY3RpdmF0ZWRQYWdlJykpIHsKICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgIGRvRXhwb3J0KEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5pdGVtcykpKTsKICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgLy8g6K6+572u5o6S5bqPCiAgICAgICAgaWYgKCF0aGlzLmlzTm9Tb3J0ICYmICFPYmplY3QuaXModGhpcy5taW5vclNvcnREaXIsICcnKSAmJiAhT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0UFNERUYsICcnKSkgewogICAgICAgICAgY29uc3Qgc29ydDogc3RyaW5nID0gdGhpcy5taW5vclNvcnRQU0RFRisiLCIrdGhpcy5taW5vclNvcnREaXI7CiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFnZSwgeyBzb3J0OiBzb3J0IH0pOwogICAgICAgIH0KICAgICAgICBjb25zdCBhcmc6IGFueSA9IHt9OwogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCBwYWdlKTsKICAgICAgICAvLyDojrflj5ZxdWVyeSzmkJzntKLooajljZXvvIx2aWV3cGFyYW1z562J54i25pWw5o2uCiAgICAgICAgY29uc3QgcGFyZW50ZGF0YTogYW55ID0ge307CiAgICAgICAgdGhpcy4kZW1pdCgnYmVmb3JlbG9hZCcsIHBhcmVudGRhdGEpOwogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCBwYXJlbnRkYXRhKTsKICAgICAgICBjb25zdCBwb3N0OiBQcm9taXNlPGFueT4gPSB0aGlzLnNlcnZpY2Uuc2VhcmNoKHRoaXMuZmV0Y2hBY3Rpb24sSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSwgYXJnLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgICBwb3N0LnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICcnLCBkZXNjOiAn5pWw5o2u5a+85Ye65aSx6LSlLCcgKyByZXNwb25zZS5pbmZvIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBkb0V4cG9ydChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHJlc3BvbnNlLmRhdGEpKSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICAgICAgfQogICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAnJywgZGVzYzogJ+aVsOaNruWvvOWHuuWksei0pScgfSk7CiAgICAgICAgfSk7CiAgICB9CgoKICAgIC8qKgogICAgICog5a+85Ye65pWw5o2u5qC85byP5YyWCiAgICAgKiAKICAgICAqIEBwYXJhbSB7Kn0gZmlsdGVyVmFsCiAgICAgKiBAcGFyYW0geyp9IGpzb25EYXRhCiAgICAgKiBAcmV0dXJucyB7W119CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGFzeW5jIGZvcm1hdEV4Y2VsRGF0YShmaWx0ZXJWYWw6YW55LCBqc29uRGF0YTphbnkpIHsKICAgICAgICBsZXQgY29kZWxpc3RDb2x1bW5zOkFycmF5PGFueT4gPSBbCiAgICAgICAgICB7CiAgICAgICAgICAgIG5hbWU6ICdjZnBseCcsCiAgICAgICAgICAgIHNyZmtleTogJ0VockNvZGVMaXN0MDIzNycsCiAgICAgICAgICAgIGNvZGVsaXN0VHlwZSA6ICdEWU5BTUlDJywKICAgICAgICAgICAgcmVuZGVyTW9kZTogJ290aGVyJywKICAgICAgICAgICAgdGV4dFNlcGFyYXRvcjogJ+OAgScsCiAgICAgICAgICAgIHZhbHVlU2VwYXJhdG9yOiAnLCcsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAnZXhwZXJpZW5jZScsCiAgICAgICAgICAgIHNyZmtleTogJ0VockNvZGVMaXN0MDQwMScsCiAgICAgICAgICAgIGNvZGVsaXN0VHlwZSA6ICdTVEFUSUMnLAogICAgICAgICAgICB0ZXh0U2VwYXJhdG9yOiAn44CBJywKICAgICAgICAgICAgcmVuZGVyTW9kZTogJ3N0cmluZycsCiAgICAgICAgICAgIHZhbHVlU2VwYXJhdG9yOiAiOyIsCiAgICAgICAgICB9LAogICAgICAgIF07CiAgICAgICAgbGV0IF90aGlzID0gdGhpczsKICAgICAgICBmb3IgKGNvbnN0IGNvZGVsaXN0IG9mIGNvZGVsaXN0Q29sdW1ucykgewogICAgICAgICAgLy8g5Yqo5oCB5Luj56CB6KGo5aSE55CGCiAgICAgICAgICBpZiAoT2JqZWN0LmlzKGNvZGVsaXN0LmNvZGVsaXN0VHlwZSwgIkRZTkFNSUMiKSkgewogICAgICAgICAgICAgIGxldCBpdGVtcyA9IGF3YWl0IF90aGlzLmNvZGVMaXN0U2VydmljZS5nZXRJdGVtcyhjb2RlbGlzdC5zcmZrZXkpOwogICAgICAgICAgICAgIGpzb25EYXRhLmZvckVhY2goKHJvdzphbnkpPT57CiAgICAgICAgICAgICAgICAgIHJvd1tjb2RlbGlzdC5uYW1lXSA9IF90aGlzLmdldENvZGVsaXN0VmFsdWUoaXRlbXMsIHJvd1tjb2RlbGlzdC5uYW1lXSwgY29kZWxpc3QpOwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgLy8g6Z2Z5oCB5aSE55CGCiAgICAgICAgICB9IGVsc2UgaWYoT2JqZWN0LmlzKGNvZGVsaXN0LmNvZGVsaXN0VHlwZSwgIlNUQVRJQyIpKXsKICAgICAgICAgICAgICBsZXQgaXRlbXMgPSBhd2FpdCBfdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDb2RlTGlzdEl0ZW1zKGNvZGVsaXN0LnNyZmtleSk7CiAgICAgICAgICAgICAganNvbkRhdGEuZm9yRWFjaCgocm93OmFueSk9PnsKICAgICAgICAgICAgICAgICAgcm93W2NvZGVsaXN0Lm5hbWVdID0gX3RoaXMuZ2V0Q29kZWxpc3RWYWx1ZShpdGVtcywgcm93W2NvZGVsaXN0Lm5hbWVdLCBjb2RlbGlzdCk7CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiBqc29uRGF0YS5tYXAoKHY6YW55KSA9PiBmaWx0ZXJWYWwubWFwKChqOmFueSkgPT4gdltqXSkpCiAgICB9ICAgCgoKICAgIC8qKgogICAgICog6Kej5p6Q5Luj56CB6KGo5ZKMdmxhdWXvvIzorr7nva5pdGVtcwogICAgICoKICAgICAqIEBwdWJsaWMKICAgICAqIEBwYXJhbSB7YW55W119IGl0ZW1zIOS7o+eggeihqOaVsOaNrgogICAgICogQHBhcmFtIHsqfSB2YWx1ZQogICAgICogQHJldHVybnMgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldENvZGVsaXN0VmFsdWUoaXRlbXM6IGFueVtdLCB2YWx1ZTogYW55LCBjb2RlbGlzdDogYW55LCl7CiAgICAgICAgaWYoIXZhbHVlKXsKICAgICAgICAgICAgcmV0dXJuIHRoaXMuJHQoJ2NvZGVsaXN0LicrY29kZWxpc3Quc3Jma2V5KycuZW1wdHknKTsKICAgICAgICB9CiAgICAgICAgaWYgKGl0ZW1zKSB7CiAgICAgICAgICAgIGxldCByZXN1bHQ6YW55ID0gW107CiAgICAgICAgICAgIGlmKE9iamVjdC5pcyhjb2RlbGlzdC5yZW5kZXJNb2RlLCJudW1iZXIiKSl7CiAgICAgICAgICAgICAgICBpdGVtcy5tYXAoKF9pdGVtOiBhbnksIGluZGV4OiBudW1iZXIpPT57CiAgICAgICAgICAgICAgICAgICAgY29uc3QgblZhbHVlID0gcGFyc2VJbnQoKHZhbHVlIGFzIGFueSksIDEwKTsKICAgICAgICAgICAgICAgICAgICBjb25zdCBjb2RldmFsdWUgPSBfaXRlbS52YWx1ZTsKICAgICAgICAgICAgICAgICAgICBpZigocGFyc2VJbnQoY29kZXZhbHVlLCAxMCkgJiBuVmFsdWUpID4gMCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKF9pdGVtKTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZihPYmplY3QuaXMoY29kZWxpc3QucmVuZGVyTW9kZSwic3RyaW5nIikpewogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlWYWx1ZTogQXJyYXk8YW55PiA9ICh2YWx1ZSBhcyBhbnkpLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKTsKICAgICAgICAgICAgICAgIGFycmF5VmFsdWUubWFwKCh2YWx1ZTogYW55LCBpbmRleDogbnVtYmVyKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goW10pOwogICAgICAgICAgICAgICAgICAgIGxldCB2YWx1ZXM6IGFueVtdID0gT2JqZWN0LmlzKHRoaXMuJHV0aWwudHlwZU9mKHZhbHVlKSwgJ251bWJlcicpID8gW3ZhbHVlXSA6IFsuLi4odmFsdWUgYXMgYW55KS5zcGxpdChjb2RlbGlzdC52YWx1ZVNlcGFyYXRvcildOwogICAgICAgICAgICAgICAgICAgIHZhbHVlcy5tYXAoKHZhbDphbnkgLG51bTogbnVtYmVyKT0+ewogICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5nZXRJdGVtKGl0ZW1zLCB2YWwsIGNvZGVsaXN0KTsgCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0pewogICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdFtpbmRleF0ucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgICAgICAgICAgfSAKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgbGV0IHZhbHVlczogYW55W10gPSBPYmplY3QuaXModGhpcy4kdXRpbC50eXBlT2YodmFsdWUpLCAnbnVtYmVyJykgPyBbdmFsdWVdIDogWy4uLih2YWx1ZSBhcyBhbnkpLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKV07CiAgICAgICAgICAgICAgICB2YWx1ZXMubWFwKCh2YWx1ZTphbnkgLGluZGV4OiBudW1iZXIpPT57CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuZ2V0SXRlbShpdGVtcywgdmFsdWUsIGNvZGVsaXN0KTsgCiAgICAgICAgICAgICAgICAgICAgaWYoaXRlbSl7CiAgICAgICAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpdGVtKTsKICAgICAgICAgICAgICAgICAgICB9IAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy8g6K6+572uaXRlbXMKICAgICAgICAgICAgaWYocmVzdWx0Lmxlbmd0aCAhPSAwKXsKICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LmpvaW4oY29kZWxpc3QudmFsdWVTZXBhcmF0b3IpOwogICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5bku6PnoIHpobkKICAgICAqCiAgICAgKiBAcHVibGljCiAgICAgKiBAcGFyYW0ge2FueVtdfSBpdGVtcwogICAgICogQHBhcmFtIHsqfSB2YWx1ZQogICAgICogQHJldHVybnMgeyp9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldEl0ZW0oaXRlbXM6IGFueVtdLCB2YWx1ZTogYW55LCBjb2RlbGlzdDogYW55KTogYW55IHsKICAgICAgICBjb25zdCBhcnI6IEFycmF5PGFueT4gPSBpdGVtcy5maWx0ZXIoaXRlbSA9PiB7cmV0dXJuIGl0ZW0udmFsdWUgPT0gdmFsdWV9KTsKICAgICAgICBpZiAoYXJyLmxlbmd0aCAhPT0gMSkgewogICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgICBpZihPYmplY3QuaXMoY29kZWxpc3QuY29kZWxpc3RUeXBlLCdTVEFUSUMnKSl7CiAgICAgICAgICAgIHJldHVybiB0aGlzLiR0KCdjb2RlbGlzdC4nK2NvZGVsaXN0LnNyZmtleSsnLicrYXJyWzBdLnZhbHVlKTsKICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgcmV0dXJuIGFyclswXS50ZXh0OwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIOeUn+WRveWRqOacnwogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgY3JlYXRlZCgpOiB2b2lkIHsKICAgICAgICB0aGlzLmFmdGVyQ3JlYXRlZCgpOwogICAgfQoKICAgIC8qKgogICAgICog5omn6KGMY3JlYXRlZOWQjueahOmAu+i+kQogICAgICoKICAgICAqICBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLyAgICAKICAgIHB1YmxpYyBhZnRlckNyZWF0ZWQoKXsKICAgICAgICB0aGlzLnNldENvbFN0YXRlKCk7CiAgICAgICAgaWYgKHRoaXMudmlld1N0YXRlKSB7CiAgICAgICAgICAgIHRoaXMudmlld1N0YXRlRXZlbnQgPSB0aGlzLnZpZXdTdGF0ZS5zdWJzY3JpYmUoKHsgdGFnLCBhY3Rpb24sIGRhdGEgfSkgPT4gewogICAgICAgICAgICAgICAgaWYgKCFPYmplY3QuaXModGFnLCB0aGlzLm5hbWUpKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKE9iamVjdC5pcygnbG9hZCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdyZW1vdmUnLCBhY3Rpb24pKSB7CiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoZGF0YSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdzYXZlJywgYWN0aW9uKSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuc2F2ZShkYXRhKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogdnVlIOeUn+WRveWRqOacnwogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgZGVzdHJveWVkKCkgewogICAgICAgIHRoaXMuYWZ0ZXJEZXN0cm95KCk7CiAgICB9CgogICAgLyoqCiAgICAgKiDmiafooYxkZXN0cm95ZWTlkI7nmoTpgLvovpEKICAgICAqCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGFmdGVyRGVzdHJveSgpIHsKICAgICAgICBpZiAodGhpcy52aWV3U3RhdGVFdmVudCkgewogICAgICAgICAgICB0aGlzLnZpZXdTdGF0ZUV2ZW50LnVuc3Vic2NyaWJlKCk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICog6I635Y+W6YCJ5Lit6KGM6IOh5pWw5o2uCiAgICAgKgogICAgICogQHJldHVybnMge2FueVtdfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBnZXRTZWxlY3Rpb24oKTogYW55W10gewogICAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbnM7CiAgICB9CgogICAgLyoqCiAgICAgKiDooYzlj4zlh7vkuovku7YKICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHJvd0RCTENsaWNrKCRldmVudDogYW55KTogdm9pZCB7CiAgICAgICAgaWYgKCEkZXZlbnQgfHwgdGhpcy5hY3R1YWxJc09wZW5FZGl0IHx8IE9iamVjdC5pcyh0aGlzLmdyaWRSb3dBY3RpdmVNb2RlLDApKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSgkZXZlbnQpKSk7CgogICAgICAgIGNvbnN0IHJlZnM6IGFueSA9IHRoaXMuJHJlZnM7CiAgICAgICAgaWYgKHJlZnMubXVsdGlwbGVUYWJsZSkgewogICAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUuY2xlYXJTZWxlY3Rpb24oKTsKICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbigkZXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy4kZW1pdCgncm93ZGJsY2xpY2snLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiDlpI3pgInmoYbmlbDmja7pgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHNlbGVjdCgkZXZlbnQ6IGFueSk6IHZvaWQgewogICAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gWy4uLkpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoJGV2ZW50KSldOwogICAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CgogICAgLyoqCiAgICAgKiDlpI3pgInmoYbmlbDmja7lhajpg6jpgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBzZWxlY3RBbGwoJGV2ZW50OiBhbnkpOiB2b2lkIHsKICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFsuLi5KU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KCRldmVudCkpXTsKICAgICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgfQoKICAgIAogICAgLyoqCiAgICAgKiDooYzljZXlh7vpgInkuK0KICAgICAqCiAgICAgKiBAcGFyYW0geyp9ICRldmVudAogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIHJvd0NsaWNrKCRldmVudDogYW55LCBpZkFsd2F5czogYm9vbGVhbiA9IGZhbHNlKTogdm9pZCB7CiAgICAgICAgaWYgKCFpZkFsd2F5cyAmJiAoISRldmVudCB8fCB0aGlzLmFjdHVhbElzT3BlbkVkaXQpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYodGhpcy5zdG9wUm93Q2xpY2spIHsKICAgICAgICAgICAgdGhpcy5zdG9wUm93Q2xpY2sgPSBmYWxzZTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZih0aGlzLmlzU2luZ2xlU2VsZWN0KXsKICAgICAgICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgICAgfQogICAgICAgIC8vIOW3sumAieS4reWImeWIoOmZpO+8jOayoemAieS4reWImea3u+WKoAogICAgICAgIGxldCBzZWxlY3RJbmRleCA9IHRoaXMuc2VsZWN0aW9ucy5maW5kSW5kZXgoKGl0ZW06YW55KT0+ewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0ucGltd29ya2hpc3RvcnksJGV2ZW50LnBpbXdvcmtoaXN0b3J5KTsKICAgICAgICB9KTsKICAgICAgICBpZiAoT2JqZWN0LmlzKHNlbGVjdEluZGV4LC0xKSl7CiAgICAgICAgICB0aGlzLnNlbGVjdGlvbnMucHVzaChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KCRldmVudCkpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnNwbGljZShzZWxlY3RJbmRleCwxKTsKICAgICAgICB9CgogICAgICAgIGNvbnN0IHJlZnM6IGFueSA9IHRoaXMuJHJlZnM7CiAgICAgICAgaWYgKHJlZnMubXVsdGlwbGVUYWJsZSkgewogICAgICAgICAgICBpZih0aGlzLmlzU2luZ2xlU2VsZWN0KXsKICAgICAgICAgICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS5jbGVhclNlbGVjdGlvbigpOwogICAgICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLnNldEN1cnJlbnRSb3coJGV2ZW50KTsKICAgICAgICAgICAgfWVsc2V7CiAgICAgICAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKCRldmVudCk7IAogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgfQoKCiAgICAvKioKICAgICAqIOmhtemdouWPmOWMlgogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50CiAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgcGFnZU9uQ2hhbmdlKCRldmVudDogYW55KTogdm9pZCB7CiAgICAgICAgaWYgKCEkZXZlbnQpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBpZiAoJGV2ZW50ID09PSB0aGlzLmN1clBhZ2UpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLmN1clBhZ2UgPSAkZXZlbnQ7CiAgICAgICAgdGhpcy5sb2FkKHt9KTsKICAgIH0KCiAgICAvKioKICAgICAqIOWIhumhteadoeaVsOWPmOWMlgogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50CiAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgb25QYWdlU2l6ZUNoYW5nZSgkZXZlbnQ6IGFueSk6IHZvaWQgewogICAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKCRldmVudCA9PT0gdGhpcy5saW1pdCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIHRoaXMubGltaXQgPSAkZXZlbnQ7CiAgICAgICAgaWYgKHRoaXMuY3VyUGFnZSA9PT0gMSkgewogICAgICAgICAgICB0aGlzLmxvYWQoe30pOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIOWIhumhteWIt+aWsAogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgcGFnZVJlZnJlc2goKTogdm9pZCB7CiAgICAgICAgdGhpcy5sb2FkKHt9KTsKICAgIH0KCiAgICAvKioKICAgICAqIOaOkuW6j+WPmOWMlgogICAgICoKICAgICAqIEBwYXJhbSB7eyBjb2x1bW46IGFueSwgcHJvcDogYW55LCBvcmRlcjogYW55IH19IHsgY29sdW1uLCBwcm9wLCBvcmRlciB9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIG9uU29ydENoYW5nZSh7IGNvbHVtbiwgcHJvcCwgb3JkZXIgfTogeyBjb2x1bW46IGFueSwgcHJvcDogYW55LCBvcmRlcjogYW55IH0pOiB2b2lkIHsKICAgICAgICBjb25zdCBkaXIgPSBPYmplY3QuaXMob3JkZXIsICdhc2NlbmRpbmcnKSA/ICdhc2MnIDogT2JqZWN0LmlzKG9yZGVyLCAnZGVzY2VuZGluZycpID8gJ2Rlc2MnIDogJyc7CiAgICAgICAgaWYgKE9iamVjdC5pcyhkaXIsIHRoaXMubWlub3JTb3J0RGlyKSAmJiBPYmplY3QuaXModGhpcy5taW5vclNvcnRQU0RFRiwgcHJvcCkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICB0aGlzLm1pbm9yU29ydERpciA9IGRpcjsKICAgICAgICB0aGlzLm1pbm9yU29ydFBTREVGID0gcHJvcCA/IHByb3AgOiAnJzsKICAgICAgICB0aGlzLmxvYWQoe30pOwogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC86KGM6YCJ5Lit5qC35byPCiAgICAgKgogICAgICogQHBhcmFtIHt7IHJvdzogYW55LCByb3dJbmRleDogYW55IH19IHsgcm93LCByb3dJbmRleCB9CiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBvblJvd0NsYXNzTmFtZSh7IHJvdywgcm93SW5kZXggfTogeyByb3c6IGFueSwgcm93SW5kZXg6IGFueSB9KTogc3RyaW5nIHsKICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuc2VsZWN0aW9ucy5maW5kSW5kZXgoKHNlbGVjdDogYW55KSA9PiBPYmplY3QuaXMoc2VsZWN0LnNyZmtleSwgcm93LnNyZmtleSkpOwogICAgICAgIHJldHVybiBpbmRleCAhPT0gLTEgPyAnZ3JpZC1yb3ctc2VsZWN0JyA6ICcnOwogICAgfQoKCgogICAgLyoqCiAgICAgKiDnlYzpnaLooYzkuLoKICAgICAqCiAgICAgKiBAcGFyYW0geyp9IHJvdwogICAgICogQHBhcmFtIHsqfSB0YWcKICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwoJcHVibGljIHVpQWN0aW9uKHJvdzogYW55LCB0YWc6IGFueSwgJGV2ZW50OiBhbnkpIHsKICAgICAgICAvLyB0aGlzLnJvd0NsaWNrKHJvdywgdHJ1ZSk7CiAgICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgfQoKICAgIC8qKgogICAgICog6K6+572u5YiX54q25oCBCiAgICAgKgogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBzZXRDb2xTdGF0ZSgpIHsKCQljb25zdCBfZGF0YTogYW55ID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3BpbXdvcmtoaXN0b3J5X21haW5fZ3JpZCcpOwoJCWlmIChfZGF0YSkgewoJCQlsZXQgY29sdW1ucyA9IEpTT04ucGFyc2UoX2RhdGEpOwoJCQljb2x1bW5zLmZvckVhY2goKGNvbDogYW55KSA9PiB7CgkJCQlsZXQgY29sdW1uID0gdGhpcy5hbGxDb2x1bW5zLmZpbmQoKGl0ZW0pID0+IE9iamVjdC5pcyhjb2wubmFtZSwgaXRlbS5uYW1lKSk7CgkJCQlpZiAoY29sdW1uKSB7CgkJCQkJT2JqZWN0LmFzc2lnbihjb2x1bW4sIGNvbCk7CgkJCQl9CgkJCX0pOwoJCX0KICAgIH0KCiAgICAvKioKICAgICAqIOWIl+WPmOWMlgogICAgICoKICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgb25Db2xDaGFuZ2UoKSB7CiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BpbXdvcmtoaXN0b3J5X21haW5fZ3JpZCcsIEpTT04uc3RyaW5naWZ5KHRoaXMuYWxsQ29sdW1ucykpOwogICAgfQoKICAgIC8qKgogICAgICog6I635Y+W5YiX54q25oCBCiAgICAgKgogICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUKICAgICAqIEByZXR1cm5zIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBnZXRDb2x1bW5TdGF0ZShuYW1lOiBzdHJpbmcpOiBib29sZWFuIHsKICAgICAgICBsZXQgY29sdW1uID0gdGhpcy5hbGxDb2x1bW5zLmZpbmQoKGNvbDogYW55KSA9PgogICAgICAgICAgICBPYmplY3QuaXMobmFtZSwgY29sLm5hbWUpCiAgICAgICAgKTsKICAgICAgICByZXR1cm4gY29sdW1uLnNob3cgPyB0cnVlIDogZmFsc2U7CiAgICB9CgogICAgLyoqCiAgICAgKiDooajmoLzliJfmmK/lkKboh6rpgILlupTluIPlsYAKICAgICAqCiAgICAgKiBAcmVhZG9ubHkKICAgICAqIEB0eXBlIHtib29sZWFufQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIGdldCBhZGFwdGl2ZVN0YXRlKCk6IGJvb2xlYW4gewogICAgICAgIHJldHVybiAhdGhpcy5hbGxDb2x1bW5zLmZpbmQoKGNvbHVtbjogYW55KSA9PiBjb2x1bW4uc2hvdyAmJiBPYmplY3QuaXMoY29sdW1uLnV0aWwsICdTVEFSJykpOwogICAgfQoKICAgIC8qKgogICAgICog5L+d5a2YCiAgICAgKgogICAgICogQHBhcmFtIHsqfSAkZXZlbnQKICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGFzeW5jIHNhdmUoYXJnczogYW55W10sIHBhcmFtcz86IGFueSwgJGV2ZW50PzogYW55LCB4RGF0YT86IGFueSl7CiAgICAgICAgbGV0IF90aGlzID0gdGhpczsKICAgICAgICBpZighYXdhaXQgdGhpcy52YWxpZGF0ZUFsbCgpKXsKICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn5YC86KeE5YiZ5qCh6aqM5byC5bi4JyB9KTsKICAgICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgIH0KICAgICAgICBsZXQgc3VjY2Vzc0l0ZW1zOmFueSA9IFtdOwogICAgICAgIGxldCBlcnJvckl0ZW1zOmFueSA9IFtdOwogICAgICAgIGxldCBlcnJvck1lc3NhZ2U6YW55ID0gW107CiAgICAgICAgZm9yIChjb25zdCBpdGVtIG9mIF90aGlzLml0ZW1zKSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgICBpZihPYmplY3QuaXMoaXRlbS5yb3dEYXRhU3RhdGUsICdjcmVhdGUnKSl7CiAgICAgICAgICAgICAgICAgICAgaWYoIXRoaXMuY3JlYXRlQWN0aW9uKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAnUElNV09SS0hJU1RPUllQaW1Xb3JrR3JpZFZpZXfop4blm77ooajmoLxjcmVhdGVBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihpdGVtLHt2aWV3cGFyYW1zOnRoaXMudmlld3BhcmFtc30pOwogICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3BvbnNlID0gYXdhaXQgdGhpcy5zZXJ2aWNlLmFkZCh0aGlzLmNyZWF0ZUFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSxpdGVtLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NJdGVtcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9ZWxzZSBpZihPYmplY3QuaXMoaXRlbS5yb3dEYXRhU3RhdGUsICd1cGRhdGUnKSl7CiAgICAgICAgICAgICAgICAgICAgaWYoIXRoaXMudXBkYXRlQWN0aW9uKXsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAnUElNV09SS0hJU1RPUllQaW1Xb3JrR3JpZFZpZXfop4blm77ooajmoLx1cGRhdGVBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOwogICAgICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGl0ZW0se3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0ucGltd29ya2hpc3RvcnkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmNvbnRleHQse3BpbXdvcmtoaXN0b3J5Oml0ZW0ucGltd29ya2hpc3Rvcnl9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBsZXQgcmVzcG9uc2UgPSBhd2FpdCB0aGlzLnNlcnZpY2UuYWRkKHRoaXMudXBkYXRlQWN0aW9uLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksaXRlbSwgdGhpcy5zaG93QnVzeUluZGljYXRvcik7CiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NJdGVtcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgICBlcnJvckl0ZW1zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShpdGVtKSkpOwogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlLnB1c2goZXJyb3IpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRoaXMuJGVtaXQoJ3NhdmUnLCBzdWNjZXNzSXRlbXMpOwogICAgICAgIHRoaXMucmVmcmVzaChbXSk7CiAgICAgICAgaWYoZXJyb3JJdGVtcy5sZW5ndGggPT09IDApewogICAgICAgICAgICB0aGlzLiROb3RpY2Uuc3VjY2Vzcyh7IHRpdGxlOiAnJywgZGVzYzogJ+S/neWtmOaIkOWKnyEnIH0pOwogICAgICAgIH1lbHNlewogICAgICAgICAgZXJyb3JJdGVtcy5mb3JFYWNoKChpdGVtOmFueSxpbmRleDpudW1iZXIpPT57CiAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn5L+d5a2Y5aSx6LSlJywgZGVzYzogaXRlbS5tYWpvcmVudGl0eW5hbWUrJ+S/neWtmOWksei0pe+8gScgfSk7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JNZXNzYWdlW2luZGV4XSk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHN1Y2Nlc3NJdGVtczsKICAgIH0KCiAgICAvKioKICAgICAqIOaWsOW7uuihjAogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50CiAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgbmV3Um93KGFyZ3M6IGFueVtdLCBwYXJhbXM/OiBhbnksICRldmVudD86IGFueSwgeERhdGE/OiBhbnkpOiB2b2lkIHsKICAgICAgICBpZighdGhpcy5sb2FkZHJhZnRBY3Rpb24pewogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICdQSU1XT1JLSElTVE9SWVBpbVdvcmtHcmlkVmlld+inhuWbvuihqOagvGxvYWRkcmFmdEFjdGlvbuWPguaVsOacqumFjee9ricgfSk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgbGV0IF90aGlzID0gdGhpczsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZ3NbMF0se3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSk7CiAgICAgICAgbGV0IHBvc3Q6IFByb21pc2U8YW55PiA9IHRoaXMuc2VydmljZS5sb2FkRHJhZnQodGhpcy5sb2FkZHJhZnRBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGFyZ3NbMF0sIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gewogICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN0YXR1cyB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmVycm9yTWVzc2FnZSkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogcmVzcG9uc2UuZXJyb3JNZXNzYWdlIH0pOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgICAgICB0aGlzLmNyZWF0ZURlZmF1bHQoZGF0YSk7CiAgICAgICAgICAgIGRhdGEucm93RGF0YVN0YXRlID0gImNyZWF0ZSI7CiAgICAgICAgICAgIF90aGlzLml0ZW1zLnB1c2goZGF0YSk7CiAgICAgICAgICAgIF90aGlzLmdyaWRJdGVtc01vZGVsLnB1c2goX3RoaXMuZ2V0R3JpZFJvd01vZGVsKCkpOwogICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7CiAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn57O757uf5byC5bi4JyB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgIH0pOwogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC857yW6L6R6aG55YC85Y+Y5pu0CiAgICAgKiAgCiAgICAgKiBAcGFyYW0gcm93IOihjOaVsOaNrgogICAgICogQHBhcmFtIHt7IG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSB9fSAkZXZlbnQKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBvbkdyaWRJdGVtVmFsdWVDaGFuZ2Uocm93OiBhbnksJGV2ZW50OiB7IG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSB9LHJvd0luZGV4OiBudW1iZXIpOiB2b2lkIHsKICAgICAgICBpZiAoISRldmVudCkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICghJGV2ZW50Lm5hbWUgfHwgT2JqZWN0LmlzKCRldmVudC5uYW1lLCAnJykgfHwgIXJvdy5oYXNPd25Qcm9wZXJ0eSgkZXZlbnQubmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICByb3dbJGV2ZW50Lm5hbWVdID0gJGV2ZW50LnZhbHVlOwogICAgICAgIHRoaXMuZ3JpZEVkaXRJdGVtQ2hhbmdlKHJvdywgJGV2ZW50Lm5hbWUsICRldmVudC52YWx1ZSwgcm93SW5kZXgpOwogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC857yW6L6R6aG55YC85Y+Y5YyWCiAgICAgKgogICAgICogQHB1YmxpYwogICAgICogQHBhcmFtIHJvdyDooYzmlbDmja4KICAgICAqIEBwYXJhbSBwcm9wZXJ0eSDliJfnvJbovpHpobnlkI0KICAgICAqIEBwYXJhbSByb3cg5YiX57yW6L6R6aG55YC8CiAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgZ3JpZEVkaXRJdGVtQ2hhbmdlKHJvdzogYW55LCBwcm9wZXJ0eTogc3RyaW5nLCB2YWx1ZTogYW55LCByb3dJbmRleDogbnVtYmVyKXsKICAgICAgICByb3cucm93RGF0YVN0YXRlID0gcm93LnJvd0RhdGFTdGF0ZSA/IHJvdy5yb3dEYXRhU3RhdGUgOiAidXBkYXRlIiA7CiAgICAgICAgdGhpcy52YWxpZGF0ZShwcm9wZXJ0eSxyb3cscm93SW5kZXgpOwogICAgfQoKICAgIC8qKgogICAgICog6KGo5qC857yW6L6R6aG55pu05pawCiAgICAgKgogICAgICogQHBhcmFtIHtzdHJpbmd9IG1vZGUg55WM6Z2i6KGM5Li65ZCN56ewCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XSDor7fmsYLmlbDmja4KICAgICAqIEBwYXJhbSB7c3RyaW5nW119IHVwZGF0ZURldGFpbHMg5pu05paw6aG5CiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtzaG93bG9hZGluZ10g5piv5ZCm5pi+56S65Yqg6L2954q25oCBCiAgICAgKiBAcmV0dXJucyB7dm9pZH0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQogICAgICovCiAgICBwdWJsaWMgdXBkYXRlR3JpZEVkaXRJdGVtKG1vZGU6IHN0cmluZywgZGF0YTogYW55ID0ge30sIHVwZGF0ZURldGFpbHM6IHN0cmluZ1tdLCBzaG93bG9hZGluZz86IGJvb2xlYW4pOiB2b2lkIHsKICAgICAgICBpZiAoIW1vZGUgfHwgKG1vZGUgJiYgT2JqZWN0LmlzKG1vZGUsICcnKSkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBjb25zdCBhcmc6IGFueSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLHt2aWV3cGFyYW1zOnRoaXMudmlld3BhcmFtc30pOwogICAgICAgIGNvbnN0IHBvc3Q6IFByb21pc2U8YW55PiA9IHRoaXMuc2VydmljZS5mcm9udExvZ2ljKG1vZGUsSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSxhcmcsIHNob3dsb2FkaW5nKTsKICAgICAgICBwb3N0LnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn6KGo5Y2V6aG55pu05paw5aSx6LSlJyB9KTsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICBjb25zdCBfZGF0YTogYW55ID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICAgICAgaWYoIV9kYXRhKXsKICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgICB1cGRhdGVEZXRhaWxzLmZvckVhY2goKG5hbWU6IHN0cmluZykgPT4gewogICAgICAgICAgICAgICAgaWYgKCFfZGF0YS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGRhdGFbbmFtZV0gPSBfZGF0YVtuYW1lXTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsKICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICfns7vnu5/lvILluLgnIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5blr7nlupTooYxjbGFzcwogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGFyZ3Mgcm93IOihjOaVsOaNru+8jHJvd0luZGV4IOihjOe0ouW8lQogICAgICogQHJldHVybnMge3ZvaWR9CiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UKICAgICAqLwogICAgcHVibGljIGdldFJvd0NsYXNzTmFtZShhcmdzOntyb3c6IGFueSxyb3dJbmRleDogbnVtYmVyfSl7CiAgICAgICAgbGV0IGlzU2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGlvbnMuc29tZSgoaXRlbTphbnkpPT57CiAgICAgICAgICAgIHJldHVybiBPYmplY3QuaXMoaXRlbS5waW13b3JraGlzdG9yeSxhcmdzLnJvdy5waW13b3JraGlzdG9yeSk7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGlzU2VsZWN0ZWQgPyAiZ3JpZC1zZWxlY3RlZC1yb3ciIDogIiI7CiAgICB9CgogICAgLyoqCiAgICAgKiDojrflj5blr7nlupTliJdjbGFzcwogICAgICoKICAgICAqIEBwYXJhbSB7Kn0gJGFyZ3Mgcm93IOihjOaVsOaNru+8jGNvbHVtbiDliJfmlbDmja7vvIxyb3dJbmRleCDooYzntKLlvJXvvIzliJfntKLlvJUKICAgICAqIEByZXR1cm5zIHt2b2lkfQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBnZXRDZWxsQ2xhc3NOYW1lKGFyZ3M6e3JvdzogYW55LCBjb2x1bW46IGFueSwgcm93SW5kZXg6IG51bWJlciwgY29sdW1uSW5kZXg6bnVtYmVyfSl7CiAgICAgICAgbGV0IGhhc1Jvd0VkaXQ6YW55ID0gewogICAgICAgICAgJ3J6a3Nzaic6dHJ1ZSwKICAgICAgICAgICdyempzc2onOnRydWUsCiAgICAgICAgICAnb3Jtb3JnbmFtZSc6dHJ1ZSwKICAgICAgICAgICdvcm1vcmdzZWN0b3JuYW1lJzp0cnVlLAogICAgICAgICAgJ29ybWR1dHluYW1lJzp0cnVlLAogICAgICAgICAgJ29ybXBvc3RuYW1lJzp0cnVlLAogICAgICAgICAgJ2NmcGx4Jzp0cnVlLAogICAgICAgICAgJ2V4cGVyaWVuY2UnOnRydWUsCiAgICAgICAgfQogICAgICAgIHJldHVybiAoIGhhc1Jvd0VkaXRbYXJncy5jb2x1bW4ucHJvcGVydHldICYmIHRoaXMuYWN0dWFsSXNPcGVuRWRpdCApID8gImVkaXQtY2VsbCIgOiAiaW5mby1jZWxsIjsKICAgIH0KCiAgICAvKioKICAgICAqIOaWsOW7uum7mOiupOWAvAogICAgICogQHBhcmFtIHsqfSAgcm93IOihjOaVsOaNrgogICAgICogQG1lbWJlcm9mIE1haW5CYXNlCiAgICAgKi8KICAgIHB1YmxpYyBjcmVhdGVEZWZhdWx0KHJvdzogYW55KXsgICAgICAgICAgICAgICAgICAgIAogICAgICAgIGlmIChyb3cuaGFzT3duUHJvcGVydHkoJ3BpbXBlcnNvbmlkJykpIHsKICAgICAgICAgICAgcm93WydwaW1wZXJzb25pZCddID0gdGhpcy52aWV3cGFyYW1zWydzcmZwYXJlbnRrZXknXTsKICAgICAgICB9CiAgICAgICAgaWYgKHJvdy5oYXNPd25Qcm9wZXJ0eSgnZXhwZXJpZW5jZScpKSB7CiAgICAgICAgICAgIHJvd1snZXhwZXJpZW5jZSddID0gMDsKICAgICAgICB9CiAgICB9Cn0K"},null]}