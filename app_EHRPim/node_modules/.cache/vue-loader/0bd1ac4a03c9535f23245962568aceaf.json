{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-archival-catalogue\\main-form\\main-form-base.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-archival-catalogue\\main-form\\main-form-base.vue","mtime":1630509411193},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KaW1wb3J0IHsgVnVlLCBDb21wb25lbnQsIFByb3AsIFByb3ZpZGUsIEVtaXQsIFdhdGNoLCBNb2RlbCxJbmplY3QgfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJzsNCmltcG9ydCB7IENyZWF0ZUVsZW1lbnQgfSBmcm9tICd2dWUnOw0KaW1wb3J0IHsgU3ViamVjdCwgU3Vic2NyaXB0aW9uIH0gZnJvbSAncnhqcyc7DQppbXBvcnQgeyBDb250cm9sSW50ZXJmYWNlIH0gZnJvbSAnQC9pbnRlcmZhY2UvY29udHJvbCc7DQppbXBvcnQgeyBVSUFjdGlvblRvb2wsVXRpbCB9IGZyb20gJ0AvdXRpbHMnOw0KaW1wb3J0IE5hdkRhdGFTZXJ2aWNlIGZyb20gJ0Avc2VydmljZS9hcHAvbmF2ZGF0YS1zZXJ2aWNlJzsNCmltcG9ydCBQaW1BcmNoaXZhbENhdGFsb2d1ZVNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL3BpbS1hcmNoaXZhbC1jYXRhbG9ndWUvcGltLWFyY2hpdmFsLWNhdGFsb2d1ZS1zZXJ2aWNlJzsNCmltcG9ydCBNYWluU2VydmljZSBmcm9tICcuL21haW4tZm9ybS1zZXJ2aWNlJzsNCg0KaW1wb3J0IHsgRm9ybUJ1dHRvbk1vZGVsLCBGb3JtUGFnZU1vZGVsLCBGb3JtSXRlbU1vZGVsLCBGb3JtRFJVSVBhcnRNb2RlbCwgRm9ybVBhcnRNb2RlbCwgRm9ybUdyb3VwUGFuZWxNb2RlbCwgRm9ybUlGcmFtZU1vZGVsLCBGb3JtUm93SXRlbU1vZGVsLCBGb3JtVGFiUGFnZU1vZGVsLCBGb3JtVGFiUGFuZWxNb2RlbCwgRm9ybVVzZXJDb250cm9sTW9kZWwgfSBmcm9tICdAL21vZGVsL2Zvcm0tZGV0YWlsJzsNCmltcG9ydCB7IGRlYm91bmNlVGltZSwgZGlzdGluY3RVbnRpbENoYW5nZWQgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7DQoNCg0KQENvbXBvbmVudCh7DQogICAgY29tcG9uZW50czogew0KICAgICAgDQogICAgfQ0KfSkNCmV4cG9ydCBkZWZhdWx0IGNsYXNzIE1haW5CYXNlIGV4dGVuZHMgVnVlIGltcGxlbWVudHMgQ29udHJvbEludGVyZmFjZSB7DQoNCiAgICAvKioNCiAgICAgKiDlkI3np7ANCiAgICAgKg0KICAgICAqIEB0eXBlIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFByb3AoKSBwdWJsaWMgbmFtZT86IHN0cmluZzsNCg0KICAgIC8qKg0KICAgICAqIOinhuWbvumAmuiur+WvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge1N1YmplY3Q8Vmlld1N0YXRlPn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBAUHJvcCgpIHB1YmxpYyB2aWV3U3RhdGUhOiBTdWJqZWN0PFZpZXdTdGF0ZT47DQoNCiAgICAvKioNCiAgICAgKiDlupTnlKjkuIrkuIvmlocNCiAgICAgKg0KICAgICAqIEB0eXBlIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBQcm9wKCkgcHVibGljIGNvbnRleHQ6IGFueTsNCg0KICAgIC8qKg0KICAgICAqIOinhuWbvuWPguaVsA0KICAgICAqDQogICAgICogQHR5cGUgeyp9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFByb3AoKSBwdWJsaWMgdmlld3BhcmFtczogYW55Ow0KDQogICAgLyoqDQogICAgICog6KeG5Zu+54q25oCB5LqL5Lu2DQogICAgICoNCiAgICAgKiBAcHVibGljDQogICAgICogQHR5cGUgeyhTdWJzY3JpcHRpb24gfCB1bmRlZmluZWQpfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyB2aWV3U3RhdGVFdmVudDogU3Vic2NyaXB0aW9uIHwgdW5kZWZpbmVkOw0KDQogICAgLyoqDQogICAgICog6I635Y+W6YOo5Lu257G75Z6LDQogICAgICoNCiAgICAgKiBAcmV0dXJucyB7c3RyaW5nfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBnZXRDb250cm9sVHlwZSgpOiBzdHJpbmcgew0KICAgICAgICByZXR1cm4gJ0ZPUk0nDQogICAgfQ0KDQoNCg0KICAgIC8qKg0KICAgICAqIOiuoeaVsOWZqOacjeWKoeWvueixoembhuWQiA0KICAgICAqDQogICAgICogQHR5cGUge0FycmF5PCo+fQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLyAgICANCiAgICBwdWJsaWMgY291bnRlclNlcnZpY2VBcnJheTpBcnJheTxhbnk+ID0gW107DQoNCiAgICAvKioNCiAgICAgKiDlu7rmnoTpg6jku7bmnI3liqHlr7nosaENCiAgICAgKg0KICAgICAqIEB0eXBlIHtNYWluU2VydmljZX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgc2VydmljZTogTWFpblNlcnZpY2UgPSBuZXcgTWFpblNlcnZpY2UoeyAkc3RvcmU6IHRoaXMuJHN0b3JlIH0pOw0KDQogICAgLyoqDQogICAgICog5a6e5L2T5pyN5Yqh5a+56LGhDQogICAgICoNCiAgICAgKiBAdHlwZSB7UGltQXJjaGl2YWxDYXRhbG9ndWVTZXJ2aWNlfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBhcHBFbnRpdHlTZXJ2aWNlOiBQaW1BcmNoaXZhbENhdGFsb2d1ZVNlcnZpY2UgPSBuZXcgUGltQXJjaGl2YWxDYXRhbG9ndWVTZXJ2aWNlKHsgJHN0b3JlOiB0aGlzLiRzdG9yZSB9KTsNCiAgICANCg0KDQogICAgLyoqDQogICAgICog5YWz6Zet6KeG5Zu+DQogICAgICoNCiAgICAgKiBAcGFyYW0ge2FueX0gYXJncw0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBjbG9zZVZpZXcoYXJnczogYW55KTogdm9pZCB7DQogICAgICAgIGxldCBfdGhpczogYW55ID0gdGhpczsNCiAgICAgICAgX3RoaXMuJGVtaXQoJ2Nsb3NldmlldycsIFthcmdzXSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICogIOiuoeaVsOWZqOWIt+aWsA0KICAgICAqDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGNvdW50ZXJSZWZyZXNoKCl7DQogICAgICAgIGNvbnN0IF90aGlzOmFueSA9dGhpczsNCiAgICAgICAgaWYoX3RoaXMuY291bnRlclNlcnZpY2VBcnJheSAmJiBfdGhpcy5jb3VudGVyU2VydmljZUFycmF5Lmxlbmd0aCA+MCl7DQogICAgICAgICAgICBfdGhpcy5jb3VudGVyU2VydmljZUFycmF5LmZvckVhY2goKGl0ZW06YW55KSA9PnsNCiAgICAgICAgICAgICAgICBpZihpdGVtLnJlZnJlc2hEYXRhICYmIGl0ZW0ucmVmcmVzaERhdGEgaW5zdGFuY2VvZiBGdW5jdGlvbil7DQogICAgICAgICAgICAgICAgICAgIGl0ZW0ucmVmcmVzaERhdGEoKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KQ0KICAgICAgICB9DQogICAgfQ0KDQoNCiAgICAvKioNCiAgICAgKiDlt6XkvZzmtYHlrqHmibnmhI/op4Hmjqfku7bnu5HlrprlgLwNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBzcmZ3Zm1lbW86c3RyaW5nID0gIiI7DQogICAgDQogICAgLyoqDQogICAgICog6I635Y+W5aSa6aG55pWw5o2uDQogICAgICoNCiAgICAgKiBAcmV0dXJucyB7YW55W119DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGdldERhdGFzKCk6IGFueVtdIHsNCiAgICAgICAgcmV0dXJuIFt0aGlzLmRhdGFdOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOiOt+WPluWNlemhueagkQ0KICAgICAqDQogICAgICogQHJldHVybnMgeyp9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGdldERhdGEoKTogYW55IHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmmK/lkKbpu5jorqTkv53lrZgNCiAgICAgKg0KICAgICAqIEB0eXBlIHtib29sZWFufQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBQcm9wKHsgZGVmYXVsdDogZmFsc2UgfSkgcHVibGljIGF1dG9zYXZlPzogYm9vbGVhbjsNCg0KICAgIC8qKg0KICAgICAqIOaYvuekuuWkhOeQhuaPkOekug0KICAgICAqDQogICAgICogQHR5cGUge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFByb3AoeyBkZWZhdWx0OiB0cnVlIH0pIHB1YmxpYyBzaG93QnVzeUluZGljYXRvcj86IGJvb2xlYW47DQoNCiAgICAvKioNCiAgICAgKiDpg6jku7booYzkuLotLXN1Ym1pdA0KICAgICAqDQogICAgICogQHR5cGUge3N0cmluZ30NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBAUHJvcCgpIHB1YmxpYyBXRlN1Ym1pdEFjdGlvbiE6IHN0cmluZzsNCiAgICANCiAgICAvKioNCiAgICAgKiDpg6jku7booYzkuLotLXN0YXJ0DQogICAgICoNCiAgICAgKiBAdHlwZSB7c3RyaW5nfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBQcm9wKCkgcHVibGljIFdGU3RhcnRBY3Rpb24hOiBzdHJpbmc7DQogICAgDQogICAgLyoqDQogICAgICog6YOo5Lu26KGM5Li6LS11cGRhdGUNCiAgICAgKg0KICAgICAqIEB0eXBlIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFByb3AoKSBwdWJsaWMgdXBkYXRlQWN0aW9uITogc3RyaW5nOw0KICAgIA0KICAgIC8qKg0KICAgICAqIOmDqOS7tuihjOS4ui0tcmVtb3ZlDQogICAgICoNCiAgICAgKiBAdHlwZSB7c3RyaW5nfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBQcm9wKCkgcHVibGljIHJlbW92ZUFjdGlvbiE6IHN0cmluZzsNCiAgICANCiAgICAvKioNCiAgICAgKiDpg6jku7booYzkuLotLWxvYWRkcmFmdA0KICAgICAqDQogICAgICogQHR5cGUge3N0cmluZ30NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBAUHJvcCgpIHB1YmxpYyBsb2FkZHJhZnRBY3Rpb24hOiBzdHJpbmc7DQogICAgDQogICAgLyoqDQogICAgICog6YOo5Lu26KGM5Li6LS1sb2FkDQogICAgICoNCiAgICAgKiBAdHlwZSB7c3RyaW5nfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBQcm9wKCkgcHVibGljIGxvYWRBY3Rpb24hOiBzdHJpbmc7DQogICAgDQogICAgLyoqDQogICAgICog6YOo5Lu26KGM5Li6LS1jcmVhdGUNCiAgICAgKg0KICAgICAqIEB0eXBlIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFByb3AoKSBwdWJsaWMgY3JlYXRlQWN0aW9uITogc3RyaW5nOw0KDQogICAgLyoqDQogICAgICog6YOo5Lu26KGM5Li6LS1jcmVhdGUNCiAgICAgKg0KICAgICAqIEB0eXBlIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFByb3AoKSBwdWJsaWMgc2VhcmNoQWN0aW9uITogc3RyaW5nOw0KDQogICAgLyoqDQogICAgICog6KeG5Zu+5qCH6K+GDQogICAgICoNCiAgICAgKiBAdHlwZSB7c3RyaW5nfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBQcm9wKCkgcHVibGljIHZpZXd0YWchOiBzdHJpbmc7DQoNCiAgICAvKioNCiAgICAgKiDooajljZXnirbmgIENCiAgICAgKg0KICAgICAqIEB0eXBlIHtTdWJqZWN0PGFueT59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGZvcm1TdGF0ZTogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3QoKTsNCg0KICAgIC8qKg0KICAgICAqIOW/veeVpeihqOWNlemhueWAvOWPmOWMlg0KICAgICAqDQogICAgICogQHR5cGUge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGlnbm9yZWZpZWxkdmFsdWVjaGFuZ2U6IGJvb2xlYW4gPSBmYWxzZTsNCg0KICAgIC8qKg0KICAgICAqIOaVsOaNruWPmOWMlg0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEB0eXBlIHtTdWJqZWN0PGFueT59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGRhdGFDaGFuZzogU3ViamVjdDxhbnk+ID0gbmV3IFN1YmplY3QoKTsNCg0KICAgIC8qKg0KICAgICAqIOinhuWbvueKtuaAgeS6i+S7tg0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEB0eXBlIHsoU3Vic2NyaXB0aW9uIHwgdW5kZWZpbmVkKX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZGF0YUNoYW5nRXZlbnQ6IFN1YnNjcmlwdGlvbiB8IHVuZGVmaW5lZDsNCg0KICAgIC8qKg0KICAgICAqIOWOn+Wni+aVsOaNrg0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEB0eXBlIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBvbGREYXRhOiBhbnkgPSB7fTsNCg0KICAgIC8qKg0KICAgICAqIOihqOWNleaVsOaNruWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUgeyp9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGRhdGE6IGFueSA9IHsNCiAgICAgICAgc3JmdXBkYXRlZGF0ZTogbnVsbCwNCiAgICAgICAgc3Jmb3Jpa2V5OiBudWxsLA0KICAgICAgICBzcmZrZXk6IG51bGwsDQogICAgICAgIHNyZm1ham9ydGV4dDogbnVsbCwNCiAgICAgICAgc3JmdGVtcG1vZGU6IG51bGwsDQogICAgICAgIHNyZnVmOiBudWxsLA0KICAgICAgICBzcmZkZWlkOiBudWxsLA0KICAgICAgICBzcmZzb3VyY2VrZXk6IG51bGwsDQogICAgICAgIHNlcmlhbG51bWJlcjogbnVsbCwNCiAgICAgICAgYXJjaGl2YWxjYXRhbG9ndWVuYW1lOiBudWxsLA0KICAgICAgICBhcmNoaXZhbGNhdGFsb2d1ZWlkOiBudWxsLA0KICAgICAgICBwaW1hcmNoaXZhbGNhdGFsb2d1ZTpudWxsLA0KICAgIH07DQoNCiAgICAvKioNCiAgICAgICog5b2T5YmN5omn6KGM55qE6KGM5Li66YC76L6RDQogICAgICAqDQogICAgICAqIEB0eXBlIHtzdHJpbmd9DQogICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAgKi8NCiAgICBwdWJsaWMgY3VycmVudEFjdGlvbjogc3RyaW5nID0gIiI7DQoNCiAgICAvKioNCiAgICAgICog5YWz57O755WM6Z2i6K6h5pWw5ZmoDQogICAgICAqDQogICAgICAqIEB0eXBlIHtudW1iZXJ9DQogICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAgKi8NCiAgICBwdWJsaWMgZHJjb3VudGVyOiBudW1iZXIgPSAwOw0KDQogICAgLyoqDQogICAgICAqIOmcgOimgeetieW+heWFs+ezu+eVjOmdouS/neWtmOaXtu+8jOesrOS4gOasoeiwg+eUqHNhdmXlj4LmlbDnmoTlpIfku70NCiAgICAgICoNCiAgICAgICogQHR5cGUge251bWJlcn0NCiAgICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICAqLw0KICAgIHB1YmxpYyBkcnNhdmVvcHQ6IGFueSA9IHt9Ow0KDQogICAgLyoqDQogICAgICAqIOihqOWNleS/neWtmOWbnuiwg+WtmOWCqOWvueixoQ0KICAgICAgKg0KICAgICAgKiBAdHlwZSB7YW55fQ0KICAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgICovDQogICAgcHVibGljIHNhdmVTdGF0ZTphbnkgOw0KDQogICAgLyoqDQogICAgICog5bGe5oCn5YC86KeE5YiZDQogICAgICoNCiAgICAgKiBAdHlwZSB7Kn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgcnVsZXM6IGFueSA9IHsNCiAgICAgICAgc3JmdXBkYXRlZGF0ZTogWw0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJ+abtOaWsOaXtumXtCDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJ+abtOaWsOaXtumXtCDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJ+abtOaWsOaXtumXtCDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAn5pu05paw5pe26Ze0IOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICBdLA0KICAgICAgICBzcmZvcmlrZXk6IFsNCiAgICAgICAgICAgIHsgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICcg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywgdHJpZ2dlcjogJ2NoYW5nZScgfSwNCiAgICAgICAgICAgIHsgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICcg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICcg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2NoYW5nZScgfSwNCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgXSwNCiAgICAgICAgc3Jma2V5OiBbDQogICAgICAgICAgICB7IHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAn5qGj5qGI55uu5b2V5qCH6K+GIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sDQogICAgICAgICAgICB7IHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAn5qGj5qGI55uu5b2V5qCH6K+GIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAn5qGj5qGI55uu5b2V5qCH6K+GIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sDQogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICfmoaPmoYjnm67lvZXmoIfor4Yg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgIF0sDQogICAgICAgIHNyZm1ham9ydGV4dDogWw0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJ+aho+ahiOebruW9leWQjeensCDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJ+aho+ahiOebruW9leWQjeensCDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJ+aho+ahiOebruW9leWQjeensCDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAn5qGj5qGI55uu5b2V5ZCN56ewIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICBdLA0KICAgICAgICBzcmZ0ZW1wbW9kZTogWw0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAnIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICBdLA0KICAgICAgICBzcmZ1ZjogWw0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAnIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICBdLA0KICAgICAgICBzcmZkZWlkOiBbDQogICAgICAgICAgICB7IHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAnIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sDQogICAgICAgICAgICB7IHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAnIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAnIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sDQogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICcg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgIF0sDQogICAgICAgIHNyZnNvdXJjZWtleTogWw0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LA0KICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAnIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICBdLA0KICAgICAgICBzZXJpYWxudW1iZXI6IFsNCiAgICAgICAgICAgIHsgdHlwZTogJ251bWJlcicsIG1lc3NhZ2U6ICfmjpLluo/lj7cg5YC85b+F6aG75Li65pWw5YC857G75Z6LJywgdHJpZ2dlcjogJ2NoYW5nZScgfSwNCiAgICAgICAgICAgIHsgdHlwZTogJ251bWJlcicsIG1lc3NhZ2U6ICfmjpLluo/lj7cg5YC85b+F6aG75Li65pWw5YC857G75Z6LJywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdHlwZTogJ251bWJlcicsIG1lc3NhZ2U6ICfmjpLluo/lj7cg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2NoYW5nZScgfSwNCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB0eXBlOiAnbnVtYmVyJywgbWVzc2FnZTogJ+aOkuW6j+WPtyDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgXSwNCiAgICAgICAgYXJjaGl2YWxjYXRhbG9ndWVuYW1lOiBbDQogICAgICAgICAgICB7IHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAn5qGj5qGI55uu5b2V5ZCN56ewIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sDQogICAgICAgICAgICB7IHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAn5qGj5qGI55uu5b2V5ZCN56ewIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsIHRyaWdnZXI6ICdibHVyJyB9LA0KICAgICAgICAgICAgeyByZXF1aXJlZDogZmFsc2UsIHR5cGU6ICdzdHJpbmcnLCBtZXNzYWdlOiAn5qGj5qGI55uu5b2V5ZCN56ewIOWAvOS4jeiDveS4uuepuicsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sDQogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICfmoaPmoYjnm67lvZXlkI3np7Ag5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgIF0sDQogICAgICAgIGFyY2hpdmFsY2F0YWxvZ3VlaWQ6IFsNCiAgICAgICAgICAgIHsgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICfmoaPmoYjnm67lvZXmoIfor4Yg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywgdHJpZ2dlcjogJ2NoYW5nZScgfSwNCiAgICAgICAgICAgIHsgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICfmoaPmoYjnm67lvZXmoIfor4Yg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywgdHJpZ2dlcjogJ2JsdXInIH0sDQogICAgICAgICAgICB7IHJlcXVpcmVkOiBmYWxzZSwgdHlwZTogJ3N0cmluZycsIG1lc3NhZ2U6ICfmoaPmoYjnm67lvZXmoIfor4Yg5YC85LiN6IO95Li656m6JywgdHJpZ2dlcjogJ2NoYW5nZScgfSwNCiAgICAgICAgICAgIHsgcmVxdWlyZWQ6IGZhbHNlLCB0eXBlOiAnc3RyaW5nJywgbWVzc2FnZTogJ+aho+ahiOebruW9leagh+ivhiDlgLzkuI3og73kuLrnqbonLCB0cmlnZ2VyOiAnYmx1cicgfSwNCiAgICAgICAgXSwNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDor6bmg4XmqKHlnovpm4blkIgNCiAgICAgKg0KICAgICAqIEB0eXBlIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBkZXRhaWxzTW9kZWw6IGFueSA9IHsNCiAgICAgICAgZ3JvdXAxOiBuZXcgRm9ybUdyb3VwUGFuZWxNb2RlbCh7IGNhcHRpb246ICfmoaPmoYjnm67lvZXln7rmnKzkv6Hmga8nLCBkZXRhaWxUeXBlOiAnR1JPVVBQQU5FTCcsIG5hbWU6ICdncm91cDEnLCB2aXNpYmxlOiB0cnVlLCBpc1Nob3dDYXB0aW9uOiB0cnVlLCBmb3JtOiB0aGlzLCB1aUFjdGlvbkdyb3VwOiB7IGNhcHRpb246ICcnLCBsYW5nYmFzZTogJ2VudGl0aWVzLnBpbWFyY2hpdmFsY2F0YWxvZ3VlLm1haW5fZm9ybScsIGV4dHJhY3RNb2RlOiAnSVRFTScsIGRldGFpbHM6IFtdIH0gfSkNCiwgDQogICAgICAgIGZvcm1wYWdlMTogbmV3IEZvcm1QYWdlTW9kZWwoeyBjYXB0aW9uOiAn5Z+65pys5L+h5oGvJywgZGV0YWlsVHlwZTogJ0ZPUk1QQUdFJywgbmFtZTogJ2Zvcm1wYWdlMScsIHZpc2libGU6IHRydWUsIGlzU2hvd0NhcHRpb246IHRydWUsIGZvcm06IHRoaXMgfSkNCiwgDQogICAgICAgIHNyZnVwZGF0ZWRhdGU6IG5ldyBGb3JtSXRlbU1vZGVsKHsgY2FwdGlvbjogJ+abtOaWsOaXtumXtCcsIGRldGFpbFR5cGU6ICdGT1JNSVRFTScsIG5hbWU6ICdzcmZ1cGRhdGVkYXRlJywgdmlzaWJsZTogdHJ1ZSwgaXNTaG93Q2FwdGlvbjogdHJ1ZSwgZm9ybTogdGhpcywgZGlzYWJsZWQ6IGZhbHNlLCBlbmFibGVDb25kOiAzIH0pDQosIA0KICAgICAgICBzcmZvcmlrZXk6IG5ldyBGb3JtSXRlbU1vZGVsKHsgY2FwdGlvbjogJycsIGRldGFpbFR5cGU6ICdGT1JNSVRFTScsIG5hbWU6ICdzcmZvcmlrZXknLCB2aXNpYmxlOiB0cnVlLCBpc1Nob3dDYXB0aW9uOiB0cnVlLCBmb3JtOiB0aGlzLCBkaXNhYmxlZDogZmFsc2UsIGVuYWJsZUNvbmQ6IDMgfSkNCiwgDQogICAgICAgIHNyZmtleTogbmV3IEZvcm1JdGVtTW9kZWwoeyBjYXB0aW9uOiAn5qGj5qGI55uu5b2V5qCH6K+GJywgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywgbmFtZTogJ3NyZmtleScsIHZpc2libGU6IHRydWUsIGlzU2hvd0NhcHRpb246IHRydWUsIGZvcm06IHRoaXMsIGRpc2FibGVkOiBmYWxzZSwgZW5hYmxlQ29uZDogMyB9KQ0KLCANCiAgICAgICAgc3JmbWFqb3J0ZXh0OiBuZXcgRm9ybUl0ZW1Nb2RlbCh7IGNhcHRpb246ICfmoaPmoYjnm67lvZXlkI3np7AnLCBkZXRhaWxUeXBlOiAnRk9STUlURU0nLCBuYW1lOiAnc3JmbWFqb3J0ZXh0JywgdmlzaWJsZTogdHJ1ZSwgaXNTaG93Q2FwdGlvbjogdHJ1ZSwgZm9ybTogdGhpcywgZGlzYWJsZWQ6IGZhbHNlLCBlbmFibGVDb25kOiAzIH0pDQosIA0KICAgICAgICBzcmZ0ZW1wbW9kZTogbmV3IEZvcm1JdGVtTW9kZWwoeyBjYXB0aW9uOiAnJywgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywgbmFtZTogJ3NyZnRlbXBtb2RlJywgdmlzaWJsZTogdHJ1ZSwgaXNTaG93Q2FwdGlvbjogdHJ1ZSwgZm9ybTogdGhpcywgZGlzYWJsZWQ6IGZhbHNlLCBlbmFibGVDb25kOiAzIH0pDQosIA0KICAgICAgICBzcmZ1ZjogbmV3IEZvcm1JdGVtTW9kZWwoeyBjYXB0aW9uOiAnJywgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywgbmFtZTogJ3NyZnVmJywgdmlzaWJsZTogdHJ1ZSwgaXNTaG93Q2FwdGlvbjogdHJ1ZSwgZm9ybTogdGhpcywgZGlzYWJsZWQ6IGZhbHNlLCBlbmFibGVDb25kOiAzIH0pDQosIA0KICAgICAgICBzcmZkZWlkOiBuZXcgRm9ybUl0ZW1Nb2RlbCh7IGNhcHRpb246ICcnLCBkZXRhaWxUeXBlOiAnRk9STUlURU0nLCBuYW1lOiAnc3JmZGVpZCcsIHZpc2libGU6IHRydWUsIGlzU2hvd0NhcHRpb246IHRydWUsIGZvcm06IHRoaXMsIGRpc2FibGVkOiBmYWxzZSwgZW5hYmxlQ29uZDogMyB9KQ0KLCANCiAgICAgICAgc3Jmc291cmNla2V5OiBuZXcgRm9ybUl0ZW1Nb2RlbCh7IGNhcHRpb246ICcnLCBkZXRhaWxUeXBlOiAnRk9STUlURU0nLCBuYW1lOiAnc3Jmc291cmNla2V5JywgdmlzaWJsZTogdHJ1ZSwgaXNTaG93Q2FwdGlvbjogdHJ1ZSwgZm9ybTogdGhpcywgZGlzYWJsZWQ6IGZhbHNlLCBlbmFibGVDb25kOiAzIH0pDQosIA0KICAgICAgICBzZXJpYWxudW1iZXI6IG5ldyBGb3JtSXRlbU1vZGVsKHsgY2FwdGlvbjogJ+aOkuW6j+WPtycsIGRldGFpbFR5cGU6ICdGT1JNSVRFTScsIG5hbWU6ICdzZXJpYWxudW1iZXInLCB2aXNpYmxlOiB0cnVlLCBpc1Nob3dDYXB0aW9uOiB0cnVlLCBmb3JtOiB0aGlzLCBkaXNhYmxlZDogZmFsc2UsIGVuYWJsZUNvbmQ6IDMgfSkNCiwgDQogICAgICAgIGFyY2hpdmFsY2F0YWxvZ3VlbmFtZTogbmV3IEZvcm1JdGVtTW9kZWwoeyBjYXB0aW9uOiAn5qGj5qGI55uu5b2V5ZCN56ewJywgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywgbmFtZTogJ2FyY2hpdmFsY2F0YWxvZ3VlbmFtZScsIHZpc2libGU6IHRydWUsIGlzU2hvd0NhcHRpb246IHRydWUsIGZvcm06IHRoaXMsIGRpc2FibGVkOiBmYWxzZSwgZW5hYmxlQ29uZDogMyB9KQ0KLCANCiAgICAgICAgYXJjaGl2YWxjYXRhbG9ndWVpZDogbmV3IEZvcm1JdGVtTW9kZWwoeyBjYXB0aW9uOiAn5qGj5qGI55uu5b2V5qCH6K+GJywgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywgbmFtZTogJ2FyY2hpdmFsY2F0YWxvZ3VlaWQnLCB2aXNpYmxlOiB0cnVlLCBpc1Nob3dDYXB0aW9uOiB0cnVlLCBmb3JtOiB0aGlzLCBkaXNhYmxlZDogZmFsc2UsIGVuYWJsZUNvbmQ6IDMgfSkNCiwgDQogICAgfTsNCg0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBzcmZ1cGRhdGVkYXRlIOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBuZXdWYWwNCiAgICAgKiBAcGFyYW0geyp9IG9sZFZhbA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBXYXRjaCgnZGF0YS5zcmZ1cGRhdGVkYXRlJykNCiAgICBvblNyZnVwZGF0ZWRhdGVDaGFuZ2UobmV3VmFsOiBhbnksIG9sZFZhbDogYW55KSB7DQogICAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoeyBuYW1lOiAnc3JmdXBkYXRlZGF0ZScsIG5ld1ZhbDogbmV3VmFsLCBvbGRWYWw6IG9sZFZhbCB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnm5HmjqfooajljZXlsZ7mgKcgc3Jmb3Jpa2V5IOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBuZXdWYWwNCiAgICAgKiBAcGFyYW0geyp9IG9sZFZhbA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBXYXRjaCgnZGF0YS5zcmZvcmlrZXknKQ0KICAgIG9uU3Jmb3Jpa2V5Q2hhbmdlKG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSkgew0KICAgICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsgbmFtZTogJ3NyZm9yaWtleScsIG5ld1ZhbDogbmV3VmFsLCBvbGRWYWw6IG9sZFZhbCB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnm5HmjqfooajljZXlsZ7mgKcgc3Jma2V5IOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBuZXdWYWwNCiAgICAgKiBAcGFyYW0geyp9IG9sZFZhbA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBXYXRjaCgnZGF0YS5zcmZrZXknKQ0KICAgIG9uU3Jma2V5Q2hhbmdlKG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSkgew0KICAgICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsgbmFtZTogJ3NyZmtleScsIG5ld1ZhbDogbmV3VmFsLCBvbGRWYWw6IG9sZFZhbCB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnm5HmjqfooajljZXlsZ7mgKcgc3JmbWFqb3J0ZXh0IOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBuZXdWYWwNCiAgICAgKiBAcGFyYW0geyp9IG9sZFZhbA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBXYXRjaCgnZGF0YS5zcmZtYWpvcnRleHQnKQ0KICAgIG9uU3JmbWFqb3J0ZXh0Q2hhbmdlKG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSkgew0KICAgICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsgbmFtZTogJ3NyZm1ham9ydGV4dCcsIG5ld1ZhbDogbmV3VmFsLCBvbGRWYWw6IG9sZFZhbCB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDnm5HmjqfooajljZXlsZ7mgKcgc3JmdGVtcG1vZGUg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFdhdGNoKCdkYXRhLnNyZnRlbXBtb2RlJykNCiAgICBvblNyZnRlbXBtb2RlQ2hhbmdlKG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSkgew0KICAgICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsgbmFtZTogJ3NyZnRlbXBtb2RlJywgbmV3VmFsOiBuZXdWYWwsIG9sZFZhbDogb2xkVmFsIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBzcmZ1ZiDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsDQogICAgICogQHBhcmFtIHsqfSBvbGRWYWwNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBAV2F0Y2goJ2RhdGEuc3JmdWYnKQ0KICAgIG9uU3JmdWZDaGFuZ2UobmV3VmFsOiBhbnksIG9sZFZhbDogYW55KSB7DQogICAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoeyBuYW1lOiAnc3JmdWYnLCBuZXdWYWw6IG5ld1ZhbCwgb2xkVmFsOiBvbGRWYWwgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog55uR5o6n6KGo5Y2V5bGe5oCnIHNyZmRlaWQg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFdhdGNoKCdkYXRhLnNyZmRlaWQnKQ0KICAgIG9uU3JmZGVpZENoYW5nZShuZXdWYWw6IGFueSwgb2xkVmFsOiBhbnkpIHsNCiAgICAgICAgdGhpcy5mb3JtRGF0YUNoYW5nZSh7IG5hbWU6ICdzcmZkZWlkJywgbmV3VmFsOiBuZXdWYWwsIG9sZFZhbDogb2xkVmFsIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBzcmZzb3VyY2VrZXkg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFdhdGNoKCdkYXRhLnNyZnNvdXJjZWtleScpDQogICAgb25TcmZzb3VyY2VrZXlDaGFuZ2UobmV3VmFsOiBhbnksIG9sZFZhbDogYW55KSB7DQogICAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoeyBuYW1lOiAnc3Jmc291cmNla2V5JywgbmV3VmFsOiBuZXdWYWwsIG9sZFZhbDogb2xkVmFsIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBzZXJpYWxudW1iZXIg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFdhdGNoKCdkYXRhLnNlcmlhbG51bWJlcicpDQogICAgb25TZXJpYWxudW1iZXJDaGFuZ2UobmV3VmFsOiBhbnksIG9sZFZhbDogYW55KSB7DQogICAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoeyBuYW1lOiAnc2VyaWFsbnVtYmVyJywgbmV3VmFsOiBuZXdWYWwsIG9sZFZhbDogb2xkVmFsIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBhcmNoaXZhbGNhdGFsb2d1ZW5hbWUg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgQFdhdGNoKCdkYXRhLmFyY2hpdmFsY2F0YWxvZ3VlbmFtZScpDQogICAgb25BcmNoaXZhbGNhdGFsb2d1ZW5hbWVDaGFuZ2UobmV3VmFsOiBhbnksIG9sZFZhbDogYW55KSB7DQogICAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoeyBuYW1lOiAnYXJjaGl2YWxjYXRhbG9ndWVuYW1lJywgbmV3VmFsOiBuZXdWYWwsIG9sZFZhbDogb2xkVmFsIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBhcmNoaXZhbGNhdGFsb2d1ZWlkIOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBuZXdWYWwNCiAgICAgKiBAcGFyYW0geyp9IG9sZFZhbA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIEBXYXRjaCgnZGF0YS5hcmNoaXZhbGNhdGFsb2d1ZWlkJykNCiAgICBvbkFyY2hpdmFsY2F0YWxvZ3VlaWRDaGFuZ2UobmV3VmFsOiBhbnksIG9sZFZhbDogYW55KSB7DQogICAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoeyBuYW1lOiAnYXJjaGl2YWxjYXRhbG9ndWVpZCcsIG5ld1ZhbDogbmV3VmFsLCBvbGRWYWw6IG9sZFZhbCB9KTsNCiAgICB9DQoNCg0KICAgIC8qKg0KICAgICAqIOmHjee9ruihqOWNlemhueWAvA0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEBwYXJhbSB7eyBuYW1lOiBzdHJpbmcsIG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSB9fSB7IG5hbWUsIG5ld1ZhbCwgb2xkVmFsIH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgcmVzZXRGb3JtRGF0YSh7IG5hbWUsIG5ld1ZhbCwgb2xkVmFsIH06IHsgbmFtZTogc3RyaW5nLCBuZXdWYWw6IGFueSwgb2xkVmFsOiBhbnkgfSk6IHZvaWQgew0KICAgIH0NCg0KICAgIC8qKg0KICAgICAgKiDnva7nqbrlr7nosaENCiAgICAgICoNCiAgICAgICogQHBhcmFtIHthbnlbXX0gYXJncw0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAgKi8NCiAgICBwdWJsaWMgUmVzZXREYXRhKF9kYXRhczphbnkpew0KICAgICAgICBpZihPYmplY3Qua2V5cyhfZGF0YXMpLmxlbmd0aCA+MCl7DQogICAgICAgICAgICBPYmplY3Qua2V5cyhfZGF0YXMpLmZvckVhY2goKG5hbWU6IHN0cmluZykgPT4gew0KICAgICAgICAgICAgICAgIGlmICh0aGlzLmRhdGEuaGFzT3duUHJvcGVydHkobmFtZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhW25hbWVdID0gbnVsbDsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOihqOWNlemAu+i+kQ0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEBwYXJhbSB7eyBuYW1lOiBzdHJpbmcsIG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSB9fSB7IG5hbWUsIG5ld1ZhbCwgb2xkVmFsIH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZm9ybUxvZ2ljKHsgbmFtZSwgbmV3VmFsLCBvbGRWYWwgfTogeyBuYW1lOiBzdHJpbmcsIG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSB9KTogdm9pZCB7DQogICAgICAgICAgICAgICAgDQoNCg0KDQoNCg0KDQoNCg0KDQoNCg0KDQoNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDooajljZXlgLzlj5jljJYNCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0ge3sgbmFtZTogc3RyaW5nLCBuZXdWYWw6IGFueSwgb2xkVmFsOiBhbnkgfX0geyBuYW1lLCBuZXdWYWwsIG9sZFZhbCB9DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGZvcm1EYXRhQ2hhbmdlKHsgbmFtZSwgbmV3VmFsLCBvbGRWYWwgfTogeyBuYW1lOiBzdHJpbmcsIG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSB9KTogdm9pZCB7DQogICAgICAgIGlmICh0aGlzLmlnbm9yZWZpZWxkdmFsdWVjaGFuZ2UpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnJlc2V0Rm9ybURhdGEoeyBuYW1lOiBuYW1lLCBuZXdWYWw6IG5ld1ZhbCwgb2xkVmFsOiBvbGRWYWwgfSk7DQogICAgICAgIHRoaXMuZm9ybUxvZ2ljKHsgbmFtZTogbmFtZSwgbmV3VmFsOiBuZXdWYWwsIG9sZFZhbDogb2xkVmFsIH0pOw0KICAgICAgICB0aGlzLmRhdGFDaGFuZy5uZXh0KEpTT04uc3RyaW5naWZ5KHRoaXMuZGF0YSkpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOihqOWNleWKoOi9veWujOaIkA0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHtzdHJpbmd9IFthY3Rpb25dDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIG9uRm9ybUxvYWQoZGF0YTogYW55ID0ge30sYWN0aW9uOnN0cmluZyk6IHZvaWQgew0KICAgICAgICBpZihPYmplY3QuaXMoYWN0aW9uLCJzYXZlIikgfHwgT2JqZWN0LmlzKGFjdGlvbiwiYXV0b1NhdmUiKSB8fCBPYmplY3QuaXMoYWN0aW9uLCJzdWJtaXQiKSkNCiAgICAgICAgLy8g5pu05pawY29udGV4dOeahOWunuS9k+S4u+mUrg0KICAgICAgICBpZihkYXRhLnBpbWFyY2hpdmFsY2F0YWxvZ3VlKXsNCiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb250ZXh0LHtwaW1hcmNoaXZhbGNhdGFsb2d1ZTpkYXRhLnBpbWFyY2hpdmFsY2F0YWxvZ3VlfSkNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLnNldEZvcm1FbmFibGVDb25kKGRhdGEpOw0KICAgICAgICB0aGlzLmZpbGxGb3JtKGRhdGEsYWN0aW9uKTsNCiAgICAgICAgdGhpcy5vbGREYXRhID0ge307DQogICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5vbGREYXRhLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuZGF0YSkpKTsNCiAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCd2aWV3YWN0aW9uL3NldFZpZXdEYXRhQ2hhbmdlJywgeyB2aWV3dGFnOiB0aGlzLnZpZXd0YWcsIHZpZXdkYXRhY2hhbmdlOiBmYWxzZSB9KTsNCiAgICAgICAgdGhpcy5mb3JtTG9naWMoeyBuYW1lOiAnJywgbmV3VmFsOiBudWxsLCBvbGRWYWw6IG51bGwgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5YC85aGr5YWFDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtfZGF0YXM9e31dDQogICAgICogQHBhcmFtIHtzdHJpbmd9IFthY3Rpb25dDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGZpbGxGb3JtKF9kYXRhczogYW55ID0ge30sYWN0aW9uOnN0cmluZyk6IHZvaWQgew0KICAgICAgICB0aGlzLmlnbm9yZWZpZWxkdmFsdWVjaGFuZ2UgPSB0cnVlOw0KICAgICAgICBPYmplY3Qua2V5cyhfZGF0YXMpLmZvckVhY2goKG5hbWU6IHN0cmluZykgPT4gew0KICAgICAgICAgICAgaWYgKHRoaXMuZGF0YS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgew0KICAgICAgICAgICAgICAgIHRoaXMuZGF0YVtuYW1lXSA9IF9kYXRhc1tuYW1lXTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGlmKE9iamVjdC5pcyhhY3Rpb24sJ2xvYWREcmFmdCcpKXsNCiAgICAgICAgICAgIHRoaXMuY3JlYXRlRGVmYXVsdCgpOw0KICAgICAgICB9DQogICAgICAgIGlmKE9iamVjdC5pcyhhY3Rpb24sJ2xvYWQnKSl7DQogICAgICAgICAgICB0aGlzLnVwZGF0ZURlZmF1bHQoKTsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB0aGlzLmlnbm9yZWZpZWxkdmFsdWVjaGFuZ2UgPSBmYWxzZTsNCiAgICAgICAgfSkNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDorr7nva7ooajljZXpobnmmK/lkKblkK/nlKgNCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0geyp9IGRhdGENCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgc2V0Rm9ybUVuYWJsZUNvbmQoZGF0YTogYW55KTogdm9pZCB7DQogICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5kZXRhaWxzTW9kZWwpLmZvckVhY2goKGRldGFpbDogYW55KSA9PiB7DQogICAgICAgICAgICBpZiAoIU9iamVjdC5pcyhkZXRhaWwuZGV0YWlsVHlwZSwgJ0ZPUk1JVEVNJykpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb25zdCBmb3JtSXRlbTogRm9ybUl0ZW1Nb2RlbCA9IGRldGFpbDsNCiAgICAgICAgICAgIGZvcm1JdGVtLnNldEVuYWJsZUNvbmQoZGF0YS5zcmZ1Zik7DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOmHjee9ruiNieeov+ihqOWNleeKtuaAgQ0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyByZXNldERyYWZ0Rm9ybVN0YXRlcygpOiB2b2lkIHsNCiAgICAgICAgY29uc3QgZm9ybTogYW55ID0gdGhpcy4kcmVmcy5mb3JtOw0KICAgICAgICBpZiAoZm9ybSkgew0KICAgICAgICAgICAgZm9ybS5yZXNldEZpZWxkcygpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YeN572u5qCh6aqM57uT5p6cDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgcmVzZXRWYWxpZGF0ZXMoKTogdm9pZCB7DQogICAgICAgIE9iamVjdC52YWx1ZXModGhpcy5kZXRhaWxzTW9kZWwpLmZvckVhY2goKGRldGFpbDogYW55KSA9PiB7DQogICAgICAgICAgICBpZiAoIU9iamVjdC5pcyhkZXRhaWwuZGV0YWlsVHlwZSwgJ0ZPUk1JVEVNJykpIHsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb25zdCBmb3JtSXRlbTogRm9ybUl0ZW1Nb2RlbCA9IGRldGFpbDsNCiAgICAgICAgICAgIGZvcm1JdGVtLnNldEVycm9yKCcnKTsNCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5aGr5YWF5qCh6aqM57uT5p6cIO+8iOWQjuWPsO+8iQ0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gZmllbGRFcnJvcnMNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgZmlsbFZhbGlkYXRlcyhmaWVsZEVycm9yczogYW55W10pOiB2b2lkIHsNCiAgICAgICAgZmllbGRFcnJvcnMuZm9yRWFjaCgoZXJyb3I6IGFueSkgPT4gew0KICAgICAgICAgICAgY29uc3QgZm9ybUl0ZW06IEZvcm1JdGVtTW9kZWwgPSB0aGlzLmRldGFpbHNNb2RlbFtlcnJvci5maWVsZF07DQogICAgICAgICAgICBpZiAoIWZvcm1JdGVtKSB7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgICAgICAgIGZvcm1JdGVtLnNldEVycm9yKGVycm9yLm1lc3NhZ2UpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOihqOWNleagoemqjOeKtuaAgQ0KICAgICAqDQogICAgICogQHJldHVybnMge2Jvb2xlYW59IA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBmb3JtVmFsaWRhdGVTdGF0dXMoKTogYm9vbGVhbiB7DQogICAgICAgIGNvbnN0IGZvcm06IGFueSA9IHRoaXMuJHJlZnMuZm9ybTsNCiAgICAgICAgbGV0IHZhbGlkYXRlc3RhdGU6IGJvb2xlYW4gPSB0cnVlOw0KICAgICAgICBmb3JtLnZhbGlkYXRlKCh2YWxpZDogYm9vbGVhbikgPT4gew0KICAgICAgICAgICAgdmFsaWRhdGVzdGF0ZSA9IHZhbGlkID8gdHJ1ZSA6IGZhbHNlOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHZhbGlkYXRlc3RhdGUNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDojrflj5blhajpg6jlgLwNCiAgICAgKg0KICAgICAqIEByZXR1cm5zIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBnZXRWYWx1ZXMoKTogYW55IHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDooajljZXpobnlgLzlj5jmm7QNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7eyBuYW1lOiBzdHJpbmcsIHZhbHVlOiBhbnkgfX0gJGV2ZW50DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIG9uRm9ybUl0ZW1WYWx1ZUNoYW5nZSgkZXZlbnQ6IHsgbmFtZTogc3RyaW5nLCB2YWx1ZTogYW55IH0pOiB2b2lkIHsNCiAgICAgICAgaWYgKCEkZXZlbnQpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBpZiAoISRldmVudC5uYW1lIHx8IE9iamVjdC5pcygkZXZlbnQubmFtZSwgJycpIHx8ICF0aGlzLmRhdGEuaGFzT3duUHJvcGVydHkoJGV2ZW50Lm5hbWUpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgdGhpcy5kYXRhWyRldmVudC5uYW1lXSA9ICRldmVudC52YWx1ZTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDorr7nva7mlbDmja7pobnlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lDQogICAgICogQHBhcmFtIHsqfSB2YWx1ZQ0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBzZXREYXRhSXRlbVZhbHVlKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQgew0KICAgICAgICBpZiAoIW5hbWUgfHwgT2JqZWN0LmlzKG5hbWUsICcnKSB8fCAhdGhpcy5kYXRhLmhhc093blByb3BlcnR5KG5hbWUpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgaWYgKE9iamVjdC5pcyh0aGlzLmRhdGFbbmFtZV0sIHZhbHVlKSkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIHRoaXMuZGF0YVtuYW1lXSA9IHZhbHVlOw0KICAgIH0NCg0KDQoNCiAgICAvKioNCiAgICAgKiDliIbnu4TnlYzpnaLooYzkuLrkuovku7YNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGdyb3VwVUlBY3Rpb25DbGljaygkZXZlbnQ6IGFueSk6IHZvaWQgew0KICAgICAgICBpZiAoISRldmVudCkgew0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIGNvbnN0IGl0ZW06YW55ID0gJGV2ZW50Lml0ZW07DQogICAgfQ0KDQogICAgLyoqDQogICAgICogVnVl5aOw5piO5ZGo5pyfKOWkhOeQhue7hOS7tueahOi+k+WFpeWxnuaApykNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBjcmVhdGVkKCk6IHZvaWQgew0KICAgICAgICB0aGlzLmFmdGVyQ3JlYXRlZCgpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOaJp+ihjGNyZWF0ZWTlkI7nmoTpgLvovpENCiAgICAgKg0KICAgICAqICBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8gICAgDQogICAgcHVibGljIGFmdGVyQ3JlYXRlZCgpew0KICAgICAgICBpZiAodGhpcy52aWV3U3RhdGUpIHsNCiAgICAgICAgICAgIHRoaXMudmlld1N0YXRlRXZlbnQgPSB0aGlzLnZpZXdTdGF0ZS5zdWJzY3JpYmUoKHsgdGFnLCBhY3Rpb24sIGRhdGEgfSkgPT4gew0KICAgICAgICAgICAgICAgIGlmICghT2JqZWN0LmlzKHRhZywgdGhpcy5uYW1lKSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChPYmplY3QuaXMoJ2F1dG9sb2FkJywgYWN0aW9uKSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmF1dG9Mb2FkKGRhdGEpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdsb2FkJywgYWN0aW9uKSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmxvYWQoZGF0YSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChPYmplY3QuaXMoJ2xvYWRkcmFmdCcsIGFjdGlvbikpIHsNCiAgICAgICAgICAgICAgICAgICAgaWYodGhpcy5jb250ZXh0LnNyZnNvdXJjZWtleSl7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNvcHkodGhpcy5jb250ZXh0LnNyZnNvdXJjZWtleSk7DQogICAgICAgICAgICAgICAgICAgIH1lbHNlew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5sb2FkRHJhZnQoZGF0YSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKE9iamVjdC5pcygnc2F2ZScsIGFjdGlvbikpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5zYXZlKGRhdGEsZGF0YS5zaG93UmVzdWx0SW5mbyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChPYmplY3QuaXMoJ3JlbW92ZScsIGFjdGlvbikpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZW1vdmUoZGF0YSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChPYmplY3QuaXMoJ3NhdmVhbmRleGl0JywgYWN0aW9uKSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVBbmRFeGl0KGRhdGEpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdzYXZlYW5kbmV3JywgYWN0aW9uKSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVBbmROZXcoZGF0YSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChPYmplY3QuaXMoJ3JlbW92ZWFuZGV4aXQnLCBhY3Rpb24pKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVtb3ZlQW5kRXhpdChkYXRhKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKE9iamVjdC5pcygncmVmcmVzaCcsIGFjdGlvbikpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWZyZXNoKGRhdGEpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgICAgIHRoaXMuZGF0YUNoYW5nDQogICAgICAgICAgICAucGlwZSgNCiAgICAgICAgICAgICAgICBkZWJvdW5jZVRpbWUoMzAwKSwNCiAgICAgICAgICAgICAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZCgpDQogICAgICAgICAgICApLnN1YnNjcmliZSgoZGF0YTogYW55KSA9PiB7DQogICAgICAgICAgICAgICAgaWYgKHRoaXMuYXV0b3NhdmUpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5hdXRvU2F2ZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBjb25zdCBzdGF0ZSA9ICFPYmplY3QuaXMoSlNPTi5zdHJpbmdpZnkodGhpcy5vbGREYXRhKSwgSlNPTi5zdHJpbmdpZnkodGhpcy5kYXRhKSkgPyB0cnVlIDogZmFsc2U7DQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCd2aWV3YWN0aW9uL3NldFZpZXdEYXRhQ2hhbmdlJywgeyB2aWV3dGFnOiB0aGlzLnZpZXd0YWcsIHZpZXdkYXRhY2hhbmdlOiBzdGF0ZSB9KTsNCiAgICAgICAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIHZ1ZSDnlJ/lkb3lkajmnJ8NCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyBkZXN0cm95ZWQoKSB7DQogICAgICAgIHRoaXMuYWZ0ZXJEZXN0cm95KCk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5omn6KGMZGVzdHJveWVk5ZCO55qE6YC76L6RDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgYWZ0ZXJEZXN0cm95KCkgew0KICAgICAgICBpZiAodGhpcy52aWV3U3RhdGVFdmVudCkgew0KICAgICAgICAgICAgdGhpcy52aWV3U3RhdGVFdmVudC51bnN1YnNjcmliZSgpOw0KICAgICAgICB9DQogICAgICAgIGlmICh0aGlzLmRhdGFDaGFuZ0V2ZW50KSB7DQogICAgICAgICAgICB0aGlzLmRhdGFDaGFuZ0V2ZW50LnVuc3Vic2NyaWJlKCk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDmi7fotJ3lhoXlrrkNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2FyZz17fV0NCiAgICAgKiBAbWVtYmVyb2YgQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGNvcHkoc3Jma2V5OiBzdHJpbmcpOiB2b2lkIHsNCiAgICAgICAgbGV0IGNvcHlEYXRhID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDb3B5RGF0YShzcmZrZXkpOw0KICAgICAgICBjb3B5RGF0YS5zcmZrZXkgPSBVdGlsLmNyZWF0ZVVVSUQoKTsNCiAgICAgICAgY29weURhdGEucGltYXJjaGl2YWxjYXRhbG9ndWUgPSBjb3B5RGF0YS5zcmZrZXk7DQogICAgICAgIGNvcHlEYXRhLmFyY2hpdmFsY2F0YWxvZ3VlaWQgPSBjb3B5RGF0YS5zcmZrZXk7DQogICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb250ZXh0LHtwaW1hcmNoaXZhbGNhdGFsb2d1ZTpjb3B5RGF0YS5waW1hcmNoaXZhbGNhdGFsb2d1ZX0pDQogICAgICAgIHRoaXMuZGF0YSA9IGNvcHlEYXRhOw0KICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgdGhpcy5mb3JtU3RhdGUubmV4dCh7IHR5cGU6ICdsb2FkJywgZGF0YTogY29weURhdGEgfSk7DQogICAgICAgICAgdGhpcy5kYXRhLnNyZnVmID0gJzAnOw0KICAgICAgICAgIHRoaXMuc2V0Rm9ybUVuYWJsZUNvbmQodGhpcy5kYXRhKTsNCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICrmiZPljbANCiAgICAgKkBtZW1iZXJvZiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgcHJpbnQoKXsNCiAgICAgICAgbGV0IF90aGlzOmFueSA9IHRoaXM7DQogICAgICAgIF90aGlzLiRwcmludCh7aWQ6J3BpbWFyY2hpdmFsY2F0YWxvZ3VlX21haW4nLHBvcFRpdGxlOifkuLvnvJbovpHooajljZUnfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6YOo5Lu25Yi35pawDQogICAgICoNCiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIHJlZnJlc2goYXJnczogYW55W10pOiB2b2lkIHsNCiAgICAgICAgbGV0IGFyZzogYW55ID0ge307DQogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLGFyZ3NbMF0pOw0KICAgICAgICBpZiAodGhpcy5kYXRhLnNyZmtleSAmJiAhT2JqZWN0LmlzKHRoaXMuZGF0YS5zcmZrZXksICcnKSkgew0KICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHsgc3Jma2V5OiB0aGlzLmRhdGEuc3Jma2V5IH0pOw0KICAgICAgICAgICAgdGhpcy5sb2FkKGFyZyk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgaWYgKHRoaXMuZGF0YS5zcmZrZXlzICYmICFPYmplY3QuaXModGhpcy5kYXRhLnNyZmtleXMsICcnKSkgew0KICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHsgc3Jma2V5OiB0aGlzLmRhdGEuc3Jma2V5cyB9KTsNCiAgICAgICAgICAgIHRoaXMubG9hZChhcmcpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6Ieq5Yqo5Yqg6L29DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFthcmc9e31dDQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGF1dG9Mb2FkKGFyZzogYW55ID0ge30pOiB2b2lkIHsNCiAgICAgICAgaWYgKGFyZy5zcmZrZXkgJiYgIU9iamVjdC5pcyhhcmcuc3Jma2V5LCAnJykpIHsNCiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCB7IHNyZmtleTogYXJnLnNyZmtleSB9KTsNCiAgICAgICAgICAgIHRoaXMubG9hZChhcmcpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIGlmIChhcmcuc3Jma2V5cyAmJiAhT2JqZWN0LmlzKGFyZy5zcmZrZXlzLCAnJykpIHsNCiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCB7IHNyZmtleTogYXJnLnNyZmtleXMgfSk7DQogICAgICAgICAgICB0aGlzLmxvYWQoYXJnKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzLmxvYWREcmFmdChhcmcpOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWKoOi9vQ0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEBwYXJhbSB7Kn0gW29wdD17fV0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgbG9hZChvcHQ6IGFueSA9IHt9KTogdm9pZCB7DQogICAgICAgIGlmKCF0aGlzLmxvYWRBY3Rpb24pew0KICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAnQVJDSElWQUxDQVRBTE9HVUVFZGl0Vmlld+inhuWbvuihqOWNlWxvYWRBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICAgIGNvbnN0IGFyZzogYW55ID0geyAuLi5vcHQgfTsNCiAgICAgICAgbGV0IHZpZXdwYXJhbVJlc3VsdDphbnkgPSBPYmplY3QuYXNzaWduKGFyZyx0aGlzLnZpZXdwYXJhbXMpOw0KICAgICAgICBjb25zdCBnZXQ6IFByb21pc2U8YW55PiA9IHRoaXMuc2VydmljZS5nZXQodGhpcy5sb2FkQWN0aW9uLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSkse3ZpZXdwYXJhbXM6dmlld3BhcmFtUmVzdWx0fSwgdGhpcy5zaG93QnVzeUluZGljYXRvcik7DQogICAgICAgIGdldC50aGVuKChyZXNwb25zZTogYW55KSA9PiB7DQogICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsNCiAgICAgICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICAgICAgICB0aGlzLm9uRm9ybUxvYWQoZGF0YSwnbG9hZCcpOw0KICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2xvYWQnLCBkYXRhKTsNCiAgICAgICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybVN0YXRlLm5leHQoeyB0eXBlOiAnbG9hZCcsIGRhdGE6IGRhdGEgfSk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7DQogICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzICYmIHJlc3BvbnNlLmRhdGEpIHsNCiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6IHJlc3BvbnNlLmRhdGEubWVzc2FnZSB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsNCiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICfns7vnu5/lvILluLgnIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5Yqg6L296I2J56i/DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtvcHQ9e31dDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGxvYWREcmFmdChvcHQ6IGFueSA9IHt9KTogdm9pZCB7DQogICAgICAgIGlmKCF0aGlzLmxvYWRkcmFmdEFjdGlvbil7DQogICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICdBUkNISVZBTENBVEFMT0dVRUVkaXRWaWV36KeG5Zu+6KGo5Y2VbG9hZGRyYWZ0QWN0aW9u5Y+C5pWw5pyq6YWN572uJyB9KTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCBhcmc6IGFueSA9IHsgLi4ub3B0IH0gOw0KICAgICAgICBsZXQgdmlld3BhcmFtUmVzdWx0OmFueSA9IE9iamVjdC5hc3NpZ24oYXJnLHRoaXMudmlld3BhcmFtcyk7DQogICAgICAgIGxldCBwb3N0OiBQcm9taXNlPGFueT4gPSB0aGlzLnNlcnZpY2UubG9hZERyYWZ0KHRoaXMubG9hZGRyYWZ0QWN0aW9uLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSkse3ZpZXdwYXJhbXM6dmlld3BhcmFtUmVzdWx0fSwgdGhpcy5zaG93QnVzeUluZGljYXRvcik7DQogICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gew0KICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5zdGF0dXMgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsNCiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6IHJlc3BvbnNlLmRhdGEubWVzc2FnZSB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICAgIGlmKGRhdGEucGltYXJjaGl2YWxjYXRhbG9ndWUpew0KICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5jb250ZXh0LHtwaW1hcmNoaXZhbGNhdGFsb2d1ZTpkYXRhLnBpbWFyY2hpdmFsY2F0YWxvZ3VlfSkNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHRoaXMucmVzZXREcmFmdEZvcm1TdGF0ZXMoKTsNCiAgICAgICAgICAgIHRoaXMub25Gb3JtTG9hZChkYXRhLCdsb2FkRHJhZnQnKTsNCiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2xvYWQnLCBkYXRhKTsNCiAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICB0aGlzLmZvcm1TdGF0ZS5uZXh0KHsgdHlwZTogJ2xvYWQnLCBkYXRhOiBkYXRhIH0pOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgICBjb25zdCBmb3JtOiBhbnkgPSB0aGlzLiRyZWZzLmZvcm07DQogICAgICAgICAgICAgICAgaWYgKGZvcm0pIHsNCiAgICAgICAgICAgICAgICAgICAgZm9ybS5maWVsZHMuZm9yRWFjaCgoZmllbGQ6IGFueSkgPT4gew0KICAgICAgICAgICAgICAgICAgICAgICAgZmllbGQudmFsaWRhdGVNZXNzYWdlID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICBmaWVsZC52YWxpZGF0ZVN0YXRlID0gIiI7DQogICAgICAgICAgICAgICAgICAgICAgICBmaWVsZC52YWxpZGF0ZVN0YXR1cyA9IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsNCiAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgICYmIHJlc3BvbnNlLmRhdGEpIHsNCiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6IHJlc3BvbnNlLmRhdGEubWVzc2FnZSB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsNCiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICfns7vnu5/lvILluLgnIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoqDQogICAgICog6Ieq5Yqo5L+d5a2YDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtvcHQ9e31dDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGF1dG9TYXZlKG9wdDogYW55ID0ge30pOiB2b2lkIHsNCiAgICAgICAgaWYgKCF0aGlzLmZvcm1WYWxpZGF0ZVN0YXR1cygpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgY29uc3QgYXJnOiBhbnkgPSB7IC4uLm9wdCB9Ow0KICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5nZXRWYWx1ZXMoKTsNCiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIGRhdGEpOw0KICAgICAgICBjb25zdCBhY3Rpb246IGFueSA9IE9iamVjdC5pcyhkYXRhLnNyZnVmLCAnMScpID8gdGhpcy51cGRhdGVBY3Rpb24gOiB0aGlzLmNyZWF0ZUFjdGlvbjsNCiAgICAgICAgaWYoIWFjdGlvbil7DQogICAgICAgICAgICBsZXQgYWN0aW9uTmFtZTphbnkgPSBPYmplY3QuaXMoZGF0YS5zcmZ1ZiwgJzEnKT8idXBkYXRlQWN0aW9uIjoiY3JlYXRlQWN0aW9uIjsNCiAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ0FSQ0hJVkFMQ0FUQUxPR1VFRWRpdFZpZXfop4blm77ooajljZUnK2FjdGlvbk5hbWUrJ+WPguaVsOacqumFjee9ricgfSk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcse3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSk7DQogICAgICAgIGNvbnN0IHBvc3Q6IFByb21pc2U8YW55PiA9IHRoaXMuc2VydmljZS5hZGQoYWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLGFyZywgdGhpcy5zaG93QnVzeUluZGljYXRvcik7DQogICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gew0KICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5zdGF0dXMgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsNCiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6IHJlc3BvbnNlLmRhdGEubWVzc2FnZSB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICAgIHRoaXMub25Gb3JtTG9hZChkYXRhLCdhdXRvU2F2ZScpOw0KICAgICAgICAgICAgdGhpcy4kZW1pdCgnc2F2ZScsIGRhdGEpOw0KICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3ZpZXdhY3Rpb24vZGF0YXNhdmVkJywgeyB2aWV3dGFnOiB0aGlzLnZpZXd0YWcgfSk7DQogICAgICAgICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7DQogICAgICAgICAgICAgICAgdGhpcy5mb3JtU3RhdGUubmV4dCh7IHR5cGU6ICdzYXZlJywgZGF0YTogZGF0YSB9KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KS5jYXRjaCgocmVzcG9uc2U6IGFueSkgPT4gew0KICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyAmJiByZXNwb25zZS5kYXRhKSB7DQogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7DQogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn57O757uf5byC5bi4JyB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOS/neWtmA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbb3B0PXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Nob3dSZXN1bHRJbmZvXSANCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpZlN0YXRlTmV4dF0gZm9ybVN0YXRl5piv5ZCm5LiL5Y+R6YCa55+lDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgYXN5bmMgc2F2ZShvcHQ6IGFueSA9IHt9LCBzaG93UmVzdWx0SW5mbz86IGJvb2xlYW4sIGlmU3RhdGVOZXh0OiBib29sZWFuID0gdHJ1ZSk6IFByb21pc2U8YW55PiB7DQogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZTogYW55LCByZWplY3Q6IGFueSkgPT4gew0KICAgICAgICAgICAgc2hvd1Jlc3VsdEluZm8gPSBzaG93UmVzdWx0SW5mbyA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGZhbHNlOw0KICAgICAgICAgICAgaWYgKCF0aGlzLmZvcm1WYWxpZGF0ZVN0YXR1cygpKSB7DQogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn5YC86KeE5YiZ5qCh6aqM5byC5bi4JyB9KTsNCiAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb25zdCBhcmc6IGFueSA9IHsgLi4ub3B0IH07DQogICAgICAgICAgICBjb25zdCBkYXRhID0gdGhpcy5nZXRWYWx1ZXMoKTsNCiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCBkYXRhKTsNCiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCB0aGlzLmNvbnRleHQpOw0KICAgICAgICAgICAgaWYgKGlmU3RhdGVOZXh0KSB7DQogICAgICAgICAgICAgICAgdGhpcy5kcmNvdW50ZXIgPSAwOw0KICAgICAgICAgICAgICAgIGlmKHRoaXMuZHJjb3VudGVyICE9PSAwKXsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kcnNhdmVvcHQgPSBvcHQ7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybVN0YXRlLm5leHQoeyB0eXBlOiAnYmVmb3Jlc2F2ZScsIGRhdGE6IGFyZyB9KTsvL+WFiOmAmuefpeWFs+ezu+eVjOmdouS/neWtmA0KICAgICAgICAgICAgICAgICAgICB0aGlzLnNhdmVTdGF0ZSA9IHJlc29sdmU7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBjb25zdCBhY3Rpb246IGFueSA9IE9iamVjdC5pcyhkYXRhLnNyZnVmLCAnMScpID8gdGhpcy51cGRhdGVBY3Rpb24gOiB0aGlzLmNyZWF0ZUFjdGlvbjsNCiAgICAgICAgICAgIGlmKCFhY3Rpb24pew0KICAgICAgICAgICAgICAgIGxldCBhY3Rpb25OYW1lOmFueSA9IE9iamVjdC5pcyhkYXRhLnNyZnVmLCAnMScpPyJ1cGRhdGVBY3Rpb24iOiJjcmVhdGVBY3Rpb24iOw0KICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ0FSQ0hJVkFMQ0FUQUxPR1VFRWRpdFZpZXfop4blm77ooajljZUnK2FjdGlvbk5hbWUrJ+WPguaVsOacqumFjee9ricgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcse3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSk7DQogICAgICAgICAgICBjb25zdCBwb3N0OiBQcm9taXNlPGFueT4gPSBPYmplY3QuaXMoZGF0YS5zcmZ1ZiwgJzEnKT90aGlzLnNlcnZpY2UudXBkYXRlKGFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSxhcmcsIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOnRoaXMuc2VydmljZS5hZGQoYWN0aW9uLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksYXJnLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsNCiAgICAgICAgICAgIHBvc3QudGhlbigocmVzcG9uc2U6IGFueSkgPT4gew0KICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2Uuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7DQogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6IHJlc3BvbnNlLmRhdGEubWVzc2FnZSB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7DQogICAgICAgICAgICAgICAgdGhpcy5vbkZvcm1Mb2FkKGRhdGEsJ3NhdmUnKTsNCiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzYXZlJywgZGF0YSk7DQogICAgICAgICAgICAgICAgdGhpcy4kc3RvcmUuZGlzcGF0Y2goJ3ZpZXdhY3Rpb24vZGF0YXNhdmVkJywgeyB2aWV3dGFnOiB0aGlzLnZpZXd0YWcgfSk7DQogICAgICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgICAgICAgICAgICB0aGlzLmZvcm1TdGF0ZS5uZXh0KHsgdHlwZTogJ3NhdmUnLCBkYXRhOiBkYXRhIH0pOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIGlmIChzaG93UmVzdWx0SW5mbykgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2Uuc3VjY2Vzcyh7IHRpdGxlOiAnJywgZGVzYzogKGRhdGEuc3JmbWFqb3J0ZXh0ID8gZGF0YS5zcmZtYWpvcnRleHQgOiAnJykgKyAnJm5ic3A75L+d5a2Y5oiQ5Yqf77yBJyB9KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7DQogICAgICAgICAgICB9KS5jYXRjaCgocmVzcG9uc2U6IGFueSkgPT4gew0KICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgICYmIHJlc3BvbnNlLmRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UgfSk7DQogICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ+ezu+e7n+W8guW4uCcgfSk7DQogICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7DQogICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9KQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICog5Yig6ZmkDQogICAgKg0KICAgICogQHB1YmxpYw0KICAgICogQHBhcmFtIHsqfSBbb3B0PXt9XQ0KICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgKi8NCiAgICBwdWJsaWMgcmVtb3ZlKG9wdDpBcnJheTxhbnk+ID0gW10sc2hvd1Jlc3VsdEluZm8/OiBib29sZWFuKTogUHJvbWlzZTxhbnk+IHsNCiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlOiBhbnksIHJlamVjdDogYW55KSA9PiB7DQogICAgICAgICAgICBpZighdGhpcy5yZW1vdmVBY3Rpb24pew0KICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ0FSQ0hJVkFMQ0FUQUxPR1VFRWRpdFZpZXfop4blm77ooajljZVyZW1vdmVBY3Rpb27lj4LmlbDmnKrphY3nva4nIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNvbnN0IGFyZzogYW55ID0gb3B0WzBdOw0KICAgICAgICAgICAgY29uc3QgX3RoaXM6IGFueSA9IHRoaXM7DQogICAgICAgICAgICBPYmplY3QuYXNzaWduKGFyZyx7dmlld3BhcmFtczp0aGlzLnZpZXdwYXJhbXN9KTsNCiAgICAgICAgICAgIHRoaXMuc2VydmljZS5kZWxldGUoX3RoaXMucmVtb3ZlQWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLGFyZywgc2hvd1Jlc3VsdEluZm8pLnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHsNCiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UpIHsNCiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3JlbW92ZScsZGF0YSk7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuZm9ybVN0YXRlLm5leHQoeyB0eXBlOiAncmVtb3ZlJywgZGF0YTogZGF0YSB9KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5kYXRhLmlzbW9kaWZ5ID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5zdWNjZXNzKHsgdGl0bGU6ICcnLCBkZXNjOiAoZGF0YS5zcmZtYWpvcnRleHQgPyBkYXRhLnNyZm1ham9ydGV4dCA6ICcnKSArICcmbmJzcDvliKDpmaTmiJDlip/vvIEnIH0pOw0KICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9KS5jYXRjaCgoZXJyb3I6IGFueSkgPT4gew0KICAgICAgICAgICAgICAgIGNvbnN0IHsgZGF0YTogX2RhdGEgfSA9IGVycm9yOw0KICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiBfZGF0YS50aXRsZSwgZGVzYzogX2RhdGEubWVzc2FnZSB9KTsNCiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOW3peS9nOa1geWQr+WKqA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtsb2NhbGRhdGE9e31dDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgYXN5bmMgd2ZzdGFydChkYXRhOiBhbnksbG9jYWxkYXRhPzphbnkpOiBQcm9taXNlPGFueT4gew0KICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmU6IGFueSwgcmVqZWN0OiBhbnkpID0+IHsNCiAgICAgICAgICAgIGNvbnN0IF90aGlzOiBhbnkgPSB0aGlzOw0KICAgICAgICAgICAgY29uc3QgcG9zdDogUHJvbWlzZTxhbnk+ID0gX3RoaXMuc2F2ZSh7fSxmYWxzZSk7DQogICAgICAgICAgICBwb3N0LnRoZW4oKHJlc3BvbnNlOmFueSkgPT57DQogICAgICAgICAgICAgICAgY29uc3QgYXJnOmFueSA9IHJlc3BvbnNlLmRhdGE7DQogICAgICAgICAgICAgICAgaWYodGhpcy52aWV3cGFyYW1zKXsNCiAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcse3ZpZXdwYXJhbXM6dGhpcy52aWV3cGFyYW1zfSk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdDogUHJvbWlzZTxhbnk+ID0gdGhpcy5zZXJ2aWNlLndmc3RhcnQoX3RoaXMuV0ZTdGFydEFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSxhcmcsIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IsbG9jYWxkYXRhKTsNCiAgICAgICAgICAgICAgICByZXN1bHQudGhlbigocmVzcG9uc2U6IGFueSkgPT4gew0KICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhKXsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJycsIGRlc2M6ICflt6XkvZzmtYHlkK/liqjlpLHotKUsICcgKyByZXNwb25zZS5kYXRhLm1lc3NhZ2UgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmluZm8oeyB0aXRsZTogJycsIGRlc2M6ICflt6XkvZzmtYHlkK/liqjmiJDlip8nIH0pOw0KICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsNCiAgICAgICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7DQogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyAmJiByZXNwb25zZS5kYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogcmVzcG9uc2UuZGF0YS5tZXNzYWdlIH0pOw0KICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICfns7vnu5/lvILluLgnIH0pOw0KICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn57O757uf5byC5bi4JyB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsNCiAgICAgICAgICAgIH0pDQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOW3peS9nOa1geaPkOS6pA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtsb2NhbGRhdGE9e31dDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgYXN5bmMgd2ZzdWJtaXQoZGF0YTogYW55LGxvY2FsZGF0YT86YW55KTogUHJvbWlzZTxhbnk+IHsNCiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlOiBhbnksIHJlamVjdDogYW55KSA9PiB7DQogICAgICAgIGNvbnN0IF90aGlzOiBhbnkgPSB0aGlzOw0KICAgICAgICBjb25zdCBhcmc6IGFueSA9IGRhdGFbMF07DQogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLHt2aWV3cGFyYW1zOnRoaXMudmlld3BhcmFtc30pOw0KICAgICAgICBpZiAoIWFyZy5waW1hcmNoaXZhbGNhdGFsb2d1ZSB8fCBPYmplY3QuaXMoYXJnLnBpbWFyY2hpdmFsY2F0YWxvZ3VlLCAnJykpIHsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCBwb3N0OiBQcm9taXNlPGFueT4gPSBPYmplY3QuaXMoYXJnLnNyZnVmLCAnMScpP3RoaXMuc2VydmljZS51cGRhdGUodGhpcy51cGRhdGVBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksYXJnLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTp0aGlzLnNlcnZpY2UuYWRkKHRoaXMuY3JlYXRlQWN0aW9uLEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksYXJnLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsNCiAgICAgICAgcG9zdC50aGVuKChyZXNwb25zZTphbnkpID0+ew0KICAgICAgICAgICAgICAgIGNvbnN0IGFyZzphbnkgPSByZXNwb25zZS5kYXRhOw0KICAgICAgICAgICAgICAgIC8vIOS/neWtmOWujOaIkFVJ5aSE55CGDQogICAgICAgICAgICAgICAgdGhpcy5vbkZvcm1Mb2FkKGFyZywnc2F2ZScpOw0KICAgICAgICAgICAgICAgIHRoaXMuJGVtaXQoJ3NhdmUnLCBhcmcpOw0KICAgICAgICAgICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5mb3JtU3RhdGUubmV4dCh7IHR5cGU6ICdzYXZlJywgZGF0YTogYXJnIH0pOw0KICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgIC8vIOWHhuWkh+aPkOS6pOWPguaVsA0KICAgICAgICAgICAgICAgIGlmKHRoaXMudmlld3BhcmFtcyl7DQogICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLHt2aWV3cGFyYW1zOnRoaXMudmlld3BhcmFtc30pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAvLyDlvLrliLbooaXlhYVzcmZ3Zm1lbW8NCiAgICAgICAgICAgICAgICBpZih0aGlzLnNyZndmbWVtbyl7DQogICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLHtzcmZ3Zm1lbW86dGhpcy5zcmZ3Zm1lbW99KTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0OiBQcm9taXNlPGFueT4gPSB0aGlzLnNlcnZpY2Uud2ZzdWJtaXQoX3RoaXMuV0ZTdWJtaXRBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksYXJnLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yLGxvY2FsZGF0YSk7DQogICAgICAgICAgICAgICAgcmVzdWx0LnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYocmVzcG9uc2UuZGF0YSl7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICcnLCBkZXNjOiAn5bel5L2c5rWB5o+Q5Lqk5aSx6LSlLCAnICsgcmVzcG9uc2UuZGF0YS5tZXNzYWdlIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHRoaXMub25Gb3JtTG9hZChhcmcsJ3N1Ym1pdCcpOw0KICAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgndmlld2FjdGlvbi9kYXRhc2F2ZWQnLCB7IHZpZXd0YWc6IHRoaXMudmlld3RhZyB9KTsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmluZm8oeyB0aXRsZTogJycsIGRlc2M6ICflt6XkvZzmtYHmj5DkuqTmiJDlip8nIH0pOw0KICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsNCiAgICAgICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7DQogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyAmJiByZXNwb25zZS5kYXRhKSB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogcmVzcG9uc2UuZGF0YS5tZXNzYWdlIH0pOw0KICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICfns7vnu5/lvILluLgnIH0pOw0KICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOw0KICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICAgIH0pLmNhdGNoKChyZXNwb25zZTogYW55KSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsgdGl0bGU6ICfplJnor68nLCBkZXNjOiAn57O757uf5byC5bi4JyB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsNCiAgICAgICAgICAgIH0pDQogICAgICAgIH0pDQogICAgfQ0KDQogICAgLyoqDQogICAgICog6KGo5Y2V6aG55pu05pawDQogICAgICoNCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbW9kZSDnlYzpnaLooYzkuLrlkI3np7ANCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XSDor7fmsYLmlbDmja4NCiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSB1cGRhdGVEZXRhaWxzIOabtOaWsOmhuQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Nob3dsb2FkaW5nXSDmmK/lkKbmmL7npLrliqDovb3nirbmgIENCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgdXBkYXRlRm9ybUl0ZW1zKG1vZGU6IHN0cmluZywgZGF0YTogYW55ID0ge30sIHVwZGF0ZURldGFpbHM6IHN0cmluZ1tdLCBzaG93bG9hZGluZz86IGJvb2xlYW4pOiB2b2lkIHsNCiAgICAgICAgaWYgKCFtb2RlIHx8IChtb2RlICYmIE9iamVjdC5pcyhtb2RlLCAnJykpKSB7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCiAgICAgICAgY29uc3QgYXJnOiBhbnkgPSB7IC4uLmRhdGEgfTsNCiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsdGhpcy52aWV3cGFyYW1zKTsNCiAgICAgICAgY29uc3QgcG9zdDogUHJvbWlzZTxhbnk+ID0gdGhpcy5zZXJ2aWNlLmZyb250TG9naWMobW9kZSxKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLGFyZywgc2hvd2xvYWRpbmcpOw0KICAgICAgICBwb3N0LnRoZW4oKHJlc3BvbnNlOiBhbnkpID0+IHsNCiAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsNCiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoeyB0aXRsZTogJ+mUmeivrycsIGRlc2M6ICfooajljZXpobnmm7TmlrDlpLHotKUnIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSByZXNwb25zZS5kYXRhOw0KICAgICAgICAgICAgY29uc3QgX2RhdGE6IGFueSA9IHt9Ow0KICAgICAgICAgICAgdXBkYXRlRGV0YWlscy5mb3JFYWNoKChuYW1lOiBzdHJpbmcpID0+IHsNCiAgICAgICAgICAgICAgICBpZiAoIWRhdGEuaGFzT3duUHJvcGVydHkobmFtZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKF9kYXRhLCB7IFtuYW1lXTogZGF0YVtuYW1lXSB9KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgdGhpcy5zZXRGb3JtRW5hYmxlQ29uZChfZGF0YSk7DQogICAgICAgICAgICB0aGlzLmZpbGxGb3JtKF9kYXRhLCd1cGRhdGVGb3JtSXRlbScpOw0KICAgICAgICAgICAgdGhpcy5mb3JtTG9naWMoeyBuYW1lOiAnJywgbmV3VmFsOiBudWxsLCBvbGRWYWw6IG51bGwgfSk7DQogICAgICAgICAgICB0aGlzLmRhdGFDaGFuZy5uZXh0KEpTT04uc3RyaW5naWZ5KHRoaXMuZGF0YSkpOw0KICAgICAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMuZm9ybVN0YXRlLm5leHQoeyB0eXBlOiAndXBkYXRlZm9ybWl0ZW0nLCB1Zmltb2RlOiBhcmcuc3JmdWZpbW9kZSwgZGF0YTogX2RhdGEgfSk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSkuY2F0Y2goKHJlc3BvbnNlOiBhbnkpID0+IHsNCiAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogcmVzcG9uc2UuZGF0YS5tZXNzYWdlIH0pOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgew0KICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7IHRpdGxlOiAn6ZSZ6K+vJywgZGVzYzogJ+ezu+e7n+W8guW4uCcgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDlm57ovabkuovku7YNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIG9uRW50ZXIoJGV2ZW50OiBhbnkpOiB2b2lkIHsNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkv53lrZjlubbpgIDlh7oNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7YW55W119IGFyZ3MNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgc2F2ZUFuZEV4aXQoZGF0YTphbnlbXSk6UHJvbWlzZTxhbnk+ew0KICAgICAgICBsZXQgX3RoaXMgPSB0aGlzOw0KICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmU6IGFueSwgcmVqZWN0OiBhbnkpID0+ew0KICAgICAgICAgICAgbGV0IGFyZzogYW55ID0ge307DQogICAgICAgICAgICBpZihkYXRhICYmIGRhdGEubGVuZ3RoID4gMCl7DQogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsZGF0YVswXSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBfdGhpcy5jdXJyZW50QWN0aW9uID0gInNhdmVBbmRFeGl0IjsNCiAgICAgICAgICAgIF90aGlzLnNhdmUoW2FyZ10pLnRoZW4oKHJlcykgPT57DQogICAgICAgICAgICAgICAgaWYocmVzKXsNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2xvc2VWaWV3KHJlcy5kYXRhKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmVzb2x2ZShyZXMpOw0KICAgICAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PnsNCiAgICAgICAgICAgICAgICByZWplY3QoZXJyb3IpOw0KICAgICAgICAgICAgfSkNCiAgICAgICAgfSkNCiAgICB9DQoNCiAgICAvKioNCiAgICAgKiDkv53lrZjlubbmlrDlu7oNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7YW55W119IGFyZ3MNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8NCiAgICBwdWJsaWMgc2F2ZUFuZE5ldyhkYXRhOmFueVtdKTpQcm9taXNlPGFueT57DQogICAgICAgIGxldCBfdGhpcyA9IHRoaXM7DQogICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZTogYW55LCByZWplY3Q6IGFueSkgPT57DQogICAgICAgICAgICBsZXQgYXJnOiBhbnkgPSB7fTsNCiAgICAgICAgICAgIGlmKGRhdGEgJiYgZGF0YS5sZW5ndGggPiAwKXsNCiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGFyZyxkYXRhWzBdKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF90aGlzLmN1cnJlbnRBY3Rpb24gPSAic2F2ZUFuZE5ldyI7DQogICAgICAgICAgICBfdGhpcy5zYXZlKFthcmddKS50aGVuKChyZXMpID0+ew0KICAgICAgICAgICAgICAgIF90aGlzLlJlc2V0RGF0YShyZXMpOw0KICAgICAgICAgICAgICAgIF90aGlzLmxvYWREcmFmdCh7fSk7DQogICAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+ew0KICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7DQogICAgICAgICAgICB9KQ0KICAgICAgICB9KQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOWIoOmZpOW5tumAgOWHug0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gYXJncw0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyByZW1vdmVBbmRFeGl0KGRhdGE6YW55W10pOlByb21pc2U8YW55PnsNCiAgICAgICAgbGV0IF90aGlzID0gdGhpczsNCiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlOiBhbnksIHJlamVjdDogYW55KSA9PnsNCiAgICAgICAgICAgIGxldCBhcmc6IGFueSA9IHt9Ow0KICAgICAgICAgICAgaWYoZGF0YSAmJiBkYXRhLmxlbmd0aCA+IDApew0KICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLGRhdGFbMF0pOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgX3RoaXMucmVtb3ZlKFthcmddKS50aGVuKChyZXMpID0+ew0KICAgICAgICAgICAgICAgIGlmKHJlcyl7DQogICAgICAgICAgICAgICAgICBfdGhpcy5jbG9zZVZpZXcocmVzLmRhdGEpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICByZXNvbHZlKHJlcyk7DQogICAgICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+ew0KICAgICAgICAgICAgICAgIHJlamVjdChlcnJvcik7DQogICAgICAgICAgICB9KQ0KICAgICAgICB9KQ0KICAgIH0NCg0KICAgIC8qKg0KICAgICog5YWz57O755WM6Z2i5pWw5o2u5L+d5a2Y5a6M5oiQDQogICAgKg0KICAgICogQHBhcmFtIHthbnl9ICRldmVudA0KICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgKi8NCiAgICBwdWJsaWMgZHJkYXRhc2F2ZWQoJGV2ZW50OmFueSl7DQogICAgICAgIGxldCBfdGhpcyA9IHRoaXM7DQogICAgICAgIHRoaXMuZHJjb3VudGVyLS07DQogICAgICAgIGlmKHRoaXMuZHJjb3VudGVyID09PSAwKXsNCiAgICAgICAgICAgIHRoaXMuc2F2ZSh0aGlzLmRyc2F2ZW9wdCwgdW5kZWZpbmVkLCBmYWxzZSkudGhlbigocmVzKSA9PnsNCiAgICAgICAgICAgICAgICB0aGlzLnNhdmVTdGF0ZShyZXMpOw0KICAgICAgICAgICAgICAgIHRoaXMuZHJzYXZlb3B0ID0ge307DQogICAgICAgICAgICAgICAgaWYoT2JqZWN0LmlzKF90aGlzLmN1cnJlbnRBY3Rpb24sICJzYXZlQW5kTmV3Iikpew0KICAgICAgICAgICAgICAgICAgICBfdGhpcy5SZXNldERhdGEocmVzKTsNCiAgICAgICAgICAgICAgICAgICAgX3RoaXMubG9hZERyYWZ0KHt9KTsNCiAgICAgICAgICAgICAgICB9ZWxzZSBpZihPYmplY3QuaXMoX3RoaXMuY3VycmVudEFjdGlvbiwgInNhdmVBbmRFeGl0Iikpew0KICAgICAgICAgICAgICAgICAgICBpZihyZXMpew0KICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2xvc2VWaWV3KHJlcy5kYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgLyoqDQogICAgICog5paw5bu66buY6K6k5YC8DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovDQogICAgcHVibGljIGNyZWF0ZURlZmF1bHQoKXsgICAgICAgICAgICAgICAgICAgIA0KICAgIH0NCg0KICAgIC8qKg0KICAgICAqIOabtOaWsOm7mOiupOWAvA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLw0KICAgIHB1YmxpYyB1cGRhdGVEZWZhdWx0KCl7ICAgICAgICAgICAgICAgICAgICANCiAgICB9DQoNCiAgICANCn0NCg=="},null]}