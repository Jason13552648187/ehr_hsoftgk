{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js??ref--14-3!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-archives\\pimrecord-treeview\\pimrecord-treeview-base.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-archives\\pimrecord-treeview\\pimrecord-treeview-base.vue","mtime":1630509411369},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5kZXgtb2YiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb21lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5kZWZpbmUtcHJvcGVydGllcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5kZWZpbmUtcHJvcGVydHkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuaXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNwbGl0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjsKaW1wb3J0IF9nZXRQcm90b3R5cGVPZiBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgppbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gInRzbGliIjsKaW1wb3J0IHsgVnVlLCBDb21wb25lbnQsIFByb3AsIFByb3ZpZGUsIFdhdGNoIH0gZnJvbSAndnVlLXByb3BlcnR5LWRlY29yYXRvcic7CmltcG9ydCB7IFV0aWwgfSBmcm9tICdAL3V0aWxzJzsKaW1wb3J0IFBpbUFyY2hpdmVzU2VydmljZSBmcm9tICdAL3NlcnZpY2UvcGltLWFyY2hpdmVzL3BpbS1hcmNoaXZlcy1zZXJ2aWNlJzsKaW1wb3J0IFBJTVJlY29yZFNlcnZpY2UgZnJvbSAnLi9waW1yZWNvcmQtdHJlZXZpZXctc2VydmljZSc7Cgp2YXIgUElNUmVjb3JkQmFzZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9WdWUpIHsKICBfaW5oZXJpdHMoUElNUmVjb3JkQmFzZSwgX1Z1ZSk7CgogIGZ1bmN0aW9uIFBJTVJlY29yZEJhc2UoKSB7CiAgICB2YXIgX3RoaXMyOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQSU1SZWNvcmRCYXNlKTsKCiAgICBfdGhpczIgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoUElNUmVjb3JkQmFzZSkuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgICAvKioNCiAgICAgKiDorqHmlbDlmajmnI3liqHlr7nosaHpm4blkIgNCiAgICAgKg0KICAgICAqIEB0eXBlIHtBcnJheTwqPn0NCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5jb3VudGVyU2VydmljZUFycmF5ID0gW107CiAgICAvKioNCiAgICAgKiDlu7rmnoTpg6jku7bmnI3liqHlr7nosaENCiAgICAgKg0KICAgICAqIEB0eXBlIHtQSU1SZWNvcmRTZXJ2aWNlfQ0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogICAgX3RoaXMyLnNlcnZpY2UgPSBuZXcgUElNUmVjb3JkU2VydmljZSh7CiAgICAgICRzdG9yZTogX3RoaXMyLiRzdG9yZQogICAgfSk7CiAgICAvKioNCiAgICAgKiDlrp7kvZPmnI3liqHlr7nosaENCiAgICAgKg0KICAgICAqIEB0eXBlIHtQaW1BcmNoaXZlc1NlcnZpY2V9DQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuYXBwRW50aXR5U2VydmljZSA9IG5ldyBQaW1BcmNoaXZlc1NlcnZpY2UoewogICAgICAkc3RvcmU6IF90aGlzMi4kc3RvcmUKICAgIH0pOwogICAgLyoqDQogICAgICog5Yid5aeL5YyW5a6M5oiQDQogICAgICoNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5pbml0ZWQgPSBmYWxzZTsKICAgIC8qKg0KICAgICAqIOW3sumAieS4reaVsOaNrumbhuWQiA0KICAgICAqDQogICAgICogQHR5cGUgeyp9DQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuc2VsZWN0ZWROb2RlcyA9IFtdOwogICAgLyoqDQogICAgICog5b2T5YmN6YCJ5Lit5pWw5o2u6aG5DQogICAgICoNCiAgICAgKiBAdHlwZSB7Kn0NCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5jdXJyZW50c2VsZWN0ZWROb2RlID0ge307CiAgICAvKioNCiAgICAgKiDlm57mmL7pgInkuK3mlbDmja7pm4blkIgNCiAgICAgKg0KICAgICAqIEB0eXBlIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogICAgX3RoaXMyLmVjaG9zZWxlY3RlZE5vZGVzID0gX3RoaXMyLnNlbGVjdGVkRGF0YSA/IF90aGlzMi5pc1NpbmdsZVNlbGVjdCA/IFtKU09OLnBhcnNlKF90aGlzMi5zZWxlY3RlZERhdGEpWzBdXSA6IEpTT04ucGFyc2UoX3RoaXMyLnNlbGVjdGVkRGF0YSkgOiBbXTsKICAgIC8qKg0KICAgICAqIOi/h+a7pOWxnuaApw0KICAgICAqDQogICAgICogQHR5cGUge3N0cmluZ30NCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5zcmZub2RlZmlsdGVyID0gJyc7CiAgICAvKioNCiAgICAgKiDpu5jorqTovpPlh7rlm77moIcNCiAgICAgKg0KICAgICAqIEB0eXBlIHtib29sZWFufQ0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogICAgX3RoaXMyLmlzT3V0cHV0SWNvbkRlZmF1bHQgPSB0cnVlOwogICAgLyoqDQogICAgICog5pWw5o2u5bGV5byA5Li76ZSuDQogICAgICoNCiAgICAgKiBAdHlwZSB7c3RyaW5nW119DQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuZXhwYW5kZWRLZXlzID0gW107CiAgICByZXR1cm4gX3RoaXMyOwogIH0KICAvKioNCiAgICog6I635Y+W6YOo5Lu257G75Z6LDQogICAqDQogICAqIEByZXR1cm5zIHtzdHJpbmd9DQogICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKFBJTVJlY29yZEJhc2UsIFt7CiAgICBrZXk6ICJnZXRDb250cm9sVHlwZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29udHJvbFR5cGUoKSB7CiAgICAgIHJldHVybiAnVFJFRVZJRVcnOwogICAgfQogICAgLyoqDQogICAgICog5YWz6Zet6KeG5Zu+DQogICAgICoNCiAgICAgKiBAcGFyYW0ge2FueX0gYXJncw0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImNsb3NlVmlldyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvc2VWaWV3KGFyZ3MpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLiRlbWl0KCdjbG9zZXZpZXcnLCBbYXJnc10pOwogICAgfQogICAgLyoqDQogICAgICogIOiuoeaVsOWZqOWIt+aWsA0KICAgICAqDQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY291bnRlclJlZnJlc2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvdW50ZXJSZWZyZXNoKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLmNvdW50ZXJTZXJ2aWNlQXJyYXkgJiYgX3RoaXMuY291bnRlclNlcnZpY2VBcnJheS5sZW5ndGggPiAwKSB7CiAgICAgICAgX3RoaXMuY291bnRlclNlcnZpY2VBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpZiAoaXRlbS5yZWZyZXNoRGF0YSAmJiBpdGVtLnJlZnJlc2hEYXRhIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgICAgaXRlbS5yZWZyZXNoRGF0YSgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5blpJrpobnmlbDmja4NCiAgICAgKg0KICAgICAqIEByZXR1cm5zIHthbnlbXX0NCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXREYXRhcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YXMoKSB7CiAgICAgIHJldHVybiBbdGhpcy5jdXJyZW50c2VsZWN0ZWROb2RlXTsKICAgIH0KICAgIC8qKg0KICAgICAqIOiOt+WPluWNlemhueagkQ0KICAgICAqDQogICAgICogQHJldHVybnMgeyp9DQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YSgpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudHNlbGVjdGVkTm9kZTsKICAgIH0KICAgIC8qKg0KICAgICAqIOmAieS4reWAvOWPmOWMlg0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBuZXdWYWwNCiAgICAgKiBAcGFyYW0geyp9IG9sZFZhbA0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uVmFsdWVDaGFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uVmFsdWVDaGFuZ2UobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgdGhpcy5lY2hvc2VsZWN0ZWROb2RlcyA9IG5ld1ZhbCA/IHRoaXMuaXNTaW5nbGVTZWxlY3QgPyBKU09OLnBhcnNlKG5ld1ZhbClbMF0gOiBKU09OLnBhcnNlKG5ld1ZhbCkgOiBbXTsKICAgICAgdGhpcy5zZWxlY3RlZE5vZGVzID0gW107CgogICAgICBpZiAodGhpcy5lY2hvc2VsZWN0ZWROb2Rlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIEFsbG5vZGVzT2JqID0gdGhpcy4kcmVmcy50cmVlZXhwYmFyX3RyZWUuc3RvcmUubm9kZXNNYXA7CiAgICAgICAgdmFyIEFsbG5vZGVzQXJyYXkgPSBbXTsKCiAgICAgICAgZm9yICh2YXIga2V5IGluIEFsbG5vZGVzT2JqKSB7CiAgICAgICAgICBpZiAoQWxsbm9kZXNPYmouaGFzT3duUHJvcGVydHkoa2V5KSkgewogICAgICAgICAgICBBbGxub2Rlc0FycmF5LnB1c2goQWxsbm9kZXNPYmpba2V5XS5kYXRhKTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIHRoaXMuc2V0RGVmYXVsdFNlbGVjdGlvbihBbGxub2Rlc0FycmF5KTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog6YCJ5Lit5pWw5o2u5Y+Y5pu05LqL5Lu2DQogICAgICoNCiAgICAgKiBAcHVibGljDQogICAgICogQHBhcmFtIHsqfSBkYXRhDQogICAgICogQHBhcmFtIHsqfSBkYXRhIOW9k+WJjeiKgueCueWvueW6lOS8oOWFpeWvueixoQ0KICAgICAqIEBwYXJhbSB7Kn0gY2hlY2tlZFN0YXRlIOagkeebruWJjemAieS4reeKtuaAgeWvueixoQ0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uQ2hlY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQ2hlY2soZGF0YSwgY2hlY2tlZFN0YXRlKSB7CiAgICAgIC8vIOWkhOeQhuWkmumAieaVsOaNrgogICAgICBpZiAoIXRoaXMuaXNTaW5nbGVTZWxlY3QpIHsKICAgICAgICB2YXIgbGVhZk5vZGVzID0gY2hlY2tlZFN0YXRlLmNoZWNrZWROb2Rlcy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmxlYWY7CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5zZWxlY3RlZE5vZGVzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShsZWFmTm9kZXMpKTsKICAgICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGVkTm9kZXMpOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDpgInkuK3mlbDmja7lj5jmm7Tkuovku7YNCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0geyp9IGRhdGEg6IqC54K55a+55bqU5Lyg5YWl5a+56LGhDQogICAgICogQHBhcmFtIHsqfSBub2RlIOiKgueCueWvueW6lG5vZGXlr7nosaENCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZWxlY3Rpb25DaGFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdGlvbkNoYW5nZShkYXRhLCBub2RlKSB7CiAgICAgIC8vIOemgeeUqOmhueWkhOeQhgogICAgICBpZiAoZGF0YS5kaXNhYmxlZCkgewogICAgICAgIG5vZGUuaXNDdXJyZW50ID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOWPquWkhOeQhuacgOW6leWxguWtkOiKgueCuQoKCiAgICAgIGlmICh0aGlzLmlzQnJhbmNoQXZhaWxhYmxlIHx8IGRhdGEubGVhZikgewogICAgICAgIHRoaXMuY3VycmVudHNlbGVjdGVkTm9kZSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOyAvLyDljZXpgInnm7TmjqXmm7/mjaIKCiAgICAgICAgaWYgKHRoaXMuaXNTaW5nbGVTZWxlY3QpIHsKICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlcyA9IFt0aGlzLmN1cnJlbnRzZWxlY3RlZE5vZGVdOwogICAgICAgICAgdGhpcy4kZW1pdCgnc2VsZWN0aW9uY2hhbmdlJywgdGhpcy5zZWxlY3RlZE5vZGVzKTsKICAgICAgICB9IC8vIOWkmumAieeUqGNoZWNr5pa55rOVCgogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiBWdWXlo7DmmI7lkajmnJ8o5aSE55CG57uE5Lu255qE6L6T5YWl5bGe5oCnKQ0KICAgICAqDQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY3JlYXRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgICAgdGhpcy5hZnRlckNyZWF0ZWQoKTsKICAgIH0KICAgIC8qKg0KICAgICAqIOaJp+ihjGNyZWF0ZWTlkI7nmoTpgLvovpENCiAgICAgKg0KICAgICAqICBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJhZnRlckNyZWF0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFmdGVyQ3JlYXRlZCgpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBpZiAodGhpcy52aWV3U3RhdGUpIHsKICAgICAgICB0aGlzLnZpZXdTdGF0ZUV2ZW50ID0gdGhpcy52aWV3U3RhdGUuc3Vic2NyaWJlKGZ1bmN0aW9uIChfcmVmKSB7CiAgICAgICAgICB2YXIgdGFnID0gX3JlZi50YWcsCiAgICAgICAgICAgICAgYWN0aW9uID0gX3JlZi5hY3Rpb24sCiAgICAgICAgICAgICAgZGF0YSA9IF9yZWYuZGF0YTsKCiAgICAgICAgICBpZiAoIU9iamVjdC5pcyh0YWcsIF90aGlzMy5uYW1lKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygnbG9hZCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXMzLmluaXRlZCA9IGZhbHNlOwoKICAgICAgICAgICAgX3RoaXMzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgX3RoaXMzLmluaXRlZCA9IHRydWU7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChPYmplY3QuaXMoJ2ZpbHRlcicsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXMzLnNyZm5vZGVmaWx0ZXIgPSBkYXRhLnNyZm5vZGVmaWx0ZXI7CgogICAgICAgICAgICBfdGhpczMucmVmcmVzaF9hbGwoKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdyZWZyZXNoX3BhcmVudCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXMzLnJlZnJlc2hfcGFyZW50KCk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOWvueagkeiKgueCuei/m+ihjOetm+mAieaTjeS9nA0KICAgICAqIEBtZW1iZXJvZiBPcmRlclRyZWUNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZmlsdGVyTm9kZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmlsdGVyTm9kZSh2YWx1ZSwgZGF0YSkgewogICAgICBpZiAoIXZhbHVlKSByZXR1cm4gdHJ1ZTsKICAgICAgcmV0dXJuIGRhdGEudGV4dC5pbmRleE9mKHZhbHVlKSAhPT0gLTE7CiAgICB9CiAgICAvKioNCiAgICAgKiB2dWUg55Sf5ZG95ZGo5pyfDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkZXN0cm95ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHsKICAgICAgdGhpcy5hZnRlckRlc3Ryb3koKTsKICAgIH0KICAgIC8qKg0KICAgICAqIOaJp+ihjGRlc3Ryb3llZOWQjueahOmAu+i+kQ0KICAgICAqDQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYWZ0ZXJEZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZnRlckRlc3Ryb3koKSB7CiAgICAgIGlmICh0aGlzLnZpZXdTdGF0ZUV2ZW50KSB7CiAgICAgICAgdGhpcy52aWV3U3RhdGVFdmVudC51bnN1YnNjcmliZSgpOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDliLfmlrDmlbDmja4NCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInJlZnJlc2hfYWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWZyZXNoX2FsbCgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB0aGlzLmluaXRlZCA9IGZhbHNlOwogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM0LmluaXRlZCA9IHRydWU7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5Yi35paw54i26IqC54K5DQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZWZyZXNoX3BhcmVudCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVmcmVzaF9wYXJlbnQoKSB7CiAgICAgIGlmIChPYmplY3Qua2V5cyh0aGlzLmN1cnJlbnRzZWxlY3RlZE5vZGUpLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHRyZWUgPSB0aGlzLiRyZWZzLnRyZWVleHBiYXJfdHJlZTsKICAgICAgdmFyIG5vZGUgPSB0cmVlLmdldE5vZGUodGhpcy5jdXJyZW50c2VsZWN0ZWROb2RlLmlkKTsKCiAgICAgIGlmICghbm9kZSB8fCAhbm9kZS5wYXJlbnQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBjdXJOb2RlID0ge307CiAgICAgIHZhciBfcGFyZW50ID0gbm9kZS5wYXJlbnQ7CiAgICAgIGN1ck5vZGUgPSBVdGlsLmRlZXBPYmplY3RNZXJnZShjdXJOb2RlLCBfcGFyZW50KTsKICAgICAgdmFyIHRlbXBDb250ZXh0ID0ge307CgogICAgICBpZiAoY3VyTm9kZS5kYXRhICYmIGN1ck5vZGUuZGF0YS5zcmZhcHBjdHgpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHRlbXBDb250ZXh0LCBjdXJOb2RlLmRhdGEuc3JmYXBwY3R4KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBPYmplY3QuYXNzaWduKHRlbXBDb250ZXh0LCB0aGlzLmNvbnRleHQpOwogICAgICB9CgogICAgICB2YXIgaWQgPSBfcGFyZW50LmtleSA/IF9wYXJlbnQua2V5IDogJyMnOwogICAgICB2YXIgcGFyYW0gPSB7CiAgICAgICAgc3Jmbm9kZWlkOiBpZAogICAgICB9OwogICAgICB0aGlzLnJlZnJlc2hfbm9kZSh0ZW1wQ29udGV4dCwgcGFyYW0sIHRydWUpOwogICAgfQogICAgLyoqDQogICAgICog5pWw5o2u5Yqg6L29DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5vZGUNCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJsb2FkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBub2RlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKICAgICAgdmFyIHJlc29sdmUgPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDsKCiAgICAgIGlmIChub2RlLmRhdGEgJiYgbm9kZS5kYXRhLmNoaWxkcmVuKSB7CiAgICAgICAgcmVzb2x2ZShub2RlLmRhdGEuY2hpbGRyZW4pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICBzcmZub2RlaWQ6IG5vZGUuZGF0YSAmJiBub2RlLmRhdGEuaWQgPyBub2RlLmRhdGEuaWQgOiAiIyIsCiAgICAgICAgc3Jmbm9kZWZpbHRlcjogdGhpcy5zcmZub2RlZmlsdGVyCiAgICAgIH07CiAgICAgIHZhciB0ZW1wVmlld1BhcmFtcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy52aWV3cGFyYW1zKSk7CiAgICAgIHZhciBjdXJOb2RlID0ge307CiAgICAgIGN1ck5vZGUgPSBVdGlsLmRlZXBPYmplY3RNZXJnZShjdXJOb2RlLCBub2RlKTsKICAgICAgdmFyIHRlbXBDb250ZXh0ID0gdGhpcy5jb21wdXRlY3VyTm9kZUNvbnRleHQoY3VyTm9kZSk7CgogICAgICBpZiAoY3VyTm9kZS5kYXRhICYmIGN1ck5vZGUuZGF0YS5zcmZwYXJlbnRkZW5hbWUpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHRlbXBDb250ZXh0LCB7CiAgICAgICAgICBzcmZwYXJlbnRkZW5hbWU6IGN1ck5vZGUuZGF0YS5zcmZwYXJlbnRkZW5hbWUKICAgICAgICB9KTsKICAgICAgICBPYmplY3QuYXNzaWduKHRlbXBWaWV3UGFyYW1zLCB7CiAgICAgICAgICBzcmZwYXJlbnRkZW5hbWU6IGN1ck5vZGUuZGF0YS5zcmZwYXJlbnRkZW5hbWUKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgaWYgKGN1ck5vZGUuZGF0YSAmJiBjdXJOb2RlLmRhdGEuc3JmcGFyZW50a2V5KSB7CiAgICAgICAgT2JqZWN0LmFzc2lnbih0ZW1wQ29udGV4dCwgewogICAgICAgICAgc3JmcGFyZW50a2V5OiBjdXJOb2RlLmRhdGEuc3JmcGFyZW50a2V5CiAgICAgICAgfSk7CiAgICAgICAgT2JqZWN0LmFzc2lnbih0ZW1wVmlld1BhcmFtcywgewogICAgICAgICAgc3JmcGFyZW50a2V5OiBjdXJOb2RlLmRhdGEuc3JmcGFyZW50a2V5CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIE9iamVjdC5hc3NpZ24ocGFyYW1zLCB7CiAgICAgICAgdmlld3BhcmFtczogdGVtcFZpZXdQYXJhbXMKICAgICAgfSk7CiAgICAgIHRoaXMuc2VydmljZS5nZXROb2Rlcyh0ZW1wQ29udGV4dCwgcGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIF90aGlzNS4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgdGl0bGU6ICLplJnor68iLAogICAgICAgICAgICBkZXNjOiByZXNwb25zZS5pbmZvCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXNvbHZlKFtdKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBfaXRlbXMgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBfdGhpczUuZm9ybWF0RXhwYW5kZWQoX2l0ZW1zKTsKCiAgICAgICAgcmVzb2x2ZShfdG9Db25zdW1hYmxlQXJyYXkoX2l0ZW1zKSk7CiAgICAgICAgdmFyIGlzUm9vdCA9IE9iamVjdC5pcyhub2RlLmxldmVsLCAwKTsKICAgICAgICB2YXIgaXNTZWxlY3RlZEFsbCA9IG5vZGUuY2hlY2tlZDsKCiAgICAgICAgX3RoaXM1LnNldERlZmF1bHRTZWxlY3Rpb24oX2l0ZW1zLCBpc1Jvb3QsIGlzU2VsZWN0ZWRBbGwpOwoKICAgICAgICBfdGhpczUuJGVtaXQoImxvYWQiLCBfaXRlbXMpOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICByZXNvbHZlKFtdKTsKCiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBfdGhpczUuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICB0aXRsZTogIumUmeivryIsCiAgICAgICAgICBkZXNjOiByZXNwb25zZS5pbmZvCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6K6h566X5b2T5YmN6IqC54K555qE5LiK5LiL5paHDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IGN1ck5vZGUg5b2T5YmN6IqC54K5DQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY29tcHV0ZWN1ck5vZGVDb250ZXh0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wdXRlY3VyTm9kZUNvbnRleHQoY3VyTm9kZSkgewogICAgICB2YXIgdGVtcENvbnRleHQgPSB7fTsKCiAgICAgIGlmIChjdXJOb2RlICYmIGN1ck5vZGUuZGF0YSAmJiBjdXJOb2RlLmRhdGEuc3JmYXBwY3R4KSB7CiAgICAgICAgdGVtcENvbnRleHQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGN1ck5vZGUuZGF0YS5zcmZhcHBjdHgpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0ZW1wQ29udGV4dCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0ZW1wQ29udGV4dDsKICAgIH0KICAgIC8qKg0KICAgICAqIOWIt+aWsOWKn+iDvQ0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gYXJncw0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInJlZnJlc2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZnJlc2goYXJncykgewogICAgICB0aGlzLnJlZnJlc2hfYWxsKCk7CiAgICB9CiAgICAvKioNCiAgICAgKiDliLfmlrDoioLngrkNCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0geyp9IFtjdXJDb250ZXh0XSDlvZPliY3oioLngrnkuIrkuIvmlocNCiAgICAgKiBAcGFyYW0geyp9IFthcmc9e31dIOW9k+WJjeiKgueCuemZhOWKoOWPguaVsA0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gcGFyZW50bm9kZSDmmK/lkKbmmK/liLfmlrDniLboioLngrkNCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZWZyZXNoX25vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlZnJlc2hfbm9kZShjdXJDb250ZXh0KSB7CiAgICAgIHZhciBfdGhpczYgPSB0aGlzOwoKICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciBwYXJlbnRub2RlID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgICAgIHZhciBpZCA9IGFyZy5zcmZub2RlaWQ7CiAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCB7CiAgICAgICAgdmlld3BhcmFtczogdGhpcy52aWV3cGFyYW1zCiAgICAgIH0pOwogICAgICB2YXIgZ2V0ID0gdGhpcy5zZXJ2aWNlLmdldE5vZGVzKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGFyZyk7CiAgICAgIGdldC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIF90aGlzNi4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICBkZXNjOiByZXNwb25zZS5pbmZvCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgX2l0ZW1zID0gX3RvQ29uc3VtYWJsZUFycmF5KHJlc3BvbnNlLmRhdGEpOwoKICAgICAgICBfdGhpczYuZm9ybWF0RXhwYW5kZWQoX2l0ZW1zKTsKCiAgICAgICAgdmFyIHRyZWUgPSBfdGhpczYuJHJlZnMudHJlZWV4cGJhcl90cmVlOwogICAgICAgIHRyZWUudXBkYXRlS2V5Q2hpbGRyZW4oaWQsIF9pdGVtcyk7CgogICAgICAgIGlmIChwYXJlbnRub2RlKSB7CiAgICAgICAgICBfdGhpczYuY3VycmVudHNlbGVjdGVkTm9kZSA9IHt9OwogICAgICAgIH0KCiAgICAgICAgX3RoaXM2LnNldERlZmF1bHRTZWxlY3Rpb24oX2l0ZW1zKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBfdGhpczYuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICBkZXNjOiByZXNwb25zZS5pbmZvCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6buY6K6k5bGV5byA6IqC54K5DQogICAgICoNCiAgICAgKiBAcHVibGljDQogICAgICogQHBhcmFtIHthbnlbXX0gaXRlbXMNCiAgICAgKiBAcmV0dXJucyB7YW55W119DQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZm9ybWF0RXhwYW5kZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZvcm1hdEV4cGFuZGVkKGl0ZW1zKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdmFyIGRhdGEgPSBbXTsKICAgICAgaXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIGlmIChpdGVtLmV4cGFuZGVkIHx8IGl0ZW0uY2hpbGRyZW4gJiYgaXRlbS5jaGlsZHJlbi5sZW5ndGggPiAwKSB7CiAgICAgICAgICBfdGhpczcuZXhwYW5kZWRLZXlzLnB1c2goaXRlbS5pZCk7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgcmV0dXJuIGRhdGE7CiAgICB9CiAgICAvKioNCiAgICAgKiDorr7nva7pu5jorqTpgInkuK0s5Zue5pi+5pWw6aG577yM6YCJ5Lit5omA5pyJ5a2Q6IqC54K5DQogICAgICoNCiAgICAgKiBAcGFyYW0ge2FueVtdfSBpdGVtcyDlvZPliY3oioLngrnmiYDmnInlrZDoioLngrnpm4blkIgNCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzUm9vdCDmmK/lkKbmmK/liqDovb3moLnoioLngrkNCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IGlzU2VsZWN0ZWRBbGwg5piv5ZCm6YCJ5Lit5omA5pyJ5a2Q6IqC54K5DQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2V0RGVmYXVsdFNlbGVjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RGVmYXVsdFNlbGVjdGlvbihpdGVtcykgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHZhciBpc1Jvb3QgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwogICAgICB2YXIgaXNTZWxlY3RlZEFsbCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDogZmFsc2U7CgogICAgICBpZiAoaXRlbXMubGVuZ3RoID09IDApIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBkZWZhdWx0RGF0YTsgLy8g5a+86Iiq5Lit6YCJ5Lit56ys5LiA5p2h6YWN572u55qE6buY6K6k6YCJ5LitLOayoeaciemAieS4reesrOS4gOadoQoKICAgICAgaWYgKHRoaXMuaXNTZWxlY3RGaXJzdERlZmF1bHQpIHsKICAgICAgICBpZiAodGhpcy5pc1NpbmdsZVNlbGVjdCkgewogICAgICAgICAgdmFyIGluZGV4ID0gaXRlbXMuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBpdGVtLnNlbGVjdGVkOwogICAgICAgICAgfSk7CgogICAgICAgICAgaWYgKGluZGV4ID09PSAtMSkgewogICAgICAgICAgICBpZiAoaXNSb290KSB7CiAgICAgICAgICAgICAgaW5kZXggPSAwOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGRlZmF1bHREYXRhID0gaXRlbXNbaW5kZXhdOwogICAgICAgICAgdGhpcy5zZXRUcmVlTm9kZUhpZ2hMaWdodChkZWZhdWx0RGF0YSk7CiAgICAgICAgICB0aGlzLmN1cnJlbnRzZWxlY3RlZE5vZGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRlZmF1bHREYXRhKSk7CgogICAgICAgICAgaWYgKHRoaXMuaXNCcmFuY2hBdmFpbGFibGUgfHwgZGVmYXVsdERhdGEubGVhZikgewogICAgICAgICAgICB0aGlzLnNlbGVjdGVkTm9kZXMgPSBbdGhpcy5jdXJyZW50c2VsZWN0ZWROb2RlXTsKICAgICAgICAgICAgdGhpcy4kZW1pdCgnc2VsZWN0aW9uY2hhbmdlJywgdGhpcy5zZWxlY3RlZE5vZGVzKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy8g5bey6YCJ5pWw5o2u55qE5Zue5pi+CgoKICAgICAgaWYgKHRoaXMuZWNob3NlbGVjdGVkTm9kZXMgJiYgdGhpcy5lY2hvc2VsZWN0ZWROb2Rlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIGNoZWNrZWROb2RlcyA9IGl0ZW1zLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIF90aGlzOC5lY2hvc2VsZWN0ZWROb2Rlcy5zb21lKGZ1bmN0aW9uICh2YWwpIHsKICAgICAgICAgICAgaWYgKE9iamVjdC5pcyhpdGVtLnNyZmtleSwgdmFsLnNyZmtleSkgJiYgT2JqZWN0LmlzKGl0ZW0uc3JmbWFqb3J0ZXh0LCB2YWwuc3JmbWFqb3J0ZXh0KSkgewogICAgICAgICAgICAgIHZhbC51c2VkID0gdHJ1ZTsKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSk7CgogICAgICAgIGlmIChjaGVja2VkTm9kZXMubGVuZ3RoID4gMCkgewogICAgICAgICAgdGhpcy5lY2hvc2VsZWN0ZWROb2RlcyA9IHRoaXMuZWNob3NlbGVjdGVkTm9kZXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiAhaXRlbS51c2VkOwogICAgICAgICAgfSk7IC8vIOeItuiKgueCuemAieS4reaXtu+8jOS4jemcgOimgeaJp+ihjOi/meaute+8jOS8mumAieS4reaJgOacieWtkOiKgueCuQoKICAgICAgICAgIGlmICghaXNTZWxlY3RlZEFsbCkgewogICAgICAgICAgICBpZiAodGhpcy5pc1NpbmdsZVNlbGVjdCkgewogICAgICAgICAgICAgIHRoaXMuc2V0VHJlZU5vZGVIaWdoTGlnaHQoY2hlY2tlZE5vZGVzWzBdKTsKICAgICAgICAgICAgICB0aGlzLmN1cnJlbnRzZWxlY3RlZE5vZGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNoZWNrZWROb2Rlc1swXSkpOwogICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlcyA9IFt0aGlzLmN1cnJlbnRzZWxlY3RlZE5vZGVdOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlcyA9IHRoaXMuc2VsZWN0ZWROb2Rlcy5jb25jYXQoY2hlY2tlZE5vZGVzKTsKICAgICAgICAgICAgICB2YXIgdHJlZSA9IHRoaXMuJHJlZnMudHJlZWV4cGJhcl90cmVlOwogICAgICAgICAgICAgIHRyZWUuc2V0Q2hlY2tlZE5vZGVzKHRoaXMuc2VsZWN0ZWROb2Rlcyk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gLy8g54i26IqC54K56YCJ5Lit5pe277yM6YCJ5Lit5omA5pyJ5a2Q6IqC54K5CgoKICAgICAgaWYgKGlzU2VsZWN0ZWRBbGwpIHsKICAgICAgICB2YXIgbGVhZk5vZGVzID0gaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gaXRlbS5sZWFmOwogICAgICAgIH0pOwogICAgICAgIHRoaXMuc2VsZWN0ZWROb2RlcyA9IHRoaXMuc2VsZWN0ZWROb2Rlcy5jb25jYXQobGVhZk5vZGVzKTsKICAgICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGVkTm9kZXMpOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDnu5jliLblj7Plh7voj5zljZUNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbm9kZQ0KICAgICAqIEByZXR1cm5zDQogICAgICogQG1lbWJlcm9mIFBJTVJlY29yZEJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVuZGVyQ29udGV4dE1lbnUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbmRlckNvbnRleHRNZW51KG5vZGUpIHsKICAgICAgdmFyIGNvbnRlbnQ7CgogICAgICBpZiAobm9kZSAmJiBub2RlLmRhdGEpIHsKICAgICAgICB2YXIgZGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkobm9kZS5kYXRhKSk7CiAgICAgICAgdGhpcy5jdXJyZW50c2VsZWN0ZWROb2RlID0gX29iamVjdFNwcmVhZCh7fSwgZGF0YSk7CiAgICAgICAgdmFyIHRhZ3MgPSBkYXRhLmlkLnNwbGl0KCc7Jyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBjb250ZW50OwogICAgfQogICAgLyoqDQogICAgICog6K6+572u6YCJ5Lit6auY5LquDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IGRhdGENCiAgICAgKiBAbWVtYmVyb2YgUElNUmVjb3JkQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZXRUcmVlTm9kZUhpZ2hMaWdodCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0VHJlZU5vZGVIaWdoTGlnaHQoZGF0YSkgewogICAgICB2YXIgdHJlZSA9IHRoaXMuJHJlZnMudHJlZWV4cGJhcl90cmVlOwogICAgICB0cmVlLnNldEN1cnJlbnRLZXkoZGF0YS5pZCk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmiafooYzpu5jorqTnlYzpnaLooYzkuLoNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbm9kZQ0KICAgICAqIEBtZW1iZXJvZiBQSU1SZWNvcmRCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImRvRGVmYXVsdEFjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZG9EZWZhdWx0QWN0aW9uKG5vZGUpIHsKICAgICAgaWYgKG5vZGUgJiYgbm9kZS5kYXRhKSB7CiAgICAgICAgdmFyIGRhdGEgPSBub2RlLmRhdGE7CiAgICAgICAgdmFyIHRhZ3MgPSBkYXRhLmlkLnNwbGl0KCc7Jyk7CiAgICAgIH0KCiAgICAgIHRoaXMuJGVtaXQoJ25vZGVkYmxjbGljaycsIHRoaXMuc2VsZWN0ZWROb2Rlcyk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gUElNUmVjb3JkQmFzZTsKfShWdWUpOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBQSU1SZWNvcmRCYXNlLnByb3RvdHlwZSwgIm5hbWUiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBQSU1SZWNvcmRCYXNlLnByb3RvdHlwZSwgInZpZXdTdGF0ZSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIFBJTVJlY29yZEJhc2UucHJvdG90eXBlLCAiY29udGV4dCIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIFBJTVJlY29yZEJhc2UucHJvdG90eXBlLCAidmlld3BhcmFtcyIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoewogICJkZWZhdWx0IjogdHJ1ZQp9KV0sIFBJTVJlY29yZEJhc2UucHJvdG90eXBlLCAiaXNTaW5nbGVTZWxlY3QiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKHsKICAiZGVmYXVsdCI6IGZhbHNlCn0pXSwgUElNUmVjb3JkQmFzZS5wcm90b3R5cGUsICJpc1NlbGVjdEZpcnN0RGVmYXVsdCIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoewogICJkZWZhdWx0IjogdHJ1ZQp9KV0sIFBJTVJlY29yZEJhc2UucHJvdG90eXBlLCAiaXNCcmFuY2hBdmFpbGFibGUiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKHsKICAiZGVmYXVsdCI6IHRydWUKfSldLCBQSU1SZWNvcmRCYXNlLnByb3RvdHlwZSwgInNob3dCdXN5SW5kaWNhdG9yIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgUElNUmVjb3JkQmFzZS5wcm90b3R5cGUsICJzZWxlY3RlZERhdGEiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtXYXRjaCgnc2VsZWN0ZWREYXRhJyldLCBQSU1SZWNvcmRCYXNlLnByb3RvdHlwZSwgIm9uVmFsdWVDaGFuZ2UiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgUElNUmVjb3JkQmFzZS5wcm90b3R5cGUsICJ1cGRhdGVBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBQSU1SZWNvcmRCYXNlLnByb3RvdHlwZSwgImZldGNoQWN0aW9uIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgUElNUmVjb3JkQmFzZS5wcm90b3R5cGUsICJyZW1vdmVBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBQSU1SZWNvcmRCYXNlLnByb3RvdHlwZSwgImxvYWRBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBQSU1SZWNvcmRCYXNlLnByb3RvdHlwZSwgImNyZWF0ZUFjdGlvbiIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3ZpZGUoKV0sIFBJTVJlY29yZEJhc2UucHJvdG90eXBlLCAiZXhwYW5kZWRLZXlzIiwgdm9pZCAwKTsKClBJTVJlY29yZEJhc2UgPSB0c2xpYl8xLl9fZGVjb3JhdGUoW0NvbXBvbmVudCh7CiAgY29tcG9uZW50czoge30KfSldLCBQSU1SZWNvcmRCYXNlKTsKZXhwb3J0IGRlZmF1bHQgUElNUmVjb3JkQmFzZTs="},null]}