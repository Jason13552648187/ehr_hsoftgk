{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js??ref--14-3!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-person\\txlxyg-grid\\txlxyg-grid-base.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-person\\txlxyg-grid\\txlxyg-grid-base.vue","mtime":1630509411992},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXgiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb21lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5kZWZpbmUtcHJvcGVydGllcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5kZWZpbmUtcHJvcGVydHkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuaXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wYXJzZS1pbnQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNlYXJjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnRpbWVycyI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9nZXRQcm90b3R5cGVPZiI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSAidHNsaWIiOwppbXBvcnQgeyBWdWUsIENvbXBvbmVudCwgUHJvcCwgV2F0Y2ggfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJzsKaW1wb3J0IFBpbVBlcnNvblNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL3BpbS1wZXJzb24vcGltLXBlcnNvbi1zZXJ2aWNlJzsKaW1wb3J0IFRYTFhZR1NlcnZpY2UgZnJvbSAnLi90eGx4eWctZ3JpZC1zZXJ2aWNlJzsKaW1wb3J0IENvZGVMaXN0U2VydmljZSBmcm9tICJAc2VydmljZS9hcHAvY29kZWxpc3Qtc2VydmljZSI7CmltcG9ydCB7IEZvcm1JdGVtTW9kZWwgfSBmcm9tICdAL21vZGVsL2Zvcm0tZGV0YWlsJzsKCnZhciBUWExYWUdCYXNlID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1Z1ZSkgewogIF9pbmhlcml0cyhUWExYWUdCYXNlLCBfVnVlKTsKCiAgZnVuY3Rpb24gVFhMWFlHQmFzZSgpIHsKICAgIHZhciBfdGhpczI7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFRYTFhZR0Jhc2UpOwoKICAgIF90aGlzMiA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihUWExYWUdCYXNlKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTsKICAgIC8qKg0KICAgICAqIOiuoeaVsOWZqOacjeWKoeWvueixoembhuWQiA0KICAgICAqDQogICAgICogQHR5cGUge0FycmF5PCo+fQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogICAgX3RoaXMyLmNvdW50ZXJTZXJ2aWNlQXJyYXkgPSBbXTsKICAgIC8qKg0KICAgICAqIOW7uuaehOmDqOS7tuacjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge1RYTFhZR1NlcnZpY2V9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuc2VydmljZSA9IG5ldyBUWExYWUdTZXJ2aWNlKHsKICAgICAgJHN0b3JlOiBfdGhpczIuJHN0b3JlCiAgICB9KTsKICAgIC8qKg0KICAgICAqIOWunuS9k+acjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge1BpbVBlcnNvblNlcnZpY2V9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuYXBwRW50aXR5U2VydmljZSA9IG5ldyBQaW1QZXJzb25TZXJ2aWNlKHsKICAgICAgJHN0b3JlOiBfdGhpczIuJHN0b3JlCiAgICB9KTsKICAgIC8qKg0KICAgICAqIOS7o+eggeihqOacjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge0NvZGVMaXN0U2VydmljZX0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5jb2RlTGlzdFNlcnZpY2UgPSBuZXcgQ29kZUxpc3RTZXJ2aWNlKHsKICAgICAgJHN0b3JlOiBfdGhpczIuJHN0b3JlCiAgICB9KTsKICAgIC8qKg0KICAgICAqIOW9k+WJjemhtQ0KICAgICAqDQogICAgICogQHR5cGUge251bWJlcn0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5jdXJQYWdlID0gMTsKICAgIC8qKg0KICAgICAqIOaVsOaNrg0KICAgICAqDQogICAgICogQHR5cGUge2FueVtdfQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogICAgX3RoaXMyLml0ZW1zID0gW107CiAgICAvKioNCiAgICAgKiDmmK/lkKbmlK/mjIHliIbpobUNCiAgICAgKg0KICAgICAqIEB0eXBlIHtib29sZWFufQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogICAgX3RoaXMyLmlzRW5hYmxlUGFnaW5nQmFyID0gdHJ1ZTsKICAgIC8qKg0KICAgICAqIOaYr+WQpuemgeeUqOaOkuW6jw0KICAgICAqDQogICAgICogQHR5cGUge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuaXNOb1NvcnQgPSBmYWxzZTsKICAgIC8qKg0KICAgICAqIOaOkuW6j+aWueWQkQ0KICAgICAqDQogICAgICogQHR5cGUge3N0cmluZ30NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5taW5vclNvcnREaXIgPSAnREVTQyc7CiAgICAvKioNCiAgICAgKiDmjpLluo/lrZfmrrUNCiAgICAgKg0KICAgICAqIEB0eXBlIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIubWlub3JTb3J0UFNERUYgPSAndHhkcSc7CiAgICAvKioNCiAgICAgKiDliIbpobXmnaHmlbANCiAgICAgKg0KICAgICAqIEB0eXBlIHtudW1iZXJ9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIubGltaXQgPSAxMDA7CiAgICAvKioNCiAgICAgKiDmmK/lkKbmmL7npLrmoIfpopgNCiAgICAgKg0KICAgICAqIEB0eXBlIHtib29sZWFufQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogICAgX3RoaXMyLmlzSGlkZUhlYWRlciA9IGZhbHNlOwogICAgLyoqDQogICAgICog5a6e6ZmF5piv5ZCm5byA5ZCv6KGM57yW6L6RDQogICAgICoNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5hY3R1YWxJc09wZW5FZGl0ID0gX3RoaXMyLmlzT3BlbkVkaXQ7CiAgICAvKioNCiAgICAgKiDmgLvmnaHmlbANCiAgICAgKg0KICAgICAqIEB0eXBlIHtudW1iZXJ9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIudG90YWxyb3cgPSAwOwogICAgLyoqDQogICAgICog6YCJ5Lit6KGM5pWw5o2uDQogICAgICoNCiAgICAgKiBAdHlwZSB7YW55W119DQogICAgICogQG1lbWJlcm9mIE1haW4NCiAgICAgKi8KCiAgICBfdGhpczIuc2VsZWN0aW9ucyA9IFtdOwogICAgLyoqDQogICAgICog5oum5oiq6KGM6YCJ5LitDQogICAgICoNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbg0KICAgICAqLwoKICAgIF90aGlzMi5zdG9wUm93Q2xpY2sgPSBmYWxzZTsKICAgIC8qKg0KICAgICAqIOihqOagvOaYr+WQpuaYvuekug0KICAgICAqDQogICAgICogQHR5cGUge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuaXNEaXNwbGF5ID0gdHJ1ZTsKICAgIC8qKg0KICAgICog6YCJ6aG55qGG5YiX5a69DQogICAgKg0KICAgICogQHR5cGUge251bWJlcn0NCiAgICAqIEBtZW1iZXJvZiBBcHBJbmRleA0KICAgICovCgogICAgX3RoaXMyLmNoZWNrYm94Q29sV2lkdGggPSAzNDsKICAgIC8qKg0KICAgICAqIOaYr+WQpuWFgeiuuOaLluWKqOWIl+WuvQ0KICAgICAqDQogICAgICogQHR5cGUge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIEFwcEVtYmVkUGlja2VyDQogICAgICovCgogICAgX3RoaXMyLmlzRHJhZ2VuZENvbCA9IGZhbHNlOwogICAgLyoqDQogICAgICog5omA5pyJ5YiX5oiQ5ZGYDQogICAgICoNCiAgICAgKiBAdHlwZSB7YW55W119DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuYWxsQ29sdW1ucyA9IFt7CiAgICAgIG5hbWU6ICd5Z2JoJywKICAgICAgbGFiZWw6ICflkZjlt6XnvJblj7cnLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMueWdiaCcsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ3BpbXBlcnNvbm5hbWUnLAogICAgICBsYWJlbDogJ+WRmOW3peWnk+WQjScsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24udHhseHlnX2dyaWQuY29sdW1ucy5waW1wZXJzb25uYW1lJywKICAgICAgc2hvdzogdHJ1ZSwKICAgICAgdXRpbDogJ3B4JwogICAgfSwgewogICAgICBuYW1lOiAneGInLAogICAgICBsYWJlbDogJ+aAp+WIqycsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24udHhseHlnX2dyaWQuY29sdW1ucy54YicsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ25qJywKICAgICAgbGFiZWw6ICflubTpvoQnLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMubmonLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAncHgnCiAgICB9LCB7CiAgICAgIG5hbWU6ICdwb3N0YWxhZGRyZXNzJywKICAgICAgbGFiZWw6ICfpgJrorq/lnLDlnYAnLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMucG9zdGFsYWRkcmVzcycsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ3JldGlwbGFjZScsCiAgICAgIGxhYmVsOiAn6YCA5LyR5ZywJywKICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbXBlcnNvbi50eGx4eWdfZ3JpZC5jb2x1bW5zLnJldGlwbGFjZScsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ2p0bHhyJywKICAgICAgbGFiZWw6ICflrrbluq3ogZTns7vkuronLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMuanRseHInLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAncHgnCiAgICB9LCB7CiAgICAgIG5hbWU6ICdqdGx4cmRoJywKICAgICAgbGFiZWw6ICflrrbluq3ogZTns7vkurrnlLXor50nLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMuanRseHJkaCcsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdQWCcKICAgIH0sIHsKICAgICAgbmFtZTogJ3p6ZHpzJywKICAgICAgbGFiZWw6ICfnu4Tnu4cnLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMuenpkenMnLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAncHgnCiAgICB9LCB7CiAgICAgIG5hbWU6ICdvcm1vcmdzZWN0b3JuYW1lJywKICAgICAgbGFiZWw6ICfpg6jpl6gnLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMub3Jtb3Jnc2VjdG9ybmFtZScsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdQWCcKICAgIH0sIHsKICAgICAgbmFtZTogJ3JhbmsnLAogICAgICBsYWJlbDogJ+iBjOe6pycsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24udHhseHlnX2dyaWQuY29sdW1ucy5yYW5rJywKICAgICAgc2hvdzogdHJ1ZSwKICAgICAgdXRpbDogJ3B4JwogICAgfSwgewogICAgICBuYW1lOiAnencnLAogICAgICBsYWJlbDogJ+mAgOS8keWJjeiBjOWKoScsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24udHhseHlnX2dyaWQuY29sdW1ucy56dycsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdQWCcKICAgIH0sIHsKICAgICAgbmFtZTogJ2d3JywKICAgICAgbGFiZWw6ICfpgIDkvJHliY3lspfkvY0nLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMuZ3cnLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAnUFgnCiAgICB9LCB7CiAgICAgIG5hbWU6ICd0eGRxJywKICAgICAgbGFiZWw6ICfpgIDkvJHml7bpl7QnLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltcGVyc29uLnR4bHh5Z19ncmlkLmNvbHVtbnMudHhkcScsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ3NqdHhycScsCiAgICAgIGxhYmVsOiAn5a6e6ZmF6YCA5LyR5pe26Ze0JywKICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbXBlcnNvbi50eGx4eWdfZ3JpZC5jb2x1bW5zLnNqdHhycScsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ2x4ZGgnLAogICAgICBsYWJlbDogJ+aJi+acuuWPt+eggScsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1wZXJzb24udHhseHlnX2dyaWQuY29sdW1ucy5seGRoJywKICAgICAgc2hvdzogdHJ1ZSwKICAgICAgdXRpbDogJ3B4JwogICAgfSwgewogICAgICBuYW1lOiAnc3BkeWxqZScsCiAgICAgIGxhYmVsOiAn5a6h5om555qE5YW76ICB6YeR6aKdJywKICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbXBlcnNvbi50eGx4eWdfZ3JpZC5jb2x1bW5zLnNwZHlsamUnLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAnUFgnCiAgICB9XTsKICAgIC8qKg0KICAgICAqIOihqOagvOaooeWei+mbhuWQiA0KICAgICAqDQogICAgICogQHR5cGUgeyp9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuZ3JpZEl0ZW1zTW9kZWwgPSBbXTsKICAgIC8qKg0KICAgICAqIOWxnuaAp+WAvOinhOWImQ0KICAgICAqDQogICAgICogQHR5cGUgeyp9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgICBfdGhpczIucnVsZXMgPSB7CiAgICAgIHNyZmtleTogW3sKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdmFsaWRhdG9yOiBmdW5jdGlvbiB2YWxpZGF0b3IocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSB7CiAgICAgICAgICByZXR1cm4gcnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpID8gZmFsc2UgOiB0cnVlOwogICAgICAgIH0sCiAgICAgICAgbWVzc2FnZTogJ+S6uuWRmOS/oeaBr+agh+ivhiDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdmFsaWRhdG9yOiBmdW5jdGlvbiB2YWxpZGF0b3IocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSB7CiAgICAgICAgICByZXR1cm4gcnVsZS5yZXF1aXJlZCAmJiAodmFsdWUgPT09IG51bGwgfHwgdmFsdWUgPT09IHVuZGVmaW5lZCB8fCB2YWx1ZSA9PT0gIiIpID8gZmFsc2UgOiB0cnVlOwogICAgICAgIH0sCiAgICAgICAgbWVzc2FnZTogJ+S6uuWRmOS/oeaBr+agh+ivhiDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XQogICAgfTsKICAgIHJldHVybiBfdGhpczI7CiAgfQogIC8qKg0KICAgKiDojrflj5bpg6jku7bnsbvlnosNCiAgICoNCiAgICogQHJldHVybnMge3N0cmluZ30NCiAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoVFhMWFlHQmFzZSwgW3sKICAgIGtleTogImdldENvbnRyb2xUeXBlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb250cm9sVHlwZSgpIHsKICAgICAgcmV0dXJuICdHUklEJzsKICAgIH0KICAgIC8qKg0KICAgICAqIOWFs+mXreinhuWbvg0KICAgICAqDQogICAgICogQHBhcmFtIHthbnl9IGFyZ3MNCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJjbG9zZVZpZXciLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNsb3NlVmlldyhhcmdzKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICBfdGhpcy4kZW1pdCgnY2xvc2V2aWV3JywgW2FyZ3NdKTsKICAgIH0KICAgIC8qKg0KICAgICAqICDorqHmlbDlmajliLfmlrANCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImNvdW50ZXJSZWZyZXNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjb3VudGVyUmVmcmVzaCgpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIGlmIChfdGhpcy5jb3VudGVyU2VydmljZUFycmF5ICYmIF90aGlzLmNvdW50ZXJTZXJ2aWNlQXJyYXkubGVuZ3RoID4gMCkgewogICAgICAgIF90aGlzLmNvdW50ZXJTZXJ2aWNlQXJyYXkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgaWYgKGl0ZW0ucmVmcmVzaERhdGEgJiYgaXRlbS5yZWZyZXNoRGF0YSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICAgIGl0ZW0ucmVmcmVzaERhdGEoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog6I635Y+W5aSa6aG55pWw5o2uDQogICAgICoNCiAgICAgKiBAcmV0dXJucyB7YW55W119DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0RGF0YXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGFzKCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25zOwogICAgfQogICAgLyoqDQogICAgICog6I635Y+W5Y2V6aG55qCRDQogICAgICoNCiAgICAgKiBAcmV0dXJucyB7Kn0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREYXRhKCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25zWzBdOwogICAgfQogICAgLyoqDQogICAgICog6YCJ5Lit5YC85Y+Y5YyWDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25WYWx1ZUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25WYWx1ZUNoYW5nZShuZXdWYWwsIG9sZFZhbCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwoKICAgICAgaWYgKHRoaXMuc2VsZWN0ZWREYXRhKSB7CiAgICAgICAgdmFyIHJlZnMgPSB0aGlzLiRyZWZzOwoKICAgICAgICBpZiAocmVmcy5tdWx0aXBsZVRhYmxlKSB7CiAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUuY2xlYXJTZWxlY3Rpb24oKTsKICAgICAgICAgIEpTT04ucGFyc2UodGhpcy5zZWxlY3RlZERhdGEpLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdGlvbikgewogICAgICAgICAgICB2YXIgc2VsZWN0ZWRJdGVtID0gX3RoaXMzLml0ZW1zLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0uc3Jma2V5LCBzZWxlY3Rpb24uc3Jma2V5KTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICBpZiAoc2VsZWN0ZWRJdGVtKSB7CiAgICAgICAgICAgICAgX3RoaXMzLnJvd0NsaWNrKHNlbGVjdGVkSXRlbSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog6YOo5Lu25Yi35pawDQogICAgICoNCiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzDQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVmcmVzaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVmcmVzaChhcmdzKSB7CiAgICAgIHRoaXMubG9hZCgpOwogICAgfQogICAgLyoqDQogICAgICog6I635Y+W6KGo5qC86KGM5qih5Z6LDQogICAgICoNCiAgICAgKiBAdHlwZSB7Kn0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRHcmlkUm93TW9kZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEdyaWRSb3dNb2RlbCgpIHsKICAgICAgcmV0dXJuIHsKICAgICAgICBzcmZrZXk6IG5ldyBGb3JtSXRlbU1vZGVsKCkKICAgICAgfTsKICAgIH0KICAgIC8qKg0KICAgICAqIOihqOagvOihjOe8lui+kemhueagoemqjA0KICAgICAqDQogICAgICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5IOWxnuaAp+WQjQ0KICAgICAqIEBwYXJhbSB7Kn0gZGF0YSDooYzmlbDmja4NCiAgICAgKiBAcGFyYW0ge251bWJlcn0gcm93SW5kZXgg6KGM57Si5byVDQogICAgICogQHJldHVybnMgUHJvbWlzZTxhbnk+DQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ2YWxpZGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdmFsaWRhdGUocHJvcGVydHksIGRhdGEsIHJvd0luZGV4KSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICBfdGhpczQuJHV0aWwudmFsaWRhdGVJdGVtKHByb3BlcnR5LCBkYXRhLCBfdGhpczQucnVsZXMpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXM0LmdyaWRJdGVtc01vZGVsW3Jvd0luZGV4XVtwcm9wZXJ0eV0uc2V0RXJyb3IobnVsbCk7CgogICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoX3JlZikgewogICAgICAgICAgdmFyIGVycm9ycyA9IF9yZWYuZXJyb3JzLAogICAgICAgICAgICAgIGZpZWxkcyA9IF9yZWYuZmllbGRzOwoKICAgICAgICAgIF90aGlzNC5ncmlkSXRlbXNNb2RlbFtyb3dJbmRleF1bcHJvcGVydHldLnNldEVycm9yKGVycm9yc1swXS5tZXNzYWdlKTsKCiAgICAgICAgICByZXNvbHZlKGZhbHNlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmoKHpqozmiYDmnInkv67mlLnov4fnmoTnvJbovpHpobkNCiAgICAgKg0KICAgICAqIEByZXR1cm5zIFByb21pc2U8YW55Pg0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInZhbGlkYXRlQWxsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfdmFsaWRhdGVBbGwgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciB2YWxpZGF0ZVN0YXRlLCBpbmRleCwgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiwgX2RpZEl0ZXJhdG9yRXJyb3IsIF9pdGVyYXRvckVycm9yLCBfaXRlcmF0b3IsIF9zdGVwLCBpdGVtLCBfaSwgX09iamVjdCRrZXlzLCBwcm9wZXJ0eTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdmFsaWRhdGVTdGF0ZSA9IHRydWU7CiAgICAgICAgICAgICAgICBpbmRleCA9IC0xOwogICAgICAgICAgICAgICAgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlOwogICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gNTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvciA9IHRoaXMuaXRlbXNbU3ltYm9sLml0ZXJhdG9yXSgpOwoKICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBpZiAoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDI0OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpdGVtID0gX3N0ZXAudmFsdWU7CiAgICAgICAgICAgICAgICBpbmRleCsrOwoKICAgICAgICAgICAgICAgIGlmICghKGl0ZW0ucm93RGF0YVN0YXRlID09PSAiY3JlYXRlIiB8fCBpdGVtLnJvd0RhdGFTdGF0ZSA9PT0gInVwZGF0ZSIpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2kgPSAwLCBfT2JqZWN0JGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLnJ1bGVzKTsKCiAgICAgICAgICAgICAgY2FzZSAxMjoKICAgICAgICAgICAgICAgIGlmICghKF9pIDwgX09iamVjdCRrZXlzLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDIxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBwcm9wZXJ0eSA9IF9PYmplY3Qka2V5c1tfaV07CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YWxpZGF0ZShwcm9wZXJ0eSwgaXRlbSwgaW5kZXgpOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgaWYgKF9jb250ZXh0LnNlbnQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE4OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB2YWxpZGF0ZVN0YXRlID0gZmFsc2U7CgogICAgICAgICAgICAgIGNhc2UgMTg6CiAgICAgICAgICAgICAgICBfaSsrOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEyOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjQ6CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMzA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyNjoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAyNjsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oNSk7CiAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvciA9IHRydWU7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvciA9IF9jb250ZXh0LnQwOwoKICAgICAgICAgICAgICBjYXNlIDMwOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDMwOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDMxOwoKICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3JbInJldHVybiJdICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yWyJyZXR1cm4iXSgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDMzOgogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDMzOwoKICAgICAgICAgICAgICAgIGlmICghX2RpZEl0ZXJhdG9yRXJyb3IpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjsKCiAgICAgICAgICAgICAgY2FzZSAzNjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goMzMpOwoKICAgICAgICAgICAgICBjYXNlIDM3OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmZpbmlzaCgzMCk7CgogICAgICAgICAgICAgIGNhc2UgMzg6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCB2YWxpZGF0ZVN0YXRlKTsKCiAgICAgICAgICAgICAgY2FzZSAzOToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUsIHRoaXMsIFtbNSwgMjYsIDMwLCAzOF0sIFszMSwsIDMzLCAzN11dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gdmFsaWRhdGVBbGwoKSB7CiAgICAgICAgcmV0dXJuIF92YWxpZGF0ZUFsbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gdmFsaWRhdGVBbGw7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIOihqOagvOaVsOaNruWKoOi9vQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbYXJnPXt9XQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWQoKSB7CiAgICAgIHZhciBfdGhpczUgPSB0aGlzOwoKICAgICAgdmFyIG9wdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgICAgIHZhciBwYWdlUmVzZXQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwoKICAgICAgaWYgKCF0aGlzLmZldGNoQWN0aW9uKSB7CiAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsKICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgIGRlc2M6ICdQSU1QRVJTT05MVFhZR0dyaWRWaWV36KeG5Zu+6KGo5qC8ZmV0Y2hBY3Rpb27lj4LmlbDmnKrphY3nva4nCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAocGFnZVJlc2V0KSB7CiAgICAgICAgdGhpcy5jdXJQYWdlID0gMTsKICAgICAgfQoKICAgICAgdmFyIGFyZyA9IF9vYmplY3RTcHJlYWQoe30sIG9wdCk7CgogICAgICB2YXIgcGFnZSA9IHt9OwoKICAgICAgaWYgKHRoaXMuaXNFbmFibGVQYWdpbmdCYXIpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsKICAgICAgICAgIHBhZ2U6IHRoaXMuY3VyUGFnZSAtIDEsCiAgICAgICAgICBzaXplOiB0aGlzLmxpbWl0CiAgICAgICAgfSk7CiAgICAgIH0gLy8g6K6+572u5o6S5bqPCgoKICAgICAgaWYgKCF0aGlzLmlzTm9Tb3J0ICYmICFPYmplY3QuaXModGhpcy5taW5vclNvcnREaXIsICcnKSAmJiAhT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0UFNERUYsICcnKSkgewogICAgICAgIHZhciBzb3J0ID0gdGhpcy5taW5vclNvcnRQU0RFRiArICIsIiArIHRoaXMubWlub3JTb3J0RGlyOwogICAgICAgIE9iamVjdC5hc3NpZ24ocGFnZSwgewogICAgICAgICAgc29ydDogc29ydAogICAgICAgIH0pOwogICAgICB9CgogICAgICBPYmplY3QuYXNzaWduKGFyZywgcGFnZSk7CiAgICAgIHZhciBwYXJlbnRkYXRhID0ge307CiAgICAgIHRoaXMuJGVtaXQoJ2JlZm9yZWxvYWQnLCBwYXJlbnRkYXRhKTsKICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHBhcmVudGRhdGEpOwogICAgICB2YXIgdGVtcFZpZXdQYXJhbXMgPSBwYXJlbnRkYXRhLnZpZXdwYXJhbXMgPyBwYXJlbnRkYXRhLnZpZXdwYXJhbXMgOiB7fTsKICAgICAgT2JqZWN0LmFzc2lnbih0ZW1wVmlld1BhcmFtcywgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnZpZXdwYXJhbXMpKSk7CiAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCB7CiAgICAgICAgdmlld3BhcmFtczogdGVtcFZpZXdQYXJhbXMKICAgICAgfSk7CiAgICAgIHZhciBwb3N0ID0gdGhpcy5zZXJ2aWNlLnNlYXJjaCh0aGlzLmZldGNoQWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBhcmcsIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICBwb3N0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKCFyZXNwb25zZS5zdGF0dXMgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvck1lc3NhZ2UpIHsKICAgICAgICAgICAgX3RoaXM1LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5lcnJvck1lc3NhZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIF90aGlzNS50b3RhbHJvdyA9IHJlc3BvbnNlLnRvdGFsOwogICAgICAgIF90aGlzNS5pdGVtcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOyAvLyDmuIXnqbpzZWxlY3Rpb25zLGdyaWRJdGVtc01vZGVsCgogICAgICAgIF90aGlzNS5zZWxlY3Rpb25zID0gW107CiAgICAgICAgX3RoaXM1LmdyaWRJdGVtc01vZGVsID0gW107CgogICAgICAgIF90aGlzNS5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzNS5ncmlkSXRlbXNNb2RlbC5wdXNoKF90aGlzNS5nZXRHcmlkUm93TW9kZWwoKSk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzNS4kZW1pdCgnbG9hZCcsIF90aGlzNS5pdGVtcyk7IC8vIOiuvue9rum7mOiupOmAieS4rQoKCiAgICAgICAgdmFyIF90aGlzID0gX3RoaXM1OwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKF90aGlzLmlzU2VsZWN0Rmlyc3REZWZhdWx0KSB7CiAgICAgICAgICAgIF90aGlzLnJvd0NsaWNrKF90aGlzLml0ZW1zWzBdKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoX3RoaXMuc2VsZWN0ZWREYXRhKSB7CiAgICAgICAgICAgIHZhciByZWZzID0gX3RoaXMuJHJlZnM7CgogICAgICAgICAgICBpZiAocmVmcy5tdWx0aXBsZVRhYmxlKSB7CiAgICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICAgICAgSlNPTi5wYXJzZShfdGhpcy5zZWxlY3RlZERhdGEpLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdGlvbikgewogICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbSA9IF90aGlzLml0ZW1zLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhpdGVtLnNyZmtleSwgc2VsZWN0aW9uLnNyZmtleSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRJdGVtKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLnJvd0NsaWNrKHNlbGVjdGVkSXRlbSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCAzMDApOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIF90aGlzNS4kTm90aWNlLmVycm9yKHsKICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgIGRlc2M6IHJlc3BvbnNlLmVycm9yTWVzc2FnZQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOWIoOmZpA0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gZGF0YXMNCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInJlbW92ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlbW92ZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKGRhdGFzKSB7CiAgICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICAgIHZhciBfZGF0YXMsIGRhdGFJbmZvLCByZW1vdmVEYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVtb3ZlQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICBkZXNjOiAnUElNUEVSU09OTFRYWUdHcmlkVmlld+inhuWbvuihqOagvHJlbW92ZUFjdGlvbuWPguaVsOacqumFjee9ricKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5hYnJ1cHQoInJldHVybiIpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBfZGF0YXMgPSBbXTsKICAgICAgICAgICAgICAgIGRhdGFzLmZvckVhY2goZnVuY3Rpb24gKHJlY29yZCwgaW5kZXgpIHsKICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5pcyhyZWNvcmQuc3JmdWYsICIwIikpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczYuaXRlbXMuc29tZShmdW5jdGlvbiAodmFsLCBudW0pIHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChKU09OLnN0cmluZ2lmeSh2YWwpID09IEpTT04uc3RyaW5naWZ5KHJlY29yZCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM2Lml0ZW1zLnNwbGljZShudW0sIDEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LmdyaWRJdGVtc01vZGVsLnNwbGljZShudW0sIDEpOwoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgX2RhdGFzLnB1c2goZGF0YXNbaW5kZXhdKTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKCEoX2RhdGFzLmxlbmd0aCA9PT0gMCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIGRhdGFJbmZvID0gJyc7CgogICAgICAgICAgICAgICAgX2RhdGFzLmZvckVhY2goZnVuY3Rpb24gKHJlY29yZCwgaW5kZXgpIHsKICAgICAgICAgICAgICAgICAgdmFyIHNyZm1ham9ydGV4dCA9IHJlY29yZC5waW1wZXJzb25uYW1lOwoKICAgICAgICAgICAgICAgICAgaWYgKGluZGV4IDwgNSkgewogICAgICAgICAgICAgICAgICAgIGlmICghT2JqZWN0LmlzKGRhdGFJbmZvLCAnJykpIHsKICAgICAgICAgICAgICAgICAgICAgIGRhdGFJbmZvICs9ICfjgIEnOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgZGF0YUluZm8gKz0gc3JmbWFqb3J0ZXh0OwogICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKF9kYXRhcy5sZW5ndGggPCA1KSB7CiAgICAgICAgICAgICAgICAgIGRhdGFJbmZvID0gZGF0YUluZm8gKyAnIOWFsScgKyBfZGF0YXMubGVuZ3RoICsgJ+adoeaVsOaNric7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICBkYXRhSW5mbyA9IGRhdGFJbmZvICsgJy4uLicgKyAnIOWFsScgKyBfZGF0YXMubGVuZ3RoICsgJ+adoeaVsOaNric7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmVtb3ZlRGF0YSA9IGZ1bmN0aW9uIHJlbW92ZURhdGEoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBrZXlzID0gW107CgogICAgICAgICAgICAgICAgICBfZGF0YXMuZm9yRWFjaChmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgIGtleXMucHVzaChkYXRhLnNyZmtleSk7CiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgdmFyIF9yZW1vdmVBY3Rpb24gPSBrZXlzLmxlbmd0aCA+IDEgPyAncmVtb3ZlQmF0Y2gnIDogX3RoaXM2LnJlbW92ZUFjdGlvbjsKCiAgICAgICAgICAgICAgICAgIHZhciBfa2V5cyA9IGtleXMubGVuZ3RoID4gMSA/IGtleXMgOiBrZXlzWzBdOwoKICAgICAgICAgICAgICAgICAgdmFyIGNvbnRleHQgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KF90aGlzNi5jb250ZXh0KSk7CgogICAgICAgICAgICAgICAgICB2YXIgcG9zdCA9IF90aGlzNi5zZXJ2aWNlWyJkZWxldGUiXShfcmVtb3ZlQWN0aW9uLCBPYmplY3QuYXNzaWduKGNvbnRleHQsIHsKICAgICAgICAgICAgICAgICAgICBwaW1wZXJzb246IF9rZXlzCiAgICAgICAgICAgICAgICAgIH0pLCBPYmplY3QuYXNzaWduKHsKICAgICAgICAgICAgICAgICAgICBwaW1wZXJzb246IF9rZXlzCiAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICB2aWV3cGFyYW1zOiBfdGhpczYudmlld3BhcmFtcwogICAgICAgICAgICAgICAgICB9KSwgX3RoaXM2LnNob3dCdXN5SW5kaWNhdG9yKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgICAgICAgcG9zdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICfliKDpmaTmlbDmja7lpLHotKUsJyArIHJlc3BvbnNlLmluZm8KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuJE5vdGljZS5zdWNjZXNzKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogJ+WIoOmZpOaIkOWKnyEnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfSAvL+WIoOmZpGl0ZW1z5Lit5bey5Yig6Zmk55qE6aG5CgoKICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKF90aGlzNi5pdGVtcyk7CgogICAgICAgICAgICAgICAgICAgICAgX2RhdGFzLmZvckVhY2goZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM2Lml0ZW1zLnNvbWUoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5pcyhpdGVtLnNyZmtleSwgZGF0YS5zcmZrZXkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuaXRlbXMuc3BsaWNlKGluZGV4LCAxKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuZ3JpZEl0ZW1zTW9kZWwuc3BsaWNlKGluZGV4LCAxKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LnRvdGFscm93IC09IF9kYXRhcy5sZW5ndGg7CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LiRlbWl0KCdyZW1vdmUnLCBudWxsKTsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICfns7vnu5/lvILluLgnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBkYXRhSW5mbyA9IGRhdGFJbmZvLnJlcGxhY2UoL1tudWxsXS9nLCAnJykucmVwbGFjZSgvW3VuZGVmaW5lZF0vZywgJycpOwogICAgICAgICAgICAgICAgdGhpcy4kTW9kYWwuY29uZmlybSh7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6K2m5ZGKJywKICAgICAgICAgICAgICAgICAgY29udGVudDogJ+ehruiupOimgeWIoOmZpCAnICsgZGF0YUluZm8gKyAn77yM5Yig6Zmk5pON5L2c5bCG5LiN5Y+v5oGi5aSN77yfJywKICAgICAgICAgICAgICAgICAgb25PazogZnVuY3Rpb24gb25PaygpIHsKICAgICAgICAgICAgICAgICAgICByZW1vdmVEYXRhKCk7CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiBvbkNhbmNlbCgpIHt9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCByZW1vdmVEYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHJlbW92ZShfeCkgewogICAgICAgIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZW1vdmU7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIOaJuemHj+a3u+WKoA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbYXJnPXt9XQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImFkZEJhdGNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRCYXRjaCgpIHsKICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICBpZiAoIXRoaXMuZmV0Y2hBY3Rpb24pIHsKICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgZGVzYzogJ1BJTVBFUlNPTkxUWFlHR3JpZFZpZXfop4blm77ooajmoLxmZXRjaEFjdGlvbuWPguaVsOacqumFjee9ricKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICghYXJnKSB7CiAgICAgICAgYXJnID0ge307CiAgICAgIH0KCiAgICAgIGNvbnNvbGUuZXJyb3IoIuaJuemHj+a3u+WKoOacquWunueOsCIpOwogICAgfQogICAgLyoqDQogICAgICog5pWw5o2u5a+85YWlDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IGRhdGENCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpbXBvcnRFeGNlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW1wb3J0RXhjZWwoKSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwogICAgICAvL+WvvOWFpWV4Y2VsCiAgICAgIHZhciBpbXBvcnREYXRhTW9kZWwgPSB7fTsKCiAgICAgIGlmIChPYmplY3Qua2V5cyhpbXBvcnREYXRhTW9kZWwpLmxlbmd0aCA9PSAwKSB7CiAgICAgICAgdGhpcy4kTm90aWNlLndhcm5pbmcoewogICAgICAgICAgJ3RpdGxlJzogdGhpcy4kdCgiYXBwLnV0aWx2aWV3Lndhcm5pbmciKSwKICAgICAgICAgICdkZXNjJzogdGhpcy4kdCgiYXBwLnV0aWx2aWV3LmluZm8iKQogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHZpZXcgPSB7CiAgICAgICAgdmlld25hbWU6ICdhcHAtZGF0YS11cGxvYWQnLAogICAgICAgIHRpdGxlOiB0aGlzLiR0KCJhcHAudXRpbHZpZXcuaW1wb3J0dmlldyIpLAogICAgICAgIHdpZHRoOiA5MDAsCiAgICAgICAgaGVpZ2h0OiA3MDAKICAgICAgfTsKICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuJGFwcG1vZGFsLm9wZW5Nb2RhbCh2aWV3LCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBpbXBvcnREYXRhTW9kZWwpOwogICAgICBjb250YWluZXIuc3Vic2NyaWJlKGZ1bmN0aW9uIChyZXN1bHQpIHsKICAgICAgICBpZiAoT2JqZWN0LmlzKHJlc3VsdC5yZXQsICdPSycpKSB7CiAgICAgICAgICBfdGhpczcucmVmcmVzaChyZXN1bHQuZGF0YXMpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmlbDmja7lr7zlh7oNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gZGF0YQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImV4cG9ydEV4Y2VsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBleHBvcnRFeGNlbCgpIHsKICAgICAgdmFyIF90aGlzOCA9IHRoaXM7CgogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICAvLyDlr7zlh7pFeGNlbAogICAgICB2YXIgZG9FeHBvcnQgPQogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgX3JlZjIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoX2RhdGEpIHsKICAgICAgICAgIHZhciB0SGVhZGVyLCBmaWx0ZXJWYWwsIGRhdGE7CiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQzLnByZXYgPSBfY29udGV4dDMubmV4dCkgewogICAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgICB0SGVhZGVyID0gW107CiAgICAgICAgICAgICAgICAgIGZpbHRlclZhbCA9IFtdOwoKICAgICAgICAgICAgICAgICAgX3RoaXM4LmFsbENvbHVtbnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICAgIGl0ZW0uc2hvdyAmJiBpdGVtLmxhYmVsID8gdEhlYWRlci5wdXNoKF90aGlzOC4kdChpdGVtLmxhbmd0YWcpKSA6ICIiOwogICAgICAgICAgICAgICAgICAgIGl0ZW0uc2hvdyAmJiBpdGVtLm5hbWUgPyBmaWx0ZXJWYWwucHVzaChpdGVtLm5hbWUpIDogIiI7CiAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXM4LmZvcm1hdEV4Y2VsRGF0YShmaWx0ZXJWYWwsIF9kYXRhKTsKCiAgICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICAgIGRhdGEgPSBfY29udGV4dDMuc2VudDsKCiAgICAgICAgICAgICAgICAgIF90aGlzOC4kZXhwb3J0LmV4cG9ydEV4Y2VsKCkudGhlbihmdW5jdGlvbiAoZXhjZWwpIHsKICAgICAgICAgICAgICAgICAgICBleGNlbC5leHBvcnRfanNvbl90b19leGNlbCh7CiAgICAgICAgICAgICAgICAgICAgICBoZWFkZXI6IHRIZWFkZXIsCiAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBkYXRhLAogICAgICAgICAgICAgICAgICAgICAgZmlsZW5hbWU6ICLkurrlkZjkv6Hmga/ooagiLAogICAgICAgICAgICAgICAgICAgICAgYXV0b1dpZHRoOiB0cnVlLAogICAgICAgICAgICAgICAgICAgICAgYm9va1R5cGU6ICJ4bHN4IiAvL+mdnuW/heWhqwoKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlMyk7CiAgICAgICAgfSkpOwoKICAgICAgICByZXR1cm4gZnVuY3Rpb24gZG9FeHBvcnQoX3gyKSB7CiAgICAgICAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9OwogICAgICB9KCk7CgogICAgICB2YXIgcGFnZSA9IHt9OyAvLyDorr7nva5wYWdl77yMc2l6ZQoKICAgICAgaWYgKE9iamVjdC5pcyhkYXRhLnR5cGUsICdtYXhSb3dDb3VudCcpKSB7CiAgICAgICAgT2JqZWN0LmFzc2lnbihwYWdlLCB7CiAgICAgICAgICBwYWdlOiAwLAogICAgICAgICAgc2l6ZTogZGF0YS5tYXhSb3dDb3VudAogICAgICAgIH0pOwogICAgICB9IGVsc2UgaWYgKE9iamVjdC5pcyhkYXRhLnR5cGUsICdhY3RpdmF0ZWRQYWdlJykpIHsKICAgICAgICB0cnkgewogICAgICAgICAgZG9FeHBvcnQoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLml0ZW1zKSkpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDorr7nva7mjpLluo8KCgogICAgICBpZiAoIXRoaXMuaXNOb1NvcnQgJiYgIU9iamVjdC5pcyh0aGlzLm1pbm9yU29ydERpciwgJycpICYmICFPYmplY3QuaXModGhpcy5taW5vclNvcnRQU0RFRiwgJycpKSB7CiAgICAgICAgdmFyIHNvcnQgPSB0aGlzLm1pbm9yU29ydFBTREVGICsgIiwiICsgdGhpcy5taW5vclNvcnREaXI7CiAgICAgICAgT2JqZWN0LmFzc2lnbihwYWdlLCB7CiAgICAgICAgICBzb3J0OiBzb3J0CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHZhciBhcmcgPSB7fTsKICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHBhZ2UpOyAvLyDojrflj5ZxdWVyeSzmkJzntKLooajljZXvvIx2aWV3cGFyYW1z562J54i25pWw5o2uCgogICAgICB2YXIgcGFyZW50ZGF0YSA9IHt9OwogICAgICB0aGlzLiRlbWl0KCdiZWZvcmVsb2FkJywgcGFyZW50ZGF0YSk7CiAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCBwYXJlbnRkYXRhKTsKICAgICAgdmFyIHBvc3QgPSB0aGlzLnNlcnZpY2Uuc2VhcmNoKHRoaXMuZmV0Y2hBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGFyZywgdGhpcy5zaG93QnVzeUluZGljYXRvcik7CiAgICAgIHBvc3QudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICBfdGhpczguJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAnJywKICAgICAgICAgICAgZGVzYzogJ+aVsOaNruWvvOWHuuWksei0pSwnICsgcmVzcG9uc2UuaW5mbwogICAgICAgICAgfSk7CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGRvRXhwb3J0KEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpKTsKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICAgICAgfQogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIF90aGlzOC4kTm90aWNlLmVycm9yKHsKICAgICAgICAgIHRpdGxlOiAnJywKICAgICAgICAgIGRlc2M6ICfmlbDmja7lr7zlh7rlpLHotKUnCiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5a+85Ye65pWw5o2u5qC85byP5YyWDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IGZpbHRlclZhbA0KICAgICAqIEBwYXJhbSB7Kn0ganNvbkRhdGENCiAgICAgKiBAcmV0dXJucyB7W119DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZm9ybWF0RXhjZWxEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZm9ybWF0RXhjZWxEYXRhID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoZmlsdGVyVmFsLCBqc29uRGF0YSkgewogICAgICAgIHZhciBjb2RlbGlzdENvbHVtbnMsIF90aGlzLCBfbG9vcCwgX2kyLCBfY29kZWxpc3RDb2x1bW5zOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTQkKF9jb250ZXh0NSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDUucHJldiA9IF9jb250ZXh0NS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29kZWxpc3RDb2x1bW5zID0gW3sKICAgICAgICAgICAgICAgICAgbmFtZTogJ3hiJywKICAgICAgICAgICAgICAgICAgc3Jma2V5OiAnRWhyQ29kZUxpc3QwMDcyJywKICAgICAgICAgICAgICAgICAgY29kZWxpc3RUeXBlOiAnRFlOQU1JQycsCiAgICAgICAgICAgICAgICAgIHJlbmRlck1vZGU6ICdvdGhlcicsCiAgICAgICAgICAgICAgICAgIHRleHRTZXBhcmF0b3I6ICfjgIEnLAogICAgICAgICAgICAgICAgICB2YWx1ZVNlcGFyYXRvcjogJywnCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICdyYW5rJywKICAgICAgICAgICAgICAgICAgc3Jma2V5OiAnRWhyQ29kZUxpc3QwMDI1JywKICAgICAgICAgICAgICAgICAgY29kZWxpc3RUeXBlOiAnRFlOQU1JQycsCiAgICAgICAgICAgICAgICAgIHRleHRTZXBhcmF0b3I6ICfjgIEnLAogICAgICAgICAgICAgICAgICByZW5kZXJNb2RlOiAnc3RyaW5nJywKICAgICAgICAgICAgICAgICAgdmFsdWVTZXBhcmF0b3I6ICI7IgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBuYW1lOiAnencnLAogICAgICAgICAgICAgICAgICBzcmZrZXk6ICdFaHJDb2RlTGlzdDAyMzMnLAogICAgICAgICAgICAgICAgICBjb2RlbGlzdFR5cGU6ICdEWU5BTUlDJywKICAgICAgICAgICAgICAgICAgdGV4dFNlcGFyYXRvcjogJ+OAgScsCiAgICAgICAgICAgICAgICAgIHJlbmRlck1vZGU6ICdzdHJpbmcnLAogICAgICAgICAgICAgICAgICB2YWx1ZVNlcGFyYXRvcjogIjsiCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIG5hbWU6ICdndycsCiAgICAgICAgICAgICAgICAgIHNyZmtleTogJ0VockNvZGVMaXN0MDA1MCcsCiAgICAgICAgICAgICAgICAgIGNvZGVsaXN0VHlwZTogJ0RZTkFNSUMnLAogICAgICAgICAgICAgICAgICB0ZXh0U2VwYXJhdG9yOiAn44CBJywKICAgICAgICAgICAgICAgICAgcmVuZGVyTW9kZTogJ3N0cmluZycsCiAgICAgICAgICAgICAgICAgIHZhbHVlU2VwYXJhdG9yOiAiOyIKICAgICAgICAgICAgICAgIH1dOwogICAgICAgICAgICAgICAgX3RoaXMgPSB0aGlzOwogICAgICAgICAgICAgICAgX2xvb3AgPQogICAgICAgICAgICAgICAgLyojX19QVVJFX18qLwogICAgICAgICAgICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2xvb3AoKSB7CiAgICAgICAgICAgICAgICAgIHZhciBjb2RlbGlzdCwgaXRlbXMsIF9pdGVtczsKCiAgICAgICAgICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfbG9vcCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZWxpc3QgPSBfY29kZWxpc3RDb2x1bW5zW19pMl07CgogICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghT2JqZWN0LmlzKGNvZGVsaXN0LmNvZGVsaXN0VHlwZSwgIkRZTkFNSUMiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA4OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLmNvZGVMaXN0U2VydmljZS5nZXRJdGVtcyhjb2RlbGlzdC5zcmZrZXkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSA0OgogICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1zID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAganNvbkRhdGEuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dbY29kZWxpc3QubmFtZV0gPSBfdGhpcy5nZXRDb2RlbGlzdFZhbHVlKGl0ZW1zLCByb3dbY29kZWxpc3QubmFtZV0sIGNvZGVsaXN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsgLy8g6Z2Z5oCB5aSE55CGCgogICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFPYmplY3QuaXMoY29kZWxpc3QuY29kZWxpc3RUeXBlLCAiU1RBVElDIikpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTM7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF90aGlzLiRzdG9yZS5nZXR0ZXJzLmdldENvZGVMaXN0SXRlbXMoY29kZWxpc3Quc3Jma2V5KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICAgICAgICAgICAgX2l0ZW1zID0gX2NvbnRleHQ0LnNlbnQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAganNvbkRhdGEuZm9yRWFjaChmdW5jdGlvbiAocm93KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3dbY29kZWxpc3QubmFtZV0gPSBfdGhpcy5nZXRDb2RlbGlzdFZhbHVlKF9pdGVtcywgcm93W2NvZGVsaXN0Lm5hbWVdLCBjb2RlbGlzdCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSwgX2xvb3ApOwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfaTIgPSAwLCBfY29kZWxpc3RDb2x1bW5zID0gY29kZWxpc3RDb2x1bW5zOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBpZiAoIShfaTIgPCBfY29kZWxpc3RDb2x1bW5zLmxlbmd0aCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmRlbGVnYXRlWWllbGQoX2xvb3AoKSwgInQwIiwgNik7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIF9pMisrOwogICAgICAgICAgICAgICAgX2NvbnRleHQ1Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBqc29uRGF0YS5tYXAoZnVuY3Rpb24gKHYpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGZpbHRlclZhbC5tYXAoZnVuY3Rpb24gKGopIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gdltqXTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBmb3JtYXRFeGNlbERhdGEoX3gzLCBfeDQpIHsKICAgICAgICByZXR1cm4gX2Zvcm1hdEV4Y2VsRGF0YS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZm9ybWF0RXhjZWxEYXRhOwogICAgfSgpCiAgICAvKioNCiAgICAgKiDop6PmnpDku6PnoIHooajlkox2bGF1Ze+8jOiuvue9rml0ZW1zDQogICAgICoNCiAgICAgKiBAcHVibGljDQogICAgICogQHBhcmFtIHthbnlbXX0gaXRlbXMg5Luj56CB6KGo5pWw5o2uDQogICAgICogQHBhcmFtIHsqfSB2YWx1ZQ0KICAgICAqIEByZXR1cm5zIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENvZGVsaXN0VmFsdWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvZGVsaXN0VmFsdWUoaXRlbXMsIHZhbHVlLCBjb2RlbGlzdCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIGlmICghdmFsdWUpIHsKICAgICAgICByZXR1cm4gdGhpcy4kdCgnY29kZWxpc3QuJyArIGNvZGVsaXN0LnNyZmtleSArICcuZW1wdHknKTsKICAgICAgfQoKICAgICAgaWYgKGl0ZW1zKSB7CiAgICAgICAgdmFyIHJlc3VsdCA9IFtdOwoKICAgICAgICBpZiAoT2JqZWN0LmlzKGNvZGVsaXN0LnJlbmRlck1vZGUsICJudW1iZXIiKSkgewogICAgICAgICAgaXRlbXMubWFwKGZ1bmN0aW9uIChfaXRlbSwgaW5kZXgpIHsKICAgICAgICAgICAgdmFyIG5WYWx1ZSA9IHBhcnNlSW50KHZhbHVlLCAxMCk7CiAgICAgICAgICAgIHZhciBjb2RldmFsdWUgPSBfaXRlbS52YWx1ZTsKCiAgICAgICAgICAgIGlmICgocGFyc2VJbnQoY29kZXZhbHVlLCAxMCkgJiBuVmFsdWUpID4gMCkgewogICAgICAgICAgICAgIHJlc3VsdC5wdXNoKF9pdGVtKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmIChPYmplY3QuaXMoY29kZWxpc3QucmVuZGVyTW9kZSwgInN0cmluZyIpKSB7CiAgICAgICAgICB2YXIgYXJyYXlWYWx1ZSA9IHZhbHVlLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKTsKICAgICAgICAgIGFycmF5VmFsdWUubWFwKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHsKICAgICAgICAgICAgcmVzdWx0LnB1c2goW10pOwogICAgICAgICAgICB2YXIgdmFsdWVzID0gT2JqZWN0LmlzKF90aGlzOS4kdXRpbC50eXBlT2YodmFsdWUpLCAnbnVtYmVyJykgPyBbdmFsdWVdIDogX3RvQ29uc3VtYWJsZUFycmF5KHZhbHVlLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKSk7CiAgICAgICAgICAgIHZhbHVlcy5tYXAoZnVuY3Rpb24gKHZhbCwgbnVtKSB7CiAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBfdGhpczkuZ2V0SXRlbShpdGVtcywgdmFsLCBjb2RlbGlzdCk7CgogICAgICAgICAgICAgIGlmIChpdGVtKSB7CiAgICAgICAgICAgICAgICByZXN1bHRbaW5kZXhdLnB1c2goaXRlbSk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgdmFsdWVzID0gT2JqZWN0LmlzKHRoaXMuJHV0aWwudHlwZU9mKHZhbHVlKSwgJ251bWJlcicpID8gW3ZhbHVlXSA6IF90b0NvbnN1bWFibGVBcnJheSh2YWx1ZS5zcGxpdChjb2RlbGlzdC52YWx1ZVNlcGFyYXRvcikpOwogICAgICAgICAgdmFsdWVzLm1hcChmdW5jdGlvbiAodmFsdWUsIGluZGV4KSB7CiAgICAgICAgICAgIHZhciBpdGVtID0gX3RoaXM5LmdldEl0ZW0oaXRlbXMsIHZhbHVlLCBjb2RlbGlzdCk7CgogICAgICAgICAgICBpZiAoaXRlbSkgewogICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGl0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IC8vIOiuvue9rml0ZW1zCgoKICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCAhPSAwKSB7CiAgICAgICAgICByZXR1cm4gcmVzdWx0LmpvaW4oY29kZWxpc3QudmFsdWVTZXBhcmF0b3IpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gdmFsdWU7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5bku6PnoIHpobkNCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0ge2FueVtdfSBpdGVtcw0KICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUNCiAgICAgKiBAcmV0dXJucyB7Kn0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRJdGVtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJdGVtKGl0ZW1zLCB2YWx1ZSwgY29kZWxpc3QpIHsKICAgICAgdmFyIGFyciA9IGl0ZW1zLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLnZhbHVlID09IHZhbHVlOwogICAgICB9KTsKCiAgICAgIGlmIChhcnIubGVuZ3RoICE9PSAxKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQoKICAgICAgaWYgKE9iamVjdC5pcyhjb2RlbGlzdC5jb2RlbGlzdFR5cGUsICdTVEFUSUMnKSkgewogICAgICAgIHJldHVybiB0aGlzLiR0KCdjb2RlbGlzdC4nICsgY29kZWxpc3Quc3Jma2V5ICsgJy4nICsgYXJyWzBdLnZhbHVlKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gYXJyWzBdLnRleHQ7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOeUn+WRveWRqOacnw0KICAgICAqDQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY3JlYXRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY3JlYXRlZCgpIHsKICAgICAgdGhpcy5hZnRlckNyZWF0ZWQoKTsKICAgIH0KICAgIC8qKg0KICAgICAqIOaJp+ihjGNyZWF0ZWTlkI7nmoTpgLvovpENCiAgICAgKg0KICAgICAqICBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJhZnRlckNyZWF0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFmdGVyQ3JlYXRlZCgpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgdGhpcy5zZXRDb2xTdGF0ZSgpOwoKICAgICAgaWYgKHRoaXMudmlld1N0YXRlKSB7CiAgICAgICAgdGhpcy52aWV3U3RhdGVFdmVudCA9IHRoaXMudmlld1N0YXRlLnN1YnNjcmliZShmdW5jdGlvbiAoX3JlZjMpIHsKICAgICAgICAgIHZhciB0YWcgPSBfcmVmMy50YWcsCiAgICAgICAgICAgICAgYWN0aW9uID0gX3JlZjMuYWN0aW9uLAogICAgICAgICAgICAgIGRhdGEgPSBfcmVmMy5kYXRhOwoKICAgICAgICAgIGlmICghT2JqZWN0LmlzKHRhZywgX3RoaXMxMC5uYW1lKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygnbG9hZCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXMxMC5sb2FkKGRhdGEpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChPYmplY3QuaXMoJ3JlbW92ZScsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXMxMC5yZW1vdmUoZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygnc2F2ZScsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXMxMC5zYXZlKGRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiB2dWUg55Sf5ZG95ZGo5pyfDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkZXN0cm95ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHsKICAgICAgdGhpcy5hZnRlckRlc3Ryb3koKTsKICAgIH0KICAgIC8qKg0KICAgICAqIOaJp+ihjGRlc3Ryb3llZOWQjueahOmAu+i+kQ0KICAgICAqDQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiYWZ0ZXJEZXN0cm95IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZnRlckRlc3Ryb3koKSB7CiAgICAgIGlmICh0aGlzLnZpZXdTdGF0ZUV2ZW50KSB7CiAgICAgICAgdGhpcy52aWV3U3RhdGVFdmVudC51bnN1YnNjcmliZSgpOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5bpgInkuK3ooYzog6HmlbDmja4NCiAgICAgKg0KICAgICAqIEByZXR1cm5zIHthbnlbXX0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRTZWxlY3Rpb24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFNlbGVjdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuc2VsZWN0aW9uczsKICAgIH0KICAgIC8qKg0KICAgICAqIOihjOWPjOWHu+S6i+S7tg0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSAkZXZlbnQNCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyb3dEQkxDbGljayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcm93REJMQ2xpY2soJGV2ZW50KSB7CiAgICAgIGlmICghJGV2ZW50IHx8IHRoaXMuYWN0dWFsSXNPcGVuRWRpdCB8fCBPYmplY3QuaXModGhpcy5ncmlkUm93QWN0aXZlTW9kZSwgMCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICB0aGlzLnNlbGVjdGlvbnMucHVzaChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KCRldmVudCkpKTsKICAgICAgdmFyIHJlZnMgPSB0aGlzLiRyZWZzOwoKICAgICAgaWYgKHJlZnMubXVsdGlwbGVUYWJsZSkgewogICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS5jbGVhclNlbGVjdGlvbigpOwogICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS50b2dnbGVSb3dTZWxlY3Rpb24oJGV2ZW50KTsKICAgICAgfQoKICAgICAgdGhpcy4kZW1pdCgncm93ZGJsY2xpY2snLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgfQogICAgLyoqDQogICAgICog5aSN6YCJ5qGG5pWw5o2u6YCJ5LitDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInNlbGVjdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0KCRldmVudCkgewogICAgICBpZiAoISRldmVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IF90b0NvbnN1bWFibGVBcnJheShKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KCRldmVudCkpKTsKICAgICAgdGhpcy4kZW1pdCgnc2VsZWN0aW9uY2hhbmdlJywgdGhpcy5zZWxlY3Rpb25zKTsKICAgIH0KICAgIC8qKg0KICAgICAqIOWkjemAieahhuaVsOaNruWFqOmDqOmAieS4rQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSAkZXZlbnQNCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZWxlY3RBbGwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNlbGVjdEFsbCgkZXZlbnQpIHsKICAgICAgaWYgKCEkZXZlbnQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICB0aGlzLnNlbGVjdGlvbnMgPSBfdG9Db25zdW1hYmxlQXJyYXkoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSgkZXZlbnQpKSk7CiAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CiAgICAvKioNCiAgICAgKiDooYzljZXlh7vpgInkuK0NCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicm93Q2xpY2siLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJvd0NsaWNrKCRldmVudCkgewogICAgICB2YXIgaWZBbHdheXMgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IGZhbHNlOwoKICAgICAgaWYgKCFpZkFsd2F5cyAmJiAoISRldmVudCB8fCB0aGlzLmFjdHVhbElzT3BlbkVkaXQpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5zdG9wUm93Q2xpY2spIHsKICAgICAgICB0aGlzLnN0b3BSb3dDbGljayA9IGZhbHNlOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuaXNTaW5nbGVTZWxlY3QpIHsKICAgICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTsKICAgICAgfSAvLyDlt7LpgInkuK3liJnliKDpmaTvvIzmsqHpgInkuK3liJnmt7vliqAKCgogICAgICB2YXIgc2VsZWN0SW5kZXggPSB0aGlzLnNlbGVjdGlvbnMuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhpdGVtLnBpbXBlcnNvbiwgJGV2ZW50LnBpbXBlcnNvbik7CiAgICAgIH0pOwoKICAgICAgaWYgKE9iamVjdC5pcyhzZWxlY3RJbmRleCwgLTEpKSB7CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSgkZXZlbnQpKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnNwbGljZShzZWxlY3RJbmRleCwgMSk7CiAgICAgIH0KCiAgICAgIHZhciByZWZzID0gdGhpcy4kcmVmczsKCiAgICAgIGlmIChyZWZzLm11bHRpcGxlVGFibGUpIHsKICAgICAgICBpZiAodGhpcy5pc1NpbmdsZVNlbGVjdCkgewogICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUuc2V0Q3VycmVudFJvdygkZXZlbnQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKCRldmVudCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgfQogICAgLyoqDQogICAgICog6aG16Z2i5Y+Y5YyWDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInBhZ2VPbkNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGFnZU9uQ2hhbmdlKCRldmVudCkgewogICAgICBpZiAoISRldmVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCRldmVudCA9PT0gdGhpcy5jdXJQYWdlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmN1clBhZ2UgPSAkZXZlbnQ7CiAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDliIbpobXmnaHmlbDlj5jljJYNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25QYWdlU2l6ZUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25QYWdlU2l6ZUNoYW5nZSgkZXZlbnQpIHsKICAgICAgaWYgKCEkZXZlbnQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICgkZXZlbnQgPT09IHRoaXMubGltaXQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMubGltaXQgPSAkZXZlbnQ7CgogICAgICBpZiAodGhpcy5jdXJQYWdlID09PSAxKSB7CiAgICAgICAgdGhpcy5sb2FkKHt9KTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog5YiG6aG15Yi35pawDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwYWdlUmVmcmVzaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGFnZVJlZnJlc2goKSB7CiAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmjpLluo/lj5jljJYNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7eyBjb2x1bW46IGFueSwgcHJvcDogYW55LCBvcmRlcjogYW55IH19IHsgY29sdW1uLCBwcm9wLCBvcmRlciB9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25Tb3J0Q2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNvcnRDaGFuZ2UoX3JlZjQpIHsKICAgICAgdmFyIGNvbHVtbiA9IF9yZWY0LmNvbHVtbiwKICAgICAgICAgIHByb3AgPSBfcmVmNC5wcm9wLAogICAgICAgICAgb3JkZXIgPSBfcmVmNC5vcmRlcjsKICAgICAgdmFyIGRpciA9IE9iamVjdC5pcyhvcmRlciwgJ2FzY2VuZGluZycpID8gJ2FzYycgOiBPYmplY3QuaXMob3JkZXIsICdkZXNjZW5kaW5nJykgPyAnZGVzYycgOiAnJzsKCiAgICAgIGlmIChPYmplY3QuaXMoZGlyLCB0aGlzLm1pbm9yU29ydERpcikgJiYgT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0UFNERUYsIHByb3ApKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLm1pbm9yU29ydERpciA9IGRpcjsKICAgICAgdGhpcy5taW5vclNvcnRQU0RFRiA9IHByb3AgPyBwcm9wIDogJyc7CiAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDooajmoLzooYzpgInkuK3moLflvI8NCiAgICAgKg0KICAgICAqIEBwYXJhbSB7eyByb3c6IGFueSwgcm93SW5kZXg6IGFueSB9fSB7IHJvdywgcm93SW5kZXggfQ0KICAgICAqIEByZXR1cm5zIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25Sb3dDbGFzc05hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUm93Q2xhc3NOYW1lKF9yZWY1KSB7CiAgICAgIHZhciByb3cgPSBfcmVmNS5yb3csCiAgICAgICAgICByb3dJbmRleCA9IF9yZWY1LnJvd0luZGV4OwogICAgICB2YXIgaW5kZXggPSB0aGlzLnNlbGVjdGlvbnMuZmluZEluZGV4KGZ1bmN0aW9uIChzZWxlY3QpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmlzKHNlbGVjdC5zcmZrZXksIHJvdy5zcmZrZXkpOwogICAgICB9KTsKICAgICAgcmV0dXJuIGluZGV4ICE9PSAtMSA/ICdncmlkLXJvdy1zZWxlY3QnIDogJyc7CiAgICB9CiAgICAvKioNCiAgICAgKiDnlYzpnaLooYzkuLoNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gcm93DQogICAgICogQHBhcmFtIHsqfSB0YWcNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEBtZW1iZXJvZiBUWExYWUdCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInVpQWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1aUFjdGlvbihyb3csIHRhZywgJGV2ZW50KSB7CiAgICAgIC8vIHRoaXMucm93Q2xpY2socm93LCB0cnVlKTsKICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgfQogICAgLyoqDQogICAgICog6K6+572u5YiX54q25oCBDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZXRDb2xTdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q29sU3RhdGUoKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHZhciBfZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwaW1wZXJzb25fdHhseHlnX2dyaWQnKTsKCiAgICAgIGlmIChfZGF0YSkgewogICAgICAgIHZhciBjb2x1bW5zID0gSlNPTi5wYXJzZShfZGF0YSk7CiAgICAgICAgY29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChjb2wpIHsKICAgICAgICAgIHZhciBjb2x1bW4gPSBfdGhpczExLmFsbENvbHVtbnMuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGNvbC5uYW1lLCBpdGVtLm5hbWUpOwogICAgICAgICAgfSk7CgogICAgICAgICAgaWYgKGNvbHVtbikgewogICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbHVtbiwgY29sKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog5YiX5Y+Y5YyWDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvbkNvbENoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25Db2xDaGFuZ2UoKSB7CiAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwaW1wZXJzb25fdHhseHlnX2dyaWQnLCBKU09OLnN0cmluZ2lmeSh0aGlzLmFsbENvbHVtbnMpKTsKICAgIH0KICAgIC8qKg0KICAgICAqIOiOt+WPluWIl+eKtuaAgQ0KICAgICAqDQogICAgICogQHBhcmFtIHtzdHJpbmd9IG5hbWUNCiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDb2x1bW5TdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29sdW1uU3RhdGUobmFtZSkgewogICAgICB2YXIgY29sdW1uID0gdGhpcy5hbGxDb2x1bW5zLmZpbmQoZnVuY3Rpb24gKGNvbCkgewogICAgICAgIHJldHVybiBPYmplY3QuaXMobmFtZSwgY29sLm5hbWUpOwogICAgICB9KTsKICAgICAgcmV0dXJuIGNvbHVtbi5zaG93ID8gdHJ1ZSA6IGZhbHNlOwogICAgfQogICAgLyoqDQogICAgICog6KGo5qC85YiX5piv5ZCm6Ieq6YCC5bqU5biD5bGADQogICAgICoNCiAgICAgKiBAcmVhZG9ubHkNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzYXZlIiwKCiAgICAvKioNCiAgICAgKiDkv53lrZgNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9zYXZlID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoYXJncywgcGFyYW1zLCAkZXZlbnQsIHhEYXRhKSB7CiAgICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgICB2YXIgX3RoaXMsIHN1Y2Nlc3NJdGVtcywgZXJyb3JJdGVtcywgZXJyb3JNZXNzYWdlLCBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiwgX2RpZEl0ZXJhdG9yRXJyb3IyLCBfaXRlcmF0b3JFcnJvcjIsIF9pdGVyYXRvcjIsIF9zdGVwMiwgaXRlbSwgcmVzcG9uc2UsIF9yZXNwb25zZTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDYpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ2LnByZXYgPSBfY29udGV4dDYubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF90aGlzID0gdGhpczsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnZhbGlkYXRlQWxsKCk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIGlmIChfY29udGV4dDYuc2VudCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgZGVzYzogJ+WAvOinhOWImeagoemqjOW8guW4uCcKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIFtdKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgc3VjY2Vzc0l0ZW1zID0gW107CiAgICAgICAgICAgICAgICBlcnJvckl0ZW1zID0gW107CiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2UgPSBbXTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlOwogICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IyID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSAxMjsKICAgICAgICAgICAgICAgIF9pdGVyYXRvcjIgPSBfdGhpcy5pdGVtc1tTeW1ib2wuaXRlcmF0b3JdKCk7CgogICAgICAgICAgICAgIGNhc2UgMTQ6CiAgICAgICAgICAgICAgICBpZiAoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0OTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaXRlbSA9IF9zdGVwMi52YWx1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gMTY7CgogICAgICAgICAgICAgICAgaWYgKCFPYmplY3QuaXMoaXRlbS5yb3dEYXRhU3RhdGUsICdjcmVhdGUnKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI5OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAodGhpcy5jcmVhdGVBY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyMjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICBkZXNjOiAnUElNUEVSU09OTFRYWUdHcmlkVmlld+inhuWbvuihqOagvGNyZWF0ZUFjdGlvbuWPguaVsOacqumFjee9ricKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyNzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihpdGVtLCB7CiAgICAgICAgICAgICAgICAgIHZpZXdwYXJhbXM6IHRoaXMudmlld3BhcmFtcwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZS5hZGQodGhpcy5jcmVhdGVBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGl0ZW0sIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICAgIHN1Y2Nlc3NJdGVtcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpKTsKCiAgICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNDA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICAgIGlmICghT2JqZWN0LmlzKGl0ZW0ucm93RGF0YVN0YXRlLCAndXBkYXRlJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0MDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMudXBkYXRlQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgZGVzYzogJ1BJTVBFUlNPTkxUWFlHR3JpZFZpZXfop4blm77ooajmoLx1cGRhdGVBY3Rpb27lj4LmlbDmnKrphY3nva4nCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNDA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAzNDoKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oaXRlbSwgewogICAgICAgICAgICAgICAgICB2aWV3cGFyYW1zOiB0aGlzLnZpZXdwYXJhbXMKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgIGlmIChpdGVtLnBpbXBlcnNvbikgewogICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuY29udGV4dCwgewogICAgICAgICAgICAgICAgICAgIHBpbXBlcnNvbjogaXRlbS5waW1wZXJzb24KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzODsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnNlcnZpY2UuYWRkKHRoaXMudXBkYXRlQWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBpdGVtLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKCiAgICAgICAgICAgICAgY2FzZSAzODoKICAgICAgICAgICAgICAgIF9yZXNwb25zZSA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgc3VjY2Vzc0l0ZW1zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfcmVzcG9uc2UuZGF0YSkpKTsKCiAgICAgICAgICAgICAgY2FzZSA0MDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNDY7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA0MjoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gNDI7CiAgICAgICAgICAgICAgICBfY29udGV4dDYudDAgPSBfY29udGV4dDZbImNhdGNoIl0oMTYpOwogICAgICAgICAgICAgICAgZXJyb3JJdGVtcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoaXRlbSkpKTsKICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZS5wdXNoKF9jb250ZXh0Ni50MCk7CgogICAgICAgICAgICAgIGNhc2UgNDY6CiAgICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNDk6CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDU1OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgNTE6CiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDUxOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2LnQxID0gX2NvbnRleHQ2WyJjYXRjaCJdKDEyKTsKICAgICAgICAgICAgICAgIF9kaWRJdGVyYXRvckVycm9yMiA9IHRydWU7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3JFcnJvcjIgPSBfY29udGV4dDYudDE7CgogICAgICAgICAgICAgIGNhc2UgNTU6CiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDU1OwogICAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSA1NjsKCiAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yICYmIF9pdGVyYXRvcjJbInJldHVybiJdICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgX2l0ZXJhdG9yMlsicmV0dXJuIl0oKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSA1ODoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gNTg7CgogICAgICAgICAgICAgICAgaWYgKCFfZGlkSXRlcmF0b3JFcnJvcjIpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA2MTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3IyOwoKICAgICAgICAgICAgICBjYXNlIDYxOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5maW5pc2goNTgpOwoKICAgICAgICAgICAgICBjYXNlIDYyOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5maW5pc2goNTUpOwoKICAgICAgICAgICAgICBjYXNlIDYzOgogICAgICAgICAgICAgICAgdGhpcy4kZW1pdCgnc2F2ZScsIHN1Y2Nlc3NJdGVtcyk7CiAgICAgICAgICAgICAgICB0aGlzLnJlZnJlc2goW10pOwoKICAgICAgICAgICAgICAgIGlmIChlcnJvckl0ZW1zLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2Uuc3VjY2Vzcyh7CiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICcnLAogICAgICAgICAgICAgICAgICAgIGRlc2M6ICfkv53lrZjmiJDlip8hJwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGVycm9ySXRlbXMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICAgICAgICAgICAgICBfdGhpczEyLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfkv53lrZjlpLHotKUnLAogICAgICAgICAgICAgICAgICAgICAgZGVzYzogaXRlbS5tYWpvcmVudGl0eW5hbWUgKyAn5L+d5a2Y5aSx6LSl77yBJwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yTWVzc2FnZVtpbmRleF0pOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmFicnVwdCgicmV0dXJuIiwgc3VjY2Vzc0l0ZW1zKTsKCiAgICAgICAgICAgICAgY2FzZSA2NzoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNSwgdGhpcywgW1sxMiwgNTEsIDU1LCA2M10sIFsxNiwgNDJdLCBbNTYsLCA1OCwgNjJdXSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHNhdmUoX3g1LCBfeDYsIF94NywgX3g4KSB7CiAgICAgICAgcmV0dXJuIF9zYXZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBzYXZlOwogICAgfSgpCiAgICAvKioNCiAgICAgKiDmlrDlu7rooYwNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAibmV3Um93IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBuZXdSb3coYXJncywgcGFyYW1zLCAkZXZlbnQsIHhEYXRhKSB7CiAgICAgIHZhciBfdGhpczEzID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5sb2FkZHJhZnRBY3Rpb24pIHsKICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgZGVzYzogJ1BJTVBFUlNPTkxUWFlHR3JpZFZpZXfop4blm77ooajmoLxsb2FkZHJhZnRBY3Rpb27lj4LmlbDmnKrphY3nva4nCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgT2JqZWN0LmFzc2lnbihhcmdzWzBdLCB7CiAgICAgICAgdmlld3BhcmFtczogdGhpcy52aWV3cGFyYW1zCiAgICAgIH0pOwogICAgICB2YXIgcG9zdCA9IHRoaXMuc2VydmljZS5sb2FkRHJhZnQodGhpcy5sb2FkZHJhZnRBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGFyZ3NbMF0sIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICBwb3N0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKCFyZXNwb25zZS5zdGF0dXMgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvck1lc3NhZ2UpIHsKICAgICAgICAgICAgX3RoaXMxMy4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgICAgZGVzYzogcmVzcG9uc2UuZXJyb3JNZXNzYWdlCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgX3RoaXMxMy5jcmVhdGVEZWZhdWx0KGRhdGEpOwoKICAgICAgICBkYXRhLnJvd0RhdGFTdGF0ZSA9ICJjcmVhdGUiOwoKICAgICAgICBfdGhpcy5pdGVtcy5wdXNoKGRhdGEpOwoKICAgICAgICBfdGhpcy5ncmlkSXRlbXNNb2RlbC5wdXNoKF90aGlzLmdldEdyaWRSb3dNb2RlbCgpKTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIF90aGlzMTMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogJ+ezu+e7n+W8guW4uCcKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6KGo5qC857yW6L6R6aG55YC85Y+Y5pu0DQogICAgICoNCiAgICAgKiBAcGFyYW0gcm93IOihjOaVsOaNrg0KICAgICAqIEBwYXJhbSB7eyBuYW1lOiBzdHJpbmcsIHZhbHVlOiBhbnkgfX0gJGV2ZW50DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25HcmlkSXRlbVZhbHVlQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkdyaWRJdGVtVmFsdWVDaGFuZ2Uocm93LCAkZXZlbnQsIHJvd0luZGV4KSB7CiAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoISRldmVudC5uYW1lIHx8IE9iamVjdC5pcygkZXZlbnQubmFtZSwgJycpIHx8ICFyb3cuaGFzT3duUHJvcGVydHkoJGV2ZW50Lm5hbWUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICByb3dbJGV2ZW50Lm5hbWVdID0gJGV2ZW50LnZhbHVlOwogICAgICB0aGlzLmdyaWRFZGl0SXRlbUNoYW5nZShyb3csICRldmVudC5uYW1lLCAkZXZlbnQudmFsdWUsIHJvd0luZGV4KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOihqOagvOe8lui+kemhueWAvOWPmOWMlg0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEBwYXJhbSByb3cg6KGM5pWw5o2uDQogICAgICogQHBhcmFtIHByb3BlcnR5IOWIl+e8lui+kemhueWQjQ0KICAgICAqIEBwYXJhbSByb3cg5YiX57yW6L6R6aG55YC8DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ3JpZEVkaXRJdGVtQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBncmlkRWRpdEl0ZW1DaGFuZ2Uocm93LCBwcm9wZXJ0eSwgdmFsdWUsIHJvd0luZGV4KSB7CiAgICAgIHJvdy5yb3dEYXRhU3RhdGUgPSByb3cucm93RGF0YVN0YXRlID8gcm93LnJvd0RhdGFTdGF0ZSA6ICJ1cGRhdGUiOwogICAgICB0aGlzLnZhbGlkYXRlKHByb3BlcnR5LCByb3csIHJvd0luZGV4KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOihqOagvOe8lui+kemhueabtOaWsA0KICAgICAqDQogICAgICogQHBhcmFtIHtzdHJpbmd9IG1vZGUg55WM6Z2i6KGM5Li65ZCN56ewDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0g6K+35rGC5pWw5o2uDQogICAgICogQHBhcmFtIHtzdHJpbmdbXX0gdXBkYXRlRGV0YWlscyDmm7TmlrDpobkNCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtzaG93bG9hZGluZ10g5piv5ZCm5pi+56S65Yqg6L2954q25oCBDQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAidXBkYXRlR3JpZEVkaXRJdGVtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVHcmlkRWRpdEl0ZW0obW9kZSkgewogICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciB1cGRhdGVEZXRhaWxzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgICAgIHZhciBzaG93bG9hZGluZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdW5kZWZpbmVkOwoKICAgICAgaWYgKCFtb2RlIHx8IG1vZGUgJiYgT2JqZWN0LmlzKG1vZGUsICcnKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGFyZyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICBPYmplY3QuYXNzaWduKGFyZywgewogICAgICAgIHZpZXdwYXJhbXM6IHRoaXMudmlld3BhcmFtcwogICAgICB9KTsKICAgICAgdmFyIHBvc3QgPSB0aGlzLnNlcnZpY2UuZnJvbnRMb2dpYyhtb2RlLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBhcmcsIHNob3dsb2FkaW5nKTsKICAgICAgcG9zdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIF90aGlzMTQuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogJ+ihqOWNlemhueabtOaWsOWksei0pScKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBfZGF0YSA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgIGlmICghX2RhdGEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHVwZGF0ZURldGFpbHMuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkgewogICAgICAgICAgaWYgKCFfZGF0YS5oYXNPd25Qcm9wZXJ0eShuYW1lKSkgewogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CgogICAgICAgICAgZGF0YVtuYW1lXSA9IF9kYXRhW25hbWVdOwogICAgICAgIH0pOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgX3RoaXMxNC4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICBkZXNjOiAn57O757uf5byC5bi4JwogICAgICAgICAgfSk7CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5blr7nlupTooYxjbGFzcw0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSAkYXJncyByb3cg6KGM5pWw5o2u77yMcm93SW5kZXgg6KGM57Si5byVDQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIFRYTFhZR0Jhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Um93Q2xhc3NOYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSb3dDbGFzc05hbWUoYXJncykgewogICAgICB2YXIgaXNTZWxlY3RlZCA9IHRoaXMuc2VsZWN0aW9ucy5zb21lKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhpdGVtLnBpbXBlcnNvbiwgYXJncy5yb3cucGltcGVyc29uKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBpc1NlbGVjdGVkID8gImdyaWQtc2VsZWN0ZWQtcm93IiA6ICIiOwogICAgfQogICAgLyoqDQogICAgICog6I635Y+W5a+55bqU5YiXY2xhc3MNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGFyZ3Mgcm93IOihjOaVsOaNru+8jGNvbHVtbiDliJfmlbDmja7vvIxyb3dJbmRleCDooYzntKLlvJXvvIzliJfntKLlvJUNCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRDZWxsQ2xhc3NOYW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDZWxsQ2xhc3NOYW1lKGFyZ3MpIHsKICAgICAgdmFyIGhhc1Jvd0VkaXQgPSB7CiAgICAgICAgJ3lnYmgnOiBmYWxzZSwKICAgICAgICAncGltcGVyc29ubmFtZSc6IGZhbHNlLAogICAgICAgICd4Yic6IGZhbHNlLAogICAgICAgICduaic6IGZhbHNlLAogICAgICAgICdwb3N0YWxhZGRyZXNzJzogZmFsc2UsCiAgICAgICAgJ3JldGlwbGFjZSc6IGZhbHNlLAogICAgICAgICdqdGx4cic6IGZhbHNlLAogICAgICAgICdqdGx4cmRoJzogZmFsc2UsCiAgICAgICAgJ3p6ZHpzJzogZmFsc2UsCiAgICAgICAgJ29ybW9yZ3NlY3Rvcm5hbWUnOiBmYWxzZSwKICAgICAgICAncmFuayc6IGZhbHNlLAogICAgICAgICd6dyc6IGZhbHNlLAogICAgICAgICdndyc6IGZhbHNlLAogICAgICAgICd0eGRxJzogZmFsc2UsCiAgICAgICAgJ3NqdHhycSc6IGZhbHNlLAogICAgICAgICdseGRoJzogZmFsc2UsCiAgICAgICAgJ3NwZHlsamUnOiBmYWxzZQogICAgICB9OwogICAgICByZXR1cm4gaGFzUm93RWRpdFthcmdzLmNvbHVtbi5wcm9wZXJ0eV0gJiYgdGhpcy5hY3R1YWxJc09wZW5FZGl0ID8gImVkaXQtY2VsbCIgOiAiaW5mby1jZWxsIjsKICAgIH0KICAgIC8qKg0KICAgICAqIOaWsOW7uum7mOiupOWAvA0KICAgICAqIEBwYXJhbSB7Kn0gIHJvdyDooYzmlbDmja4NCiAgICAgKiBAbWVtYmVyb2YgVFhMWFlHQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJjcmVhdGVEZWZhdWx0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVEZWZhdWx0KHJvdykge30KICB9LCB7CiAgICBrZXk6ICJhZGFwdGl2ZVN0YXRlIiwKICAgIGdldDogZnVuY3Rpb24gZ2V0KCkgewogICAgICByZXR1cm4gIXRoaXMuYWxsQ29sdW1ucy5maW5kKGZ1bmN0aW9uIChjb2x1bW4pIHsKICAgICAgICByZXR1cm4gY29sdW1uLnNob3cgJiYgT2JqZWN0LmlzKGNvbHVtbi51dGlsLCAnU1RBUicpOwogICAgICB9KTsKICAgIH0KICB9XSk7CgogIHJldHVybiBUWExYWUdCYXNlOwp9KFZ1ZSk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAibmFtZSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAidmlld1N0YXRlIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgVFhMWFlHQmFzZS5wcm90b3R5cGUsICJjb250ZXh0Iiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgVFhMWFlHQmFzZS5wcm90b3R5cGUsICJ2aWV3cGFyYW1zIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgVFhMWFlHQmFzZS5wcm90b3R5cGUsICJuZXdkYXRhIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgVFhMWFlHQmFzZS5wcm90b3R5cGUsICJvcGVuZGF0YSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoewogICJkZWZhdWx0IjogdHJ1ZQp9KV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAic2hvd0J1c3lJbmRpY2F0b3IiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBUWExYWUdCYXNlLnByb3RvdHlwZSwgInVwZGF0ZUFjdGlvbiIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAiZmV0Y2hBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBUWExYWUdCYXNlLnByb3RvdHlwZSwgInJlbW92ZUFjdGlvbiIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAibG9hZEFjdGlvbiIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAibG9hZGRyYWZ0QWN0aW9uIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgVFhMWFlHQmFzZS5wcm90b3R5cGUsICJjcmVhdGVBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKHsKICAiZGVmYXVsdCI6IGZhbHNlCn0pXSwgVFhMWFlHQmFzZS5wcm90b3R5cGUsICJpc1NlbGVjdEZpcnN0RGVmYXVsdCIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAiaXNTaW5nbGVTZWxlY3QiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBUWExYWUdCYXNlLnByb3RvdHlwZSwgInNlbGVjdGVkRGF0YSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1dhdGNoKCdzZWxlY3RlZERhdGEnKV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAib25WYWx1ZUNoYW5nZSIsIG51bGwpOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKHsKICAiZGVmYXVsdCI6IDIKfSldLCBUWExYWUdCYXNlLnByb3RvdHlwZSwgImdyaWRSb3dBY3RpdmVNb2RlIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCh7CiAgImRlZmF1bHQiOiBmYWxzZQp9KV0sIFRYTFhZR0Jhc2UucHJvdG90eXBlLCAiaXNPcGVuRWRpdCIsIHZvaWQgMCk7CgpUWExYWUdCYXNlID0gdHNsaWJfMS5fX2RlY29yYXRlKFtDb21wb25lbnQoewogIGNvbXBvbmVudHM6IHt9Cn0pXSwgVFhMWFlHQmFzZSk7CmV4cG9ydCBkZWZhdWx0IFRYTFhZR0Jhc2U7"},null]}