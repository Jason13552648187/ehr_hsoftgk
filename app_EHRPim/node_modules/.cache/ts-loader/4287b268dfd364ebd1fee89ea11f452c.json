{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js??ref--14-3!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-contract-type\\main-form\\main-form-base.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-contract-type\\main-form\\main-form-base.vue","mtime":1630509411409},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0aWVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5pcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC52YWx1ZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnRpbWVycyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjsKaW1wb3J0IF9nZXRQcm90b3R5cGVPZiBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2Fzc2VydFRoaXNJbml0aWFsaXplZCBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vYXNzZXJ0VGhpc0luaXRpYWxpemVkIjsKaW1wb3J0IF9pbmhlcml0cyBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vaW5oZXJpdHMiOwoKZnVuY3Rpb24gb3duS2V5cyhvYmplY3QsIGVudW1lcmFibGVPbmx5KSB7IHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqZWN0KTsgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMpIHsgdmFyIHN5bWJvbHMgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKG9iamVjdCk7IGlmIChlbnVtZXJhYmxlT25seSkgc3ltYm9scyA9IHN5bWJvbHMuZmlsdGVyKGZ1bmN0aW9uIChzeW0pIHsgcmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Iob2JqZWN0LCBzeW0pLmVudW1lcmFibGU7IH0pOyBrZXlzLnB1c2guYXBwbHkoa2V5cywgc3ltYm9scyk7IH0gcmV0dXJuIGtleXM7IH0KCmZ1bmN0aW9uIF9vYmplY3RTcHJlYWQodGFyZ2V0KSB7IGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7IHZhciBzb3VyY2UgPSBhcmd1bWVudHNbaV0gIT0gbnVsbCA/IGFyZ3VtZW50c1tpXSA6IHt9OyBpZiAoaSAlIDIpIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSwgdHJ1ZSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IF9kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgc291cmNlW2tleV0pOyB9KTsgfSBlbHNlIGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycykgeyBPYmplY3QuZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKHNvdXJjZSkpOyB9IGVsc2UgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKHNvdXJjZSwga2V5KSk7IH0pOyB9IH0gcmV0dXJuIHRhcmdldDsgfQoKaW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tICJ0c2xpYiI7CmltcG9ydCB7IFZ1ZSwgQ29tcG9uZW50LCBQcm9wLCBXYXRjaCB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InOwppbXBvcnQgeyBTdWJqZWN0IH0gZnJvbSAncnhqcyc7CmltcG9ydCB7IFV0aWwgfSBmcm9tICdAL3V0aWxzJzsKaW1wb3J0IFBpbUNvbnRyYWN0VHlwZVNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL3BpbS1jb250cmFjdC10eXBlL3BpbS1jb250cmFjdC10eXBlLXNlcnZpY2UnOwppbXBvcnQgTWFpblNlcnZpY2UgZnJvbSAnLi9tYWluLWZvcm0tc2VydmljZSc7CmltcG9ydCB7IEZvcm1QYWdlTW9kZWwsIEZvcm1JdGVtTW9kZWwsIEZvcm1Hcm91cFBhbmVsTW9kZWwgfSBmcm9tICdAL21vZGVsL2Zvcm0tZGV0YWlsJzsKaW1wb3J0IHsgZGVib3VuY2VUaW1lLCBkaXN0aW5jdFVudGlsQ2hhbmdlZCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJzsKCnZhciBNYWluQmFzZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9WdWUpIHsKICBfaW5oZXJpdHMoTWFpbkJhc2UsIF9WdWUpOwoKICBmdW5jdGlvbiBNYWluQmFzZSgpIHsKICAgIHZhciBfdGhpczI7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1haW5CYXNlKTsKCiAgICBfdGhpczIgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoTWFpbkJhc2UpLmFwcGx5KHRoaXMsIGFyZ3VtZW50cykpOwogICAgLyoqDQogICAgICog6K6h5pWw5Zmo5pyN5Yqh5a+56LGh6ZuG5ZCIDQogICAgICoNCiAgICAgKiBAdHlwZSB7QXJyYXk8Kj59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogICAgX3RoaXMyLmNvdW50ZXJTZXJ2aWNlQXJyYXkgPSBbXTsKICAgIC8qKg0KICAgICAqIOW7uuaehOmDqOS7tuacjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge01haW5TZXJ2aWNlfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5zZXJ2aWNlID0gbmV3IE1haW5TZXJ2aWNlKHsKICAgICAgJHN0b3JlOiBfdGhpczIuJHN0b3JlCiAgICB9KTsKICAgIC8qKg0KICAgICAqIOWunuS9k+acjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge1BpbUNvbnRyYWN0VHlwZVNlcnZpY2V9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogICAgX3RoaXMyLmFwcEVudGl0eVNlcnZpY2UgPSBuZXcgUGltQ29udHJhY3RUeXBlU2VydmljZSh7CiAgICAgICRzdG9yZTogX3RoaXMyLiRzdG9yZQogICAgfSk7CiAgICAvKioNCiAgICAgKiDlt6XkvZzmtYHlrqHmibnmhI/op4Hmjqfku7bnu5HlrprlgLwNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5zcmZ3Zm1lbW8gPSAiIjsKICAgIC8qKg0KICAgICAqIOihqOWNleeKtuaAgQ0KICAgICAqDQogICAgICogQHR5cGUge1N1YmplY3Q8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuZm9ybVN0YXRlID0gbmV3IFN1YmplY3QoKTsKICAgIC8qKg0KICAgICAqIOW/veeVpeihqOWNlemhueWAvOWPmOWMlg0KICAgICAqDQogICAgICogQHR5cGUge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogICAgX3RoaXMyLmlnbm9yZWZpZWxkdmFsdWVjaGFuZ2UgPSBmYWxzZTsKICAgIC8qKg0KICAgICAqIOaVsOaNruWPmOWMlg0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEB0eXBlIHtTdWJqZWN0PGFueT59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogICAgX3RoaXMyLmRhdGFDaGFuZyA9IG5ldyBTdWJqZWN0KCk7CiAgICAvKioNCiAgICAgKiDljp/lp4vmlbDmja4NCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAdHlwZSB7Kn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIub2xkRGF0YSA9IHt9OwogICAgLyoqDQogICAgICog6KGo5Y2V5pWw5o2u5a+56LGhDQogICAgICoNCiAgICAgKiBAdHlwZSB7Kn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuZGF0YSA9IHsKICAgICAgc3JmdXBkYXRlZGF0ZTogbnVsbCwKICAgICAgc3Jmb3Jpa2V5OiBudWxsLAogICAgICBzcmZrZXk6IG51bGwsCiAgICAgIHNyZm1ham9ydGV4dDogbnVsbCwKICAgICAgc3JmdGVtcG1vZGU6IG51bGwsCiAgICAgIHNyZnVmOiBudWxsLAogICAgICBzcmZkZWlkOiBudWxsLAogICAgICBzcmZzb3VyY2VrZXk6IG51bGwsCiAgICAgIHNibTogbnVsbCwKICAgICAgcGltY29udHJhY3R0eXBlbmFtZTogbnVsbCwKICAgICAgcGltY29udHJhY3R0eXBlaWQ6IG51bGwsCiAgICAgIHBpbWNvbnRyYWN0dHlwZTogbnVsbAogICAgfTsKICAgIC8qKg0KICAgICAgKiDlvZPliY3miafooYznmoTooYzkuLrpgLvovpENCiAgICAgICoNCiAgICAgICogQHR5cGUge3N0cmluZ30NCiAgICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICAqLwoKICAgIF90aGlzMi5jdXJyZW50QWN0aW9uID0gIiI7CiAgICAvKioNCiAgICAgICog5YWz57O755WM6Z2i6K6h5pWw5ZmoDQogICAgICAqDQogICAgICAqIEB0eXBlIHtudW1iZXJ9DQogICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAgKi8KCiAgICBfdGhpczIuZHJjb3VudGVyID0gMDsKICAgIC8qKg0KICAgICAgKiDpnIDopoHnrYnlvoXlhbPns7vnlYzpnaLkv53lrZjml7bvvIznrKzkuIDmrKHosIPnlKhzYXZl5Y+C5pWw55qE5aSH5Lu9DQogICAgICAqDQogICAgICAqIEB0eXBlIHtudW1iZXJ9DQogICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAgKi8KCiAgICBfdGhpczIuZHJzYXZlb3B0ID0ge307CiAgICAvKioNCiAgICAgKiDlsZ7mgKflgLzop4TliJkNCiAgICAgKg0KICAgICAqIEB0eXBlIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5ydWxlcyA9IHsKICAgICAgc3JmdXBkYXRlZGF0ZTogW3sKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAn5pu05paw5pe26Ze0IOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgIG1lc3NhZ2U6ICfmm7TmlrDml7bpl7Qg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfSwgewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAn5pu05paw5pe26Ze0IOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAn5pu05paw5pe26Ze0IOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dLAogICAgICBzcmZvcmlrZXk6IFt7CiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAnIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgc3Jma2V5OiBbewogICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgIG1lc3NhZ2U6ICflkIjlkIwv5Y2P6K6u57G75Z6L566h55CG5qCH6K+GIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgIG1lc3NhZ2U6ICflkIjlkIwv5Y2P6K6u57G75Z6L566h55CG5qCH6K+GIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjC/ljY/orq7nsbvlnovnrqHnkIbmoIfor4Yg5YC85LiN6IO95Li656m6JywKICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJwogICAgICB9LCB7CiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgIG1lc3NhZ2U6ICflkIjlkIwv5Y2P6K6u57G75Z6L566h55CG5qCH6K+GIOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dLAogICAgICBzcmZtYWpvcnRleHQ6IFt7CiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjOexu+WIq+WQjeensCDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAn5ZCI5ZCM57G75Yir5ZCN56ewIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjOexu+WIq+WQjeensCDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjOexu+WIq+WQjeensCDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgc3JmdGVtcG1vZGU6IFt7CiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAnIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgc3JmdWY6IFt7CiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAnIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgc3JmZGVpZDogW3sKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAnIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgIG1lc3NhZ2U6ICcg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfSwgewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAnIOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAnIOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dLAogICAgICBzcmZzb3VyY2VrZXk6IFt7CiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAnIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJyDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgc2JtOiBbewogICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgIG1lc3NhZ2U6ICflkIjlkIznsbvliKvku6PnoIEg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywKICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJwogICAgICB9LCB7CiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjOexu+WIq+S7o+eggSDlgLzlv4XpobvkuLrlrZfnrKbkuLLnsbvlnosnLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9LCB7CiAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjOexu+WIq+S7o+eggSDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAn5ZCI5ZCM57G75Yir5Luj56CBIOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dLAogICAgICBwaW1jb250cmFjdHR5cGVuYW1lOiBbewogICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgIG1lc3NhZ2U6ICflkIjlkIwv5Y2P6K6u57G75Z6L5ZCN56ewIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHR5cGU6ICdzdHJpbmcnLAogICAgICAgIG1lc3NhZ2U6ICflkIjlkIwv5Y2P6K6u57G75Z6L5ZCN56ewIOWAvOW/hemhu+S4uuWtl+espuS4suexu+WeiycsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAn5ZCI5ZCML+WNj+iuruexu+Wei+WQjeensCDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAn5ZCI5ZCML+WNj+iuruexu+Wei+WQjeensCDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdibHVyJwogICAgICB9XSwKICAgICAgcGltY29udHJhY3R0eXBlaWQ6IFt7CiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjC/ljY/orq7nsbvlnovnrqHnkIbmoIfor4Yg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywKICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJwogICAgICB9LCB7CiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjC/ljY/orq7nsbvlnovnrqHnkIbmoIfor4Yg5YC85b+F6aG75Li65a2X56ym5Liy57G75Z6LJywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfSwgewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB0eXBlOiAnc3RyaW5nJywKICAgICAgICBtZXNzYWdlOiAn5ZCI5ZCML+WNj+iuruexu+Wei+euoeeQhuagh+ivhiDlgLzkuI3og73kuLrnqbonLAogICAgICAgIHRyaWdnZXI6ICdjaGFuZ2UnCiAgICAgIH0sIHsKICAgICAgICByZXF1aXJlZDogZmFsc2UsCiAgICAgICAgdHlwZTogJ3N0cmluZycsCiAgICAgICAgbWVzc2FnZTogJ+WQiOWQjC/ljY/orq7nsbvlnovnrqHnkIbmoIfor4Yg5YC85LiN6IO95Li656m6JywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfV0KICAgIH07CiAgICAvKioNCiAgICAgKiDor6bmg4XmqKHlnovpm4blkIgNCiAgICAgKg0KICAgICAqIEB0eXBlIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5kZXRhaWxzTW9kZWwgPSB7CiAgICAgIGdyb3VwMTogbmV3IEZvcm1Hcm91cFBhbmVsTW9kZWwoewogICAgICAgIGNhcHRpb246ICflkIjlkIznsbvliKvkv6Hmga8nLAogICAgICAgIGRldGFpbFR5cGU6ICdHUk9VUFBBTkVMJywKICAgICAgICBuYW1lOiAnZ3JvdXAxJywKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIGlzU2hvd0NhcHRpb246IHRydWUsCiAgICAgICAgZm9ybTogX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpLAogICAgICAgIHVpQWN0aW9uR3JvdXA6IHsKICAgICAgICAgIGNhcHRpb246ICcnLAogICAgICAgICAgbGFuZ2Jhc2U6ICdlbnRpdGllcy5waW1jb250cmFjdHR5cGUubWFpbl9mb3JtJywKICAgICAgICAgIGV4dHJhY3RNb2RlOiAnSVRFTScsCiAgICAgICAgICBkZXRhaWxzOiBbXQogICAgICAgIH0KICAgICAgfSksCiAgICAgIGZvcm1wYWdlMTogbmV3IEZvcm1QYWdlTW9kZWwoewogICAgICAgIGNhcHRpb246ICfln7rmnKzkv6Hmga8nLAogICAgICAgIGRldGFpbFR5cGU6ICdGT1JNUEFHRScsCiAgICAgICAgbmFtZTogJ2Zvcm1wYWdlMScsCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBpc1Nob3dDYXB0aW9uOiB0cnVlLAogICAgICAgIGZvcm06IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKQogICAgICB9KSwKICAgICAgc3JmdXBkYXRlZGF0ZTogbmV3IEZvcm1JdGVtTW9kZWwoewogICAgICAgIGNhcHRpb246ICfmm7TmlrDml7bpl7QnLAogICAgICAgIGRldGFpbFR5cGU6ICdGT1JNSVRFTScsCiAgICAgICAgbmFtZTogJ3NyZnVwZGF0ZWRhdGUnLAogICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgaXNTaG93Q2FwdGlvbjogdHJ1ZSwKICAgICAgICBmb3JtOiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMiksCiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgIGVuYWJsZUNvbmQ6IDMKICAgICAgfSksCiAgICAgIHNyZm9yaWtleTogbmV3IEZvcm1JdGVtTW9kZWwoewogICAgICAgIGNhcHRpb246ICcnLAogICAgICAgIGRldGFpbFR5cGU6ICdGT1JNSVRFTScsCiAgICAgICAgbmFtZTogJ3NyZm9yaWtleScsCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBpc1Nob3dDYXB0aW9uOiB0cnVlLAogICAgICAgIGZvcm06IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSwKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgICAgZW5hYmxlQ29uZDogMwogICAgICB9KSwKICAgICAgc3Jma2V5OiBuZXcgRm9ybUl0ZW1Nb2RlbCh7CiAgICAgICAgY2FwdGlvbjogJ+WQiOWQjC/ljY/orq7nsbvlnovnrqHnkIbmoIfor4YnLAogICAgICAgIGRldGFpbFR5cGU6ICdGT1JNSVRFTScsCiAgICAgICAgbmFtZTogJ3NyZmtleScsCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBpc1Nob3dDYXB0aW9uOiB0cnVlLAogICAgICAgIGZvcm06IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSwKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgICAgZW5hYmxlQ29uZDogMwogICAgICB9KSwKICAgICAgc3JmbWFqb3J0ZXh0OiBuZXcgRm9ybUl0ZW1Nb2RlbCh7CiAgICAgICAgY2FwdGlvbjogJ+WQiOWQjOexu+WIq+WQjeensCcsCiAgICAgICAgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywKICAgICAgICBuYW1lOiAnc3JmbWFqb3J0ZXh0JywKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIGlzU2hvd0NhcHRpb246IHRydWUsCiAgICAgICAgZm9ybTogX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgICBlbmFibGVDb25kOiAzCiAgICAgIH0pLAogICAgICBzcmZ0ZW1wbW9kZTogbmV3IEZvcm1JdGVtTW9kZWwoewogICAgICAgIGNhcHRpb246ICcnLAogICAgICAgIGRldGFpbFR5cGU6ICdGT1JNSVRFTScsCiAgICAgICAgbmFtZTogJ3NyZnRlbXBtb2RlJywKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIGlzU2hvd0NhcHRpb246IHRydWUsCiAgICAgICAgZm9ybTogX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgICBlbmFibGVDb25kOiAzCiAgICAgIH0pLAogICAgICBzcmZ1ZjogbmV3IEZvcm1JdGVtTW9kZWwoewogICAgICAgIGNhcHRpb246ICcnLAogICAgICAgIGRldGFpbFR5cGU6ICdGT1JNSVRFTScsCiAgICAgICAgbmFtZTogJ3NyZnVmJywKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIGlzU2hvd0NhcHRpb246IHRydWUsCiAgICAgICAgZm9ybTogX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgICBlbmFibGVDb25kOiAzCiAgICAgIH0pLAogICAgICBzcmZkZWlkOiBuZXcgRm9ybUl0ZW1Nb2RlbCh7CiAgICAgICAgY2FwdGlvbjogJycsCiAgICAgICAgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywKICAgICAgICBuYW1lOiAnc3JmZGVpZCcsCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBpc1Nob3dDYXB0aW9uOiB0cnVlLAogICAgICAgIGZvcm06IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSwKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgICAgZW5hYmxlQ29uZDogMwogICAgICB9KSwKICAgICAgc3Jmc291cmNla2V5OiBuZXcgRm9ybUl0ZW1Nb2RlbCh7CiAgICAgICAgY2FwdGlvbjogJycsCiAgICAgICAgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywKICAgICAgICBuYW1lOiAnc3Jmc291cmNla2V5JywKICAgICAgICB2aXNpYmxlOiB0cnVlLAogICAgICAgIGlzU2hvd0NhcHRpb246IHRydWUsCiAgICAgICAgZm9ybTogX2Fzc2VydFRoaXNJbml0aWFsaXplZChfdGhpczIpLAogICAgICAgIGRpc2FibGVkOiBmYWxzZSwKICAgICAgICBlbmFibGVDb25kOiAzCiAgICAgIH0pLAogICAgICBzYm06IG5ldyBGb3JtSXRlbU1vZGVsKHsKICAgICAgICBjYXB0aW9uOiAn5ZCI5ZCM57G75Yir5Luj56CBJywKICAgICAgICBkZXRhaWxUeXBlOiAnRk9STUlURU0nLAogICAgICAgIG5hbWU6ICdzYm0nLAogICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgaXNTaG93Q2FwdGlvbjogdHJ1ZSwKICAgICAgICBmb3JtOiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMiksCiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgIGVuYWJsZUNvbmQ6IDMKICAgICAgfSksCiAgICAgIHBpbWNvbnRyYWN0dHlwZW5hbWU6IG5ldyBGb3JtSXRlbU1vZGVsKHsKICAgICAgICBjYXB0aW9uOiAn5ZCI5ZCML+WNj+iuruexu+Wei+WQjeensCcsCiAgICAgICAgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywKICAgICAgICBuYW1lOiAncGltY29udHJhY3R0eXBlbmFtZScsCiAgICAgICAgdmlzaWJsZTogdHJ1ZSwKICAgICAgICBpc1Nob3dDYXB0aW9uOiB0cnVlLAogICAgICAgIGZvcm06IF9hc3NlcnRUaGlzSW5pdGlhbGl6ZWQoX3RoaXMyKSwKICAgICAgICBkaXNhYmxlZDogZmFsc2UsCiAgICAgICAgZW5hYmxlQ29uZDogMwogICAgICB9KSwKICAgICAgcGltY29udHJhY3R0eXBlaWQ6IG5ldyBGb3JtSXRlbU1vZGVsKHsKICAgICAgICBjYXB0aW9uOiAn5ZCI5ZCML+WNj+iuruexu+Wei+euoeeQhuagh+ivhicsCiAgICAgICAgZGV0YWlsVHlwZTogJ0ZPUk1JVEVNJywKICAgICAgICBuYW1lOiAncGltY29udHJhY3R0eXBlaWQnLAogICAgICAgIHZpc2libGU6IHRydWUsCiAgICAgICAgaXNTaG93Q2FwdGlvbjogdHJ1ZSwKICAgICAgICBmb3JtOiBfYXNzZXJ0VGhpc0luaXRpYWxpemVkKF90aGlzMiksCiAgICAgICAgZGlzYWJsZWQ6IGZhbHNlLAogICAgICAgIGVuYWJsZUNvbmQ6IDMKICAgICAgfSkKICAgIH07CiAgICByZXR1cm4gX3RoaXMyOwogIH0KICAvKioNCiAgICog6I635Y+W6YOo5Lu257G75Z6LDQogICAqDQogICAqIEByZXR1cm5zIHtzdHJpbmd9DQogICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhNYWluQmFzZSwgW3sKICAgIGtleTogImdldENvbnRyb2xUeXBlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRDb250cm9sVHlwZSgpIHsKICAgICAgcmV0dXJuICdGT1JNJzsKICAgIH0KICAgIC8qKg0KICAgICAqIOWFs+mXreinhuWbvg0KICAgICAqDQogICAgICogQHBhcmFtIHthbnl9IGFyZ3MNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY2xvc2VWaWV3IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjbG9zZVZpZXcoYXJncykgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuJGVtaXQoJ2Nsb3NldmlldycsIFthcmdzXSk7CiAgICB9CiAgICAvKioNCiAgICAgKiAg6K6h5pWw5Zmo5Yi35pawDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY291bnRlclJlZnJlc2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvdW50ZXJSZWZyZXNoKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLmNvdW50ZXJTZXJ2aWNlQXJyYXkgJiYgX3RoaXMuY291bnRlclNlcnZpY2VBcnJheS5sZW5ndGggPiAwKSB7CiAgICAgICAgX3RoaXMuY291bnRlclNlcnZpY2VBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpZiAoaXRlbS5yZWZyZXNoRGF0YSAmJiBpdGVtLnJlZnJlc2hEYXRhIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgICAgaXRlbS5yZWZyZXNoRGF0YSgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5blpJrpobnmlbDmja4NCiAgICAgKg0KICAgICAqIEByZXR1cm5zIHthbnlbXX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0RGF0YXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGFzKCkgewogICAgICByZXR1cm4gW3RoaXMuZGF0YV07CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5bljZXpobnmoJENCiAgICAgKg0KICAgICAqIEByZXR1cm5zIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXREYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXREYXRhKCkgewogICAgICByZXR1cm4gdGhpcy5kYXRhOwogICAgfQogICAgLyoqDQogICAgICog55uR5o6n6KGo5Y2V5bGe5oCnIHNyZnVwZGF0ZWRhdGUg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uU3JmdXBkYXRlZGF0ZUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TcmZ1cGRhdGVkYXRlQ2hhbmdlKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoewogICAgICAgIG5hbWU6ICdzcmZ1cGRhdGVkYXRlJywKICAgICAgICBuZXdWYWw6IG5ld1ZhbCwKICAgICAgICBvbGRWYWw6IG9sZFZhbAogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBzcmZvcmlrZXkg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uU3Jmb3Jpa2V5Q2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNyZm9yaWtleUNoYW5nZShuZXdWYWwsIG9sZFZhbCkgewogICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsKICAgICAgICBuYW1lOiAnc3Jmb3Jpa2V5JywKICAgICAgICBuZXdWYWw6IG5ld1ZhbCwKICAgICAgICBvbGRWYWw6IG9sZFZhbAogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBzcmZrZXkg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uU3Jma2V5Q2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNyZmtleUNoYW5nZShuZXdWYWwsIG9sZFZhbCkgewogICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsKICAgICAgICBuYW1lOiAnc3Jma2V5JywKICAgICAgICBuZXdWYWw6IG5ld1ZhbCwKICAgICAgICBvbGRWYWw6IG9sZFZhbAogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBzcmZtYWpvcnRleHQg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uU3JmbWFqb3J0ZXh0Q2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNyZm1ham9ydGV4dENoYW5nZShuZXdWYWwsIG9sZFZhbCkgewogICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsKICAgICAgICBuYW1lOiAnc3JmbWFqb3J0ZXh0JywKICAgICAgICBuZXdWYWw6IG5ld1ZhbCwKICAgICAgICBvbGRWYWw6IG9sZFZhbAogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBzcmZ0ZW1wbW9kZSDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsDQogICAgICogQHBhcmFtIHsqfSBvbGRWYWwNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25TcmZ0ZW1wbW9kZUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25TcmZ0ZW1wbW9kZUNoYW5nZShuZXdWYWwsIG9sZFZhbCkgewogICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsKICAgICAgICBuYW1lOiAnc3JmdGVtcG1vZGUnLAogICAgICAgIG5ld1ZhbDogbmV3VmFsLAogICAgICAgIG9sZFZhbDogb2xkVmFsCiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog55uR5o6n6KGo5Y2V5bGe5oCnIHNyZnVmIOWAvA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBuZXdWYWwNCiAgICAgKiBAcGFyYW0geyp9IG9sZFZhbA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvblNyZnVmQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNyZnVmQ2hhbmdlKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoewogICAgICAgIG5hbWU6ICdzcmZ1ZicsCiAgICAgICAgbmV3VmFsOiBuZXdWYWwsCiAgICAgICAgb2xkVmFsOiBvbGRWYWwKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDnm5HmjqfooajljZXlsZ7mgKcgc3JmZGVpZCDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsDQogICAgICogQHBhcmFtIHsqfSBvbGRWYWwNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25TcmZkZWlkQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNyZmRlaWRDaGFuZ2UobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgdGhpcy5mb3JtRGF0YUNoYW5nZSh7CiAgICAgICAgbmFtZTogJ3NyZmRlaWQnLAogICAgICAgIG5ld1ZhbDogbmV3VmFsLAogICAgICAgIG9sZFZhbDogb2xkVmFsCiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog55uR5o6n6KGo5Y2V5bGe5oCnIHNyZnNvdXJjZWtleSDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsDQogICAgICogQHBhcmFtIHsqfSBvbGRWYWwNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25TcmZzb3VyY2VrZXlDaGFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uU3Jmc291cmNla2V5Q2hhbmdlKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoewogICAgICAgIG5hbWU6ICdzcmZzb3VyY2VrZXknLAogICAgICAgIG5ld1ZhbDogbmV3VmFsLAogICAgICAgIG9sZFZhbDogb2xkVmFsCiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog55uR5o6n6KGo5Y2V5bGe5oCnIHNibSDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsDQogICAgICogQHBhcmFtIHsqfSBvbGRWYWwNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25TYm1DaGFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uU2JtQ2hhbmdlKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoewogICAgICAgIG5hbWU6ICdzYm0nLAogICAgICAgIG5ld1ZhbDogbmV3VmFsLAogICAgICAgIG9sZFZhbDogb2xkVmFsCiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog55uR5o6n6KGo5Y2V5bGe5oCnIHBpbWNvbnRyYWN0dHlwZW5hbWUg5YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uUGltY29udHJhY3R0eXBlbmFtZUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25QaW1jb250cmFjdHR5cGVuYW1lQ2hhbmdlKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIHRoaXMuZm9ybURhdGFDaGFuZ2UoewogICAgICAgIG5hbWU6ICdwaW1jb250cmFjdHR5cGVuYW1lJywKICAgICAgICBuZXdWYWw6IG5ld1ZhbCwKICAgICAgICBvbGRWYWw6IG9sZFZhbAogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOebkeaOp+ihqOWNleWxnuaApyBwaW1jb250cmFjdHR5cGVpZCDlgLwNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsDQogICAgICogQHBhcmFtIHsqfSBvbGRWYWwNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25QaW1jb250cmFjdHR5cGVpZENoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25QaW1jb250cmFjdHR5cGVpZENoYW5nZShuZXdWYWwsIG9sZFZhbCkgewogICAgICB0aGlzLmZvcm1EYXRhQ2hhbmdlKHsKICAgICAgICBuYW1lOiAncGltY29udHJhY3R0eXBlaWQnLAogICAgICAgIG5ld1ZhbDogbmV3VmFsLAogICAgICAgIG9sZFZhbDogb2xkVmFsCiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6YeN572u6KGo5Y2V6aG55YC8DQogICAgICoNCiAgICAgKiBAcHVibGljDQogICAgICogQHBhcmFtIHt7IG5hbWU6IHN0cmluZywgbmV3VmFsOiBhbnksIG9sZFZhbDogYW55IH19IHsgbmFtZSwgbmV3VmFsLCBvbGRWYWwgfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZXNldEZvcm1EYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldEZvcm1EYXRhKF9yZWYpIHsKICAgICAgdmFyIG5hbWUgPSBfcmVmLm5hbWUsCiAgICAgICAgICBuZXdWYWwgPSBfcmVmLm5ld1ZhbCwKICAgICAgICAgIG9sZFZhbCA9IF9yZWYub2xkVmFsOwogICAgfQogICAgLyoqDQogICAgICAqIOe9ruepuuWvueixoQ0KICAgICAgKg0KICAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJSZXNldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIFJlc2V0RGF0YShfZGF0YXMpIHsKICAgICAgdmFyIF90aGlzMyA9IHRoaXM7CgogICAgICBpZiAoT2JqZWN0LmtleXMoX2RhdGFzKS5sZW5ndGggPiAwKSB7CiAgICAgICAgT2JqZWN0LmtleXMoX2RhdGFzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgICBpZiAoX3RoaXMzLmRhdGEuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgICAgICAgX3RoaXMzLmRhdGFbbmFtZV0gPSBudWxsOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDooajljZXpgLvovpENCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0ge3sgbmFtZTogc3RyaW5nLCBuZXdWYWw6IGFueSwgb2xkVmFsOiBhbnkgfX0geyBuYW1lLCBuZXdWYWwsIG9sZFZhbCB9DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImZvcm1Mb2dpYyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZm9ybUxvZ2ljKF9yZWYyKSB7CiAgICAgIHZhciBuYW1lID0gX3JlZjIubmFtZSwKICAgICAgICAgIG5ld1ZhbCA9IF9yZWYyLm5ld1ZhbCwKICAgICAgICAgIG9sZFZhbCA9IF9yZWYyLm9sZFZhbDsKICAgIH0KICAgIC8qKg0KICAgICAqIOihqOWNleWAvOWPmOWMlg0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEBwYXJhbSB7eyBuYW1lOiBzdHJpbmcsIG5ld1ZhbDogYW55LCBvbGRWYWw6IGFueSB9fSB7IG5hbWUsIG5ld1ZhbCwgb2xkVmFsIH0NCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZm9ybURhdGFDaGFuZ2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZvcm1EYXRhQ2hhbmdlKF9yZWYzKSB7CiAgICAgIHZhciBuYW1lID0gX3JlZjMubmFtZSwKICAgICAgICAgIG5ld1ZhbCA9IF9yZWYzLm5ld1ZhbCwKICAgICAgICAgIG9sZFZhbCA9IF9yZWYzLm9sZFZhbDsKCiAgICAgIGlmICh0aGlzLmlnbm9yZWZpZWxkdmFsdWVjaGFuZ2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMucmVzZXRGb3JtRGF0YSh7CiAgICAgICAgbmFtZTogbmFtZSwKICAgICAgICBuZXdWYWw6IG5ld1ZhbCwKICAgICAgICBvbGRWYWw6IG9sZFZhbAogICAgICB9KTsKICAgICAgdGhpcy5mb3JtTG9naWMoewogICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgbmV3VmFsOiBuZXdWYWwsCiAgICAgICAgb2xkVmFsOiBvbGRWYWwKICAgICAgfSk7CiAgICAgIHRoaXMuZGF0YUNoYW5nLm5leHQoSlNPTi5zdHJpbmdpZnkodGhpcy5kYXRhKSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDooajljZXliqDovb3lrozmiJANCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBbYWN0aW9uXQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvbkZvcm1Mb2FkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkZvcm1Mb2FkKCkgewogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgICAgIHZhciBhY3Rpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDsKICAgICAgaWYgKE9iamVjdC5pcyhhY3Rpb24sICJzYXZlIikgfHwgT2JqZWN0LmlzKGFjdGlvbiwgImF1dG9TYXZlIikgfHwgT2JqZWN0LmlzKGFjdGlvbiwgInN1Ym1pdCIpKSAvLyDmm7TmlrBjb250ZXh055qE5a6e5L2T5Li76ZSuCiAgICAgICAgaWYgKGRhdGEucGltY29udHJhY3R0eXBlKSB7CiAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuY29udGV4dCwgewogICAgICAgICAgICBwaW1jb250cmFjdHR5cGU6IGRhdGEucGltY29udHJhY3R0eXBlCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIHRoaXMuc2V0Rm9ybUVuYWJsZUNvbmQoZGF0YSk7CiAgICAgIHRoaXMuZmlsbEZvcm0oZGF0YSwgYWN0aW9uKTsKICAgICAgdGhpcy5vbGREYXRhID0ge307CiAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5vbGREYXRhLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuZGF0YSkpKTsKICAgICAgdGhpcy4kc3RvcmUuY29tbWl0KCd2aWV3YWN0aW9uL3NldFZpZXdEYXRhQ2hhbmdlJywgewogICAgICAgIHZpZXd0YWc6IHRoaXMudmlld3RhZywKICAgICAgICB2aWV3ZGF0YWNoYW5nZTogZmFsc2UKICAgICAgfSk7CiAgICAgIHRoaXMuZm9ybUxvZ2ljKHsKICAgICAgICBuYW1lOiAnJywKICAgICAgICBuZXdWYWw6IG51bGwsCiAgICAgICAgb2xkVmFsOiBudWxsCiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5YC85aGr5YWFDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtfZGF0YXM9e31dDQogICAgICogQHBhcmFtIHtzdHJpbmd9IFthY3Rpb25dDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImZpbGxGb3JtIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmaWxsRm9ybSgpIHsKICAgICAgdmFyIF90aGlzNCA9IHRoaXM7CgogICAgICB2YXIgX2RhdGFzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKCiAgICAgIHZhciBhY3Rpb24gPSBhcmd1bWVudHMubGVuZ3RoID4gMSA/IGFyZ3VtZW50c1sxXSA6IHVuZGVmaW5lZDsKICAgICAgdGhpcy5pZ25vcmVmaWVsZHZhbHVlY2hhbmdlID0gdHJ1ZTsKICAgICAgT2JqZWN0LmtleXMoX2RhdGFzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgaWYgKF90aGlzNC5kYXRhLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgICAgICBfdGhpczQuZGF0YVtuYW1lXSA9IF9kYXRhc1tuYW1lXTsKICAgICAgICB9CiAgICAgIH0pOwoKICAgICAgaWYgKE9iamVjdC5pcyhhY3Rpb24sICdsb2FkRHJhZnQnKSkgewogICAgICAgIHRoaXMuY3JlYXRlRGVmYXVsdCgpOwogICAgICB9CgogICAgICBpZiAoT2JqZWN0LmlzKGFjdGlvbiwgJ2xvYWQnKSkgewogICAgICAgIHRoaXMudXBkYXRlRGVmYXVsdCgpOwogICAgICB9CgogICAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgdGhpcy5pZ25vcmVmaWVsZHZhbHVlY2hhbmdlID0gZmFsc2U7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6K6+572u6KGo5Y2V6aG55piv5ZCm5ZCv55SoDQogICAgICoNCiAgICAgKiBAcHVibGljDQogICAgICogQHBhcmFtIHsqfSBkYXRhDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInNldEZvcm1FbmFibGVDb25kIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZXRGb3JtRW5hYmxlQ29uZChkYXRhKSB7CiAgICAgIE9iamVjdC52YWx1ZXModGhpcy5kZXRhaWxzTW9kZWwpLmZvckVhY2goZnVuY3Rpb24gKGRldGFpbCkgewogICAgICAgIGlmICghT2JqZWN0LmlzKGRldGFpbC5kZXRhaWxUeXBlLCAnRk9STUlURU0nKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGZvcm1JdGVtID0gZGV0YWlsOwogICAgICAgIGZvcm1JdGVtLnNldEVuYWJsZUNvbmQoZGF0YS5zcmZ1Zik7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6YeN572u6I2J56i/6KGo5Y2V54q25oCBDQogICAgICoNCiAgICAgKiBAcHVibGljDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInJlc2V0RHJhZnRGb3JtU3RhdGVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZXNldERyYWZ0Rm9ybVN0YXRlcygpIHsKICAgICAgdmFyIGZvcm0gPSB0aGlzLiRyZWZzLmZvcm07CgogICAgICBpZiAoZm9ybSkgewogICAgICAgIGZvcm0ucmVzZXRGaWVsZHMoKTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog6YeN572u5qCh6aqM57uT5p6cDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVzZXRWYWxpZGF0ZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlc2V0VmFsaWRhdGVzKCkgewogICAgICBPYmplY3QudmFsdWVzKHRoaXMuZGV0YWlsc01vZGVsKS5mb3JFYWNoKGZ1bmN0aW9uIChkZXRhaWwpIHsKICAgICAgICBpZiAoIU9iamVjdC5pcyhkZXRhaWwuZGV0YWlsVHlwZSwgJ0ZPUk1JVEVNJykpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHZhciBmb3JtSXRlbSA9IGRldGFpbDsKICAgICAgICBmb3JtSXRlbS5zZXRFcnJvcignJyk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5aGr5YWF5qCh6aqM57uT5p6cIO+8iOWQjuWPsO+8iQ0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gZmllbGRFcnJvcnMNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZmlsbFZhbGlkYXRlcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZmlsbFZhbGlkYXRlcyhmaWVsZEVycm9ycykgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIGZpZWxkRXJyb3JzLmZvckVhY2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgdmFyIGZvcm1JdGVtID0gX3RoaXM1LmRldGFpbHNNb2RlbFtlcnJvci5maWVsZF07CgogICAgICAgIGlmICghZm9ybUl0ZW0pIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIF90aGlzNS4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgICAgZm9ybUl0ZW0uc2V0RXJyb3IoZXJyb3IubWVzc2FnZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6KGo5Y2V5qCh6aqM54q25oCBDQogICAgICoNCiAgICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZm9ybVZhbGlkYXRlU3RhdHVzIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBmb3JtVmFsaWRhdGVTdGF0dXMoKSB7CiAgICAgIHZhciBmb3JtID0gdGhpcy4kcmVmcy5mb3JtOwogICAgICB2YXIgdmFsaWRhdGVzdGF0ZSA9IHRydWU7CiAgICAgIGZvcm0udmFsaWRhdGUoZnVuY3Rpb24gKHZhbGlkKSB7CiAgICAgICAgdmFsaWRhdGVzdGF0ZSA9IHZhbGlkID8gdHJ1ZSA6IGZhbHNlOwogICAgICB9KTsKICAgICAgcmV0dXJuIHZhbGlkYXRlc3RhdGU7CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5blhajpg6jlgLwNCiAgICAgKg0KICAgICAqIEByZXR1cm5zIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRWYWx1ZXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldFZhbHVlcygpIHsKICAgICAgcmV0dXJuIHRoaXMuZGF0YTsKICAgIH0KICAgIC8qKg0KICAgICAqIOihqOWNlemhueWAvOWPmOabtA0KICAgICAqDQogICAgICogQHBhcmFtIHt7IG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSB9fSAkZXZlbnQNCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25Gb3JtSXRlbVZhbHVlQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkZvcm1JdGVtVmFsdWVDaGFuZ2UoJGV2ZW50KSB7CiAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoISRldmVudC5uYW1lIHx8IE9iamVjdC5pcygkZXZlbnQubmFtZSwgJycpIHx8ICF0aGlzLmRhdGEuaGFzT3duUHJvcGVydHkoJGV2ZW50Lm5hbWUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmRhdGFbJGV2ZW50Lm5hbWVdID0gJGV2ZW50LnZhbHVlOwogICAgfQogICAgLyoqDQogICAgICog6K6+572u5pWw5o2u6aG55YC8DQogICAgICoNCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbmFtZQ0KICAgICAqIEBwYXJhbSB7Kn0gdmFsdWUNCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2V0RGF0YUl0ZW1WYWx1ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0RGF0YUl0ZW1WYWx1ZShuYW1lLCB2YWx1ZSkgewogICAgICBpZiAoIW5hbWUgfHwgT2JqZWN0LmlzKG5hbWUsICcnKSB8fCAhdGhpcy5kYXRhLmhhc093blByb3BlcnR5KG5hbWUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoT2JqZWN0LmlzKHRoaXMuZGF0YVtuYW1lXSwgdmFsdWUpKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmRhdGFbbmFtZV0gPSB2YWx1ZTsKICAgIH0KICAgIC8qKg0KICAgICAqIOWIhue7hOeVjOmdouihjOS4uuS6i+S7tg0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSAkZXZlbnQNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ3JvdXBVSUFjdGlvbkNsaWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBncm91cFVJQWN0aW9uQ2xpY2soJGV2ZW50KSB7CiAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgaXRlbSA9ICRldmVudC5pdGVtOwogICAgfQogICAgLyoqDQogICAgICogVnVl5aOw5piO5ZGo5pyfKOWkhOeQhue7hOS7tueahOi+k+WFpeWxnuaApykNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJjcmVhdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgICB0aGlzLmFmdGVyQ3JlYXRlZCgpOwogICAgfQogICAgLyoqDQogICAgICog5omn6KGMY3JlYXRlZOWQjueahOmAu+i+kQ0KICAgICAqDQogICAgICogIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJhZnRlckNyZWF0ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFmdGVyQ3JlYXRlZCgpIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICBpZiAodGhpcy52aWV3U3RhdGUpIHsKICAgICAgICB0aGlzLnZpZXdTdGF0ZUV2ZW50ID0gdGhpcy52aWV3U3RhdGUuc3Vic2NyaWJlKGZ1bmN0aW9uIChfcmVmNCkgewogICAgICAgICAgdmFyIHRhZyA9IF9yZWY0LnRhZywKICAgICAgICAgICAgICBhY3Rpb24gPSBfcmVmNC5hY3Rpb24sCiAgICAgICAgICAgICAgZGF0YSA9IF9yZWY0LmRhdGE7CgogICAgICAgICAgaWYgKCFPYmplY3QuaXModGFnLCBfdGhpczYubmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChPYmplY3QuaXMoJ2F1dG9sb2FkJywgYWN0aW9uKSkgewogICAgICAgICAgICBfdGhpczYuYXV0b0xvYWQoZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygnbG9hZCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXM2LmxvYWQoZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygnbG9hZGRyYWZ0JywgYWN0aW9uKSkgewogICAgICAgICAgICBpZiAoX3RoaXM2LmNvbnRleHQuc3Jmc291cmNla2V5KSB7CiAgICAgICAgICAgICAgX3RoaXM2LmNvcHkoX3RoaXM2LmNvbnRleHQuc3Jmc291cmNla2V5KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBfdGhpczYubG9hZERyYWZ0KGRhdGEpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygnc2F2ZScsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXM2LnNhdmUoZGF0YSwgZGF0YS5zaG93UmVzdWx0SW5mbyk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygncmVtb3ZlJywgYWN0aW9uKSkgewogICAgICAgICAgICBfdGhpczYucmVtb3ZlKGRhdGEpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChPYmplY3QuaXMoJ3NhdmVhbmRleGl0JywgYWN0aW9uKSkgewogICAgICAgICAgICBfdGhpczYuc2F2ZUFuZEV4aXQoZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygnc2F2ZWFuZG5ldycsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXM2LnNhdmVBbmROZXcoZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygncmVtb3ZlYW5kZXhpdCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXM2LnJlbW92ZUFuZEV4aXQoZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygncmVmcmVzaCcsIGFjdGlvbikpIHsKICAgICAgICAgICAgX3RoaXM2LnJlZnJlc2goZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuZGF0YUNoYW5nLnBpcGUoZGVib3VuY2VUaW1lKDMwMCksIGRpc3RpbmN0VW50aWxDaGFuZ2VkKCkpLnN1YnNjcmliZShmdW5jdGlvbiAoZGF0YSkgewogICAgICAgIGlmIChfdGhpczYuYXV0b3NhdmUpIHsKICAgICAgICAgIF90aGlzNi5hdXRvU2F2ZSgpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHN0YXRlID0gIU9iamVjdC5pcyhKU09OLnN0cmluZ2lmeShfdGhpczYub2xkRGF0YSksIEpTT04uc3RyaW5naWZ5KF90aGlzNi5kYXRhKSkgPyB0cnVlIDogZmFsc2U7CgogICAgICAgIF90aGlzNi4kc3RvcmUuY29tbWl0KCd2aWV3YWN0aW9uL3NldFZpZXdEYXRhQ2hhbmdlJywgewogICAgICAgICAgdmlld3RhZzogX3RoaXM2LnZpZXd0YWcsCiAgICAgICAgICB2aWV3ZGF0YWNoYW5nZTogc3RhdGUKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiB2dWUg55Sf5ZG95ZGo5pyfDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZGVzdHJveWVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkZXN0cm95ZWQoKSB7CiAgICAgIHRoaXMuYWZ0ZXJEZXN0cm95KCk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmiafooYxkZXN0cm95ZWTlkI7nmoTpgLvovpENCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJhZnRlckRlc3Ryb3kiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFmdGVyRGVzdHJveSgpIHsKICAgICAgaWYgKHRoaXMudmlld1N0YXRlRXZlbnQpIHsKICAgICAgICB0aGlzLnZpZXdTdGF0ZUV2ZW50LnVuc3Vic2NyaWJlKCk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLmRhdGFDaGFuZ0V2ZW50KSB7CiAgICAgICAgdGhpcy5kYXRhQ2hhbmdFdmVudC51bnN1YnNjcmliZSgpOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDmi7fotJ3lhoXlrrkNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2FyZz17fV0NCiAgICAgKiBAbWVtYmVyb2YgQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImNvcHkiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvcHkoc3Jma2V5KSB7CiAgICAgIHZhciBfdGhpczcgPSB0aGlzOwoKICAgICAgdmFyIGNvcHlEYXRhID0gdGhpcy4kc3RvcmUuZ2V0dGVycy5nZXRDb3B5RGF0YShzcmZrZXkpOwogICAgICBjb3B5RGF0YS5zcmZrZXkgPSBVdGlsLmNyZWF0ZVVVSUQoKTsKICAgICAgY29weURhdGEucGltY29udHJhY3R0eXBlID0gY29weURhdGEuc3Jma2V5OwogICAgICBjb3B5RGF0YS5waW1jb250cmFjdHR5cGVpZCA9IGNvcHlEYXRhLnNyZmtleTsKICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmNvbnRleHQsIHsKICAgICAgICBwaW1jb250cmFjdHR5cGU6IGNvcHlEYXRhLnBpbWNvbnRyYWN0dHlwZQogICAgICB9KTsKICAgICAgdGhpcy5kYXRhID0gY29weURhdGE7CiAgICAgIHRoaXMuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICBfdGhpczcuZm9ybVN0YXRlLm5leHQoewogICAgICAgICAgdHlwZTogJ2xvYWQnLAogICAgICAgICAgZGF0YTogY29weURhdGEKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXM3LmRhdGEuc3JmdWYgPSAnMCc7CgogICAgICAgIF90aGlzNy5zZXRGb3JtRW5hYmxlQ29uZChfdGhpczcuZGF0YSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICrmiZPljbANCiAgICAgKkBtZW1iZXJvZiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicHJpbnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHByaW50KCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgX3RoaXMuJHByaW50KHsKICAgICAgICBpZDogJ3BpbWNvbnRyYWN0dHlwZV9tYWluJywKICAgICAgICBwb3BUaXRsZTogJ+S4u+e8lui+keihqOWNlScKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDpg6jku7bliLfmlrANCiAgICAgKg0KICAgICAqIEBwYXJhbSB7YW55W119IGFyZ3MNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVmcmVzaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVmcmVzaChhcmdzKSB7CiAgICAgIHZhciBhcmcgPSB7fTsKICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIGFyZ3NbMF0pOwoKICAgICAgaWYgKHRoaXMuZGF0YS5zcmZrZXkgJiYgIU9iamVjdC5pcyh0aGlzLmRhdGEuc3Jma2V5LCAnJykpIHsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgewogICAgICAgICAgc3Jma2V5OiB0aGlzLmRhdGEuc3Jma2V5CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5sb2FkKGFyZyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5kYXRhLnNyZmtleXMgJiYgIU9iamVjdC5pcyh0aGlzLmRhdGEuc3Jma2V5cywgJycpKSB7CiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHsKICAgICAgICAgIHNyZmtleTogdGhpcy5kYXRhLnNyZmtleXMKICAgICAgICB9KTsKICAgICAgICB0aGlzLmxvYWQoYXJnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOiHquWKqOWKoOi9vQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbYXJnPXt9XQ0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJhdXRvTG9hZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYXV0b0xvYWQoKSB7CiAgICAgIHZhciBhcmcgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwoKICAgICAgaWYgKGFyZy5zcmZrZXkgJiYgIU9iamVjdC5pcyhhcmcuc3Jma2V5LCAnJykpIHsKICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgewogICAgICAgICAgc3Jma2V5OiBhcmcuc3Jma2V5CiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5sb2FkKGFyZyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoYXJnLnNyZmtleXMgJiYgIU9iamVjdC5pcyhhcmcuc3Jma2V5cywgJycpKSB7CiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHsKICAgICAgICAgIHNyZmtleTogYXJnLnNyZmtleXMKICAgICAgICB9KTsKICAgICAgICB0aGlzLmxvYWQoYXJnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMubG9hZERyYWZ0KGFyZyk7CiAgICB9CiAgICAvKioNCiAgICAgKiDliqDovb0NCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0geyp9IFtvcHQ9e31dDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImxvYWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGxvYWQoKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIG9wdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICBpZiAoIXRoaXMubG9hZEFjdGlvbikgewogICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICBkZXNjOiAnUElNQ09OVFJBQ1RUWVBFRWRpdFZpZXfop4blm77ooajljZVsb2FkQWN0aW9u5Y+C5pWw5pyq6YWN572uJwogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGFyZyA9IF9vYmplY3RTcHJlYWQoe30sIG9wdCk7CgogICAgICB2YXIgdmlld3BhcmFtUmVzdWx0ID0gT2JqZWN0LmFzc2lnbihhcmcsIHRoaXMudmlld3BhcmFtcyk7CiAgICAgIHZhciBnZXQgPSB0aGlzLnNlcnZpY2UuZ2V0KHRoaXMubG9hZEFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSwgewogICAgICAgIHZpZXdwYXJhbXM6IHZpZXdwYXJhbVJlc3VsdAogICAgICB9LCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgZ2V0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgX3RoaXM4Lm9uRm9ybUxvYWQoZGF0YSwgJ2xvYWQnKTsKCiAgICAgICAgICBfdGhpczguJGVtaXQoJ2xvYWQnLCBkYXRhKTsKCiAgICAgICAgICBfdGhpczguJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgX3RoaXM4LmZvcm1TdGF0ZS5uZXh0KHsKICAgICAgICAgICAgICB0eXBlOiAnbG9hZCcsCiAgICAgICAgICAgICAgZGF0YTogZGF0YQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyAmJiByZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICBfdGhpczguJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogcmVzcG9uc2UuZGF0YS5tZXNzYWdlCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIF90aGlzOC4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICBkZXNjOiAn57O757uf5byC5bi4JwogICAgICAgICAgfSk7CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDliqDovb3ojYnnqL8NCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW29wdD17fV0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAibG9hZERyYWZ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkRHJhZnQoKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgdmFyIG9wdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICBpZiAoIXRoaXMubG9hZGRyYWZ0QWN0aW9uKSB7CiAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsKICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgIGRlc2M6ICdQSU1DT05UUkFDVFRZUEVFZGl0Vmlld+inhuWbvuihqOWNlWxvYWRkcmFmdEFjdGlvbuWPguaVsOacqumFjee9ricKICAgICAgICB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBhcmcgPSBfb2JqZWN0U3ByZWFkKHt9LCBvcHQpOwoKICAgICAgdmFyIHZpZXdwYXJhbVJlc3VsdCA9IE9iamVjdC5hc3NpZ24oYXJnLCB0aGlzLnZpZXdwYXJhbXMpOwogICAgICB2YXIgcG9zdCA9IHRoaXMuc2VydmljZS5sb2FkRHJhZnQodGhpcy5sb2FkZHJhZnRBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIHsKICAgICAgICB2aWV3cGFyYW1zOiB2aWV3cGFyYW1SZXN1bHQKICAgICAgfSwgdGhpcy5zaG93QnVzeUluZGljYXRvcik7CiAgICAgIHBvc3QudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAoIXJlc3BvbnNlLnN0YXR1cyB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgX3RoaXM5LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBpZiAoZGF0YS5waW1jb250cmFjdHR5cGUpIHsKICAgICAgICAgIE9iamVjdC5hc3NpZ24oX3RoaXM5LmNvbnRleHQsIHsKICAgICAgICAgICAgcGltY29udHJhY3R0eXBlOiBkYXRhLnBpbWNvbnRyYWN0dHlwZQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBfdGhpczkucmVzZXREcmFmdEZvcm1TdGF0ZXMoKTsKCiAgICAgICAgX3RoaXM5Lm9uRm9ybUxvYWQoZGF0YSwgJ2xvYWREcmFmdCcpOwoKICAgICAgICBfdGhpczkuJGVtaXQoJ2xvYWQnLCBkYXRhKTsKCiAgICAgICAgX3RoaXM5LiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczkuZm9ybVN0YXRlLm5leHQoewogICAgICAgICAgICB0eXBlOiAnbG9hZCcsCiAgICAgICAgICAgIGRhdGE6IGRhdGEKICAgICAgICAgIH0pOwogICAgICAgIH0pOwoKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBmb3JtID0gX3RoaXM5LiRyZWZzLmZvcm07CgogICAgICAgICAgaWYgKGZvcm0pIHsKICAgICAgICAgICAgZm9ybS5maWVsZHMuZm9yRWFjaChmdW5jdGlvbiAoZmllbGQpIHsKICAgICAgICAgICAgICBmaWVsZC52YWxpZGF0ZU1lc3NhZ2UgPSAiIjsKICAgICAgICAgICAgICBmaWVsZC52YWxpZGF0ZVN0YXRlID0gIiI7CiAgICAgICAgICAgICAgZmllbGQudmFsaWRhdGVTdGF0dXMgPSBmYWxzZTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgX3RoaXM5LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgIGRlc2M6IHJlc3BvbnNlLmRhdGEubWVzc2FnZQogICAgICAgICAgfSk7CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICBfdGhpczkuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogJ+ezu+e7n+W8guW4uCcKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6Ieq5Yqo5L+d5a2YDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtvcHQ9e31dDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImF1dG9TYXZlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhdXRvU2F2ZSgpIHsKICAgICAgdmFyIF90aGlzMTAgPSB0aGlzOwoKICAgICAgdmFyIG9wdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICBpZiAoIXRoaXMuZm9ybVZhbGlkYXRlU3RhdHVzKCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBhcmcgPSBfb2JqZWN0U3ByZWFkKHt9LCBvcHQpOwoKICAgICAgdmFyIGRhdGEgPSB0aGlzLmdldFZhbHVlcygpOwogICAgICBPYmplY3QuYXNzaWduKGFyZywgZGF0YSk7CiAgICAgIHZhciBhY3Rpb24gPSBPYmplY3QuaXMoZGF0YS5zcmZ1ZiwgJzEnKSA/IHRoaXMudXBkYXRlQWN0aW9uIDogdGhpcy5jcmVhdGVBY3Rpb247CgogICAgICBpZiAoIWFjdGlvbikgewogICAgICAgIHZhciBhY3Rpb25OYW1lID0gT2JqZWN0LmlzKGRhdGEuc3JmdWYsICcxJykgPyAidXBkYXRlQWN0aW9uIiA6ICJjcmVhdGVBY3Rpb24iOwogICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICBkZXNjOiAnUElNQ09OVFJBQ1RUWVBFRWRpdFZpZXfop4blm77ooajljZUnICsgYWN0aW9uTmFtZSArICflj4LmlbDmnKrphY3nva4nCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBPYmplY3QuYXNzaWduKGFyZywgewogICAgICAgIHZpZXdwYXJhbXM6IHRoaXMudmlld3BhcmFtcwogICAgICB9KTsKICAgICAgdmFyIHBvc3QgPSB0aGlzLnNlcnZpY2UuYWRkKGFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSwgYXJnLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgcG9zdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmICghcmVzcG9uc2Uuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICBfdGhpczEwLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBfdGhpczEwLm9uRm9ybUxvYWQoZGF0YSwgJ2F1dG9TYXZlJyk7CgogICAgICAgIF90aGlzMTAuJGVtaXQoJ3NhdmUnLCBkYXRhKTsKCiAgICAgICAgX3RoaXMxMC4kc3RvcmUuZGlzcGF0Y2goJ3ZpZXdhY3Rpb24vZGF0YXNhdmVkJywgewogICAgICAgICAgdmlld3RhZzogX3RoaXMxMC52aWV3dGFnCiAgICAgICAgfSk7CgogICAgICAgIF90aGlzMTAuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMTAuZm9ybVN0YXRlLm5leHQoewogICAgICAgICAgICB0eXBlOiAnc2F2ZScsCiAgICAgICAgICAgIGRhdGE6IGRhdGEKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzICYmIHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIF90aGlzMTAuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogcmVzcG9uc2UuZGF0YS5tZXNzYWdlCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIF90aGlzMTAuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogJ+ezu+e7n+W8guW4uCcKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5L+d5a2YDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtvcHQ9e31dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbc2hvd1Jlc3VsdEluZm9dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbaWZTdGF0ZU5leHRdIGZvcm1TdGF0ZeaYr+WQpuS4i+WPkemAmuefpQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInNhdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9zYXZlID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgX3RoaXMxMSA9IHRoaXM7CgogICAgICAgIHZhciBvcHQsCiAgICAgICAgICAgIHNob3dSZXN1bHRJbmZvLAogICAgICAgICAgICBpZlN0YXRlTmV4dCwKICAgICAgICAgICAgX2FyZ3MgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgb3B0ID0gX2FyZ3MubGVuZ3RoID4gMCAmJiBfYXJnc1swXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3NbMF0gOiB7fTsKICAgICAgICAgICAgICAgIHNob3dSZXN1bHRJbmZvID0gX2FyZ3MubGVuZ3RoID4gMSA/IF9hcmdzWzFdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgaWZTdGF0ZU5leHQgPSBfYXJncy5sZW5ndGggPiAyICYmIF9hcmdzWzJdICE9PSB1bmRlZmluZWQgPyBfYXJnc1syXSA6IHRydWU7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuYWJydXB0KCJyZXR1cm4iLCBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgICAgIHNob3dSZXN1bHRJbmZvID0gc2hvd1Jlc3VsdEluZm8gPT09IHVuZGVmaW5lZCA/IHRydWUgOiBmYWxzZTsKCiAgICAgICAgICAgICAgICAgIGlmICghX3RoaXMxMS5mb3JtVmFsaWRhdGVTdGF0dXMoKSkgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTEuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgICAgICAgICAgICBkZXNjOiAn5YC86KeE5YiZ5qCh6aqM5byC5bi4JwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHZhciBhcmcgPSBfb2JqZWN0U3ByZWFkKHt9LCBvcHQpOwoKICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBfdGhpczExLmdldFZhbHVlcygpOwoKICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIGRhdGEpOwogICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgX3RoaXMxMS5jb250ZXh0KTsKCiAgICAgICAgICAgICAgICAgIGlmIChpZlN0YXRlTmV4dCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTEuZHJjb3VudGVyID0gMDsKCiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMTEuZHJjb3VudGVyICE9PSAwKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczExLmRyc2F2ZW9wdCA9IG9wdDsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczExLmZvcm1TdGF0ZS5uZXh0KHsKICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2JlZm9yZXNhdmUnLAogICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiBhcmcKICAgICAgICAgICAgICAgICAgICAgIH0pOyAvL+WFiOmAmuefpeWFs+ezu+eVjOmdouS/neWtmAoKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczExLnNhdmVTdGF0ZSA9IHJlc29sdmU7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uID0gT2JqZWN0LmlzKGRhdGEuc3JmdWYsICcxJykgPyBfdGhpczExLnVwZGF0ZUFjdGlvbiA6IF90aGlzMTEuY3JlYXRlQWN0aW9uOwoKICAgICAgICAgICAgICAgICAgaWYgKCFhY3Rpb24pIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aW9uTmFtZSA9IE9iamVjdC5pcyhkYXRhLnNyZnVmLCAnMScpID8gInVwZGF0ZUFjdGlvbiIgOiAiY3JlYXRlQWN0aW9uIjsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMS4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICdQSU1DT05UUkFDVFRZUEVFZGl0Vmlld+inhuWbvuihqOWNlScgKyBhY3Rpb25OYW1lICsgJ+WPguaVsOacqumFjee9ricKICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgewogICAgICAgICAgICAgICAgICAgIHZpZXdwYXJhbXM6IF90aGlzMTEudmlld3BhcmFtcwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSBPYmplY3QuaXMoZGF0YS5zcmZ1ZiwgJzEnKSA/IF90aGlzMTEuc2VydmljZS51cGRhdGUoYWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KF90aGlzMTEuY29udGV4dCkpLCBhcmcsIF90aGlzMTEuc2hvd0J1c3lJbmRpY2F0b3IpIDogX3RoaXMxMS5zZXJ2aWNlLmFkZChhY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXMxMS5jb250ZXh0KSksIGFyZywgX3RoaXMxMS5zaG93QnVzeUluZGljYXRvcik7CiAgICAgICAgICAgICAgICAgIHBvc3QudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlLnN0YXR1cyB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMxMS4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogcmVzcG9uc2UuZGF0YS5tZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMS5vbkZvcm1Mb2FkKGRhdGEsICdzYXZlJyk7CgogICAgICAgICAgICAgICAgICAgIF90aGlzMTEuJGVtaXQoJ3NhdmUnLCBkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXMxMS4kc3RvcmUuZGlzcGF0Y2goJ3ZpZXdhY3Rpb24vZGF0YXNhdmVkJywgewogICAgICAgICAgICAgICAgICAgICAgdmlld3RhZzogX3RoaXMxMS52aWV3dGFnCiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIF90aGlzMTEuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTEuZm9ybVN0YXRlLm5leHQoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2F2ZScsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICBpZiAoc2hvd1Jlc3VsdEluZm8pIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTEuJE5vdGljZS5zdWNjZXNzKHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiAoZGF0YS5zcmZtYWpvcnRleHQgPyBkYXRhLnNyZm1ham9ydGV4dCA6ICcnKSArICcmbmJzcDvkv53lrZjmiJDlip/vvIEnCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzICYmIHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTEuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogcmVzcG9uc2UuZGF0YS5tZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICBfdGhpczExLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICfns7vnu5/lvILluLgnCiAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9KSk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBzYXZlKCkgewogICAgICAgIHJldHVybiBfc2F2ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gc2F2ZTsKICAgIH0oKQogICAgLyoqDQogICAgKiDliKDpmaQNCiAgICAqDQogICAgKiBAcHVibGljDQogICAgKiBAcGFyYW0geyp9IFtvcHQ9e31dDQogICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZW1vdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHJlbW92ZSgpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgdmFyIG9wdCA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDogW107CiAgICAgIHZhciBzaG93UmVzdWx0SW5mbyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxID8gYXJndW1lbnRzWzFdIDogdW5kZWZpbmVkOwogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIGlmICghX3RoaXMxMi5yZW1vdmVBY3Rpb24pIHsKICAgICAgICAgIF90aGlzMTIuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogJ1BJTUNPTlRSQUNUVFlQRUVkaXRWaWV36KeG5Zu+6KGo5Y2VcmVtb3ZlQWN0aW9u5Y+C5pWw5pyq6YWN572uJwogICAgICAgICAgfSk7CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGFyZyA9IG9wdFswXTsKICAgICAgICB2YXIgX3RoaXMgPSBfdGhpczEyOwogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCB7CiAgICAgICAgICB2aWV3cGFyYW1zOiBfdGhpczEyLnZpZXdwYXJhbXMKICAgICAgICB9KTsKCiAgICAgICAgX3RoaXMxMi5zZXJ2aWNlWyJkZWxldGUiXShfdGhpcy5yZW1vdmVBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXMxMi5jb250ZXh0KSksIGFyZywgc2hvd1Jlc3VsdEluZm8pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICAgICAgX3RoaXMxMi4kZW1pdCgncmVtb3ZlJywgZGF0YSk7CgogICAgICAgICAgICBfdGhpczEyLmZvcm1TdGF0ZS5uZXh0KHsKICAgICAgICAgICAgICB0eXBlOiAncmVtb3ZlJywKICAgICAgICAgICAgICBkYXRhOiBkYXRhCiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgX3RoaXMxMi5kYXRhLmlzbW9kaWZ5ID0gZmFsc2U7CgogICAgICAgICAgICBfdGhpczEyLiROb3RpY2Uuc3VjY2Vzcyh7CiAgICAgICAgICAgICAgdGl0bGU6ICcnLAogICAgICAgICAgICAgIGRlc2M6IChkYXRhLnNyZm1ham9ydGV4dCA/IGRhdGEuc3JmbWFqb3J0ZXh0IDogJycpICsgJyZuYnNwO+WIoOmZpOaIkOWKn++8gScKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICAgIH0KICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHZhciBfZGF0YSA9IGVycm9yLmRhdGE7CgogICAgICAgICAgX3RoaXMxMi4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgdGl0bGU6IF9kYXRhLnRpdGxlLAogICAgICAgICAgICBkZXNjOiBfZGF0YS5tZXNzYWdlCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOW3peS9nOa1geWQr+WKqA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtsb2NhbGRhdGE9e31dDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAid2ZzdGFydCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3dmc3RhcnQgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMihkYXRhLCBsb2NhbGRhdGEpIHsKICAgICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIiwgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSBfdGhpczEzOwoKICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSBfdGhpcy5zYXZlKHt9LCBmYWxzZSk7CgogICAgICAgICAgICAgICAgICBwb3N0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgdmFyIGFyZyA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgICAgICAgICAgICAgIGlmIChfdGhpczEzLnZpZXdwYXJhbXMpIHsKICAgICAgICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXdwYXJhbXM6IF90aGlzMTMudmlld3BhcmFtcwogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gX3RoaXMxMy5zZXJ2aWNlLndmc3RhcnQoX3RoaXMuV0ZTdGFydEFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfdGhpczEzLmNvbnRleHQpKSwgYXJnLCBfdGhpczEzLnNob3dCdXN5SW5kaWNhdG9yLCBsb2NhbGRhdGEpOwoKICAgICAgICAgICAgICAgICAgICByZXN1bHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczEzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogJ+W3peS9nOa1geWQr+WKqOWksei0pSwgJyArIHJlc3BvbnNlLmRhdGEubWVzc2FnZQogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXMxMy4kTm90aWNlLmluZm8oewogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICflt6XkvZzmtYHlkK/liqjmiJDlip8nCiAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczEzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICfns7vnu5/lvILluLgnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXMxMy4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogJ+ezu+e7n+W8guW4uCcKICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gd2ZzdGFydChfeCwgX3gyKSB7CiAgICAgICAgcmV0dXJuIF93ZnN0YXJ0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB3ZnN0YXJ0OwogICAgfSgpCiAgICAvKioNCiAgICAgKiDlt6XkvZzmtYHmj5DkuqQNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHsqfSBbbG9jYWxkYXRhPXt9XQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIndmc3VibWl0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfd2ZzdWJtaXQgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhkYXRhLCBsb2NhbGRhdGEpIHsKICAgICAgICB2YXIgX3RoaXMxNCA9IHRoaXM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgICAgICAgICAgICB2YXIgX3RoaXMgPSBfdGhpczE0OwogICAgICAgICAgICAgICAgICB2YXIgYXJnID0gZGF0YVswXTsKICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHsKICAgICAgICAgICAgICAgICAgICB2aWV3cGFyYW1zOiBfdGhpczE0LnZpZXdwYXJhbXMKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBpZiAoIWFyZy5waW1jb250cmFjdHR5cGUgfHwgT2JqZWN0LmlzKGFyZy5waW1jb250cmFjdHR5cGUsICcnKSkgewogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSBPYmplY3QuaXMoYXJnLnNyZnVmLCAnMScpID8gX3RoaXMxNC5zZXJ2aWNlLnVwZGF0ZShfdGhpczE0LnVwZGF0ZUFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfdGhpczE0LmNvbnRleHQpKSwgYXJnLCBfdGhpczE0LnNob3dCdXN5SW5kaWNhdG9yKSA6IF90aGlzMTQuc2VydmljZS5hZGQoX3RoaXMxNC5jcmVhdGVBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXMxNC5jb250ZXh0KSksIGFyZywgX3RoaXMxNC5zaG93QnVzeUluZGljYXRvcik7CiAgICAgICAgICAgICAgICAgIHBvc3QudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICB2YXIgYXJnID0gcmVzcG9uc2UuZGF0YTsgLy8g5L+d5a2Y5a6M5oiQVUnlpITnkIYKCiAgICAgICAgICAgICAgICAgICAgX3RoaXMxNC5vbkZvcm1Mb2FkKGFyZywgJ3NhdmUnKTsKCiAgICAgICAgICAgICAgICAgICAgX3RoaXMxNC4kZW1pdCgnc2F2ZScsIGFyZyk7CgogICAgICAgICAgICAgICAgICAgIF90aGlzMTQuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTQuZm9ybVN0YXRlLm5leHQoewogICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc2F2ZScsCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGFyZwogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgfSk7IC8vIOWHhuWkh+aPkOS6pOWPguaVsAoKCiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMTQudmlld3BhcmFtcykgewogICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHsKICAgICAgICAgICAgICAgICAgICAgICAgdmlld3BhcmFtczogX3RoaXMxNC52aWV3cGFyYW1zCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9IC8vIOW8uuWItuihpeWFhXNyZndmbWVtbwoKCiAgICAgICAgICAgICAgICAgICAgaWYgKF90aGlzMTQuc3Jmd2ZtZW1vKSB7CiAgICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgewogICAgICAgICAgICAgICAgICAgICAgICBzcmZ3Zm1lbW86IF90aGlzMTQuc3Jmd2ZtZW1vCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBfdGhpczE0LnNlcnZpY2Uud2ZzdWJtaXQoX3RoaXMuV0ZTdWJtaXRBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXMxNC5jb250ZXh0KSksIGFyZywgX3RoaXMxNC5zaG93QnVzeUluZGljYXRvciwgbG9jYWxkYXRhKTsKCiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMxNC4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnJywKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICflt6XkvZzmtYHmj5DkuqTlpLHotKUsICcgKyByZXNwb25zZS5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTQub25Gb3JtTG9hZChhcmcsICdzdWJtaXQnKTsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczE0LiRzdG9yZS5kaXNwYXRjaCgndmlld2FjdGlvbi9kYXRhc2F2ZWQnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXd0YWc6IF90aGlzMTQudmlld3RhZwogICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXMxNC4kTm90aWNlLmluZm8oewogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICflt6XkvZzmtYHmj5DkuqTmiJDlip8nCiAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczE0LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTQuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICfns7vnu5/lvILluLgnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgJiYgcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgX3RoaXMxNC4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgIF90aGlzMTQuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogJ+ezu+e7n+W8guW4uCcKICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gd2ZzdWJtaXQoX3gzLCBfeDQpIHsKICAgICAgICByZXR1cm4gX3dmc3VibWl0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiB3ZnN1Ym1pdDsKICAgIH0oKQogICAgLyoqDQogICAgICog6KGo5Y2V6aG55pu05pawDQogICAgICoNCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gbW9kZSDnlYzpnaLooYzkuLrlkI3np7ANCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XSDor7fmsYLmlbDmja4NCiAgICAgKiBAcGFyYW0ge3N0cmluZ1tdfSB1cGRhdGVEZXRhaWxzIOabtOaWsOmhuQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW3Nob3dsb2FkaW5nXSDmmK/lkKbmmL7npLrliqDovb3nirbmgIENCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAidXBkYXRlRm9ybUl0ZW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1cGRhdGVGb3JtSXRlbXMobW9kZSkgewogICAgICB2YXIgX3RoaXMxNSA9IHRoaXM7CgogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciB1cGRhdGVEZXRhaWxzID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgPyBhcmd1bWVudHNbMl0gOiB1bmRlZmluZWQ7CiAgICAgIHZhciBzaG93bG9hZGluZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdW5kZWZpbmVkOwoKICAgICAgaWYgKCFtb2RlIHx8IG1vZGUgJiYgT2JqZWN0LmlzKG1vZGUsICcnKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIGFyZyA9IF9vYmplY3RTcHJlYWQoe30sIGRhdGEpOwoKICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHRoaXMudmlld3BhcmFtcyk7CiAgICAgIHZhciBwb3N0ID0gdGhpcy5zZXJ2aWNlLmZyb250TG9naWMobW9kZSwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSwgYXJnLCBzaG93bG9hZGluZyk7CiAgICAgIHBvc3QudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICBfdGhpczE1LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgIGRlc2M6ICfooajljZXpobnmm7TmlrDlpLHotKUnCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgdmFyIF9kYXRhID0ge307CiAgICAgICAgdXBkYXRlRGV0YWlscy5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgICAgICBpZiAoIWRhdGEuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIE9iamVjdC5hc3NpZ24oX2RhdGEsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgbmFtZSwgZGF0YVtuYW1lXSkpOwogICAgICAgIH0pOwoKICAgICAgICBfdGhpczE1LnNldEZvcm1FbmFibGVDb25kKF9kYXRhKTsKCiAgICAgICAgX3RoaXMxNS5maWxsRm9ybShfZGF0YSwgJ3VwZGF0ZUZvcm1JdGVtJyk7CgogICAgICAgIF90aGlzMTUuZm9ybUxvZ2ljKHsKICAgICAgICAgIG5hbWU6ICcnLAogICAgICAgICAgbmV3VmFsOiBudWxsLAogICAgICAgICAgb2xkVmFsOiBudWxsCiAgICAgICAgfSk7CgogICAgICAgIF90aGlzMTUuZGF0YUNoYW5nLm5leHQoSlNPTi5zdHJpbmdpZnkoX3RoaXMxNS5kYXRhKSk7CgogICAgICAgIF90aGlzMTUuJG5leHRUaWNrKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMTUuZm9ybVN0YXRlLm5leHQoewogICAgICAgICAgICB0eXBlOiAndXBkYXRlZm9ybWl0ZW0nLAogICAgICAgICAgICB1Zmltb2RlOiBhcmcuc3JmdWZpbW9kZSwKICAgICAgICAgICAgZGF0YTogX2RhdGEKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzICYmIHJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIF90aGlzMTUuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogcmVzcG9uc2UuZGF0YS5tZXNzYWdlCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIF90aGlzMTUuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogJ+ezu+e7n+W8guW4uCcKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5Zue6L2m5LqL5Lu2DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvbkVudGVyIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkVudGVyKCRldmVudCkge30KICAgIC8qKg0KICAgICAqIOS/neWtmOW5tumAgOWHug0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gYXJncw0KICAgICAqIEBtZW1iZXJvZiBNYWluQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzYXZlQW5kRXhpdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2F2ZUFuZEV4aXQoZGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgYXJnID0ge307CgogICAgICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIGRhdGFbMF0pOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuY3VycmVudEFjdGlvbiA9ICJzYXZlQW5kRXhpdCI7CgogICAgICAgIF90aGlzLnNhdmUoW2FyZ10pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICBfdGhpcy5jbG9zZVZpZXcocmVzLmRhdGEpOwogICAgICAgICAgfQoKICAgICAgICAgIHJlc29sdmUocmVzKTsKICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5L+d5a2Y5bm25paw5bu6DQogICAgICoNCiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzDQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInNhdmVBbmROZXciLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNhdmVBbmROZXcoZGF0YSkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgYXJnID0ge307CgogICAgICAgIGlmIChkYXRhICYmIGRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIGRhdGFbMF0pOwogICAgICAgIH0KCiAgICAgICAgX3RoaXMuY3VycmVudEFjdGlvbiA9ICJzYXZlQW5kTmV3IjsKCiAgICAgICAgX3RoaXMuc2F2ZShbYXJnXSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgICBfdGhpcy5SZXNldERhdGEocmVzKTsKCiAgICAgICAgICBfdGhpcy5sb2FkRHJhZnQoe30pOwogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDliKDpmaTlubbpgIDlh7oNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7YW55W119IGFyZ3MNCiAgICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAicmVtb3ZlQW5kRXhpdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcmVtb3ZlQW5kRXhpdChkYXRhKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciBhcmcgPSB7fTsKCiAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICBPYmplY3QuYXNzaWduKGFyZywgZGF0YVswXSk7CiAgICAgICAgfQoKICAgICAgICBfdGhpcy5yZW1vdmUoW2FyZ10pLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICBfdGhpcy5jbG9zZVZpZXcocmVzLmRhdGEpOwogICAgICAgICAgfQoKICAgICAgICAgIHJlc29sdmUocmVzKTsKICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgKiDlhbPns7vnlYzpnaLmlbDmja7kv53lrZjlrozmiJANCiAgICAqDQogICAgKiBAcGFyYW0ge2FueX0gJGV2ZW50DQogICAgKiBAbWVtYmVyb2YgTWFpbkJhc2UNCiAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkcmRhdGFzYXZlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZHJkYXRhc2F2ZWQoJGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLmRyY291bnRlci0tOwoKICAgICAgaWYgKHRoaXMuZHJjb3VudGVyID09PSAwKSB7CiAgICAgICAgdGhpcy5zYXZlKHRoaXMuZHJzYXZlb3B0LCB1bmRlZmluZWQsIGZhbHNlKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICAgIF90aGlzMTYuc2F2ZVN0YXRlKHJlcyk7CgogICAgICAgICAgX3RoaXMxNi5kcnNhdmVvcHQgPSB7fTsKCiAgICAgICAgICBpZiAoT2JqZWN0LmlzKF90aGlzLmN1cnJlbnRBY3Rpb24sICJzYXZlQW5kTmV3IikpIHsKICAgICAgICAgICAgX3RoaXMuUmVzZXREYXRhKHJlcyk7CgogICAgICAgICAgICBfdGhpcy5sb2FkRHJhZnQoe30pOwogICAgICAgICAgfSBlbHNlIGlmIChPYmplY3QuaXMoX3RoaXMuY3VycmVudEFjdGlvbiwgInNhdmVBbmRFeGl0IikpIHsKICAgICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICAgIF90aGlzLmNsb3NlVmlldyhyZXMuZGF0YSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog5paw5bu66buY6K6k5YC8DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImNyZWF0ZURlZmF1bHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHQoKSB7fQogICAgLyoqDQogICAgICog5pu05paw6buY6K6k5YC8DQogICAgICogQG1lbWJlcm9mIE1haW5CYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInVwZGF0ZURlZmF1bHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZURlZmF1bHQoKSB7fQogIH1dKTsKCiAgcmV0dXJuIE1haW5CYXNlOwp9KFZ1ZSk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5CYXNlLnByb3RvdHlwZSwgIm5hbWUiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluQmFzZS5wcm90b3R5cGUsICJ2aWV3U3RhdGUiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluQmFzZS5wcm90b3R5cGUsICJjb250ZXh0Iiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAidmlld3BhcmFtcyIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoewogICJkZWZhdWx0IjogZmFsc2UKfSldLCBNYWluQmFzZS5wcm90b3R5cGUsICJhdXRvc2F2ZSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoewogICJkZWZhdWx0IjogdHJ1ZQp9KV0sIE1haW5CYXNlLnByb3RvdHlwZSwgInNob3dCdXN5SW5kaWNhdG9yIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAiV0ZTdWJtaXRBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluQmFzZS5wcm90b3R5cGUsICJXRlN0YXJ0QWN0aW9uIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAidXBkYXRlQWN0aW9uIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAicmVtb3ZlQWN0aW9uIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAibG9hZGRyYWZ0QWN0aW9uIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAibG9hZEFjdGlvbiIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5CYXNlLnByb3RvdHlwZSwgImNyZWF0ZUFjdGlvbiIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5CYXNlLnByb3RvdHlwZSwgInNlYXJjaEFjdGlvbiIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5CYXNlLnByb3RvdHlwZSwgInZpZXd0YWciLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtXYXRjaCgnZGF0YS5zcmZ1cGRhdGVkYXRlJyldLCBNYWluQmFzZS5wcm90b3R5cGUsICJvblNyZnVwZGF0ZWRhdGVDaGFuZ2UiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbV2F0Y2goJ2RhdGEuc3Jmb3Jpa2V5JyldLCBNYWluQmFzZS5wcm90b3R5cGUsICJvblNyZm9yaWtleUNoYW5nZSIsIG51bGwpOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtXYXRjaCgnZGF0YS5zcmZrZXknKV0sIE1haW5CYXNlLnByb3RvdHlwZSwgIm9uU3Jma2V5Q2hhbmdlIiwgbnVsbCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1dhdGNoKCdkYXRhLnNyZm1ham9ydGV4dCcpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAib25TcmZtYWpvcnRleHRDaGFuZ2UiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbV2F0Y2goJ2RhdGEuc3JmdGVtcG1vZGUnKV0sIE1haW5CYXNlLnByb3RvdHlwZSwgIm9uU3JmdGVtcG1vZGVDaGFuZ2UiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbV2F0Y2goJ2RhdGEuc3JmdWYnKV0sIE1haW5CYXNlLnByb3RvdHlwZSwgIm9uU3JmdWZDaGFuZ2UiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbV2F0Y2goJ2RhdGEuc3JmZGVpZCcpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAib25TcmZkZWlkQ2hhbmdlIiwgbnVsbCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1dhdGNoKCdkYXRhLnNyZnNvdXJjZWtleScpXSwgTWFpbkJhc2UucHJvdG90eXBlLCAib25TcmZzb3VyY2VrZXlDaGFuZ2UiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbV2F0Y2goJ2RhdGEuc2JtJyldLCBNYWluQmFzZS5wcm90b3R5cGUsICJvblNibUNoYW5nZSIsIG51bGwpOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtXYXRjaCgnZGF0YS5waW1jb250cmFjdHR5cGVuYW1lJyldLCBNYWluQmFzZS5wcm90b3R5cGUsICJvblBpbWNvbnRyYWN0dHlwZW5hbWVDaGFuZ2UiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbV2F0Y2goJ2RhdGEucGltY29udHJhY3R0eXBlaWQnKV0sIE1haW5CYXNlLnByb3RvdHlwZSwgIm9uUGltY29udHJhY3R0eXBlaWRDaGFuZ2UiLCBudWxsKTsKCk1haW5CYXNlID0gdHNsaWJfMS5fX2RlY29yYXRlKFtDb21wb25lbnQoewogIGNvbXBvbmVudHM6IHt9Cn0pXSwgTWFpbkJhc2UpOwpleHBvcnQgZGVmYXVsdCBNYWluQmFzZTs="},null]}