{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js??ref--13-3!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\uiservice\\pim-person-change\\pim-person-change-ui-service-base.ts","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\uiservice\\pim-person-change\\pim-person-change-ui-service-base.ts","mtime":1630509410826},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9nZXRQcm90b3R5cGVPZiI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKaW1wb3J0IHsgRW52aXJvbm1lbnQgfSBmcm9tICdAL2Vudmlyb25tZW50cy9lbnZpcm9ubWVudCc7CmltcG9ydCB7IFVJQWN0aW9uVG9vbCwgVXRpbCB9IGZyb20gJ0AvdXRpbHMnOwppbXBvcnQgVUlTZXJ2aWNlIGZyb20gJy4uL3VpLXNlcnZpY2UnOwppbXBvcnQgUGltUGVyc29uQ2hhbmdlU2VydmljZSBmcm9tICdAL3NlcnZpY2UvcGltLXBlcnNvbi1jaGFuZ2UvcGltLXBlcnNvbi1jaGFuZ2Utc2VydmljZSc7Ci8qKg0KICog5Lq65ZGY5L+h5oGv5Y+Y5pu05a6h5qC4VUnmnI3liqHlr7nosaHln7rnsbsNCiAqDQogKiBAZXhwb3J0DQogKiBAY2xhc3MgUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZQ0KICovCgp2YXIgUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9VSVNlcnZpY2UpIHsKICBfaW5oZXJpdHMoUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZSwgX1VJU2VydmljZSk7CgogIC8qKg0KICAgKiBDcmVhdGVzIGFuIGluc3RhbmNlIG9mICBQaW1QZXJzb25DaGFuZ2VVSVNlcnZpY2VCYXNlLg0KICAgKg0KICAgKiBAcGFyYW0geyp9IFtvcHRzPXt9XQ0KICAgKiBAbWVtYmVyb2YgIFBpbVBlcnNvbkNoYW5nZVVJU2VydmljZUJhc2UNCiAgICovCiAgZnVuY3Rpb24gUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZSgpIHsKICAgIHZhciBfdGhpczI7CgogICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQaW1QZXJzb25DaGFuZ2VVSVNlcnZpY2VCYXNlKTsKCiAgICBfdGhpczIgPSBfcG9zc2libGVDb25zdHJ1Y3RvclJldHVybih0aGlzLCBfZ2V0UHJvdG90eXBlT2YoUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZSkuY2FsbCh0aGlzLCBvcHRzKSk7CiAgICAvKioNCiAgICAgKiDmmK/lkKbmlK/mjIHlt6XkvZzmtYENCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiAgUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5pc0VuYWJsZVdvcmtmbG93ID0gZmFsc2U7CiAgICAvKioNCiAgICAgKiDlvZPliY1VSeacjeWKoeWvueW6lOeahOaVsOaNruacjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQG1lbWJlcm9mICBQaW1QZXJzb25DaGFuZ2VVSVNlcnZpY2VCYXNlDQogICAgICovCgogICAgX3RoaXMyLmRhdGFTZXJ2aWNlID0gbmV3IFBpbVBlcnNvbkNoYW5nZVNlcnZpY2UoKTsKICAgIC8qKg0KICAgICAqIOaJgOacieWFs+iBlOinhuWbvg0KICAgICAqDQogICAgICogQG1lbWJlcm9mICBQaW1QZXJzb25DaGFuZ2VVSVNlcnZpY2VCYXNlDQogICAgICovCgogICAgX3RoaXMyLmFsbFZpZXdNYXAgPSBuZXcgTWFwKCk7CiAgICAvKioNCiAgICAgKiDnirbmgIHlgLwNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiAgUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5zdGF0ZVZhbHVlID0gMDsKICAgIC8qKg0KICAgICAqIOeKtuaAgeWxnuaApw0KICAgICAqDQogICAgICogQG1lbWJlcm9mICBQaW1QZXJzb25DaGFuZ2VVSVNlcnZpY2VCYXNlDQogICAgICovCgogICAgX3RoaXMyLnN0YXRlRmllbGQgPSAiIjsKICAgIC8qKg0KICAgICAqIOS4u+eKtuaAgeWxnuaAp+mbhuWQiA0KICAgICAqDQogICAgICogQG1lbWJlcm9mICBQaW1QZXJzb25DaGFuZ2VVSVNlcnZpY2VCYXNlDQogICAgICovCgogICAgX3RoaXMyLm1haW5TdGF0ZUZpZWxkcyA9IFtdOwogICAgLyoqDQogICAgICog5Li754q25oCB6ZuG5ZCITWFwDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgIFBpbVBlcnNvbkNoYW5nZVVJU2VydmljZUJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuYWxsRGVNYWluU3RhdGVNYXAgPSBuZXcgTWFwKCk7CgogICAgX3RoaXMyLmluaXRWaWV3TWFwKCk7CgogICAgX3RoaXMyLmluaXREZU1haW5TdGF0ZU1hcCgpOwoKICAgIHJldHVybiBfdGhpczI7CiAgfQogIC8qKg0KICAgKiDliJ3lp4vljJbop4blm75NYXANCiAgICoNCiAgICogQG1lbWJlcm9mICBQaW1QZXJzb25DaGFuZ2VVSVNlcnZpY2VCYXNlDQogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKFBpbVBlcnNvbkNoYW5nZVVJU2VydmljZUJhc2UsIFt7CiAgICBrZXk6ICJpbml0Vmlld01hcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaW5pdFZpZXdNYXAoKSB7CiAgICAgIHRoaXMuYWxsVmlld01hcC5zZXQoJzonLCB7CiAgICAgICAgdmlld25hbWU6ICdlZGl0dmlldzInLAogICAgICAgIHNyZmFwcGRlOiAncGltcGVyc29uY2hhbmdlcycKICAgICAgfSk7CiAgICAgIHRoaXMuYWxsVmlld01hcC5zZXQoJ01EQVRBVklFVzonLCB7CiAgICAgICAgdmlld25hbWU6ICdncmlkdmlldycsCiAgICAgICAgc3JmYXBwZGU6ICdwaW1wZXJzb25jaGFuZ2VzJwogICAgICB9KTsKICAgICAgdGhpcy5hbGxWaWV3TWFwLnNldCgnRURJVFZJRVc6JywgewogICAgICAgIHZpZXduYW1lOiAnZWRpdHZpZXcnLAogICAgICAgIHNyZmFwcGRlOiAncGltcGVyc29uY2hhbmdlcycKICAgICAgfSk7CiAgICAgIHRoaXMuYWxsVmlld01hcC5zZXQoJzonLCB7CiAgICAgICAgdmlld25hbWU6ICdoaXNyZWNncmlkdmlldycsCiAgICAgICAgc3JmYXBwZGU6ICdwaW1wZXJzb25jaGFuZ2VzJwogICAgICB9KTsKICAgICAgdGhpcy5hbGxWaWV3TWFwLnNldCgnOicsIHsKICAgICAgICB2aWV3bmFtZTogJ3JlYXNvbmVkaXR2aWV3JywKICAgICAgICBzcmZhcHBkZTogJ3BpbXBlcnNvbmNoYW5nZXMnCiAgICAgIH0pOwogICAgICB0aGlzLmFsbFZpZXdNYXAuc2V0KCc6JywgewogICAgICAgIHZpZXduYW1lOiAncGlja3VwZ3JpZHZpZXcnLAogICAgICAgIHNyZmFwcGRlOiAncGltcGVyc29uY2hhbmdlcycKICAgICAgfSk7CiAgICAgIHRoaXMuYWxsVmlld01hcC5zZXQoJzonLCB7CiAgICAgICAgdmlld25hbWU6ICdyZWFkZWRpdHZpZXcnLAogICAgICAgIHNyZmFwcGRlOiAncGltcGVyc29uY2hhbmdlcycKICAgICAgfSk7CiAgICAgIHRoaXMuYWxsVmlld01hcC5zZXQoJ1BJQ0tVUFZJRVc6JywgewogICAgICAgIHZpZXduYW1lOiAncGlja3VwdmlldycsCiAgICAgICAgc3JmYXBwZGU6ICdwaW1wZXJzb25jaGFuZ2VzJwogICAgICB9KTsKICAgICAgdGhpcy5hbGxWaWV3TWFwLnNldCgnUkVESVJFQ1RWSUVXOicsIHsKICAgICAgICB2aWV3bmFtZTogJ3JlZGlyZWN0dmlldycsCiAgICAgICAgc3JmYXBwZGU6ICdwaW1wZXJzb25jaGFuZ2VzJwogICAgICB9KTsKICAgICAgdGhpcy5hbGxWaWV3TWFwLnNldCgnTVBJQ0tVUFZJRVc6JywgewogICAgICAgIHZpZXduYW1lOiAnbXBpY2t1cHZpZXcnLAogICAgICAgIHNyZmFwcGRlOiAncGltcGVyc29uY2hhbmdlcycKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDliJ3lp4vljJbkuLvnirbmgIHpm4blkIgNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiAgUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJpbml0RGVNYWluU3RhdGVNYXAiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGluaXREZU1haW5TdGF0ZU1hcCgpIHt9CiAgICAvKioNCiAgICAgKiDljoblj7LlrqHmoLjorrDlvZUNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7YW55W119IGFyZ3Mg5b2T5YmN5pWw5o2uDQogICAgICogQHBhcmFtIHthbnl9IGNvbnRleHQg6KGM5Li66ZmE5Yqg5LiK5LiL5paHDQogICAgICogQHBhcmFtIHsqfSBbcGFyYW1zXSDpmYTliqDlj4LmlbANCiAgICAgKiBAcGFyYW0geyp9IFskZXZlbnRdIOS6i+S7tua6kA0KICAgICAqIEBwYXJhbSB7Kn0gW3hEYXRhXSAg5omn6KGM6KGM5Li65omA6ZyA5b2T5YmN6YOo5Lu2DQogICAgICogQHBhcmFtIHsqfSBbYWN0aW9uQ29udGV4dF0gIOaJp+ihjOihjOS4uuS4iuS4i+aWhw0KICAgICAqIEBwYXJhbSB7Kn0gW3NyZlBhcmVudERlTmFtZV0g54i25a6e5L2T5ZCN56ewDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiUGltUGVyc29uQ2hhbmdlX0hpc1JlYyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX1BpbVBlcnNvbkNoYW5nZV9IaXNSZWMgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKGFyZ3MpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgcGFyYW1zLAogICAgICAgICAgICAkZXZlbnQsCiAgICAgICAgICAgIHhEYXRhLAogICAgICAgICAgICBhY3Rpb25Db250ZXh0LAogICAgICAgICAgICBzcmZQYXJlbnREZU5hbWUsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIHBhcmVudENvbnRleHQsCiAgICAgICAgICAgIHBhcmVudFZpZXdQYXJhbSwKICAgICAgICAgICAgX3RoaXMsCiAgICAgICAgICAgIF9hcmdzLAogICAgICAgICAgICBhY3Rpb25UYXJnZXQsCiAgICAgICAgICAgIHBhcmVudE9iaiwKICAgICAgICAgICAgZGVSZXNQYXJhbWV0ZXJzLAogICAgICAgICAgICBwYXJhbWV0ZXJzLAogICAgICAgICAgICBvcGVuSW5kZXhWaWV3VGFiLAogICAgICAgICAgICBfYXJnczIgPSBhcmd1bWVudHM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBfYXJnczIubGVuZ3RoID4gMSAmJiBfYXJnczJbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMlsxXSA6IHt9OwogICAgICAgICAgICAgICAgcGFyYW1zID0gX2FyZ3MyLmxlbmd0aCA+IDIgJiYgX2FyZ3MyWzJdICE9PSB1bmRlZmluZWQgPyBfYXJnczJbMl0gOiB7fTsKICAgICAgICAgICAgICAgICRldmVudCA9IF9hcmdzMi5sZW5ndGggPiAzID8gX2FyZ3MyWzNdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgeERhdGEgPSBfYXJnczIubGVuZ3RoID4gNCA/IF9hcmdzMls0XSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIGFjdGlvbkNvbnRleHQgPSBfYXJnczIubGVuZ3RoID4gNSA/IF9hcmdzMls1XSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIHNyZlBhcmVudERlTmFtZSA9IF9hcmdzMi5sZW5ndGggPiA2ID8gX2FyZ3MyWzZdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgZGF0YSA9IHt9OwogICAgICAgICAgICAgICAgcGFyZW50Q29udGV4dCA9IHt9OwogICAgICAgICAgICAgICAgcGFyZW50Vmlld1BhcmFtID0ge307CiAgICAgICAgICAgICAgICBfdGhpcyA9IGFjdGlvbkNvbnRleHQ7CiAgICAgICAgICAgICAgICBfYXJncyA9IFV0aWwuZGVlcENvcHkoYXJncyk7CiAgICAgICAgICAgICAgICBhY3Rpb25UYXJnZXQgPSAnTk9ORSc7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzLmNvbnRleHQpIHsKICAgICAgICAgICAgICAgICAgcGFyZW50Q29udGV4dCA9IF90aGlzLmNvbnRleHQ7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKF90aGlzLnZpZXdwYXJhbXMpIHsKICAgICAgICAgICAgICAgICAgcGFyZW50Vmlld1BhcmFtID0gX3RoaXMudmlld3BhcmFtczsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb250ZXh0ID0gVUlBY3Rpb25Ub29sLmhhbmRsZUNvbnRleHRQYXJhbShhY3Rpb25UYXJnZXQsIF9hcmdzLCBwYXJlbnRDb250ZXh0LCBwYXJlbnRWaWV3UGFyYW0sIGNvbnRleHQpOwogICAgICAgICAgICAgICAgZGF0YSA9IFVJQWN0aW9uVG9vbC5oYW5kbGVBY3Rpb25QYXJhbShhY3Rpb25UYXJnZXQsIF9hcmdzLCBwYXJlbnRDb250ZXh0LCBwYXJlbnRWaWV3UGFyYW0sIHBhcmFtcyk7CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gT2JqZWN0LmFzc2lnbih7fSwgYWN0aW9uQ29udGV4dC5jb250ZXh0LCBjb250ZXh0KTsKICAgICAgICAgICAgICAgIHBhcmVudE9iaiA9IHsKICAgICAgICAgICAgICAgICAgc3JmcGFyZW50ZGVuYW1lOiBzcmZQYXJlbnREZU5hbWUgPyBzcmZQYXJlbnREZU5hbWUgOiBudWxsLAogICAgICAgICAgICAgICAgICBzcmZwYXJlbnRrZXk6IHNyZlBhcmVudERlTmFtZSA/IGNvbnRleHRbc3JmUGFyZW50RGVOYW1lLnRvTG93ZXJDYXNlKCldIDogbnVsbAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGF0YSwgcGFyZW50T2JqKTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oY29udGV4dCwgcGFyZW50T2JqKTsKICAgICAgICAgICAgICAgIGRlUmVzUGFyYW1ldGVycyA9IFtdOwoKICAgICAgICAgICAgICAgIGlmIChjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSB7CiAgICAgICAgICAgICAgICAgIGRlUmVzUGFyYW1ldGVycyA9IFt7CiAgICAgICAgICAgICAgICAgICAgcGF0aE5hbWU6ICdwaW1wZW9wbGUnLAogICAgICAgICAgICAgICAgICAgIHBhcmFtZXRlck5hbWU6ICdwaW1wZXJzb24nCiAgICAgICAgICAgICAgICAgIH1dOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHBhcmFtZXRlcnMgPSBbewogICAgICAgICAgICAgICAgICBwYXRoTmFtZTogJ3BpbXBlcnNvbmNoYW5nZXMnLAogICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJOYW1lOiAncGltcGVyc29uY2hhbmdlJwogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBwYXRoTmFtZTogJ2hpc3JlY2dyaWR2aWV3JywKICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyTmFtZTogJ2hpc3JlY2dyaWR2aWV3JwogICAgICAgICAgICAgICAgfV07CgogICAgICAgICAgICAgICAgb3BlbkluZGV4Vmlld1RhYiA9IGZ1bmN0aW9uIG9wZW5JbmRleFZpZXdUYWIoZGF0YSkgewogICAgICAgICAgICAgICAgICB2YXIgcm91dGVQYXRoID0gYWN0aW9uQ29udGV4dC4kdmlld1Rvb2wuYnVpbGRVcFJvdXRlUGF0aChhY3Rpb25Db250ZXh0LiRyb3V0ZSwgY29udGV4dCwgZGVSZXNQYXJhbWV0ZXJzLCBwYXJhbWV0ZXJzLCBfYXJncywgZGF0YSk7CiAgICAgICAgICAgICAgICAgIGFjdGlvbkNvbnRleHQuJHJvdXRlci5wdXNoKHJvdXRlUGF0aCk7CiAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBvcGVuSW5kZXhWaWV3VGFiKGRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIFBpbVBlcnNvbkNoYW5nZV9IaXNSZWMoX3gpIHsKICAgICAgICByZXR1cm4gX1BpbVBlcnNvbkNoYW5nZV9IaXNSZWMuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFBpbVBlcnNvbkNoYW5nZV9IaXNSZWM7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIOaLkue7nQ0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gYXJncyDlvZPliY3mlbDmja4NCiAgICAgKiBAcGFyYW0ge2FueX0gY29udGV4dCDooYzkuLrpmYTliqDkuIrkuIvmlocNCiAgICAgKiBAcGFyYW0geyp9IFtwYXJhbXNdIOmZhOWKoOWPguaVsA0KICAgICAqIEBwYXJhbSB7Kn0gWyRldmVudF0g5LqL5Lu25rqQDQogICAgICogQHBhcmFtIHsqfSBbeERhdGFdICDmiafooYzooYzkuLrmiYDpnIDlvZPliY3pg6jku7YNCiAgICAgKiBAcGFyYW0geyp9IFthY3Rpb25Db250ZXh0XSAg5omn6KGM6KGM5Li65LiK5LiL5paHDQogICAgICogQHBhcmFtIHsqfSBbc3JmUGFyZW50RGVOYW1lXSDniLblrp7kvZPlkI3np7ANCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJQaW1QZXJzb25DaGFuZ2VfUmVmdXNlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfUGltUGVyc29uQ2hhbmdlX1JlZnVzZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKGFyZ3MpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgcGFyYW1zLAogICAgICAgICAgICAkZXZlbnQsCiAgICAgICAgICAgIHhEYXRhLAogICAgICAgICAgICBhY3Rpb25Db250ZXh0LAogICAgICAgICAgICBzcmZQYXJlbnREZU5hbWUsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIHBhcmVudENvbnRleHQsCiAgICAgICAgICAgIHBhcmVudFZpZXdQYXJhbSwKICAgICAgICAgICAgX3RoaXMsCiAgICAgICAgICAgIF9hcmdzLAogICAgICAgICAgICBhY3Rpb25UYXJnZXQsCiAgICAgICAgICAgIHBhcmVudE9iaiwKICAgICAgICAgICAgZGVSZXNQYXJhbWV0ZXJzLAogICAgICAgICAgICBwYXJhbWV0ZXJzLAogICAgICAgICAgICBvcGVuSW5kZXhWaWV3VGFiLAogICAgICAgICAgICBfYXJnczMgPSBhcmd1bWVudHM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Mi5wcmV2ID0gX2NvbnRleHQyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MzLmxlbmd0aCA+IDEgJiYgX2FyZ3MzWzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczNbMV0gOiB7fTsKICAgICAgICAgICAgICAgIHBhcmFtcyA9IF9hcmdzMy5sZW5ndGggPiAyICYmIF9hcmdzM1syXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MzWzJdIDoge307CiAgICAgICAgICAgICAgICAkZXZlbnQgPSBfYXJnczMubGVuZ3RoID4gMyA/IF9hcmdzM1szXSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIHhEYXRhID0gX2FyZ3MzLmxlbmd0aCA+IDQgPyBfYXJnczNbNF0gOiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBhY3Rpb25Db250ZXh0ID0gX2FyZ3MzLmxlbmd0aCA+IDUgPyBfYXJnczNbNV0gOiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBzcmZQYXJlbnREZU5hbWUgPSBfYXJnczMubGVuZ3RoID4gNiA/IF9hcmdzM1s2XSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIGRhdGEgPSB7fTsKICAgICAgICAgICAgICAgIHBhcmVudENvbnRleHQgPSB7fTsKICAgICAgICAgICAgICAgIHBhcmVudFZpZXdQYXJhbSA9IHt9OwogICAgICAgICAgICAgICAgX3RoaXMgPSBhY3Rpb25Db250ZXh0OwogICAgICAgICAgICAgICAgX2FyZ3MgPSBVdGlsLmRlZXBDb3B5KGFyZ3MpOwogICAgICAgICAgICAgICAgYWN0aW9uVGFyZ2V0ID0gJ1NJTkdMRUtFWSc7CiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbnRleHQsIHsKICAgICAgICAgICAgICAgICAgcGltcGVyc29uY2hhbmdlOiAnJXBpbXBlcnNvbmNoYW5nZSUnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFyYW1zLCB7CiAgICAgICAgICAgICAgICAgIHBpbXBlcnNvbmNoYW5nZWlkOiAnJXBpbXBlcnNvbmNoYW5nZSUnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFyYW1zLCB7CiAgICAgICAgICAgICAgICAgIHBpbXBlcnNvbmNoYW5nZW5hbWU6ICclcGltcGVyc29uY2hhbmdlbmFtZSUnCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY29udGV4dCkgewogICAgICAgICAgICAgICAgICBwYXJlbnRDb250ZXh0ID0gX3RoaXMuY29udGV4dDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMudmlld3BhcmFtcykgewogICAgICAgICAgICAgICAgICBwYXJlbnRWaWV3UGFyYW0gPSBfdGhpcy52aWV3cGFyYW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBVSUFjdGlvblRvb2wuaGFuZGxlQ29udGV4dFBhcmFtKGFjdGlvblRhcmdldCwgX2FyZ3MsIHBhcmVudENvbnRleHQsIHBhcmVudFZpZXdQYXJhbSwgY29udGV4dCk7CiAgICAgICAgICAgICAgICBkYXRhID0gVUlBY3Rpb25Ub29sLmhhbmRsZUFjdGlvblBhcmFtKGFjdGlvblRhcmdldCwgX2FyZ3MsIHBhcmVudENvbnRleHQsIHBhcmVudFZpZXdQYXJhbSwgcGFyYW1zKTsKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBPYmplY3QuYXNzaWduKHt9LCBhY3Rpb25Db250ZXh0LmNvbnRleHQsIGNvbnRleHQpOwogICAgICAgICAgICAgICAgcGFyZW50T2JqID0gewogICAgICAgICAgICAgICAgICBzcmZwYXJlbnRkZW5hbWU6IHNyZlBhcmVudERlTmFtZSA/IHNyZlBhcmVudERlTmFtZSA6IG51bGwsCiAgICAgICAgICAgICAgICAgIHNyZnBhcmVudGtleTogc3JmUGFyZW50RGVOYW1lID8gY29udGV4dFtzcmZQYXJlbnREZU5hbWUudG9Mb3dlckNhc2UoKV0gOiBudWxsCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihkYXRhLCBwYXJlbnRPYmopOwogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb250ZXh0LCBwYXJlbnRPYmopOwogICAgICAgICAgICAgICAgZGVSZXNQYXJhbWV0ZXJzID0gW107CgogICAgICAgICAgICAgICAgaWYgKGNvbnRleHQucGltcGVyc29uICYmIHRydWUpIHsKICAgICAgICAgICAgICAgICAgZGVSZXNQYXJhbWV0ZXJzID0gW3sKICAgICAgICAgICAgICAgICAgICBwYXRoTmFtZTogJ3BpbXBlb3BsZScsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyTmFtZTogJ3BpbXBlcnNvbicKICAgICAgICAgICAgICAgICAgfV07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcGFyYW1ldGVycyA9IFt7CiAgICAgICAgICAgICAgICAgIHBhdGhOYW1lOiAncGltcGVyc29uY2hhbmdlcycsCiAgICAgICAgICAgICAgICAgIHBhcmFtZXRlck5hbWU6ICdwaW1wZXJzb25jaGFuZ2UnCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIHBhdGhOYW1lOiAncmVhc29uZWRpdHZpZXcnLAogICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJOYW1lOiAncmVhc29uZWRpdHZpZXcnCiAgICAgICAgICAgICAgICB9XTsKCiAgICAgICAgICAgICAgICBvcGVuSW5kZXhWaWV3VGFiID0gZnVuY3Rpb24gb3BlbkluZGV4Vmlld1RhYihkYXRhKSB7CiAgICAgICAgICAgICAgICAgIHZhciByb3V0ZVBhdGggPSBhY3Rpb25Db250ZXh0LiR2aWV3VG9vbC5idWlsZFVwUm91dGVQYXRoKGFjdGlvbkNvbnRleHQuJHJvdXRlLCBjb250ZXh0LCBkZVJlc1BhcmFtZXRlcnMsIHBhcmFtZXRlcnMsIF9hcmdzLCBkYXRhKTsKICAgICAgICAgICAgICAgICAgYWN0aW9uQ29udGV4dC4kcm91dGVyLnB1c2gocm91dGVQYXRoKTsKCiAgICAgICAgICAgICAgICAgIGlmICh4RGF0YSAmJiB4RGF0YS5yZWZyZXNoICYmIHhEYXRhLnJlZnJlc2ggaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICAgICAgICAgICAgICAgIHhEYXRhLnJlZnJlc2goYXJncyk7CiAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBvcGVuSW5kZXhWaWV3VGFiKGRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDI4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUyKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gUGltUGVyc29uQ2hhbmdlX1JlZnVzZShfeDIpIHsKICAgICAgICByZXR1cm4gX1BpbVBlcnNvbkNoYW5nZV9SZWZ1c2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFBpbVBlcnNvbkNoYW5nZV9SZWZ1c2U7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIOehruiupA0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gYXJncyDlvZPliY3mlbDmja4NCiAgICAgKiBAcGFyYW0ge2FueX0gY29udGV4dCDooYzkuLrpmYTliqDkuIrkuIvmlocNCiAgICAgKiBAcGFyYW0geyp9IFtwYXJhbXNdIOmZhOWKoOWPguaVsA0KICAgICAqIEBwYXJhbSB7Kn0gWyRldmVudF0g5LqL5Lu25rqQDQogICAgICogQHBhcmFtIHsqfSBbeERhdGFdICDmiafooYzooYzkuLrmiYDpnIDlvZPliY3pg6jku7YNCiAgICAgKiBAcGFyYW0geyp9IFthY3Rpb25Db250ZXh0XSAg5omn6KGM6KGM5Li65LiK5LiL5paHDQogICAgICogQHBhcmFtIHsqfSBbc3JmUGFyZW50RGVOYW1lXSDniLblrp7kvZPlkI3np7ANCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJQaW1QZXJzb25DaGFuZ2VfRW5zdXJlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfUGltUGVyc29uQ2hhbmdlX0Vuc3VyZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUzKGFyZ3MpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgcGFyYW1zLAogICAgICAgICAgICAkZXZlbnQsCiAgICAgICAgICAgIHhEYXRhLAogICAgICAgICAgICBhY3Rpb25Db250ZXh0LAogICAgICAgICAgICBzcmZQYXJlbnREZU5hbWUsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIHBhcmVudENvbnRleHQsCiAgICAgICAgICAgIHBhcmVudFZpZXdQYXJhbSwKICAgICAgICAgICAgX3RoaXMsCiAgICAgICAgICAgIF9hcmdzLAogICAgICAgICAgICBhY3Rpb25UYXJnZXQsCiAgICAgICAgICAgIHBhcmVudE9iaiwKICAgICAgICAgICAgYmFja2VuZCwKICAgICAgICAgICAgX2FyZ3M0ID0gYXJndW1lbnRzOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTMkKF9jb250ZXh0MykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29udGV4dCA9IF9hcmdzNC5sZW5ndGggPiAxICYmIF9hcmdzNFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M0WzFdIDoge307CiAgICAgICAgICAgICAgICBwYXJhbXMgPSBfYXJnczQubGVuZ3RoID4gMiAmJiBfYXJnczRbMl0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNFsyXSA6IHt9OwogICAgICAgICAgICAgICAgJGV2ZW50ID0gX2FyZ3M0Lmxlbmd0aCA+IDMgPyBfYXJnczRbM10gOiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICB4RGF0YSA9IF9hcmdzNC5sZW5ndGggPiA0ID8gX2FyZ3M0WzRdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgYWN0aW9uQ29udGV4dCA9IF9hcmdzNC5sZW5ndGggPiA1ID8gX2FyZ3M0WzVdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgc3JmUGFyZW50RGVOYW1lID0gX2FyZ3M0Lmxlbmd0aCA+IDYgPyBfYXJnczRbNl0gOiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBkYXRhID0ge307CiAgICAgICAgICAgICAgICBwYXJlbnRDb250ZXh0ID0ge307CiAgICAgICAgICAgICAgICBwYXJlbnRWaWV3UGFyYW0gPSB7fTsKICAgICAgICAgICAgICAgIF90aGlzID0gYWN0aW9uQ29udGV4dDsKICAgICAgICAgICAgICAgIF9hcmdzID0gVXRpbC5kZWVwQ29weShhcmdzKTsKICAgICAgICAgICAgICAgIGFjdGlvblRhcmdldCA9ICdTSU5HTEVLRVknOwogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb250ZXh0LCB7CiAgICAgICAgICAgICAgICAgIHBpbXBlcnNvbmNoYW5nZTogJyVwaW1wZXJzb25jaGFuZ2UlJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgewogICAgICAgICAgICAgICAgICBwaW1wZXJzb25jaGFuZ2VpZDogJyVwaW1wZXJzb25jaGFuZ2UlJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgewogICAgICAgICAgICAgICAgICBwaW1wZXJzb25jaGFuZ2VuYW1lOiAnJXBpbXBlcnNvbmNoYW5nZW5hbWUlJwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzLmNvbnRleHQpIHsKICAgICAgICAgICAgICAgICAgcGFyZW50Q29udGV4dCA9IF90aGlzLmNvbnRleHQ7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKF90aGlzLnZpZXdwYXJhbXMpIHsKICAgICAgICAgICAgICAgICAgcGFyZW50Vmlld1BhcmFtID0gX3RoaXMudmlld3BhcmFtczsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb250ZXh0ID0gVUlBY3Rpb25Ub29sLmhhbmRsZUNvbnRleHRQYXJhbShhY3Rpb25UYXJnZXQsIF9hcmdzLCBwYXJlbnRDb250ZXh0LCBwYXJlbnRWaWV3UGFyYW0sIGNvbnRleHQpOwogICAgICAgICAgICAgICAgZGF0YSA9IFVJQWN0aW9uVG9vbC5oYW5kbGVBY3Rpb25QYXJhbShhY3Rpb25UYXJnZXQsIF9hcmdzLCBwYXJlbnRDb250ZXh0LCBwYXJlbnRWaWV3UGFyYW0sIHBhcmFtcyk7CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gT2JqZWN0LmFzc2lnbih7fSwgYWN0aW9uQ29udGV4dC5jb250ZXh0LCBjb250ZXh0KTsKICAgICAgICAgICAgICAgIHBhcmVudE9iaiA9IHsKICAgICAgICAgICAgICAgICAgc3JmcGFyZW50ZGVuYW1lOiBzcmZQYXJlbnREZU5hbWUgPyBzcmZQYXJlbnREZU5hbWUgOiBudWxsLAogICAgICAgICAgICAgICAgICBzcmZwYXJlbnRrZXk6IHNyZlBhcmVudERlTmFtZSA/IGNvbnRleHRbc3JmUGFyZW50RGVOYW1lLnRvTG93ZXJDYXNlKCldIDogbnVsbAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGF0YSwgcGFyZW50T2JqKTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oY29udGV4dCwgcGFyZW50T2JqKTsgLy8g55u05o6l6LCD5a6e5L2T5pyN5Yqh6ZyA6KaB6L2s5o2i55qE5pWw5o2uCgogICAgICAgICAgICAgICAgaWYgKGNvbnRleHQgJiYgY29udGV4dC5zcmZzZXNzaW9uaWQpIHsKICAgICAgICAgICAgICAgICAgY29udGV4dC5zcmZzZXNzaW9ua2V5ID0gY29udGV4dC5zcmZzZXNzaW9uaWQ7CiAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjb250ZXh0LnNyZnNlc3Npb25pZDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBhY3Rpb25Db250ZXh0LmNsb3NlVmlldyhudWxsKTsKCiAgICAgICAgICAgICAgICBiYWNrZW5kID0gZnVuY3Rpb24gYmFja2VuZCgpIHsKICAgICAgICAgICAgICAgICAgdmFyIGN1clNlcnZpY2UgPSBuZXcgUGltUGVyc29uQ2hhbmdlU2VydmljZSgpOwogICAgICAgICAgICAgICAgICBjdXJTZXJ2aWNlLkVuc3VyZShjb250ZXh0LCBkYXRhLCB0cnVlKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkNvbnRleHQuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogcmVzcG9uc2UubWVzc2FnZQogICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBhY3Rpb25Db250ZXh0LiROb3RpY2Uuc3VjY2Vzcyh7CiAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+aIkOWKnycsCiAgICAgICAgICAgICAgICAgICAgICBkZXNjOiAn56Gu6K6k5oiQ5Yqf77yBJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHZhciBfdGhpcyA9IGFjdGlvbkNvbnRleHQ7CgogICAgICAgICAgICAgICAgICAgIGlmICh4RGF0YSAmJiB4RGF0YS5yZWZyZXNoICYmIHhEYXRhLnJlZnJlc2ggaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICAgICAgICAgICAgICAgICAgeERhdGEucmVmcmVzaChhcmdzKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTsKICAgICAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25Db250ZXh0LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICfns7vnu5/lvILluLjvvIEnCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH07CgogICAgICAgICAgICAgICAgYmFja2VuZCgpOwoKICAgICAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gUGltUGVyc29uQ2hhbmdlX0Vuc3VyZShfeDMpIHsKICAgICAgICByZXR1cm4gX1BpbVBlcnNvbkNoYW5nZV9FbnN1cmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFBpbVBlcnNvbkNoYW5nZV9FbnN1cmU7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIOWQjOaEjw0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gYXJncyDlvZPliY3mlbDmja4NCiAgICAgKiBAcGFyYW0ge2FueX0gY29udGV4dCDooYzkuLrpmYTliqDkuIrkuIvmlocNCiAgICAgKiBAcGFyYW0geyp9IFtwYXJhbXNdIOmZhOWKoOWPguaVsA0KICAgICAqIEBwYXJhbSB7Kn0gWyRldmVudF0g5LqL5Lu25rqQDQogICAgICogQHBhcmFtIHsqfSBbeERhdGFdICDmiafooYzooYzkuLrmiYDpnIDlvZPliY3pg6jku7YNCiAgICAgKiBAcGFyYW0geyp9IFthY3Rpb25Db250ZXh0XSAg5omn6KGM6KGM5Li65LiK5LiL5paHDQogICAgICogQHBhcmFtIHsqfSBbc3JmUGFyZW50RGVOYW1lXSDniLblrp7kvZPlkI3np7ANCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJQaW1QZXJzb25DaGFuZ2VfUVIiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9QaW1QZXJzb25DaGFuZ2VfUVIgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChhcmdzKSB7CiAgICAgICAgdmFyIGNvbnRleHQsCiAgICAgICAgICAgIHBhcmFtcywKICAgICAgICAgICAgJGV2ZW50LAogICAgICAgICAgICB4RGF0YSwKICAgICAgICAgICAgYWN0aW9uQ29udGV4dCwKICAgICAgICAgICAgc3JmUGFyZW50RGVOYW1lLAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBwYXJlbnRDb250ZXh0LAogICAgICAgICAgICBwYXJlbnRWaWV3UGFyYW0sCiAgICAgICAgICAgIF90aGlzLAogICAgICAgICAgICBfYXJncywKICAgICAgICAgICAgYWN0aW9uVGFyZ2V0LAogICAgICAgICAgICBwYXJlbnRPYmosCiAgICAgICAgICAgIGJhY2tlbmQsCiAgICAgICAgICAgIF9hcmdzNSA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU0JChfY29udGV4dDQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ0LnByZXYgPSBfY29udGV4dDQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBfYXJnczUubGVuZ3RoID4gMSAmJiBfYXJnczVbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNVsxXSA6IHt9OwogICAgICAgICAgICAgICAgcGFyYW1zID0gX2FyZ3M1Lmxlbmd0aCA+IDIgJiYgX2FyZ3M1WzJdICE9PSB1bmRlZmluZWQgPyBfYXJnczVbMl0gOiB7fTsKICAgICAgICAgICAgICAgICRldmVudCA9IF9hcmdzNS5sZW5ndGggPiAzID8gX2FyZ3M1WzNdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgeERhdGEgPSBfYXJnczUubGVuZ3RoID4gNCA/IF9hcmdzNVs0XSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIGFjdGlvbkNvbnRleHQgPSBfYXJnczUubGVuZ3RoID4gNSA/IF9hcmdzNVs1XSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIHNyZlBhcmVudERlTmFtZSA9IF9hcmdzNS5sZW5ndGggPiA2ID8gX2FyZ3M1WzZdIDogdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgZGF0YSA9IHt9OwogICAgICAgICAgICAgICAgcGFyZW50Q29udGV4dCA9IHt9OwogICAgICAgICAgICAgICAgcGFyZW50Vmlld1BhcmFtID0ge307CiAgICAgICAgICAgICAgICBfdGhpcyA9IGFjdGlvbkNvbnRleHQ7CiAgICAgICAgICAgICAgICBfYXJncyA9IFV0aWwuZGVlcENvcHkoYXJncyk7CiAgICAgICAgICAgICAgICBhY3Rpb25UYXJnZXQgPSAnTVVMVElLRVknOwogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb250ZXh0LCB7CiAgICAgICAgICAgICAgICAgIHBpbXBlcnNvbmNoYW5nZTogJyVwaW1wZXJzb25jaGFuZ2UlJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgewogICAgICAgICAgICAgICAgICBwaW1wZXJzb25jaGFuZ2VpZDogJyVwaW1wZXJzb25jaGFuZ2UlJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHBhcmFtcywgewogICAgICAgICAgICAgICAgICBwaW1wZXJzb25jaGFuZ2VuYW1lOiAnJXBpbXBlcnNvbmNoYW5nZW5hbWUlJwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKF90aGlzLmNvbnRleHQpIHsKICAgICAgICAgICAgICAgICAgcGFyZW50Q29udGV4dCA9IF90aGlzLmNvbnRleHQ7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKF90aGlzLnZpZXdwYXJhbXMpIHsKICAgICAgICAgICAgICAgICAgcGFyZW50Vmlld1BhcmFtID0gX3RoaXMudmlld3BhcmFtczsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBjb250ZXh0ID0gVUlBY3Rpb25Ub29sLmhhbmRsZUNvbnRleHRQYXJhbShhY3Rpb25UYXJnZXQsIF9hcmdzLCBwYXJlbnRDb250ZXh0LCBwYXJlbnRWaWV3UGFyYW0sIGNvbnRleHQpOwogICAgICAgICAgICAgICAgZGF0YSA9IFVJQWN0aW9uVG9vbC5oYW5kbGVBY3Rpb25QYXJhbShhY3Rpb25UYXJnZXQsIF9hcmdzLCBwYXJlbnRDb250ZXh0LCBwYXJlbnRWaWV3UGFyYW0sIHBhcmFtcyk7CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gT2JqZWN0LmFzc2lnbih7fSwgYWN0aW9uQ29udGV4dC5jb250ZXh0LCBjb250ZXh0KTsKICAgICAgICAgICAgICAgIHBhcmVudE9iaiA9IHsKICAgICAgICAgICAgICAgICAgc3JmcGFyZW50ZGVuYW1lOiBzcmZQYXJlbnREZU5hbWUgPyBzcmZQYXJlbnREZU5hbWUgOiBudWxsLAogICAgICAgICAgICAgICAgICBzcmZwYXJlbnRrZXk6IHNyZlBhcmVudERlTmFtZSA/IGNvbnRleHRbc3JmUGFyZW50RGVOYW1lLnRvTG93ZXJDYXNlKCldIDogbnVsbAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGF0YSwgcGFyZW50T2JqKTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oY29udGV4dCwgcGFyZW50T2JqKTsgLy8g55u05o6l6LCD5a6e5L2T5pyN5Yqh6ZyA6KaB6L2s5o2i55qE5pWw5o2uCgogICAgICAgICAgICAgICAgaWYgKGNvbnRleHQgJiYgY29udGV4dC5zcmZzZXNzaW9uaWQpIHsKICAgICAgICAgICAgICAgICAgY29udGV4dC5zcmZzZXNzaW9ua2V5ID0gY29udGV4dC5zcmZzZXNzaW9uaWQ7CiAgICAgICAgICAgICAgICAgIGRlbGV0ZSBjb250ZXh0LnNyZnNlc3Npb25pZDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBhY3Rpb25Db250ZXh0LmNsb3NlVmlldyhudWxsKTsKCiAgICAgICAgICAgICAgICBiYWNrZW5kID0gZnVuY3Rpb24gYmFja2VuZCgpIHsKICAgICAgICAgICAgICAgICAgdmFyIGN1clNlcnZpY2UgPSBuZXcgUGltUGVyc29uQ2hhbmdlU2VydmljZSgpOwogICAgICAgICAgICAgICAgICBjdXJTZXJ2aWNlLlFSKGNvbnRleHQsIGRhdGEsIHRydWUpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgYWN0aW9uQ29udGV4dC4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5tZXNzYWdlCiAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGFjdGlvbkNvbnRleHQuJE5vdGljZS5zdWNjZXNzKHsKICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn5oiQ5YqfJywKICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICflkIzmhI/miJDlip/vvIEnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgdmFyIF90aGlzID0gYWN0aW9uQ29udGV4dDsKCiAgICAgICAgICAgICAgICAgICAgaWYgKHhEYXRhICYmIHhEYXRhLnJlZnJlc2ggJiYgeERhdGEucmVmcmVzaCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgICB4RGF0YS5yZWZyZXNoKGFyZ3MpOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgICAgICAgICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkNvbnRleHQuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogJ+ezu+e7n+W8guW4uO+8gScKICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBiYWNrZW5kKCk7CgogICAgICAgICAgICAgIGNhc2UgMjc6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBQaW1QZXJzb25DaGFuZ2VfUVIoX3g0KSB7CiAgICAgICAgcmV0dXJuIF9QaW1QZXJzb25DaGFuZ2VfUVIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFBpbVBlcnNvbkNoYW5nZV9RUjsKICAgIH0oKQogICAgLyoqDQogICAgICog5ouS57udDQogICAgICoNCiAgICAgKiBAcGFyYW0ge2FueVtdfSBhcmdzIOW9k+WJjeaVsOaNrg0KICAgICAqIEBwYXJhbSB7YW55fSBjb250ZXh0IOihjOS4uumZhOWKoOS4iuS4i+aWhw0KICAgICAqIEBwYXJhbSB7Kn0gW3BhcmFtc10g6ZmE5Yqg5Y+C5pWwDQogICAgICogQHBhcmFtIHsqfSBbJGV2ZW50XSDkuovku7bmupANCiAgICAgKiBAcGFyYW0geyp9IFt4RGF0YV0gIOaJp+ihjOihjOS4uuaJgOmcgOW9k+WJjemDqOS7tg0KICAgICAqIEBwYXJhbSB7Kn0gW2FjdGlvbkNvbnRleHRdICDmiafooYzooYzkuLrkuIrkuIvmlocNCiAgICAgKiBAcGFyYW0geyp9IFtzcmZQYXJlbnREZU5hbWVdIOeItuWunuS9k+WQjeensA0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICovCgogIH0sIHsKICAgIGtleTogIlBpbVBlcnNvbkNoYW5nZV9CSCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX1BpbVBlcnNvbkNoYW5nZV9CSCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KGFyZ3MpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgcGFyYW1zLAogICAgICAgICAgICAkZXZlbnQsCiAgICAgICAgICAgIHhEYXRhLAogICAgICAgICAgICBhY3Rpb25Db250ZXh0LAogICAgICAgICAgICBzcmZQYXJlbnREZU5hbWUsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIHBhcmVudENvbnRleHQsCiAgICAgICAgICAgIHBhcmVudFZpZXdQYXJhbSwKICAgICAgICAgICAgX3RoaXMsCiAgICAgICAgICAgIF9hcmdzLAogICAgICAgICAgICBhY3Rpb25UYXJnZXQsCiAgICAgICAgICAgIHBhcmVudE9iaiwKICAgICAgICAgICAgZGVSZXNQYXJhbWV0ZXJzLAogICAgICAgICAgICBwYXJhbWV0ZXJzLAogICAgICAgICAgICBvcGVuSW5kZXhWaWV3VGFiLAogICAgICAgICAgICBfYXJnczYgPSBhcmd1bWVudHM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3M2Lmxlbmd0aCA+IDEgJiYgX2FyZ3M2WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczZbMV0gOiB7fTsKICAgICAgICAgICAgICAgIHBhcmFtcyA9IF9hcmdzNi5sZW5ndGggPiAyICYmIF9hcmdzNlsyXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M2WzJdIDoge307CiAgICAgICAgICAgICAgICAkZXZlbnQgPSBfYXJnczYubGVuZ3RoID4gMyA/IF9hcmdzNlszXSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIHhEYXRhID0gX2FyZ3M2Lmxlbmd0aCA+IDQgPyBfYXJnczZbNF0gOiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBhY3Rpb25Db250ZXh0ID0gX2FyZ3M2Lmxlbmd0aCA+IDUgPyBfYXJnczZbNV0gOiB1bmRlZmluZWQ7CiAgICAgICAgICAgICAgICBzcmZQYXJlbnREZU5hbWUgPSBfYXJnczYubGVuZ3RoID4gNiA/IF9hcmdzNls2XSA6IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIGRhdGEgPSB7fTsKICAgICAgICAgICAgICAgIHBhcmVudENvbnRleHQgPSB7fTsKICAgICAgICAgICAgICAgIHBhcmVudFZpZXdQYXJhbSA9IHt9OwogICAgICAgICAgICAgICAgX3RoaXMgPSBhY3Rpb25Db250ZXh0OwogICAgICAgICAgICAgICAgX2FyZ3MgPSBVdGlsLmRlZXBDb3B5KGFyZ3MpOwogICAgICAgICAgICAgICAgYWN0aW9uVGFyZ2V0ID0gJ1NJTkdMRUtFWSc7CiAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKGNvbnRleHQsIHsKICAgICAgICAgICAgICAgICAgcGltcGVyc29uY2hhbmdlOiAnJXBpbXBlcnNvbmNoYW5nZSUnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFyYW1zLCB7CiAgICAgICAgICAgICAgICAgIHBpbXBlcnNvbmNoYW5nZWlkOiAnJXBpbXBlcnNvbmNoYW5nZSUnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24ocGFyYW1zLCB7CiAgICAgICAgICAgICAgICAgIHBpbXBlcnNvbmNoYW5nZW5hbWU6ICclcGltcGVyc29uY2hhbmdlbmFtZSUnCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMuY29udGV4dCkgewogICAgICAgICAgICAgICAgICBwYXJlbnRDb250ZXh0ID0gX3RoaXMuY29udGV4dDsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZiAoX3RoaXMudmlld3BhcmFtcykgewogICAgICAgICAgICAgICAgICBwYXJlbnRWaWV3UGFyYW0gPSBfdGhpcy52aWV3cGFyYW1zOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBVSUFjdGlvblRvb2wuaGFuZGxlQ29udGV4dFBhcmFtKGFjdGlvblRhcmdldCwgX2FyZ3MsIHBhcmVudENvbnRleHQsIHBhcmVudFZpZXdQYXJhbSwgY29udGV4dCk7CiAgICAgICAgICAgICAgICBkYXRhID0gVUlBY3Rpb25Ub29sLmhhbmRsZUFjdGlvblBhcmFtKGFjdGlvblRhcmdldCwgX2FyZ3MsIHBhcmVudENvbnRleHQsIHBhcmVudFZpZXdQYXJhbSwgcGFyYW1zKTsKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBPYmplY3QuYXNzaWduKHt9LCBhY3Rpb25Db250ZXh0LmNvbnRleHQsIGNvbnRleHQpOwogICAgICAgICAgICAgICAgcGFyZW50T2JqID0gewogICAgICAgICAgICAgICAgICBzcmZwYXJlbnRkZW5hbWU6IHNyZlBhcmVudERlTmFtZSA/IHNyZlBhcmVudERlTmFtZSA6IG51bGwsCiAgICAgICAgICAgICAgICAgIHNyZnBhcmVudGtleTogc3JmUGFyZW50RGVOYW1lID8gY29udGV4dFtzcmZQYXJlbnREZU5hbWUudG9Mb3dlckNhc2UoKV0gOiBudWxsCiAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihkYXRhLCBwYXJlbnRPYmopOwogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihjb250ZXh0LCBwYXJlbnRPYmopOwogICAgICAgICAgICAgICAgZGVSZXNQYXJhbWV0ZXJzID0gW107CgogICAgICAgICAgICAgICAgaWYgKGNvbnRleHQucGltcGVyc29uICYmIHRydWUpIHsKICAgICAgICAgICAgICAgICAgZGVSZXNQYXJhbWV0ZXJzID0gW3sKICAgICAgICAgICAgICAgICAgICBwYXRoTmFtZTogJ3BpbXBlb3BsZScsCiAgICAgICAgICAgICAgICAgICAgcGFyYW1ldGVyTmFtZTogJ3BpbXBlcnNvbicKICAgICAgICAgICAgICAgICAgfV07CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcGFyYW1ldGVycyA9IFt7CiAgICAgICAgICAgICAgICAgIHBhdGhOYW1lOiAncGltcGVyc29uY2hhbmdlcycsCiAgICAgICAgICAgICAgICAgIHBhcmFtZXRlck5hbWU6ICdwaW1wZXJzb25jaGFuZ2UnCiAgICAgICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgICAgIHBhdGhOYW1lOiAncmVhc29uZWRpdHZpZXcnLAogICAgICAgICAgICAgICAgICBwYXJhbWV0ZXJOYW1lOiAncmVhc29uZWRpdHZpZXcnCiAgICAgICAgICAgICAgICB9XTsKICAgICAgICAgICAgICAgIGFjdGlvbkNvbnRleHQuY2xvc2VWaWV3KG51bGwpOwoKICAgICAgICAgICAgICAgIG9wZW5JbmRleFZpZXdUYWIgPSBmdW5jdGlvbiBvcGVuSW5kZXhWaWV3VGFiKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgdmFyIHJvdXRlUGF0aCA9IGFjdGlvbkNvbnRleHQuJHZpZXdUb29sLmJ1aWxkVXBSb3V0ZVBhdGgoYWN0aW9uQ29udGV4dC4kcm91dGUsIGNvbnRleHQsIGRlUmVzUGFyYW1ldGVycywgcGFyYW1ldGVycywgX2FyZ3MsIGRhdGEpOwogICAgICAgICAgICAgICAgICBhY3Rpb25Db250ZXh0LiRyb3V0ZXIucHVzaChyb3V0ZVBhdGgpOwoKICAgICAgICAgICAgICAgICAgaWYgKHhEYXRhICYmIHhEYXRhLnJlZnJlc2ggJiYgeERhdGEucmVmcmVzaCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICAgICAgICAgICAgeERhdGEucmVmcmVzaChhcmdzKTsKICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgICAgICAgICB9OwoKICAgICAgICAgICAgICAgIG9wZW5JbmRleFZpZXdUYWIoZGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMjk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTUpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBQaW1QZXJzb25DaGFuZ2VfQkgoX3g1KSB7CiAgICAgICAgcmV0dXJuIF9QaW1QZXJzb25DaGFuZ2VfQkguYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFBpbVBlcnNvbkNoYW5nZV9CSDsKICAgIH0oKQogICAgLyoqDQogICAgICog6I635Y+W5oyH5a6a5pWw5o2u55qE6YeN5a6a5ZCR6aG16Z2iDQogICAgICoNCiAgICAgKiBAcGFyYW0gc3Jma2V5IOaVsOaNruS4u+mUrg0KICAgICAqIEBwYXJhbSBpc0VuYWJsZVdvcmtmbG93ICDph43lrprlkJHop4blm77mmK/lkKbpnIDopoHlpITnkIbmtYHnqIvkuK3nmoTmlbDmja4NCiAgICAgKiBAbWVtYmVyb2YgIFBpbVBlcnNvbkNoYW5nZVVJU2VydmljZUJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0UkRBcHBWaWV3IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfZ2V0UkRBcHBWaWV3ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTYoc3Jma2V5LCBpc0VuYWJsZVdvcmtmbG93KSB7CiAgICAgICAgdmFyIHJlc3VsdCwgY3VyRGF0YSwgaVJlYWxERU1vZGVsLCBiRGF0YUluV0YsIGJXRk1vZGUsIHN0clBEVFZpZXdQYXJhbTsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgdGhpcy5pc0VuYWJsZVdvcmtmbG93ID0gaXNFbmFibGVXb3JrZmxvdzsgLy8g6L+b6KGM5pWw5o2u5p+l6K+iCgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAzOwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuZGF0YVNlcnZpY2UuR2V0KHsKICAgICAgICAgICAgICAgICAgcGltcGVyc29uY2hhbmdlOiBzcmZrZXkKICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICByZXN1bHQgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICAgIGN1ckRhdGEgPSByZXN1bHQuZGF0YTsgLy/liKTmlq3lvZPliY3mlbDmja7mqKHlvI8s6buY6K6k5Li6dHJ1Ze+8jHRvZG8KCiAgICAgICAgICAgICAgICBpUmVhbERFTW9kZWwgPSB0cnVlOwogICAgICAgICAgICAgICAgYkRhdGFJbldGID0gZmFsc2U7CiAgICAgICAgICAgICAgICBiV0ZNb2RlID0gZmFsc2U7IC8vIOiuoeeul+aVsOaNruaooeW8jwoKICAgICAgICAgICAgICAgIGlmICghdGhpcy5pc0VuYWJsZVdvcmtmbG93KSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTE7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS50ZXN0RGF0YUluV0YoewogICAgICAgICAgICAgICAgICBzdGF0ZVZhbHVlOiB0aGlzLnN0YXRlVmFsdWUsCiAgICAgICAgICAgICAgICAgIHN0YXRlRmllbGQ6IHRoaXMuc3RhdGVGaWVsZAogICAgICAgICAgICAgICAgfSwgY3VyRGF0YSk7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBiRGF0YUluV0YgPSBfY29udGV4dDYuc2VudDsKCiAgICAgICAgICAgICAgICBpZiAoIWJEYXRhSW5XRikgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBiRGF0YUluV0YgPSB0cnVlOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAxNjsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRhdGFTZXJ2aWNlLnRlc3RVc2VyRXhpc3RXb3JrbGlzdChudWxsLCBjdXJEYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIGJXRk1vZGUgPSBfY29udGV4dDYuc2VudDsKCiAgICAgICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5nZXRERVNEREVWaWV3UERUUGFyYW0oY3VyRGF0YSwgYkRhdGFJbldGLCBiV0ZNb2RlKTsKCiAgICAgICAgICAgICAgY2FzZSAxOToKICAgICAgICAgICAgICAgIHN0clBEVFZpZXdQYXJhbSA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHRoaXMuYWxsVmlld01hcC5nZXQoc3RyUERUVmlld1BhcmFtKSk7CgogICAgICAgICAgICAgIGNhc2UgMjE6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBnZXRSREFwcFZpZXcoX3g2LCBfeDcpIHsKICAgICAgICByZXR1cm4gX2dldFJEQXBwVmlldy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gZ2V0UkRBcHBWaWV3OwogICAgfSgpCiAgICAvKioNCiAgICAgKiDojrflj5blrp7pmYXnmoTmlbDmja7nsbvlnosNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiAgUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRSZWFsREVUeXBlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSZWFsREVUeXBlKGVudGl0eSkge30KICAgIC8qKg0KICAgICAqIOiOt+WPluWunuS9k+WNleaVsOaNruWunuS9k+inhuWbvumihOWumuS5ieWPguaVsA0KICAgICAqDQogICAgICogQHBhcmFtIGN1ckRhdGEg5b2T5YmN5pWw5o2uDQogICAgICogQHBhcmFtIGJEYXRhSW5XRiDmmK/lkKbmnInmlbDmja7lnKjlt6XkvZzmtYHkuK0NCiAgICAgKiBAcGFyYW0gYldGTW9kZSAgIOaYr+WQpuW3peS9nOa1geaooeW8jw0KICAgICAqIEBtZW1iZXJvZiAgUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXRERVNEREVWaWV3UERUUGFyYW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRERVNEREVWaWV3UERUUGFyYW0gPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNyhjdXJEYXRhLCBiRGF0YUluV0YsIGJXRk1vZGUpIHsKICAgICAgICB2YXIgc3RyUERUUGFyYW0sIGlzRW5hYmxlTXVsdGlGb3JtLCBtdWx0aUZvcm1ERUZpZWxkLCBvYmpGb3JtVmFsdWU7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHN0clBEVFBhcmFtID0gJyc7CgogICAgICAgICAgICAgICAgaWYgKGJEYXRhSW5XRikge30gLy8g5Yik5pat5pWw5o2u5piv5ZCm5Zyo5rWB56iL5LitCiAgICAgICAgICAgICAgICAvL+WkmuihqOWNle+8jHRvZG8KCgogICAgICAgICAgICAgICAgaXNFbmFibGVNdWx0aUZvcm0gPSBmYWxzZTsKICAgICAgICAgICAgICAgIG11bHRpRm9ybURFRmllbGQgPSBudWxsOwoKICAgICAgICAgICAgICAgIGlmICghKGlzRW5hYmxlTXVsdGlGb3JtICYmIG11bHRpRm9ybURFRmllbGQpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgb2JqRm9ybVZhbHVlID0gY3VyRGF0YVttdWx0aUZvcm1ERUZpZWxkXTsKCiAgICAgICAgICAgICAgICBpZiAoRW52aXJvbm1lbnQuaXNBcHBNb2RlKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5hYnJ1cHQoInJldHVybiIsICdNT0JFRElUVklFVycgKyBvYmpGb3JtVmFsdWUpOwoKICAgICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgJ0VESVRWSUVXJyArIG9iakZvcm1WYWx1ZSk7CgogICAgICAgICAgICAgIGNhc2UgOToKICAgICAgICAgICAgICAgIGlmIChFbnZpcm9ubWVudC5pc0FwcE1vZGUpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCF0aGlzLmdldERFTWFpblN0YXRlVGFnKGN1ckRhdGEpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMTY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny50MCA9ICJNT0JFRElUVklFVzpNU1RBRzoiOwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAxNDsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldERFTWFpblN0YXRlVGFnKGN1ckRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgX2NvbnRleHQ3LnQxID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ3LnQwLmNvbmNhdC5jYWxsKF9jb250ZXh0Ny50MCwgX2NvbnRleHQ3LnQxKSk7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgJ01PQkVESVRWSUVXOicpOwoKICAgICAgICAgICAgICBjYXNlIDE3OgogICAgICAgICAgICAgICAgaWYgKCF0aGlzLmdldERFTWFpblN0YXRlVGFnKGN1ckRhdGEpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gMjM7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny50MiA9ICJFRElUVklFVzpNU1RBRzoiOwogICAgICAgICAgICAgICAgX2NvbnRleHQ3Lm5leHQgPSAyMTsKICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLmdldERFTWFpblN0YXRlVGFnKGN1ckRhdGEpOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgX2NvbnRleHQ3LnQzID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgX2NvbnRleHQ3LnQyLmNvbmNhdC5jYWxsKF9jb250ZXh0Ny50MiwgX2NvbnRleHQ3LnQzKSk7CgogICAgICAgICAgICAgIGNhc2UgMjM6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgJ0VESVRWSUVXOicpOwoKICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU3LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0REVTRERFVmlld1BEVFBhcmFtKF94OCwgX3g5LCBfeDEwKSB7CiAgICAgICAgcmV0dXJuIF9nZXRERVNEREVWaWV3UERUUGFyYW0uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldERFU0RERVZpZXdQRFRQYXJhbTsKICAgIH0oKQogICAgLyoqDQogICAgICog6I635Y+W5pWw5o2u5a+56LGh55qE5Li754q25oCB5qCH6K+GDQogICAgICoNCiAgICAgKiBAcGFyYW0gY3VyRGF0YSDlvZPliY3mlbDmja4NCiAgICAgKiBAbWVtYmVyb2YgIFBpbVBlcnNvbkNoYW5nZVVJU2VydmljZUJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0REVNYWluU3RhdGVUYWciLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9nZXRERU1haW5TdGF0ZVRhZyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU4KGN1ckRhdGEpIHsKICAgICAgICB2YXIgc3RyVGFnLCBpLCBfc3RyVGFnLCBqLCBzdHJUYWcyLCBrLCBzdHJUYWczOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTgkKF9jb250ZXh0OCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDgucHJldiA9IF9jb250ZXh0OC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKCEodGhpcy5tYWluU3RhdGVGaWVsZHMubGVuZ3RoID09PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCBudWxsKTsKCiAgICAgICAgICAgICAgY2FzZSAyOgogICAgICAgICAgICAgICAgdGhpcy5tYWluU3RhdGVGaWVsZHMuZm9yRWFjaChmdW5jdGlvbiAoc2luZ2xlTWFpbkZpZWxkKSB7CiAgICAgICAgICAgICAgICAgIGlmICghKHNpbmdsZU1haW5GaWVsZCBpbiBjdXJEYXRhKSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIlx1NUY1M1x1NTI0RFx1NjU3MFx1NjM2RVx1NUJGOVx1OEM2MVx1NEUwRFx1NTMwNVx1NTQyQlx1NUM1RVx1NjAyN3NpbmdsZU1haW5GaWVsZFx1RkYwQ1x1NTNFRlx1ODBGRFx1NEYxQVx1NTNEMVx1NzUxRlx1OTUxOVx1OEJFRiIpOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHN0clRhZyA9ICIiOwogICAgICAgICAgICAgICAgaSA9IDA7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIGlmICghKGkgPD0gMSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAzMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3N0clRhZyA9IGN1ckRhdGFbdGhpcy5tYWluU3RhdGVGaWVsZHNbMF1dID8gaSA9PSAwID8gY3VyRGF0YVt0aGlzLm1haW5TdGF0ZUZpZWxkc1swXV0gOiAiIiA6ICIiOwoKICAgICAgICAgICAgICAgIGlmICghKHRoaXMubWFpblN0YXRlRmllbGRzLmxlbmd0aCA+PSAyKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDI3OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBqID0gMDsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgaWYgKCEoaiA8PSAxKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBzdHJUYWcyID0gY3VyRGF0YVt0aGlzLm1haW5TdGF0ZUZpZWxkc1sxXV0gPyAiIi5jb25jYXQoX3N0clRhZywgIl9fIikuY29uY2F0KGogPT0gMCA/IGN1ckRhdGFbdGhpcy5tYWluU3RhdGVGaWVsZHNbMV1dIDogIiIpIDogX3N0clRhZzsKCiAgICAgICAgICAgICAgICBpZiAoISh0aGlzLm1haW5TdGF0ZUZpZWxkcy5sZW5ndGggPj0gMykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgayA9IDA7CgogICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICBpZiAoIShrIDw9IDEpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gMTk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHN0clRhZzMgPSBjdXJEYXRhW3RoaXMubWFpblN0YXRlRmllbGRzWzJdXSA/ICIiLmNvbmNhdChzdHJUYWcyLCAiX18iKS5jb25jYXQoayA9PSAwID8gY3VyRGF0YVt0aGlzLm1haW5TdGF0ZUZpZWxkc1syXV0gOiAiIikgOiBzdHJUYWcyOyAvLyDliKTmlq3mmK/lkKblrZjlnKgKCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgdGhpcy5hbGxEZU1haW5TdGF0ZU1hcC5nZXQoc3RyVGFnMykpOwoKICAgICAgICAgICAgICBjYXNlIDE2OgogICAgICAgICAgICAgICAgaysrOwogICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDE5OgogICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIHRoaXMuYWxsRGVNYWluU3RhdGVNYXAuZ2V0KHN0clRhZzIpKTsKCiAgICAgICAgICAgICAgY2FzZSAyMjoKICAgICAgICAgICAgICAgIGorKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgX2NvbnRleHQ4Lm5leHQgPSAyODsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI3OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIHRoaXMuYWxsRGVNYWluU3RhdGVNYXAuZ2V0KF9zdHJUYWcpKTsKCiAgICAgICAgICAgICAgY2FzZSAyODoKICAgICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0OC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDMxOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5hYnJ1cHQoInJldHVybiIsIG51bGwpOwoKICAgICAgICAgICAgICBjYXNlIDMyOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU4LCB0aGlzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gZ2V0REVNYWluU3RhdGVUYWcoX3gxMSkgewogICAgICAgIHJldHVybiBfZ2V0REVNYWluU3RhdGVUYWcuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGdldERFTWFpblN0YXRlVGFnOwogICAgfSgpCiAgfV0pOwoKICByZXR1cm4gUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZTsKfShVSVNlcnZpY2UpOwoKZXhwb3J0IHsgUGltUGVyc29uQ2hhbmdlVUlTZXJ2aWNlQmFzZSBhcyBkZWZhdWx0IH07"},null]}