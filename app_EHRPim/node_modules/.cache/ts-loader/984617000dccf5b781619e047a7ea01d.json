{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js??ref--13-3!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\service\\pim-contract\\pim-contract-service-base.ts","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\service\\pim-contract\\pim-contract-service-base.ts","mtime":1630509410505},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjsKaW1wb3J0IF9nZXRQcm90b3R5cGVPZiBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CmltcG9ydCB7IEh0dHAgfSBmcm9tICdAL3V0aWxzJzsKaW1wb3J0IEVudGl0eVNlcnZpY2UgZnJvbSAnLi4vZW50aXR5LXNlcnZpY2UnOwovKioNCiAqIOWQiOWQjOS/oeaBr+acjeWKoeWvueixoeWfuuexuw0KICoNCiAqIEBleHBvcnQNCiAqIEBjbGFzcyBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogKiBAZXh0ZW5kcyB7RW50aXR5U2VydmllfQ0KICovCgp2YXIgUGltQ29udHJhY3RTZXJ2aWNlQmFzZSA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9FbnRpdHlTZXJ2aWNlKSB7CiAgX2luaGVyaXRzKFBpbUNvbnRyYWN0U2VydmljZUJhc2UsIF9FbnRpdHlTZXJ2aWNlKTsKCiAgLyoqDQogICAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgIFBpbUNvbnRyYWN0U2VydmljZUJhc2UuDQogICAqDQogICAqIEBwYXJhbSB7Kn0gW29wdHM9e31dDQogICAqIEBtZW1iZXJvZiAgUGltQ29udHJhY3RTZXJ2aWNlQmFzZQ0KICAgKi8KICBmdW5jdGlvbiBQaW1Db250cmFjdFNlcnZpY2VCYXNlKCkgewogICAgdmFyIG9wdHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBQaW1Db250cmFjdFNlcnZpY2VCYXNlKTsKCiAgICByZXR1cm4gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKFBpbUNvbnRyYWN0U2VydmljZUJhc2UpLmNhbGwodGhpcywgb3B0cykpOwogIH0KICAvKioNCiAgICog5Yid5aeL5YyW5Z+656GA5pWw5o2uDQogICAqDQogICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAqLwoKCiAgX2NyZWF0ZUNsYXNzKFBpbUNvbnRyYWN0U2VydmljZUJhc2UsIFt7CiAgICBrZXk6ICJpbml0QmFzaWNEYXRhIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbml0QmFzaWNEYXRhKCkgewogICAgICB0aGlzLkFQUExZREVLRVkgPSAncGltY29udHJhY3QnOwogICAgICB0aGlzLkFQUERFS0VZID0gJ3BpbWNvbnRyYWN0aWQnOwogICAgICB0aGlzLkFQUERFTkFNRSA9ICdwaW1jb250cmFjdHMnOwogICAgICB0aGlzLkFQUERFVEVYVCA9ICdwaW1wZXJzb25uYW1lJzsKICAgICAgdGhpcy5BUFBOQU1FID0gJ2VocnBpbSc7CiAgICAgIHRoaXMuU1lTVEVNTkFNRSA9ICdlaHInOwogICAgfSAvLyDlrp7kvZPmjqXlj6MKCiAgICAvKioNCiAgICAgKiBTZWxlY3TmjqXlj6Pmlrnms5UNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9e31dDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgUGltQ29udHJhY3RTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJTZWxlY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9TZWxlY3QgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgICAgIHZhciBjb250ZXh0LAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBpc2xvYWRpbmcsCiAgICAgICAgICAgIF9hcmdzID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBfYXJncy5sZW5ndGggPiAwICYmIF9hcmdzWzBdICE9PSB1bmRlZmluZWQgPyBfYXJnc1swXSA6IHt9OwogICAgICAgICAgICAgICAgZGF0YSA9IF9hcmdzLmxlbmd0aCA+IDEgJiYgX2FyZ3NbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzWzFdIDoge307CiAgICAgICAgICAgICAgICBpc2xvYWRpbmcgPSBfYXJncy5sZW5ndGggPiAyID8gX2FyZ3NbMl0gOiB1bmRlZmluZWQ7CgogICAgICAgICAgICAgICAgaWYgKCEoY29udGV4dC5waW1wZXJzb24gJiYgY29udGV4dC5waW1jb250cmFjdCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzLyIpLmNvbmNhdChjb250ZXh0LnBpbWNvbnRyYWN0LCAiL3NlbGVjdCIpLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbWNvbnRyYWN0cy8iLmNvbmNhdChjb250ZXh0LnBpbWNvbnRyYWN0LCAiL3NlbGVjdCIpLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIFNlbGVjdCgpIHsKICAgICAgICByZXR1cm4gX1NlbGVjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gU2VsZWN0OwogICAgfSgpCiAgICAvKioNCiAgICAgKiBDaGVja0tleeaOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkNoZWNrS2V5IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfQ2hlY2tLZXkgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMigpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfYXJnczIgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBfYXJnczIubGVuZ3RoID4gMCAmJiBfYXJnczJbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMlswXSA6IHt9OwogICAgICAgICAgICAgICAgZGF0YSA9IF9hcmdzMi5sZW5ndGggPiAxICYmIF9hcmdzMlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MyWzFdIDoge307CiAgICAgICAgICAgICAgICBpc2xvYWRpbmcgPSBfYXJnczIubGVuZ3RoID4gMiA/IF9hcmdzMlsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiBjb250ZXh0LnBpbWNvbnRyYWN0KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkucG9zdCgiL3BpbXBlb3BsZS8iLmNvbmNhdChjb250ZXh0LnBpbXBlcnNvbiwgIi9waW1jb250cmFjdHMvIikuY29uY2F0KGNvbnRleHQucGltY29udHJhY3QsICIvY2hlY2trZXkiKSwgZGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkucG9zdCgiL3BpbWNvbnRyYWN0cy8iLmNvbmNhdChjb250ZXh0LnBpbWNvbnRyYWN0LCAiL2NoZWNra2V5IiksIGRhdGEsIGlzbG9hZGluZykpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTIpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBDaGVja0tleSgpIHsKICAgICAgICByZXR1cm4gX0NoZWNrS2V5LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBDaGVja0tleTsKICAgIH0oKQogICAgLyoqDQogICAgICogQ2FsQ29udHJhY3RUaW1l5o6l5Y+j5pa55rOVDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtjb250ZXh0PXt9XQ0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbaXNsb2FkaW5nXQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIFBpbUNvbnRyYWN0U2VydmljZUJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiQ2FsQ29udHJhY3RUaW1lIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfQ2FsQ29udHJhY3RUaW1lID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTMoKSB7CiAgICAgICAgdmFyIGNvbnRleHQsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIGlzbG9hZGluZywKICAgICAgICAgICAgX2FyZ3MzID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0My5wcmV2ID0gX2NvbnRleHQzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MzLmxlbmd0aCA+IDAgJiYgX2FyZ3MzWzBdICE9PSB1bmRlZmluZWQgPyBfYXJnczNbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczMubGVuZ3RoID4gMSAmJiBfYXJnczNbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzM1sxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MzLmxlbmd0aCA+IDIgPyBfYXJnczNbMl0gOiB1bmRlZmluZWQ7CgogICAgICAgICAgICAgICAgaWYgKCEoY29udGV4dC5waW1wZXJzb24gJiYgY29udGV4dC5waW1jb250cmFjdCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQzLm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLnBvc3QoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzLyIpLmNvbmNhdChjb250ZXh0LnBpbWNvbnRyYWN0LCAiL2NhbGNvbnRyYWN0dGltZSIpLCBkYXRhLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0My5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5wb3N0KCIvcGltY29udHJhY3RzLyIuY29uY2F0KGNvbnRleHQucGltY29udHJhY3QsICIvY2FsY29udHJhY3R0aW1lIiksIGRhdGEsIGlzbG9hZGluZykpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBDYWxDb250cmFjdFRpbWUoKSB7CiAgICAgICAgcmV0dXJuIF9DYWxDb250cmFjdFRpbWUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIENhbENvbnRyYWN0VGltZTsKICAgIH0oKQogICAgLyoqDQogICAgICogUmVtb3Zl5o6l5Y+j5pa55rOVDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtjb250ZXh0PXt9XQ0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbaXNsb2FkaW5nXQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIFBpbUNvbnRyYWN0U2VydmljZUJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiUmVtb3ZlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfUmVtb3ZlID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTQoKSB7CiAgICAgICAgdmFyIGNvbnRleHQsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIGlzbG9hZGluZywKICAgICAgICAgICAgX2FyZ3M0ID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NC5wcmV2ID0gX2NvbnRleHQ0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3M0Lmxlbmd0aCA+IDAgJiYgX2FyZ3M0WzBdICE9PSB1bmRlZmluZWQgPyBfYXJnczRbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczQubGVuZ3RoID4gMSAmJiBfYXJnczRbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNFsxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3M0Lmxlbmd0aCA+IDIgPyBfYXJnczRbMl0gOiB1bmRlZmluZWQ7CgogICAgICAgICAgICAgICAgaWYgKCEoY29udGV4dC5waW1wZXJzb24gJiYgY29udGV4dC5waW1jb250cmFjdCkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ0LmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpWyJkZWxldGUiXSgiL3BpbXBlb3BsZS8iLmNvbmNhdChjb250ZXh0LnBpbXBlcnNvbiwgIi9waW1jb250cmFjdHMvIikuY29uY2F0KGNvbnRleHQucGltY29udHJhY3QpLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKVsiZGVsZXRlIl0oIi9waW1jb250cmFjdHMvIi5jb25jYXQoY29udGV4dC5waW1jb250cmFjdCksIGlzbG9hZGluZykpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTQpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBSZW1vdmUoKSB7CiAgICAgICAgcmV0dXJuIF9SZW1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIFJlbW92ZTsKICAgIH0oKQogICAgLyoqDQogICAgICogR2V05o6l5Y+j5pa55rOVDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtjb250ZXh0PXt9XQ0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbaXNsb2FkaW5nXQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIFBpbUNvbnRyYWN0U2VydmljZUJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiR2V0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfR2V0ID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTUoKSB7CiAgICAgICAgdmFyIGNvbnRleHQsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIGlzbG9hZGluZywKICAgICAgICAgICAgcmVzLAogICAgICAgICAgICBfYXJnczUgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU1JChfY29udGV4dDUpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ1LnByZXYgPSBfY29udGV4dDUubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBfYXJnczUubGVuZ3RoID4gMCAmJiBfYXJnczVbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzNVswXSA6IHt9OwogICAgICAgICAgICAgICAgZGF0YSA9IF9hcmdzNS5sZW5ndGggPiAxICYmIF9hcmdzNVsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M1WzFdIDoge307CiAgICAgICAgICAgICAgICBpc2xvYWRpbmcgPSBfYXJnczUubGVuZ3RoID4gMiA/IF9hcmdzNVsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiBjb250ZXh0LnBpbWNvbnRyYWN0KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkuZ2V0KCIvcGltcGVvcGxlLyIuY29uY2F0KGNvbnRleHQucGltcGVyc29uLCAiL3BpbWNvbnRyYWN0cy8iKS5jb25jYXQoY29udGV4dC5waW1jb250cmFjdCksIGlzbG9hZGluZykpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDc7CiAgICAgICAgICAgICAgICByZXR1cm4gSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbWNvbnRyYWN0cy8iLmNvbmNhdChjb250ZXh0LnBpbWNvbnRyYWN0KSwgaXNsb2FkaW5nKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ1LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LmFicnVwdCgicmV0dXJuIiwgcmVzKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ1LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gR2V0KCkgewogICAgICAgIHJldHVybiBfR2V0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBHZXQ7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIENyZWF0ZeaOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkNyZWF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX0NyZWF0ZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU2KCkgewogICAgICAgIHZhciBjb250ZXh0LAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBpc2xvYWRpbmcsCiAgICAgICAgICAgIG1hc3RlckRhdGEsCiAgICAgICAgICAgIHRlbXBDb250ZXh0LAogICAgICAgICAgICByZXMsCiAgICAgICAgICAgIF9hcmdzNiA9IGFyZ3VtZW50czsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTYkKF9jb250ZXh0NikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDYucHJldiA9IF9jb250ZXh0Ni5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29udGV4dCA9IF9hcmdzNi5sZW5ndGggPiAwICYmIF9hcmdzNlswXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M2WzBdIDoge307CiAgICAgICAgICAgICAgICBkYXRhID0gX2FyZ3M2Lmxlbmd0aCA+IDEgJiYgX2FyZ3M2WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczZbMV0gOiB7fTsKICAgICAgICAgICAgICAgIGlzbG9hZGluZyA9IF9hcmdzNi5sZW5ndGggPiAyID8gX2FyZ3M2WzJdIDogdW5kZWZpbmVkOwoKICAgICAgICAgICAgICAgIGlmICghKGNvbnRleHQucGltcGVyc29uICYmIHRydWUpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKCFkYXRhLnNyZmZyb250dWYgfHwgZGF0YS5zcmZmcm9udHVmICE9PSAiMSIpIHsKICAgICAgICAgICAgICAgICAgZGF0YVt0aGlzLkFQUERFS0VZXSA9IG51bGw7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGRhdGEuc3JmZnJvbnR1ZikgewogICAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5zcmZmcm9udHVmOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkucG9zdCgiL3BpbXBlb3BsZS8iLmNvbmNhdChjb250ZXh0LnBpbXBlcnNvbiwgIi9waW1jb250cmFjdHMiKSwgZGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgNzoKICAgICAgICAgICAgICAgIG1hc3RlckRhdGEgPSB7fTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGF0YSwgbWFzdGVyRGF0YSk7CgogICAgICAgICAgICAgICAgaWYgKCFkYXRhLnNyZmZyb250dWYgfHwgZGF0YS5zcmZmcm9udHVmICE9PSAiMSIpIHsKICAgICAgICAgICAgICAgICAgZGF0YVt0aGlzLkFQUERFS0VZXSA9IG51bGw7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKGRhdGEuc3JmZnJvbnR1ZikgewogICAgICAgICAgICAgICAgICBkZWxldGUgZGF0YS5zcmZmcm9udHVmOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRlbXBDb250ZXh0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb250ZXh0KSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgcmV0dXJuIEh0dHAuZ2V0SW5zdGFuY2UoKS5wb3N0KCIvcGltY29udHJhY3RzIiwgZGF0YSwgaXNsb2FkaW5nKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0Ni5zZW50OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ni5hYnJ1cHQoInJldHVybiIsIHJlcyk7CgogICAgICAgICAgICAgIGNhc2UgMTY6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTYsIHRoaXMpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBDcmVhdGUoKSB7CiAgICAgICAgcmV0dXJuIF9DcmVhdGUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIENyZWF0ZTsKICAgIH0oKQogICAgLyoqDQogICAgICogU2F2ZeaOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIlNhdmUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9TYXZlID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTcoKSB7CiAgICAgICAgdmFyIGNvbnRleHQsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIGlzbG9hZGluZywKICAgICAgICAgICAgbWFzdGVyRGF0YSwKICAgICAgICAgICAgcmVzLAogICAgICAgICAgICBfYXJnczcgPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU3JChfY29udGV4dDcpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ3LnByZXYgPSBfY29udGV4dDcubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBfYXJnczcubGVuZ3RoID4gMCAmJiBfYXJnczdbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzN1swXSA6IHt9OwogICAgICAgICAgICAgICAgZGF0YSA9IF9hcmdzNy5sZW5ndGggPiAxICYmIF9hcmdzN1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M3WzFdIDoge307CiAgICAgICAgICAgICAgICBpc2xvYWRpbmcgPSBfYXJnczcubGVuZ3RoID4gMiA/IF9hcmdzN1syXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiBjb250ZXh0LnBpbWNvbnRyYWN0KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDcubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDcuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkucG9zdCgiL3BpbXBlb3BsZS8iLmNvbmNhdChjb250ZXh0LnBpbXBlcnNvbiwgIi9waW1jb250cmFjdHMvIikuY29uY2F0KGNvbnRleHQucGltY29udHJhY3QsICIvc2F2ZSIpLCBkYXRhLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgbWFzdGVyRGF0YSA9IHt9OwogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihkYXRhLCBtYXN0ZXJEYXRhKTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ny5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBIdHRwLmdldEluc3RhbmNlKCkucG9zdCgiL3BpbWNvbnRyYWN0cy8iLmNvbmNhdChjb250ZXh0LnBpbWNvbnRyYWN0LCAiL3NhdmUiKSwgZGF0YSwgaXNsb2FkaW5nKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ3LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ3LmFicnVwdCgicmV0dXJuIiwgcmVzKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Ny5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIFNhdmUoKSB7CiAgICAgICAgcmV0dXJuIF9TYXZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBTYXZlOwogICAgfSgpCiAgICAvKioNCiAgICAgKiBTdG9wQ29udHJhY3TmjqXlj6Pmlrnms5UNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9e31dDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgUGltQ29udHJhY3RTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJTdG9wQ29udHJhY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9TdG9wQ29udHJhY3QgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOCgpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfYXJnczggPSBhcmd1bWVudHM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWU4JChfY29udGV4dDgpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQ4LnByZXYgPSBfY29udGV4dDgubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBfYXJnczgubGVuZ3RoID4gMCAmJiBfYXJnczhbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzOFswXSA6IHt9OwogICAgICAgICAgICAgICAgZGF0YSA9IF9hcmdzOC5sZW5ndGggPiAxICYmIF9hcmdzOFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M4WzFdIDoge307CiAgICAgICAgICAgICAgICBpc2xvYWRpbmcgPSBfYXJnczgubGVuZ3RoID4gMiA/IF9hcmdzOFsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiBjb250ZXh0LnBpbWNvbnRyYWN0KSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDgubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDguYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkucG9zdCgiL3BpbXBlb3BsZS8iLmNvbmNhdChjb250ZXh0LnBpbXBlcnNvbiwgIi9waW1jb250cmFjdHMvIikuY29uY2F0KGNvbnRleHQucGltY29udHJhY3QsICIvc3RvcGNvbnRyYWN0IiksIGRhdGEsIGlzbG9hZGluZykpOwoKICAgICAgICAgICAgICBjYXNlIDU6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ4LmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLnBvc3QoIi9waW1jb250cmFjdHMvIi5jb25jYXQoY29udGV4dC5waW1jb250cmFjdCwgIi9zdG9wY29udHJhY3QiKSwgZGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOCk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIFN0b3BDb250cmFjdCgpIHsKICAgICAgICByZXR1cm4gX1N0b3BDb250cmFjdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gU3RvcENvbnRyYWN0OwogICAgfSgpCiAgICAvKioNCiAgICAgKiBVcGRhdGXmjqXlj6Pmlrnms5UNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9e31dDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgUGltQ29udHJhY3RTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJVcGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9VcGRhdGUgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlOSgpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBtYXN0ZXJEYXRhLAogICAgICAgICAgICByZXMsCiAgICAgICAgICAgIF9hcmdzOSA9IGFyZ3VtZW50czsKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTkkKF9jb250ZXh0OSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDkucHJldiA9IF9jb250ZXh0OS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29udGV4dCA9IF9hcmdzOS5sZW5ndGggPiAwICYmIF9hcmdzOVswXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3M5WzBdIDoge307CiAgICAgICAgICAgICAgICBkYXRhID0gX2FyZ3M5Lmxlbmd0aCA+IDEgJiYgX2FyZ3M5WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczlbMV0gOiB7fTsKICAgICAgICAgICAgICAgIGlzbG9hZGluZyA9IF9hcmdzOS5sZW5ndGggPiAyID8gX2FyZ3M5WzJdIDogdW5kZWZpbmVkOwoKICAgICAgICAgICAgICAgIGlmICghKGNvbnRleHQucGltcGVyc29uICYmIGNvbnRleHQucGltY29udHJhY3QpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0OS5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5wdXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzLyIpLmNvbmNhdChjb250ZXh0LnBpbWNvbnRyYWN0KSwgZGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgIG1hc3RlckRhdGEgPSB7fTsKICAgICAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oZGF0YSwgbWFzdGVyRGF0YSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDkubmV4dCA9IDk7CiAgICAgICAgICAgICAgICByZXR1cm4gSHR0cC5nZXRJbnN0YW5jZSgpLnB1dCgiL3BpbWNvbnRyYWN0cy8iLmNvbmNhdChjb250ZXh0LnBpbWNvbnRyYWN0KSwgZGF0YSwgaXNsb2FkaW5nKTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQ5LnNlbnQ7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ5LmFicnVwdCgicmV0dXJuIiwgcmVzKTsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0OS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlOSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIFVwZGF0ZSgpIHsKICAgICAgICByZXR1cm4gX1VwZGF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gVXBkYXRlOwogICAgfSgpCiAgICAvKioNCiAgICAgKiBHZXREcmFmdOaOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkdldERyYWZ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfR2V0RHJhZnQgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMTAoKSB7CiAgICAgICAgdmFyIGNvbnRleHQsCiAgICAgICAgICAgIGRhdGEsCiAgICAgICAgICAgIGlzbG9hZGluZywKICAgICAgICAgICAgcmVzLAogICAgICAgICAgICBfYXJnczEwID0gYXJndW1lbnRzOwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTAkKF9jb250ZXh0MTApIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMC5wcmV2ID0gX2NvbnRleHQxMC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29udGV4dCA9IF9hcmdzMTAubGVuZ3RoID4gMCAmJiBfYXJnczEwWzBdICE9PSB1bmRlZmluZWQgPyBfYXJnczEwWzBdIDoge307CiAgICAgICAgICAgICAgICBkYXRhID0gX2FyZ3MxMC5sZW5ndGggPiAxICYmIF9hcmdzMTBbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTBbMV0gOiB7fTsKICAgICAgICAgICAgICAgIGlzbG9hZGluZyA9IF9hcmdzMTAubGVuZ3RoID4gMiA/IF9hcmdzMTBbMl0gOiB1bmRlZmluZWQ7CgogICAgICAgICAgICAgICAgaWYgKCEoY29udGV4dC5waW1wZXJzb24gJiYgdHJ1ZSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkuZ2V0KCIvcGltcGVvcGxlLyIuY29uY2F0KGNvbnRleHQucGltcGVyc29uLCAiL3BpbWNvbnRyYWN0cy9nZXRkcmFmdCIpLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgX2NvbnRleHQxMC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIHJldHVybiBIdHRwLmdldEluc3RhbmNlKCkuZ2V0KCIvcGltY29udHJhY3RzL2dldGRyYWZ0IiwgaXNsb2FkaW5nKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgcmVzID0gX2NvbnRleHQxMC5zZW50OwogICAgICAgICAgICAgICAgcmVzLmRhdGEucGltY29udHJhY3QgPSBkYXRhLnBpbWNvbnRyYWN0OwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTAuYWJydXB0KCJyZXR1cm4iLCByZXMpOwoKICAgICAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTApOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBHZXREcmFmdCgpIHsKICAgICAgICByZXR1cm4gX0dldERyYWZ0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBHZXREcmFmdDsKICAgIH0oKQogICAgLyoqDQogICAgICogRmV0Y2hSU1RYRFPmjqXlj6Pmlrnms5UNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9e31dDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgUGltQ29udHJhY3RTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJGZXRjaFJTVFhEUyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX0ZldGNoUlNUWERTID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTExKCkgewogICAgICAgIHZhciBjb250ZXh0LAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBpc2xvYWRpbmcsCiAgICAgICAgICAgIF90ZW1wRGF0YSwKICAgICAgICAgICAgdGVtcERhdGEsCiAgICAgICAgICAgIF9hcmdzMTEgPSBhcmd1bWVudHM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMTEkKF9jb250ZXh0MTEpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQxMS5wcmV2ID0gX2NvbnRleHQxMS5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgY29udGV4dCA9IF9hcmdzMTEubGVuZ3RoID4gMCAmJiBfYXJnczExWzBdICE9PSB1bmRlZmluZWQgPyBfYXJnczExWzBdIDoge307CiAgICAgICAgICAgICAgICBkYXRhID0gX2FyZ3MxMS5sZW5ndGggPiAxICYmIF9hcmdzMTFbMV0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTFbMV0gOiB7fTsKICAgICAgICAgICAgICAgIGlzbG9hZGluZyA9IF9hcmdzMTEubGVuZ3RoID4gMiA/IF9hcmdzMTFbMl0gOiB1bmRlZmluZWQ7CgogICAgICAgICAgICAgICAgaWYgKCEoY29udGV4dC5waW1wZXJzb24gJiYgdHJ1ZSkpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQxMS5uZXh0ID0gNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgX3RlbXBEYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzL2ZldGNocnN0eGRzIiksIF90ZW1wRGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIHRlbXBEYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMS5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1jb250cmFjdHMvZmV0Y2hyc3R4ZHMiLCB0ZW1wRGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTEuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTExKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gRmV0Y2hSU1RYRFMoKSB7CiAgICAgICAgcmV0dXJuIF9GZXRjaFJTVFhEUy5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gRmV0Y2hSU1RYRFM7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIEZldGNoSkxTU+aOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkZldGNoSkxTUyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX0ZldGNoSkxTUyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMigpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfdGVtcERhdGEyLAogICAgICAgICAgICB0ZW1wRGF0YSwKICAgICAgICAgICAgX2FyZ3MxMiA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMiQoX2NvbnRleHQxMikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEyLnByZXYgPSBfY29udGV4dDEyLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MxMi5sZW5ndGggPiAwICYmIF9hcmdzMTJbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTJbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczEyLmxlbmd0aCA+IDEgJiYgX2FyZ3MxMlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxMlsxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MxMi5sZW5ndGggPiAyID8gX2FyZ3MxMlsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEyLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGVtcERhdGEyID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMi5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzL2ZldGNoamxzcyIpLCBfdGVtcERhdGEyLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgdGVtcERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEyLmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbWNvbnRyYWN0cy9mZXRjaGpsc3MiLCB0ZW1wRGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTIuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEyKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gRmV0Y2hKTFNTKCkgewogICAgICAgIHJldHVybiBfRmV0Y2hKTFNTLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBGZXRjaEpMU1M7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIEZldGNoT3JkZXJCeU9yZ+aOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkZldGNoT3JkZXJCeU9yZyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX0ZldGNoT3JkZXJCeU9yZyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxMygpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfdGVtcERhdGEzLAogICAgICAgICAgICB0ZW1wRGF0YSwKICAgICAgICAgICAgX2FyZ3MxMyA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxMyQoX2NvbnRleHQxMykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDEzLnByZXYgPSBfY29udGV4dDEzLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MxMy5sZW5ndGggPiAwICYmIF9hcmdzMTNbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTNbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczEzLmxlbmd0aCA+IDEgJiYgX2FyZ3MxM1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxM1sxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MxMy5sZW5ndGggPiAyID8gX2FyZ3MxM1syXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDEzLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGVtcERhdGEzID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxMy5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzL2ZldGNob3JkZXJieW9yZyIpLCBfdGVtcERhdGEzLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgdGVtcERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDEzLmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbWNvbnRyYWN0cy9mZXRjaG9yZGVyYnlvcmciLCB0ZW1wRGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTMuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTEzKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gRmV0Y2hPcmRlckJ5T3JnKCkgewogICAgICAgIHJldHVybiBfRmV0Y2hPcmRlckJ5T3JnLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBGZXRjaE9yZGVyQnlPcmc7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIEZldGNoU3RvcENvbnRyYWN0c+aOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkZldGNoU3RvcENvbnRyYWN0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX0ZldGNoU3RvcENvbnRyYWN0cyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNCgpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfdGVtcERhdGE0LAogICAgICAgICAgICB0ZW1wRGF0YSwKICAgICAgICAgICAgX2FyZ3MxNCA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNCQoX2NvbnRleHQxNCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE0LnByZXYgPSBfY29udGV4dDE0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MxNC5sZW5ndGggPiAwICYmIF9hcmdzMTRbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTRbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczE0Lmxlbmd0aCA+IDEgJiYgX2FyZ3MxNFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxNFsxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MxNC5sZW5ndGggPiAyID8gX2FyZ3MxNFsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE0Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGVtcERhdGE0ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNC5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzL2ZldGNoc3RvcGNvbnRyYWN0cyIpLCBfdGVtcERhdGE0LCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgdGVtcERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE0LmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbWNvbnRyYWN0cy9mZXRjaHN0b3Bjb250cmFjdHMiLCB0ZW1wRGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE0KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gRmV0Y2hTdG9wQ29udHJhY3RzKCkgewogICAgICAgIHJldHVybiBfRmV0Y2hTdG9wQ29udHJhY3RzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBGZXRjaFN0b3BDb250cmFjdHM7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIEZldGNoU2lnbkNvbnRyYWN0c+aOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkZldGNoU2lnbkNvbnRyYWN0cyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX0ZldGNoU2lnbkNvbnRyYWN0cyA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNSgpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfdGVtcERhdGE1LAogICAgICAgICAgICB0ZW1wRGF0YSwKICAgICAgICAgICAgX2FyZ3MxNSA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNSQoX2NvbnRleHQxNSkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE1LnByZXYgPSBfY29udGV4dDE1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MxNS5sZW5ndGggPiAwICYmIF9hcmdzMTVbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTVbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczE1Lmxlbmd0aCA+IDEgJiYgX2FyZ3MxNVsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxNVsxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MxNS5sZW5ndGggPiAyID8gX2FyZ3MxNVsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE1Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGVtcERhdGE1ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNS5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzL2ZldGNoc2lnbmNvbnRyYWN0cyIpLCBfdGVtcERhdGE1LCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgdGVtcERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE1LmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbWNvbnRyYWN0cy9mZXRjaHNpZ25jb250cmFjdHMiLCB0ZW1wRGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTUuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE1KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gRmV0Y2hTaWduQ29udHJhY3RzKCkgewogICAgICAgIHJldHVybiBfRmV0Y2hTaWduQ29udHJhY3RzLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBGZXRjaFNpZ25Db250cmFjdHM7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIEZldGNoRGVmYXVsdOaOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkZldGNoRGVmYXVsdCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX0ZldGNoRGVmYXVsdCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNigpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfdGVtcERhdGE2LAogICAgICAgICAgICB0ZW1wRGF0YSwKICAgICAgICAgICAgX2FyZ3MxNiA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNiQoX2NvbnRleHQxNikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE2LnByZXYgPSBfY29udGV4dDE2Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MxNi5sZW5ndGggPiAwICYmIF9hcmdzMTZbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTZbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczE2Lmxlbmd0aCA+IDEgJiYgX2FyZ3MxNlsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxNlsxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MxNi5sZW5ndGggPiAyID8gX2FyZ3MxNlsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE2Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGVtcERhdGE2ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNi5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzL2ZldGNoZGVmYXVsdCIpLCBfdGVtcERhdGE2LCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgdGVtcERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE2LmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbWNvbnRyYWN0cy9mZXRjaGRlZmF1bHQiLCB0ZW1wRGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTYuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE2KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gRmV0Y2hEZWZhdWx0KCkgewogICAgICAgIHJldHVybiBfRmV0Y2hEZWZhdWx0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBGZXRjaERlZmF1bHQ7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIEZldGNoWFlIVOaOpeWPo+aWueazlQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBQaW1Db250cmFjdFNlcnZpY2VCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIkZldGNoWFlIVCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX0ZldGNoWFlIVCA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxNygpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfdGVtcERhdGE3LAogICAgICAgICAgICB0ZW1wRGF0YSwKICAgICAgICAgICAgX2FyZ3MxNyA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxNyQoX2NvbnRleHQxNykgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE3LnByZXYgPSBfY29udGV4dDE3Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MxNy5sZW5ndGggPiAwICYmIF9hcmdzMTdbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMTdbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczE3Lmxlbmd0aCA+IDEgJiYgX2FyZ3MxN1sxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxN1sxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MxNy5sZW5ndGggPiAyID8gX2FyZ3MxN1syXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE3Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGVtcERhdGE3ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxNy5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzL2ZldGNoeHlodCIpLCBfdGVtcERhdGE3LCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgdGVtcERhdGEgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE3LmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbWNvbnRyYWN0cy9mZXRjaHh5aHQiLCB0ZW1wRGF0YSwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTcuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZTE3KTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gRmV0Y2hYWUhUKCkgewogICAgICAgIHJldHVybiBfRmV0Y2hYWUhULmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBGZXRjaFhZSFQ7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIEZldGNoWklaSFXmjqXlj6Pmlrnms5UNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9e31dDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgUGltQ29udHJhY3RTZXJ2aWNlQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJGZXRjaFpJWkhVIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfRmV0Y2haSVpIVSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUxOCgpIHsKICAgICAgICB2YXIgY29udGV4dCwKICAgICAgICAgICAgZGF0YSwKICAgICAgICAgICAgaXNsb2FkaW5nLAogICAgICAgICAgICBfdGVtcERhdGE4LAogICAgICAgICAgICB0ZW1wRGF0YSwKICAgICAgICAgICAgX2FyZ3MxOCA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUxOCQoX2NvbnRleHQxOCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDE4LnByZXYgPSBfY29udGV4dDE4Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MxOC5sZW5ndGggPiAwICYmIF9hcmdzMThbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMThbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczE4Lmxlbmd0aCA+IDEgJiYgX2FyZ3MxOFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxOFsxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MxOC5sZW5ndGggPiAyID8gX2FyZ3MxOFsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDE4Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGVtcERhdGE4ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1wZW9wbGUvIi5jb25jYXQoY29udGV4dC5waW1wZXJzb24sICIvcGltY29udHJhY3RzL2ZldGNoeml6aHUiKSwgX3RlbXBEYXRhOCwgaXNsb2FkaW5nKSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIHRlbXBEYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShkYXRhKSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5hYnJ1cHQoInJldHVybiIsIEh0dHAuZ2V0SW5zdGFuY2UoKS5nZXQoIi9waW1jb250cmFjdHMvZmV0Y2h6aXpodSIsIHRlbXBEYXRhLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTgpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBGZXRjaFpJWkhVKCkgewogICAgICAgIHJldHVybiBfRmV0Y2haSVpIVS5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICB9CgogICAgICByZXR1cm4gRmV0Y2haSVpIVTsKICAgIH0oKQogICAgLyoqDQogICAgICogRmV0Y2hMREhU5o6l5Y+j5pa55rOVDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtjb250ZXh0PXt9XQ0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbaXNsb2FkaW5nXQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIFBpbUNvbnRyYWN0U2VydmljZUJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiRmV0Y2hMREhUIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfRmV0Y2hMREhUID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTE5KCkgewogICAgICAgIHZhciBjb250ZXh0LAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBpc2xvYWRpbmcsCiAgICAgICAgICAgIF90ZW1wRGF0YTksCiAgICAgICAgICAgIHRlbXBEYXRhLAogICAgICAgICAgICBfYXJnczE5ID0gYXJndW1lbnRzOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTE5JChfY29udGV4dDE5KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0MTkucHJldiA9IF9jb250ZXh0MTkubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbnRleHQgPSBfYXJnczE5Lmxlbmd0aCA+IDAgJiYgX2FyZ3MxOVswXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MxOVswXSA6IHt9OwogICAgICAgICAgICAgICAgZGF0YSA9IF9hcmdzMTkubGVuZ3RoID4gMSAmJiBfYXJnczE5WzFdICE9PSB1bmRlZmluZWQgPyBfYXJnczE5WzFdIDoge307CiAgICAgICAgICAgICAgICBpc2xvYWRpbmcgPSBfYXJnczE5Lmxlbmd0aCA+IDIgPyBfYXJnczE5WzJdIDogdW5kZWZpbmVkOwoKICAgICAgICAgICAgICAgIGlmICghKGNvbnRleHQucGltcGVyc29uICYmIHRydWUpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0MTkubmV4dCA9IDY7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF90ZW1wRGF0YTkgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDE5LmFicnVwdCgicmV0dXJuIiwgSHR0cC5nZXRJbnN0YW5jZSgpLmdldCgiL3BpbXBlb3BsZS8iLmNvbmNhdChjb250ZXh0LnBpbXBlcnNvbiwgIi9waW1jb250cmFjdHMvZmV0Y2hsZGh0IiksIF90ZW1wRGF0YTksIGlzbG9hZGluZykpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICB0ZW1wRGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MTkuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkuZ2V0KCIvcGltY29udHJhY3RzL2ZldGNobGRodCIsIHRlbXBEYXRhLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQxOS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMTkpOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBGZXRjaExESFQoKSB7CiAgICAgICAgcmV0dXJuIF9GZXRjaExESFQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIEZldGNoTERIVDsKICAgIH0oKQogICAgLyoqDQogICAgICogRmV0Y2hMV0hU5o6l5Y+j5pa55rOVDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IFtjb250ZXh0PXt9XQ0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbaXNsb2FkaW5nXQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIFBpbUNvbnRyYWN0U2VydmljZUJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiRmV0Y2hMV0hUIiwKICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfRmV0Y2hMV0hUID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZTIwKCkgewogICAgICAgIHZhciBjb250ZXh0LAogICAgICAgICAgICBkYXRhLAogICAgICAgICAgICBpc2xvYWRpbmcsCiAgICAgICAgICAgIF90ZW1wRGF0YTEwLAogICAgICAgICAgICB0ZW1wRGF0YSwKICAgICAgICAgICAgX2FyZ3MyMCA9IGFyZ3VtZW50czsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyMCQoX2NvbnRleHQyMCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIwLnByZXYgPSBfY29udGV4dDIwLm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb250ZXh0ID0gX2FyZ3MyMC5sZW5ndGggPiAwICYmIF9hcmdzMjBbMF0gIT09IHVuZGVmaW5lZCA/IF9hcmdzMjBbMF0gOiB7fTsKICAgICAgICAgICAgICAgIGRhdGEgPSBfYXJnczIwLmxlbmd0aCA+IDEgJiYgX2FyZ3MyMFsxXSAhPT0gdW5kZWZpbmVkID8gX2FyZ3MyMFsxXSA6IHt9OwogICAgICAgICAgICAgICAgaXNsb2FkaW5nID0gX2FyZ3MyMC5sZW5ndGggPiAyID8gX2FyZ3MyMFsyXSA6IHVuZGVmaW5lZDsKCiAgICAgICAgICAgICAgICBpZiAoIShjb250ZXh0LnBpbXBlcnNvbiAmJiB0cnVlKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIwLm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfdGVtcERhdGExMCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjAuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkuZ2V0KCIvcGltcGVvcGxlLyIuY29uY2F0KGNvbnRleHQucGltcGVyc29uLCAiL3BpbWNvbnRyYWN0cy9mZXRjaGx3aHQiKSwgX3RlbXBEYXRhMTAsIGlzbG9hZGluZykpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICB0ZW1wRGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOwogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0MjAuYWJydXB0KCJyZXR1cm4iLCBIdHRwLmdldEluc3RhbmNlKCkuZ2V0KCIvcGltY29udHJhY3RzL2ZldGNobHdodCIsIHRlbXBEYXRhLCBpc2xvYWRpbmcpKTsKCiAgICAgICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyMC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMjApOwogICAgICB9KSk7CgogICAgICBmdW5jdGlvbiBGZXRjaExXSFQoKSB7CiAgICAgICAgcmV0dXJuIF9GZXRjaExXSFQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIEZldGNoTFdIVDsKICAgIH0oKQogIH1dKTsKCiAgcmV0dXJuIFBpbUNvbnRyYWN0U2VydmljZUJhc2U7Cn0oRW50aXR5U2VydmljZSk7CgpleHBvcnQgeyBQaW1Db250cmFjdFNlcnZpY2VCYXNlIGFzIGRlZmF1bHQgfTs="},null]}