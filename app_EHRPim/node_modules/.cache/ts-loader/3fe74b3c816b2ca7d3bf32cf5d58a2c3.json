{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js??ref--13-3!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-contract\\lab-services-edit-grid-form\\lab-services-edit-grid-form-service.ts","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-contract\\lab-services-edit-grid-form\\lab-services-edit-grid-form-service.ts","mtime":1630509411428},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjsKaW1wb3J0IF9nZXRQcm90b3R5cGVPZiBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSAidHNsaWIiOwppbXBvcnQgeyBVdGlsLCBFcnJvcmxvZyB9IGZyb20gJ0AvdXRpbHMnOwppbXBvcnQgQ29udHJvbFNlcnZpY2UgZnJvbSAnQC93aWRnZXRzL2NvbnRyb2wtc2VydmljZSc7CmltcG9ydCBQaW1Db250cmFjdFNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL3BpbS1jb250cmFjdC9waW0tY29udHJhY3Qtc2VydmljZSc7CmltcG9ydCBMYWJTZXJ2aWNlc19FZGl0R3JpZE1vZGVsIGZyb20gJy4vbGFiLXNlcnZpY2VzLWVkaXQtZ3JpZC1mb3JtLW1vZGVsJzsKaW1wb3J0IFBpbVBlcnNvblNlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL3BpbS1wZXJzb24vcGltLXBlcnNvbi1zZXJ2aWNlJzsKaW1wb3J0IE9ybU9yZ1NlcnZpY2UgZnJvbSAnQC9zZXJ2aWNlL29ybS1vcmcvb3JtLW9yZy1zZXJ2aWNlJzsKaW1wb3J0IFBpbUxhYm91cmNhbXBhbnlTZXJ2aWNlIGZyb20gJ0Avc2VydmljZS9waW0tbGFib3VyY2FtcGFueS9waW0tbGFib3VyY2FtcGFueS1zZXJ2aWNlJzsKLyoqDQogKiBMYWJTZXJ2aWNlc19FZGl0R3JpZCDpg6jku7bmnI3liqHlr7nosaENCiAqDQogKiBAZXhwb3J0DQogKiBAY2xhc3MgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlDQogKi8KCnZhciBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UgPQovKiNfX1BVUkVfXyovCmZ1bmN0aW9uIChfQ29udHJvbFNlcnZpY2UpIHsKICBfaW5oZXJpdHMoTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlLCBfQ29udHJvbFNlcnZpY2UpOwoKICAvKioNCiAgICogQ3JlYXRlcyBhbiBpbnN0YW5jZSBvZiBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UuDQogICAqDQogICAqIEBwYXJhbSB7Kn0gW29wdHM9e31dDQogICAqIEBtZW1iZXJvZiBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UNCiAgICovCiAgZnVuY3Rpb24gTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlKCkgewogICAgdmFyIF90aGlzOwoKICAgIHZhciBvcHRzID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKCiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlKTsKCiAgICBfdGhpcyA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UpLmNhbGwodGhpcywgb3B0cykpOwogICAgLyoqDQogICAgICog5ZCI5ZCM5L+h5oGv5pyN5Yqh5a+56LGhDQogICAgICoNCiAgICAgKiBAdHlwZSB7UGltQ29udHJhY3RTZXJ2aWNlfQ0KICAgICAqIEBtZW1iZXJvZiBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UNCiAgICAgKi8KCiAgICBfdGhpcy5hcHBFbnRpdHlTZXJ2aWNlID0gbmV3IFBpbUNvbnRyYWN0U2VydmljZSh7CiAgICAgICRzdG9yZTogX3RoaXMuZ2V0U3RvcmUoKQogICAgfSk7CiAgICAvKioNCiAgICAgKiDkurrlkZjkv6Hmga/mnI3liqHlr7nosaENCiAgICAgKg0KICAgICAqIEB0eXBlIHtQaW1QZXJzb25TZXJ2aWNlfQ0KICAgICAqIEBtZW1iZXJvZiBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UNCiAgICAgKi8KCiAgICBfdGhpcy5waW1wZXJzb25TZXJ2aWNlID0gbmV3IFBpbVBlcnNvblNlcnZpY2UoKTsKICAgIC8qKg0KICAgICAqIOe7hOe7h+euoeeQhuacjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge09ybU9yZ1NlcnZpY2V9DQogICAgICogQG1lbWJlcm9mIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZQ0KICAgICAqLwoKICAgIF90aGlzLm9ybW9yZ1NlcnZpY2UgPSBuZXcgT3JtT3JnU2VydmljZSgpOwogICAgLyoqDQogICAgICog5Yqz5Yqh5rS+6YGj5YWs5Y+4566h55CG5pyN5Yqh5a+56LGhDQogICAgICoNCiAgICAgKiBAdHlwZSB7UGltTGFib3VyY2FtcGFueVNlcnZpY2V9DQogICAgICogQG1lbWJlcm9mIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZQ0KICAgICAqLwoKICAgIF90aGlzLnBpbWxhYm91cmNhbXBhbnlTZXJ2aWNlID0gbmV3IFBpbUxhYm91cmNhbXBhbnlTZXJ2aWNlKCk7CiAgICBfdGhpcy5tb2RlbCA9IG5ldyBMYWJTZXJ2aWNlc19FZGl0R3JpZE1vZGVsKCk7CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIC8qKg0KICAgKiDorr7nva7ku47mlbDmja7mqKHlvI8NCiAgICoNCiAgICogQHR5cGUge2Jvb2xlYW59DQogICAqIEBtZW1iZXJvZiBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UNCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlLCBbewogICAga2V5OiAic2V0VGVtcE1vZGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHNldFRlbXBNb2RlKCkgewogICAgICB0aGlzLmlzVGVtcE1vZGUgPSBmYWxzZTsKICAgIH0KICAgIC8qKg0KICAgICAqIOWkhOeQhuaVsOaNrg0KICAgICAqDQogICAgICogQHByaXZhdGUNCiAgICAgKiBAcGFyYW0ge1Byb21pc2U8YW55Pn0gcHJvbWlzZQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkb0l0ZW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBkb0l0ZW1zKHByb21pc2UsIGRlS2V5RmllbGQsIGRlTmFtZSkgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgICAgIGRhdGEuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSwgaW5kZXgpIHsKICAgICAgICAgICAgICBpdGVtW2RlTmFtZV0gPSBpdGVtW2RlS2V5RmllbGRdOwogICAgICAgICAgICAgIGRhdGFbaW5kZXhdID0gaXRlbTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJlc29sdmUoZGF0YSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZWplY3QoW10pOwogICAgICAgICAgfQogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgcmVqZWN0KFtdKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5bot6jlrp7kvZPmlbDmja7pm4blkIgNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzZXJ2aWNlTmFtZSDmnI3liqHlkI3np7ANCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gaW50ZXJmYWNlTmFtZSDmjqXlj6PlkI3np7ANCiAgICAgKiBAcGFyYW0geyp9IGRhdGENCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55W10+fQ0KICAgICAqIEBtZW1iZXJvZiAgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEl0ZW1zIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRJdGVtcyhzZXJ2aWNlTmFtZSwgaW50ZXJmYWNlTmFtZSkgewogICAgICB2YXIgY29udGV4dCA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CiAgICAgIHZhciBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CiAgICAgIHZhciBpc2xvYWRpbmcgPSBhcmd1bWVudHMubGVuZ3RoID4gNCA/IGFyZ3VtZW50c1s0XSA6IHVuZGVmaW5lZDsKCiAgICAgIGlmIChPYmplY3QuaXMoc2VydmljZU5hbWUsICdQaW1QZXJzb25TZXJ2aWNlJykgJiYgT2JqZWN0LmlzKGludGVyZmFjZU5hbWUsICdGZXRjaEF1dGhQZXJzb24nKSkgewogICAgICAgIHJldHVybiB0aGlzLmRvSXRlbXModGhpcy5waW1wZXJzb25TZXJ2aWNlLkZldGNoQXV0aFBlcnNvbihKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnRleHQpKSwgZGF0YSwgaXNsb2FkaW5nKSwgJ3BpbXBlcnNvbmlkJywgJ3BpbXBlcnNvbicpOwogICAgICB9CgogICAgICBpZiAoT2JqZWN0LmlzKHNlcnZpY2VOYW1lLCAnT3JtT3JnU2VydmljZScpICYmIE9iamVjdC5pcyhpbnRlcmZhY2VOYW1lLCAnRmV0Y2hEZWZhdWx0JykpIHsKICAgICAgICByZXR1cm4gdGhpcy5kb0l0ZW1zKHRoaXMub3Jtb3JnU2VydmljZS5GZXRjaERlZmF1bHQoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb250ZXh0KSksIGRhdGEsIGlzbG9hZGluZyksICdvcmdpZCcsICdvcm1vcmcnKTsKICAgICAgfQoKICAgICAgaWYgKE9iamVjdC5pcyhzZXJ2aWNlTmFtZSwgJ1BpbUxhYm91cmNhbXBhbnlTZXJ2aWNlJykgJiYgT2JqZWN0LmlzKGludGVyZmFjZU5hbWUsICdGZXRjaERlZmF1bHQnKSkgewogICAgICAgIHJldHVybiB0aGlzLmRvSXRlbXModGhpcy5waW1sYWJvdXJjYW1wYW55U2VydmljZS5GZXRjaERlZmF1bHQoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb250ZXh0KSksIGRhdGEsIGlzbG9hZGluZyksICdwaW1sYWJvdXJjYW1wYW55aWQnLCAncGltbGFib3VyY2FtcGFueScpOwogICAgICB9CgogICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoW10pOwogICAgfQogICAgLyoqDQogICAgICog5ZCv5Yqo5bel5L2c5rWBDQogICAgICoNCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcGFyYW0geyp9IFtsb2NhbGRhdGFdDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIndmc3RhcnQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHdmc3RhcnQoYWN0aW9uKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgdmFyIGNvbnRleHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CiAgICAgIHZhciBpc2xvYWRpbmcgPSBhcmd1bWVudHMubGVuZ3RoID4gMyA/IGFyZ3VtZW50c1szXSA6IHVuZGVmaW5lZDsKICAgICAgdmFyIGxvY2FsZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiA0ID8gYXJndW1lbnRzWzRdIDogdW5kZWZpbmVkOwogICAgICBkYXRhID0gdGhpcy5oYW5kbGVXRkRhdGEoZGF0YSk7CiAgICAgIGNvbnRleHQgPSB0aGlzLmhhbmRsZVJlcXVlc3REYXRhKGFjdGlvbiwgY29udGV4dCwgZGF0YSkuY29udGV4dDsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHZhciBfYXBwRW50aXR5U2VydmljZSA9IF90aGlzMi5hcHBFbnRpdHlTZXJ2aWNlOwoKICAgICAgICBpZiAoX2FwcEVudGl0eVNlcnZpY2VbYWN0aW9uXSAmJiBfYXBwRW50aXR5U2VydmljZVthY3Rpb25dIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgIHJlc3VsdCA9IF9hcHBFbnRpdHlTZXJ2aWNlW2FjdGlvbl0oY29udGV4dCwgZGF0YSwgaXNsb2FkaW5nLCBsb2NhbGRhdGEpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXN1bHQgPSBfdGhpczIuYXBwRW50aXR5U2VydmljZS5XRlN0YXJ0KGNvbnRleHQsIGRhdGEsIGlzbG9hZGluZywgbG9jYWxkYXRhKTsKICAgICAgICB9CgogICAgICAgIHJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXMyLmhhbmRsZVJlc3BvbnNlKGFjdGlvbiwgcmVzcG9uc2UpOwoKICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmj5DkuqTlt6XkvZzmtYENCiAgICAgKg0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb24NCiAgICAgKiBAcGFyYW0geyp9IFtjb250ZXh0PXt9XQ0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbaXNsb2FkaW5nXQ0KICAgICAqIEBwYXJhbSB7Kn0gW2xvY2FsZGF0YV0NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAid2ZzdWJtaXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHdmc3VibWl0KGFjdGlvbikgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBjb250ZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogICAgICB2YXIgaXNsb2FkaW5nID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CiAgICAgIHZhciBsb2NhbGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gNCA/IGFyZ3VtZW50c1s0XSA6IHVuZGVmaW5lZDsKICAgICAgZGF0YSA9IHRoaXMuaGFuZGxlV0ZEYXRhKGRhdGEsIHRydWUpOwogICAgICBjb250ZXh0ID0gdGhpcy5oYW5kbGVSZXF1ZXN0RGF0YShhY3Rpb24sIGNvbnRleHQsIGRhdGEsIHRydWUpLmNvbnRleHQ7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICB2YXIgX2FwcEVudGl0eVNlcnZpY2UgPSBfdGhpczMuYXBwRW50aXR5U2VydmljZTsKCiAgICAgICAgaWYgKF9hcHBFbnRpdHlTZXJ2aWNlW2FjdGlvbl0gJiYgX2FwcEVudGl0eVNlcnZpY2VbYWN0aW9uXSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICByZXN1bHQgPSBfYXBwRW50aXR5U2VydmljZVthY3Rpb25dKGNvbnRleHQsIGRhdGEsIGlzbG9hZGluZywgbG9jYWxkYXRhKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ID0gX3RoaXMzLmFwcEVudGl0eVNlcnZpY2UuV0ZTdWJtaXQoY29udGV4dCwgZGF0YSwgaXNsb2FkaW5nLCBsb2NhbGRhdGEpOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczMuaGFuZGxlUmVzcG9uc2UoYWN0aW9uLCByZXNwb25zZSk7CgogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOa3u+WKoOaVsOaNrg0KICAgICAqDQogICAgICogQHBhcmFtIHtzdHJpbmd9IGFjdGlvbg0KICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9e31dDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImFkZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWRkKGFjdGlvbikgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHZhciBjb250ZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogICAgICB2YXIgaXNsb2FkaW5nID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CgogICAgICB2YXIgX3RoaXMkaGFuZGxlUmVxdWVzdERhID0gdGhpcy5oYW5kbGVSZXF1ZXN0RGF0YShhY3Rpb24sIGNvbnRleHQsIGRhdGEpLAogICAgICAgICAgRGF0YSA9IF90aGlzJGhhbmRsZVJlcXVlc3REYS5kYXRhLAogICAgICAgICAgQ29udGV4dCA9IF90aGlzJGhhbmRsZVJlcXVlc3REYS5jb250ZXh0OwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHZhciBfYXBwRW50aXR5U2VydmljZSA9IF90aGlzNC5hcHBFbnRpdHlTZXJ2aWNlOwoKICAgICAgICBpZiAoX2FwcEVudGl0eVNlcnZpY2VbYWN0aW9uXSAmJiBfYXBwRW50aXR5U2VydmljZVthY3Rpb25dIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgIHJlc3VsdCA9IF9hcHBFbnRpdHlTZXJ2aWNlW2FjdGlvbl0oQ29udGV4dCwgRGF0YSwgaXNsb2FkaW5nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ID0gX3RoaXM0LmFwcEVudGl0eVNlcnZpY2UuQ3JlYXRlKENvbnRleHQsIERhdGEsIGlzbG9hZGluZyk7CiAgICAgICAgfQoKICAgICAgICByZXN1bHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzNC5oYW5kbGVSZXNwb25zZShhY3Rpb24sIHJlc3BvbnNlKTsKCiAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5Yig6Zmk5pWw5o2uDQogICAgICoNCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZGVsZXRlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBfZGVsZXRlKGFjdGlvbikgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBjb250ZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogICAgICB2YXIgaXNsb2FkaW5nID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CgogICAgICB2YXIgX3RoaXMkaGFuZGxlUmVxdWVzdERhMiA9IHRoaXMuaGFuZGxlUmVxdWVzdERhdGEoYWN0aW9uLCBjb250ZXh0LCBkYXRhKSwKICAgICAgICAgIERhdGEgPSBfdGhpcyRoYW5kbGVSZXF1ZXN0RGEyLmRhdGEsCiAgICAgICAgICBDb250ZXh0ID0gX3RoaXMkaGFuZGxlUmVxdWVzdERhMi5jb250ZXh0OwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHZhciBfYXBwRW50aXR5U2VydmljZSA9IF90aGlzNS5hcHBFbnRpdHlTZXJ2aWNlOwoKICAgICAgICBpZiAoX2FwcEVudGl0eVNlcnZpY2VbYWN0aW9uXSAmJiBfYXBwRW50aXR5U2VydmljZVthY3Rpb25dIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgIHJlc3VsdCA9IF9hcHBFbnRpdHlTZXJ2aWNlW2FjdGlvbl0oQ29udGV4dCwgRGF0YSwgaXNsb2FkaW5nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ID0gX3RoaXM1LmFwcEVudGl0eVNlcnZpY2UuUmVtb3ZlKENvbnRleHQsIERhdGEsIGlzbG9hZGluZyk7CiAgICAgICAgfQoKICAgICAgICByZXN1bHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDkv67mlLnmlbDmja4NCiAgICAgKg0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBhY3Rpb24NCiAgICAgKiBAcGFyYW0geyp9IFtjb250ZXh0PXt9XQ0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgICogQHBhcmFtIHtib29sZWFufSBbaXNsb2FkaW5nXQ0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ1cGRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHVwZGF0ZShhY3Rpb24pIHsKICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICB2YXIgY29udGV4dCA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDoge307CiAgICAgIHZhciBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTsKICAgICAgdmFyIGlzbG9hZGluZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzID8gYXJndW1lbnRzWzNdIDogdW5kZWZpbmVkOwoKICAgICAgdmFyIF90aGlzJGhhbmRsZVJlcXVlc3REYTMgPSB0aGlzLmhhbmRsZVJlcXVlc3REYXRhKGFjdGlvbiwgY29udGV4dCwgZGF0YSksCiAgICAgICAgICBEYXRhID0gX3RoaXMkaGFuZGxlUmVxdWVzdERhMy5kYXRhLAogICAgICAgICAgQ29udGV4dCA9IF90aGlzJGhhbmRsZVJlcXVlc3REYTMuY29udGV4dDsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICB2YXIgX2FwcEVudGl0eVNlcnZpY2UgPSBfdGhpczYuYXBwRW50aXR5U2VydmljZTsKCiAgICAgICAgaWYgKF9hcHBFbnRpdHlTZXJ2aWNlW2FjdGlvbl0gJiYgX2FwcEVudGl0eVNlcnZpY2VbYWN0aW9uXSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICByZXN1bHQgPSBfYXBwRW50aXR5U2VydmljZVthY3Rpb25dKENvbnRleHQsIERhdGEsIGlzbG9hZGluZyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdCA9IF90aGlzNi5hcHBFbnRpdHlTZXJ2aWNlLlVwZGF0ZShDb250ZXh0LCBEYXRhLCBpc2xvYWRpbmcpOwogICAgICAgIH0KCiAgICAgICAgcmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICBfdGhpczYuaGFuZGxlUmVzcG9uc2UoYWN0aW9uLCByZXNwb25zZSk7CgogICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICByZWplY3QocmVzcG9uc2UpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOafpeivouaVsOaNrg0KICAgICAqDQogICAgICogQHBhcmFtIHtzdHJpbmd9IGFjdGlvbg0KICAgICAqIEBwYXJhbSB7Kn0gW2NvbnRleHQ9e31dDQogICAgICogQHBhcmFtIHsqfSBbZGF0YT17fV0NCiAgICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgICogQHJldHVybnMge1Byb21pc2U8YW55Pn0NCiAgICAgKiBAbWVtYmVyb2YgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0KGFjdGlvbikgewogICAgICB2YXIgX3RoaXM3ID0gdGhpczsKCiAgICAgIHZhciBjb250ZXh0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiB7fTsKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9OwogICAgICB2YXIgaXNsb2FkaW5nID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgPyBhcmd1bWVudHNbM10gOiB1bmRlZmluZWQ7CgogICAgICB2YXIgX3RoaXMkaGFuZGxlUmVxdWVzdERhNCA9IHRoaXMuaGFuZGxlUmVxdWVzdERhdGEoYWN0aW9uLCBjb250ZXh0LCBkYXRhKSwKICAgICAgICAgIERhdGEgPSBfdGhpcyRoYW5kbGVSZXF1ZXN0RGE0LmRhdGEsCiAgICAgICAgICBDb250ZXh0ID0gX3RoaXMkaGFuZGxlUmVxdWVzdERhNC5jb250ZXh0OwoKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICB2YXIgcmVzdWx0OwogICAgICAgIHZhciBfYXBwRW50aXR5U2VydmljZSA9IF90aGlzNy5hcHBFbnRpdHlTZXJ2aWNlOwoKICAgICAgICBpZiAoX2FwcEVudGl0eVNlcnZpY2VbYWN0aW9uXSAmJiBfYXBwRW50aXR5U2VydmljZVthY3Rpb25dIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgIHJlc3VsdCA9IF9hcHBFbnRpdHlTZXJ2aWNlW2FjdGlvbl0oQ29udGV4dCwgRGF0YSwgaXNsb2FkaW5nKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ID0gX3RoaXM3LmFwcEVudGl0eVNlcnZpY2UuR2V0KENvbnRleHQsIERhdGEsIGlzbG9hZGluZyk7CiAgICAgICAgfQoKICAgICAgICByZXN1bHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIF90aGlzNy5oYW5kbGVSZXNwb25zZShhY3Rpb24sIHJlc3BvbnNlKTsKCiAgICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5Yqg6L296I2J56i/DQogICAgICoNCiAgICAgKiBAcGFyYW0ge3N0cmluZ30gYWN0aW9uDQogICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAgKiBAcGFyYW0geyp9IFtkYXRhPXt9XQ0KICAgICAqIEBwYXJhbSB7Ym9vbGVhbn0gW2lzbG9hZGluZ10NCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAibG9hZERyYWZ0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkRHJhZnQoYWN0aW9uKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIGNvbnRleHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CiAgICAgIHZhciBpc2xvYWRpbmcgPSBhcmd1bWVudHMubGVuZ3RoID4gMyA/IGFyZ3VtZW50c1szXSA6IHVuZGVmaW5lZDsKCiAgICAgIHZhciBfdGhpcyRoYW5kbGVSZXF1ZXN0RGE1ID0gdGhpcy5oYW5kbGVSZXF1ZXN0RGF0YShhY3Rpb24sIGNvbnRleHQsIGRhdGEpLAogICAgICAgICAgRGF0YSA9IF90aGlzJGhhbmRsZVJlcXVlc3REYTUuZGF0YSwKICAgICAgICAgIENvbnRleHQgPSBfdGhpcyRoYW5kbGVSZXF1ZXN0RGE1LmNvbnRleHQ7IC8v5Lu/55yf5Li76ZSu5pWw5o2uCgoKICAgICAgdmFyIFByaW1hcnlLZXkgPSBVdGlsLmNyZWF0ZVVVSUQoKTsKICAgICAgRGF0YS5waW1jb250cmFjdGlkID0gUHJpbWFyeUtleTsKICAgICAgRGF0YS5waW1jb250cmFjdCA9IFByaW1hcnlLZXk7CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgdmFyIHJlc3VsdDsKICAgICAgICB2YXIgX2FwcEVudGl0eVNlcnZpY2UgPSBfdGhpczguYXBwRW50aXR5U2VydmljZTsKCiAgICAgICAgaWYgKF9hcHBFbnRpdHlTZXJ2aWNlW2FjdGlvbl0gJiYgX2FwcEVudGl0eVNlcnZpY2VbYWN0aW9uXSBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CiAgICAgICAgICByZXN1bHQgPSBfYXBwRW50aXR5U2VydmljZVthY3Rpb25dKENvbnRleHQsIERhdGEsIGlzbG9hZGluZyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdCA9IF90aGlzOC5hcHBFbnRpdHlTZXJ2aWNlLkdldERyYWZ0KENvbnRleHQsIERhdGEsIGlzbG9hZGluZyk7CiAgICAgICAgfQoKICAgICAgICByZXN1bHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgIHJlc3BvbnNlLmRhdGEucGltY29udHJhY3RpZCA9IFByaW1hcnlLZXk7CgogICAgICAgICAgX3RoaXM4LmhhbmRsZVJlc3BvbnNlKGFjdGlvbiwgcmVzcG9uc2UsIHRydWUpOwoKICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAqIOWJjeWPsOmAu+i+kQ0KICAgICogQHBhcmFtIHtzdHJpbmd9IGFjdGlvbg0KICAgICogQHBhcmFtIHsqfSBbY29udGV4dD17fV0NCiAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dDQogICAgKiBAcGFyYW0ge2Jvb2xlYW59IFtpc2xvYWRpbmddDQogICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICogQG1lbWJlcm9mIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZQ0KICAgICovCgogIH0sIHsKICAgIGtleTogImZyb250TG9naWMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGZyb250TG9naWMoYWN0aW9uKSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgdmFyIGNvbnRleHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAyICYmIGFyZ3VtZW50c1syXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzJdIDoge307CiAgICAgIHZhciBpc2xvYWRpbmcgPSBhcmd1bWVudHMubGVuZ3RoID4gMyA/IGFyZ3VtZW50c1szXSA6IHVuZGVmaW5lZDsKCiAgICAgIHZhciBfdGhpcyRoYW5kbGVSZXF1ZXN0RGE2ID0gdGhpcy5oYW5kbGVSZXF1ZXN0RGF0YShhY3Rpb24sIGNvbnRleHQsIGRhdGEpLAogICAgICAgICAgRGF0YSA9IF90aGlzJGhhbmRsZVJlcXVlc3REYTYuZGF0YSwKICAgICAgICAgIENvbnRleHQgPSBfdGhpcyRoYW5kbGVSZXF1ZXN0RGE2LmNvbnRleHQ7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgdmFyIF9hcHBFbnRpdHlTZXJ2aWNlID0gX3RoaXM5LmFwcEVudGl0eVNlcnZpY2U7CgogICAgICAgIGlmIChfYXBwRW50aXR5U2VydmljZVthY3Rpb25dICYmIF9hcHBFbnRpdHlTZXJ2aWNlW2FjdGlvbl0gaW5zdGFuY2VvZiBGdW5jdGlvbikgewogICAgICAgICAgcmVzdWx0ID0gX2FwcEVudGl0eVNlcnZpY2VbYWN0aW9uXShDb250ZXh0LCBEYXRhLCBpc2xvYWRpbmcpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoewogICAgICAgICAgICBzdGF0dXM6IDUwMCwKICAgICAgICAgICAgZGF0YTogewogICAgICAgICAgICAgIHRpdGxlOiAn5aSx6LSlJywKICAgICAgICAgICAgICBtZXNzYWdlOiAn57O757uf5byC5bi4JwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIHJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgX3RoaXM5LmhhbmRsZVJlc3BvbnNlKGFjdGlvbiwgcmVzcG9uc2UsIHRydWUpOwoKICAgICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDlpITnkIbor7fmsYLmlbDmja4NCiAgICAgKg0KICAgICAqIEBwYXJhbSBhY3Rpb24g6KGM5Li6DQogICAgICogQHBhcmFtIGRhdGEg5pWw5o2uDQogICAgICogQG1lbWJlcm9mIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJoYW5kbGVSZXF1ZXN0RGF0YSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gaGFuZGxlUmVxdWVzdERhdGEoYWN0aW9uLCBjb250ZXh0KSB7CiAgICAgIHZhciBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTsKICAgICAgdmFyIGlzTWVyZ2UgPSBhcmd1bWVudHMubGVuZ3RoID4gMyAmJiBhcmd1bWVudHNbM10gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1szXSA6IGZhbHNlOwogICAgICB2YXIgbW9kZSA9IHRoaXMuZ2V0TW9kZSgpOwoKICAgICAgaWYgKCFtb2RlICYmIG1vZGUuZ2V0RGF0YUl0ZW1zIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICByZXR1cm4gZGF0YTsKICAgICAgfQoKICAgICAgdmFyIGZvcm1JdGVtSXRlbXMgPSBtb2RlLmdldERhdGFJdGVtcygpOwogICAgICB2YXIgcmVxdWVzdERhdGEgPSB7fTsKCiAgICAgIGlmIChpc01lcmdlICYmIGRhdGEgJiYgZGF0YS52aWV3cGFyYW1zKSB7CiAgICAgICAgT2JqZWN0LmFzc2lnbihyZXF1ZXN0RGF0YSwgZGF0YS52aWV3cGFyYW1zKTsKICAgICAgfQoKICAgICAgZm9ybUl0ZW1JdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbS5kYXRhVHlwZSAmJiBPYmplY3QuaXMoaXRlbS5kYXRhVHlwZSwgJ0ZPTlRLRVknKSkgewogICAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbS5wcm9wKSB7CiAgICAgICAgICAgIHJlcXVlc3REYXRhW2l0ZW0ucHJvcF0gPSBjb250ZXh0W2l0ZW0ubmFtZV07CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChpdGVtICYmIGl0ZW0ucHJvcCkgewogICAgICAgICAgICByZXF1ZXN0RGF0YVtpdGVtLnByb3BdID0gZGF0YVtpdGVtLm5hbWVdOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICAgIHZhciB0ZW1wQ29udGV4dCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoY29udGV4dCkpOwoKICAgICAgaWYgKHRlbXBDb250ZXh0ICYmIHRlbXBDb250ZXh0LnNyZnNlc3Npb25pZCkgewogICAgICAgIHRlbXBDb250ZXh0LnNyZnNlc3Npb25rZXkgPSB0ZW1wQ29udGV4dC5zcmZzZXNzaW9uaWQ7CiAgICAgICAgZGVsZXRlIHRlbXBDb250ZXh0LnNyZnNlc3Npb25pZDsKICAgICAgfQoKICAgICAgcmV0dXJuIHsKICAgICAgICBjb250ZXh0OiB0ZW1wQ29udGV4dCwKICAgICAgICBkYXRhOiByZXF1ZXN0RGF0YQogICAgICB9OwogICAgfQogIH1dKTsKCiAgcmV0dXJuIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZTsKfShDb250cm9sU2VydmljZSk7CgpleHBvcnQgeyBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UgYXMgZGVmYXVsdCB9OwoKdHNsaWJfMS5fX2RlY29yYXRlKFtFcnJvcmxvZ10sIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZS5wcm90b3R5cGUsICJnZXRJdGVtcyIsIG51bGwpOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtFcnJvcmxvZ10sIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZS5wcm90b3R5cGUsICJ3ZnN0YXJ0IiwgbnVsbCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW0Vycm9ybG9nXSwgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlLnByb3RvdHlwZSwgIndmc3VibWl0IiwgbnVsbCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW0Vycm9ybG9nXSwgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlLnByb3RvdHlwZSwgImFkZCIsIG51bGwpOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtFcnJvcmxvZ10sIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZS5wcm90b3R5cGUsICJkZWxldGUiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbRXJyb3Jsb2ddLCBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UucHJvdG90eXBlLCAidXBkYXRlIiwgbnVsbCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW0Vycm9ybG9nXSwgTGFiU2VydmljZXNfRWRpdEdyaWRTZXJ2aWNlLnByb3RvdHlwZSwgImdldCIsIG51bGwpOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtFcnJvcmxvZ10sIExhYlNlcnZpY2VzX0VkaXRHcmlkU2VydmljZS5wcm90b3R5cGUsICJsb2FkRHJhZnQiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbRXJyb3Jsb2ddLCBMYWJTZXJ2aWNlc19FZGl0R3JpZFNlcnZpY2UucHJvdG90eXBlLCAiZnJvbnRMb2dpYyIsIG51bGwpOw=="},null]}