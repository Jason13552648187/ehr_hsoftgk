{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js??ref--14-3!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-archives\\main-2-grid\\main-2-grid-base.vue?vue&type=script&lang=tsx&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\widgets\\pim-archives\\main-2-grid\\main-2-grid-base.vue","mtime":1630509411327},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLmRlc2NyaXB0aW9uIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbmQtaW5kZXgiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmpvaW4iOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb21lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5kZWZpbmUtcHJvcGVydGllcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5kZWZpbmUtcHJvcGVydHkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmdldC1vd24tcHJvcGVydHktZGVzY3JpcHRvcnMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuaXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5wYXJzZS1pbnQiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5yZWdleHAuZXhlYyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5pdGVyYXRvciI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5yZXBsYWNlIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnNlYXJjaCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zcGxpdCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLml0ZXJhdG9yIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnRpbWVycyI7CmltcG9ydCBfdG9Db25zdW1hYmxlQXJyYXkgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3RvQ29uc3VtYWJsZUFycmF5IjsKaW1wb3J0IF9kZWZpbmVQcm9wZXJ0eSBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZGVmaW5lUHJvcGVydHkiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZSI7CmltcG9ydCBfYXN5bmNUb0dlbmVyYXRvciBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vYXN5bmNUb0dlbmVyYXRvciI7CmltcG9ydCBfY2xhc3NDYWxsQ2hlY2sgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NsYXNzQ2FsbENoZWNrIjsKaW1wb3J0IF9jcmVhdGVDbGFzcyBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlQ2xhc3MiOwppbXBvcnQgX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4gZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4iOwppbXBvcnQgX2dldFByb3RvdHlwZU9mIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9nZXRQcm90b3R5cGVPZiI7CmltcG9ydCBfaW5oZXJpdHMgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2luaGVyaXRzIjsKCmZ1bmN0aW9uIG93bktleXMob2JqZWN0LCBlbnVtZXJhYmxlT25seSkgeyB2YXIga2V5cyA9IE9iamVjdC5rZXlzKG9iamVjdCk7IGlmIChPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKSB7IHZhciBzeW1ib2xzID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhvYmplY3QpOyBpZiAoZW51bWVyYWJsZU9ubHkpIHN5bWJvbHMgPSBzeW1ib2xzLmZpbHRlcihmdW5jdGlvbiAoc3ltKSB7IHJldHVybiBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgc3ltKS5lbnVtZXJhYmxlOyB9KTsga2V5cy5wdXNoLmFwcGx5KGtleXMsIHN5bWJvbHMpOyB9IHJldHVybiBrZXlzOyB9CgpmdW5jdGlvbiBfb2JqZWN0U3ByZWFkKHRhcmdldCkgeyBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykgeyB2YXIgc291cmNlID0gYXJndW1lbnRzW2ldICE9IG51bGwgPyBhcmd1bWVudHNbaV0gOiB7fTsgaWYgKGkgJSAyKSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSksIHRydWUpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBfZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHNvdXJjZVtrZXldKTsgfSk7IH0gZWxzZSBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMpIHsgT2JqZWN0LmRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9ycyhzb3VyY2UpKTsgfSBlbHNlIHsgb3duS2V5cyhPYmplY3Qoc291cmNlKSkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGtleSwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihzb3VyY2UsIGtleSkpOyB9KTsgfSB9IHJldHVybiB0YXJnZXQ7IH0KCmltcG9ydCAqIGFzIHRzbGliXzEgZnJvbSAidHNsaWIiOwppbXBvcnQgeyBWdWUsIENvbXBvbmVudCwgUHJvcCwgV2F0Y2ggfSBmcm9tICd2dWUtcHJvcGVydHktZGVjb3JhdG9yJzsKaW1wb3J0IFBpbUFyY2hpdmVzU2VydmljZSBmcm9tICdAL3NlcnZpY2UvcGltLWFyY2hpdmVzL3BpbS1hcmNoaXZlcy1zZXJ2aWNlJzsKaW1wb3J0IE1haW5fMlNlcnZpY2UgZnJvbSAnLi9tYWluLTItZ3JpZC1zZXJ2aWNlJzsKaW1wb3J0IENvZGVMaXN0U2VydmljZSBmcm9tICJAc2VydmljZS9hcHAvY29kZWxpc3Qtc2VydmljZSI7CmltcG9ydCB7IEZvcm1JdGVtTW9kZWwgfSBmcm9tICdAL21vZGVsL2Zvcm0tZGV0YWlsJzsKCnZhciBNYWluXzJCYXNlID0KLyojX19QVVJFX18qLwpmdW5jdGlvbiAoX1Z1ZSkgewogIF9pbmhlcml0cyhNYWluXzJCYXNlLCBfVnVlKTsKCiAgZnVuY3Rpb24gTWFpbl8yQmFzZSgpIHsKICAgIHZhciBfdGhpczI7CgogICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIE1haW5fMkJhc2UpOwoKICAgIF90aGlzMiA9IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuKHRoaXMsIF9nZXRQcm90b3R5cGVPZihNYWluXzJCYXNlKS5hcHBseSh0aGlzLCBhcmd1bWVudHMpKTsKICAgIC8qKg0KICAgICAqIOiuoeaVsOWZqOacjeWKoeWvueixoembhuWQiA0KICAgICAqDQogICAgICogQHR5cGUge0FycmF5PCo+fQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogICAgX3RoaXMyLmNvdW50ZXJTZXJ2aWNlQXJyYXkgPSBbXTsKICAgIC8qKg0KICAgICAqIOW7uuaehOmDqOS7tuacjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge01haW5fMlNlcnZpY2V9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuc2VydmljZSA9IG5ldyBNYWluXzJTZXJ2aWNlKHsKICAgICAgJHN0b3JlOiBfdGhpczIuJHN0b3JlCiAgICB9KTsKICAgIC8qKg0KICAgICAqIOWunuS9k+acjeWKoeWvueixoQ0KICAgICAqDQogICAgICogQHR5cGUge1BpbUFyY2hpdmVzU2VydmljZX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5hcHBFbnRpdHlTZXJ2aWNlID0gbmV3IFBpbUFyY2hpdmVzU2VydmljZSh7CiAgICAgICRzdG9yZTogX3RoaXMyLiRzdG9yZQogICAgfSk7CiAgICAvKioNCiAgICAgKiDku6PnoIHooajmnI3liqHlr7nosaENCiAgICAgKg0KICAgICAqIEB0eXBlIHtDb2RlTGlzdFNlcnZpY2V9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuY29kZUxpc3RTZXJ2aWNlID0gbmV3IENvZGVMaXN0U2VydmljZSh7CiAgICAgICRzdG9yZTogX3RoaXMyLiRzdG9yZQogICAgfSk7CiAgICAvKioNCiAgICAgKiDlvZPliY3pobUNCiAgICAgKg0KICAgICAqIEB0eXBlIHtudW1iZXJ9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuY3VyUGFnZSA9IDE7CiAgICAvKioNCiAgICAgKiDmlbDmja4NCiAgICAgKg0KICAgICAqIEB0eXBlIHthbnlbXX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5pdGVtcyA9IFtdOwogICAgLyoqDQogICAgICog5piv5ZCm5pSv5oyB5YiG6aG1DQogICAgICoNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5pc0VuYWJsZVBhZ2luZ0JhciA9IHRydWU7CiAgICAvKioNCiAgICAgKiDmmK/lkKbnpoHnlKjmjpLluo8NCiAgICAgKg0KICAgICAqIEB0eXBlIHtib29sZWFufQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogICAgX3RoaXMyLmlzTm9Tb3J0ID0gZmFsc2U7CiAgICAvKioNCiAgICAgKiDmjpLluo/mlrnlkJENCiAgICAgKg0KICAgICAqIEB0eXBlIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIubWlub3JTb3J0RGlyID0gJ0RFU0MnOwogICAgLyoqDQogICAgICog5o6S5bqP5a2X5q61DQogICAgICoNCiAgICAgKiBAdHlwZSB7c3RyaW5nfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogICAgX3RoaXMyLm1pbm9yU29ydFBTREVGID0gJ2RhZHJycSc7CiAgICAvKioNCiAgICAgKiDliIbpobXmnaHmlbANCiAgICAgKg0KICAgICAqIEB0eXBlIHtudW1iZXJ9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIubGltaXQgPSAyMDsKICAgIC8qKg0KICAgICAqIOaYr+WQpuaYvuekuuagh+mimA0KICAgICAqDQogICAgICogQHR5cGUge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuaXNIaWRlSGVhZGVyID0gZmFsc2U7CiAgICAvKioNCiAgICAgKiDlrp7pmYXmmK/lkKblvIDlkK/ooYznvJbovpENCiAgICAgKg0KICAgICAqIEB0eXBlIHtib29sZWFufQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogICAgX3RoaXMyLmFjdHVhbElzT3BlbkVkaXQgPSBfdGhpczIuaXNPcGVuRWRpdDsKICAgIC8qKg0KICAgICAqIOaAu+adoeaVsA0KICAgICAqDQogICAgICogQHR5cGUge251bWJlcn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi50b3RhbHJvdyA9IDA7CiAgICAvKioNCiAgICAgKiDpgInkuK3ooYzmlbDmja4NCiAgICAgKg0KICAgICAqIEB0eXBlIHthbnlbXX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbg0KICAgICAqLwoKICAgIF90aGlzMi5zZWxlY3Rpb25zID0gW107CiAgICAvKioNCiAgICAgKiDmi6bmiKrooYzpgInkuK0NCiAgICAgKg0KICAgICAqIEB0eXBlIHtib29sZWFufQ0KICAgICAqIEBtZW1iZXJvZiBNYWluDQogICAgICovCgogICAgX3RoaXMyLnN0b3BSb3dDbGljayA9IGZhbHNlOwogICAgLyoqDQogICAgICog6KGo5qC85piv5ZCm5pi+56S6DQogICAgICoNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5pc0Rpc3BsYXkgPSB0cnVlOwogICAgLyoqDQogICAgKiDpgInpobnmoYbliJflrr0NCiAgICAqDQogICAgKiBAdHlwZSB7bnVtYmVyfQ0KICAgICogQG1lbWJlcm9mIEFwcEluZGV4DQogICAgKi8KCiAgICBfdGhpczIuY2hlY2tib3hDb2xXaWR0aCA9IDM0OwogICAgLyoqDQogICAgICog5piv5ZCm5YWB6K645ouW5Yqo5YiX5a69DQogICAgICoNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgQXBwRW1iZWRQaWNrZXINCiAgICAgKi8KCiAgICBfdGhpczIuaXNEcmFnZW5kQ29sID0gZmFsc2U7CiAgICAvKioNCiAgICAgKiDmiYDmnInliJfmiJDlkZgNCiAgICAgKg0KICAgICAqIEB0eXBlIHthbnlbXX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICAgIF90aGlzMi5hbGxDb2x1bW5zID0gW3sKICAgICAgbmFtZTogJ2RhYmgnLAogICAgICBsYWJlbDogJ+aho+ahiOe8luWPtycsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1hcmNoaXZlcy5tYWluXzJfZ3JpZC5jb2x1bW5zLmRhYmgnLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAnUFgnCiAgICB9LCB7CiAgICAgIG5hbWU6ICdvcm1vcmduYW1lMycsCiAgICAgIGxhYmVsOiAn566h55CG5Y2V5L2NJywKICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbWFyY2hpdmVzLm1haW5fMl9ncmlkLmNvbHVtbnMub3Jtb3JnbmFtZTMnLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAnUFgnCiAgICB9LCB7CiAgICAgIG5hbWU6ICdkYWJnZCcsCiAgICAgIGxhYmVsOiAn5qGj5qGI5L+d566h5ZywJywKICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbWFyY2hpdmVzLm1haW5fMl9ncmlkLmNvbHVtbnMuZGFiZ2QnLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAnUFgnCiAgICB9LCB7CiAgICAgIG5hbWU6ICdhcmNoaXZlc2NlbnRlcm5hbWUnLAogICAgICBsYWJlbDogJ+aho+ahiOWupCcsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1hcmNoaXZlcy5tYWluXzJfZ3JpZC5jb2x1bW5zLmFyY2hpdmVzY2VudGVybmFtZScsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ2VkdWNhdGlvbicsCiAgICAgIGxhYmVsOiAn5qGj5qGI5a2m5Y6GJywKICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbWFyY2hpdmVzLm1haW5fMl9ncmlkLmNvbHVtbnMuZWR1Y2F0aW9uJywKICAgICAgc2hvdzogdHJ1ZSwKICAgICAgdXRpbDogJ3B4JwogICAgfSwgewogICAgICBuYW1lOiAnZGF0ZW9mYmlydGgnLAogICAgICBsYWJlbDogJ+aho+ahiOWHuueUn+aXpeacnycsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1hcmNoaXZlcy5tYWluXzJfZ3JpZC5jb2x1bW5zLmRhdGVvZmJpcnRoJywKICAgICAgc2hvdzogdHJ1ZSwKICAgICAgdXRpbDogJ3B4JwogICAgfSwgewogICAgICBuYW1lOiAnam9pbnBhcnR5ZGF0ZScsCiAgICAgIGxhYmVsOiAn5qGj5qGI5YWl5YWa5pe26Ze0JywKICAgICAgbGFuZ3RhZzogJ2VudGl0aWVzLnBpbWFyY2hpdmVzLm1haW5fMl9ncmlkLmNvbHVtbnMuam9pbnBhcnR5ZGF0ZScsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ3N0YXJ0d29ya2RhdGFlJywKICAgICAgbGFiZWw6ICfmoaPmoYjlj4LliqDlt6XkvZzml7bpl7QnLAogICAgICBsYW5ndGFnOiAnZW50aXRpZXMucGltYXJjaGl2ZXMubWFpbl8yX2dyaWQuY29sdW1ucy5zdGFydHdvcmtkYXRhZScsCiAgICAgIHNob3c6IHRydWUsCiAgICAgIHV0aWw6ICdweCcKICAgIH0sIHsKICAgICAgbmFtZTogJ2Rhc3RhdGUnLAogICAgICBsYWJlbDogJ+aho+ahiOeKtuaAgScsCiAgICAgIGxhbmd0YWc6ICdlbnRpdGllcy5waW1hcmNoaXZlcy5tYWluXzJfZ3JpZC5jb2x1bW5zLmRhc3RhdGUnLAogICAgICBzaG93OiB0cnVlLAogICAgICB1dGlsOiAncHgnCiAgICB9XTsKICAgIC8qKg0KICAgICAqIOihqOagvOaooeWei+mbhuWQiA0KICAgICAqDQogICAgICogQHR5cGUgeyp9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIuZ3JpZEl0ZW1zTW9kZWwgPSBbXTsKICAgIC8qKg0KICAgICAqIOWxnuaAp+WAvOinhOWImQ0KICAgICAqDQogICAgICogQHR5cGUgeyp9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgICBfdGhpczIucnVsZXMgPSB7CiAgICAgIHBpbXBlcnNvbmlkOiBbewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB2YWxpZGF0b3I6IGZ1bmN0aW9uIHZhbGlkYXRvcihydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsKICAgICAgICAgIHJldHVybiBydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgfSwKICAgICAgICBtZXNzYWdlOiAn5ZGY5belIOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB2YWxpZGF0b3I6IGZ1bmN0aW9uIHZhbGlkYXRvcihydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsKICAgICAgICAgIHJldHVybiBydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgfSwKICAgICAgICBtZXNzYWdlOiAn5ZGY5belIOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dLAogICAgICBkYWJoOiBbewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB2YWxpZGF0b3I6IGZ1bmN0aW9uIHZhbGlkYXRvcihydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsKICAgICAgICAgIHJldHVybiBydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgfSwKICAgICAgICBtZXNzYWdlOiAn5qGj5qGI57yW5Y+3IOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB2YWxpZGF0b3I6IGZ1bmN0aW9uIHZhbGlkYXRvcihydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsKICAgICAgICAgIHJldHVybiBydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgfSwKICAgICAgICBtZXNzYWdlOiAn5qGj5qGI57yW5Y+3IOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dLAogICAgICBzcmZrZXk6IFt7CiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgIHZhbGlkYXRvcjogZnVuY3Rpb24gdmFsaWRhdG9yKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgewogICAgICAgICAgcmV0dXJuIHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSA/IGZhbHNlIDogdHJ1ZTsKICAgICAgICB9LAogICAgICAgIG1lc3NhZ2U6ICfmoaPmoYjkv6Hmga/moIfor4Yg5YC85LiN6IO95Li656m6JywKICAgICAgICB0cmlnZ2VyOiAnY2hhbmdlJwogICAgICB9LCB7CiAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLAogICAgICAgIHZhbGlkYXRvcjogZnVuY3Rpb24gdmFsaWRhdG9yKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgewogICAgICAgICAgcmV0dXJuIHJ1bGUucmVxdWlyZWQgJiYgKHZhbHVlID09PSBudWxsIHx8IHZhbHVlID09PSB1bmRlZmluZWQgfHwgdmFsdWUgPT09ICIiKSA/IGZhbHNlIDogdHJ1ZTsKICAgICAgICB9LAogICAgICAgIG1lc3NhZ2U6ICfmoaPmoYjkv6Hmga/moIfor4Yg5YC85LiN6IO95Li656m6JywKICAgICAgICB0cmlnZ2VyOiAnYmx1cicKICAgICAgfV0sCiAgICAgIGRhYmdkOiBbewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB2YWxpZGF0b3I6IGZ1bmN0aW9uIHZhbGlkYXRvcihydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsKICAgICAgICAgIHJldHVybiBydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgfSwKICAgICAgICBtZXNzYWdlOiAn5qGj5qGI5L+d566h5ZywIOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScKICAgICAgfSwgewogICAgICAgIHJlcXVpcmVkOiBmYWxzZSwKICAgICAgICB2YWxpZGF0b3I6IGZ1bmN0aW9uIHZhbGlkYXRvcihydWxlLCB2YWx1ZSwgY2FsbGJhY2spIHsKICAgICAgICAgIHJldHVybiBydWxlLnJlcXVpcmVkICYmICh2YWx1ZSA9PT0gbnVsbCB8fCB2YWx1ZSA9PT0gdW5kZWZpbmVkIHx8IHZhbHVlID09PSAiIikgPyBmYWxzZSA6IHRydWU7CiAgICAgICAgfSwKICAgICAgICBtZXNzYWdlOiAn5qGj5qGI5L+d566h5ZywIOWAvOS4jeiDveS4uuepuicsCiAgICAgICAgdHJpZ2dlcjogJ2JsdXInCiAgICAgIH1dCiAgICB9OwogICAgcmV0dXJuIF90aGlzMjsKICB9CiAgLyoqDQogICAqIOiOt+WPlumDqOS7tuexu+Weiw0KICAgKg0KICAgKiBAcmV0dXJucyB7c3RyaW5nfQ0KICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgKi8KCgogIF9jcmVhdGVDbGFzcyhNYWluXzJCYXNlLCBbewogICAga2V5OiAiZ2V0Q29udHJvbFR5cGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbnRyb2xUeXBlKCkgewogICAgICByZXR1cm4gJ0dSSUQnOwogICAgfQogICAgLyoqDQogICAgICog5YWz6Zet6KeG5Zu+DQogICAgICoNCiAgICAgKiBAcGFyYW0ge2FueX0gYXJncw0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImNsb3NlVmlldyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvc2VWaWV3KGFyZ3MpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIF90aGlzLiRlbWl0KCdjbG9zZXZpZXcnLCBbYXJnc10pOwogICAgfQogICAgLyoqDQogICAgICogIOiuoeaVsOWZqOWIt+aWsA0KICAgICAqDQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY291bnRlclJlZnJlc2giLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNvdW50ZXJSZWZyZXNoKCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgaWYgKF90aGlzLmNvdW50ZXJTZXJ2aWNlQXJyYXkgJiYgX3RoaXMuY291bnRlclNlcnZpY2VBcnJheS5sZW5ndGggPiAwKSB7CiAgICAgICAgX3RoaXMuY291bnRlclNlcnZpY2VBcnJheS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpZiAoaXRlbS5yZWZyZXNoRGF0YSAmJiBpdGVtLnJlZnJlc2hEYXRhIGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKICAgICAgICAgICAgaXRlbS5yZWZyZXNoRGF0YSgpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5blpJrpobnmlbDmja4NCiAgICAgKg0KICAgICAqIEByZXR1cm5zIHthbnlbXX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJnZXREYXRhcyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0RGF0YXMoKSB7CiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbnM7CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5bljZXpobnmoJENCiAgICAgKg0KICAgICAqIEByZXR1cm5zIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldERhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGlvbnNbMF07CiAgICB9CiAgICAvKioNCiAgICAgKiDpgInkuK3lgLzlj5jljJYNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gbmV3VmFsDQogICAgICogQHBhcmFtIHsqfSBvbGRWYWwNCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvblZhbHVlQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblZhbHVlQ2hhbmdlKG5ld1ZhbCwgb2xkVmFsKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CgogICAgICBpZiAodGhpcy5zZWxlY3RlZERhdGEpIHsKICAgICAgICB2YXIgcmVmcyA9IHRoaXMuJHJlZnM7CgogICAgICAgIGlmIChyZWZzLm11bHRpcGxlVGFibGUpIHsKICAgICAgICAgIHJlZnMubXVsdGlwbGVUYWJsZS5jbGVhclNlbGVjdGlvbigpOwogICAgICAgICAgSlNPTi5wYXJzZSh0aGlzLnNlbGVjdGVkRGF0YSkuZm9yRWFjaChmdW5jdGlvbiAoc2VsZWN0aW9uKSB7CiAgICAgICAgICAgIHZhciBzZWxlY3RlZEl0ZW0gPSBfdGhpczMuaXRlbXMuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIHJldHVybiBPYmplY3QuaXMoaXRlbS5zcmZrZXksIHNlbGVjdGlvbi5zcmZrZXkpOwogICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGlmIChzZWxlY3RlZEl0ZW0pIHsKICAgICAgICAgICAgICBfdGhpczMucm93Q2xpY2soc2VsZWN0ZWRJdGVtKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDpg6jku7bliLfmlrANCiAgICAgKg0KICAgICAqIEBwYXJhbSB7YW55W119IGFyZ3MNCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyZWZyZXNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByZWZyZXNoKGFyZ3MpIHsKICAgICAgdGhpcy5sb2FkKCk7CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5booajmoLzooYzmqKHlnosNCiAgICAgKg0KICAgICAqIEB0eXBlIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEdyaWRSb3dNb2RlbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0R3JpZFJvd01vZGVsKCkgewogICAgICByZXR1cm4gewogICAgICAgIHBpbXBlcnNvbmlkOiBuZXcgRm9ybUl0ZW1Nb2RlbCgpLAogICAgICAgIGRhYmg6IG5ldyBGb3JtSXRlbU1vZGVsKCksCiAgICAgICAgc3Jma2V5OiBuZXcgRm9ybUl0ZW1Nb2RlbCgpLAogICAgICAgIGRhYmdkOiBuZXcgRm9ybUl0ZW1Nb2RlbCgpCiAgICAgIH07CiAgICB9CiAgICAvKioNCiAgICAgKiDooajmoLzooYznvJbovpHpobnmoKHpqowNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBwcm9wZXJ0eSDlsZ7mgKflkI0NCiAgICAgKiBAcGFyYW0geyp9IGRhdGEg6KGM5pWw5o2uDQogICAgICogQHBhcmFtIHtudW1iZXJ9IHJvd0luZGV4IOihjOe0ouW8lQ0KICAgICAqIEByZXR1cm5zIFByb21pc2U8YW55Pg0KICAgICAqDQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAidmFsaWRhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIHZhbGlkYXRlKHByb3BlcnR5LCBkYXRhLCByb3dJbmRleCkgewogICAgICB2YXIgX3RoaXM0ID0gdGhpczsKCiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgX3RoaXM0LiR1dGlsLnZhbGlkYXRlSXRlbShwcm9wZXJ0eSwgZGF0YSwgX3RoaXM0LnJ1bGVzKS50aGVuKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzNC5ncmlkSXRlbXNNb2RlbFtyb3dJbmRleF1bcHJvcGVydHldLnNldEVycm9yKG51bGwpOwoKICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICAgIHZhciBlcnJvcnMgPSBfcmVmLmVycm9ycywKICAgICAgICAgICAgICBmaWVsZHMgPSBfcmVmLmZpZWxkczsKCiAgICAgICAgICBfdGhpczQuZ3JpZEl0ZW1zTW9kZWxbcm93SW5kZXhdW3Byb3BlcnR5XS5zZXRFcnJvcihlcnJvcnNbMF0ubWVzc2FnZSk7CgogICAgICAgICAgcmVzb2x2ZShmYWxzZSk7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5qCh6aqM5omA5pyJ5L+u5pS56L+H55qE57yW6L6R6aG5DQogICAgICoNCiAgICAgKiBAcmV0dXJucyBQcm9taXNlPGFueT4NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJ2YWxpZGF0ZUFsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3ZhbGlkYXRlQWxsID0gX2FzeW5jVG9HZW5lcmF0b3IoCiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgdmFsaWRhdGVTdGF0ZSwgaW5kZXgsIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24sIF9kaWRJdGVyYXRvckVycm9yLCBfaXRlcmF0b3JFcnJvciwgX2l0ZXJhdG9yLCBfc3RlcCwgaXRlbSwgX2ksIF9PYmplY3Qka2V5cywgcHJvcGVydHk7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIHZhbGlkYXRlU3RhdGUgPSB0cnVlOwogICAgICAgICAgICAgICAgaW5kZXggPSAtMTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlOwogICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkOwogICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDU7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3IgPSB0aGlzLml0ZW1zW1N5bWJvbC5pdGVyYXRvcl0oKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgaWYgKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSAoX3N0ZXAgPSBfaXRlcmF0b3IubmV4dCgpKS5kb25lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyNDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaXRlbSA9IF9zdGVwLnZhbHVlOwogICAgICAgICAgICAgICAgaW5kZXgrKzsKCiAgICAgICAgICAgICAgICBpZiAoIShpdGVtLnJvd0RhdGFTdGF0ZSA9PT0gImNyZWF0ZSIgfHwgaXRlbS5yb3dEYXRhU3RhdGUgPT09ICJ1cGRhdGUiKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMjE7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIF9pID0gMCwgX09iamVjdCRrZXlzID0gT2JqZWN0LmtleXModGhpcy5ydWxlcyk7CgogICAgICAgICAgICAgIGNhc2UgMTI6CiAgICAgICAgICAgICAgICBpZiAoIShfaSA8IF9PYmplY3Qka2V5cy5sZW5ndGgpKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyMTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgcHJvcGVydHkgPSBfT2JqZWN0JGtleXNbX2ldOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE2OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMudmFsaWRhdGUocHJvcGVydHksIGl0ZW0sIGluZGV4KTsKCiAgICAgICAgICAgICAgY2FzZSAxNjoKICAgICAgICAgICAgICAgIGlmIChfY29udGV4dC5zZW50KSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxODsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdmFsaWRhdGVTdGF0ZSA9IGZhbHNlOwoKICAgICAgICAgICAgICBjYXNlIDE4OgogICAgICAgICAgICAgICAgX2krKzsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAxMjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIxOgogICAgICAgICAgICAgICAgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gNzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDI0OgogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDMwOwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMjY6CiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMjY7CiAgICAgICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDUpOwogICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlOwogICAgICAgICAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBfY29udGV4dC50MDsKCiAgICAgICAgICAgICAgY2FzZSAzMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzMDsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzMTsKCiAgICAgICAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gJiYgX2l0ZXJhdG9yWyJyZXR1cm4iXSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICAgIF9pdGVyYXRvclsicmV0dXJuIl0oKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgY2FzZSAzMzoKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAzMzsKCiAgICAgICAgICAgICAgICBpZiAoIV9kaWRJdGVyYXRvckVycm9yKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAzNjsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7CgogICAgICAgICAgICAgIGNhc2UgMzY6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuZmluaXNoKDMzKTsKCiAgICAgICAgICAgICAgY2FzZSAzNzoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5maW5pc2goMzApOwoKICAgICAgICAgICAgICBjYXNlIDM4OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIiwgdmFsaWRhdGVTdGF0ZSk7CgogICAgICAgICAgICAgIGNhc2UgMzk6CiAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlLCB0aGlzLCBbWzUsIDI2LCAzMCwgMzhdLCBbMzEsLCAzMywgMzddXSk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHZhbGlkYXRlQWxsKCkgewogICAgICAgIHJldHVybiBfdmFsaWRhdGVBbGwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHZhbGlkYXRlQWxsOwogICAgfSgpCiAgICAvKioNCiAgICAgKiDooajmoLzmlbDmja7liqDovb0NCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gW2FyZz17fV0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJsb2FkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBsb2FkKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBvcHQgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHt9OwogICAgICB2YXIgcGFnZVJlc2V0ID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiBmYWxzZTsKCiAgICAgIGlmICghdGhpcy5mZXRjaEFjdGlvbikgewogICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICBkZXNjOiAnUElNQVJDSElWRVNQaW1EYW5nYUdyaWRWaWV36KeG5Zu+6KGo5qC8ZmV0Y2hBY3Rpb27lj4LmlbDmnKrphY3nva4nCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAocGFnZVJlc2V0KSB7CiAgICAgICAgdGhpcy5jdXJQYWdlID0gMTsKICAgICAgfQoKICAgICAgdmFyIGFyZyA9IF9vYmplY3RTcHJlYWQoe30sIG9wdCk7CgogICAgICB2YXIgcGFnZSA9IHt9OwoKICAgICAgaWYgKHRoaXMuaXNFbmFibGVQYWdpbmdCYXIpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsKICAgICAgICAgIHBhZ2U6IHRoaXMuY3VyUGFnZSAtIDEsCiAgICAgICAgICBzaXplOiB0aGlzLmxpbWl0CiAgICAgICAgfSk7CiAgICAgIH0gLy8g6K6+572u5o6S5bqPCgoKICAgICAgaWYgKCF0aGlzLmlzTm9Tb3J0ICYmICFPYmplY3QuaXModGhpcy5taW5vclNvcnREaXIsICcnKSAmJiAhT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0UFNERUYsICcnKSkgewogICAgICAgIHZhciBzb3J0ID0gdGhpcy5taW5vclNvcnRQU0RFRiArICIsIiArIHRoaXMubWlub3JTb3J0RGlyOwogICAgICAgIE9iamVjdC5hc3NpZ24ocGFnZSwgewogICAgICAgICAgc29ydDogc29ydAogICAgICAgIH0pOwogICAgICB9CgogICAgICBPYmplY3QuYXNzaWduKGFyZywgcGFnZSk7CiAgICAgIHZhciBwYXJlbnRkYXRhID0ge307CiAgICAgIHRoaXMuJGVtaXQoJ2JlZm9yZWxvYWQnLCBwYXJlbnRkYXRhKTsKICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHBhcmVudGRhdGEpOwogICAgICB2YXIgdGVtcFZpZXdQYXJhbXMgPSBwYXJlbnRkYXRhLnZpZXdwYXJhbXMgPyBwYXJlbnRkYXRhLnZpZXdwYXJhbXMgOiB7fTsKICAgICAgT2JqZWN0LmFzc2lnbih0ZW1wVmlld1BhcmFtcywgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLnZpZXdwYXJhbXMpKSk7CiAgICAgIE9iamVjdC5hc3NpZ24oYXJnLCB7CiAgICAgICAgdmlld3BhcmFtczogdGVtcFZpZXdQYXJhbXMKICAgICAgfSk7CiAgICAgIHZhciBwb3N0ID0gdGhpcy5zZXJ2aWNlLnNlYXJjaCh0aGlzLmZldGNoQWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBhcmcsIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwogICAgICBwb3N0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKCFyZXNwb25zZS5zdGF0dXMgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIGlmIChyZXNwb25zZS5lcnJvck1lc3NhZ2UpIHsKICAgICAgICAgICAgX3RoaXM1LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICBkZXNjOiByZXNwb25zZS5lcnJvck1lc3NhZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIF90aGlzNS50b3RhbHJvdyA9IHJlc3BvbnNlLnRvdGFsOwogICAgICAgIF90aGlzNS5pdGVtcyA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOyAvLyDmuIXnqbpzZWxlY3Rpb25zLGdyaWRJdGVtc01vZGVsCgogICAgICAgIF90aGlzNS5zZWxlY3Rpb25zID0gW107CiAgICAgICAgX3RoaXM1LmdyaWRJdGVtc01vZGVsID0gW107CgogICAgICAgIF90aGlzNS5pdGVtcy5mb3JFYWNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzNS5ncmlkSXRlbXNNb2RlbC5wdXNoKF90aGlzNS5nZXRHcmlkUm93TW9kZWwoKSk7CiAgICAgICAgfSk7CgogICAgICAgIF90aGlzNS4kZW1pdCgnbG9hZCcsIF90aGlzNS5pdGVtcyk7IC8vIOiuvue9rum7mOiupOmAieS4rQoKCiAgICAgICAgdmFyIF90aGlzID0gX3RoaXM1OwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgaWYgKF90aGlzLmlzU2VsZWN0Rmlyc3REZWZhdWx0KSB7CiAgICAgICAgICAgIF90aGlzLnJvd0NsaWNrKF90aGlzLml0ZW1zWzBdKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoX3RoaXMuc2VsZWN0ZWREYXRhKSB7CiAgICAgICAgICAgIHZhciByZWZzID0gX3RoaXMuJHJlZnM7CgogICAgICAgICAgICBpZiAocmVmcy5tdWx0aXBsZVRhYmxlKSB7CiAgICAgICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICAgICAgSlNPTi5wYXJzZShfdGhpcy5zZWxlY3RlZERhdGEpLmZvckVhY2goZnVuY3Rpb24gKHNlbGVjdGlvbikgewogICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkSXRlbSA9IF90aGlzLml0ZW1zLmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhpdGVtLnNyZmtleSwgc2VsZWN0aW9uLnNyZmtleSk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRJdGVtKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzLnJvd0NsaWNrKHNlbGVjdGVkSXRlbSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCAzMDApOwogICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIF90aGlzNS4kTm90aWNlLmVycm9yKHsKICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgIGRlc2M6IHJlc3BvbnNlLmVycm9yTWVzc2FnZQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOWIoOmZpA0KICAgICAqDQogICAgICogQHBhcmFtIHthbnlbXX0gZGF0YXMNCiAgICAgKiBAcmV0dXJucyB7UHJvbWlzZTxhbnk+fQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInJlbW92ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgX3JlbW92ZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKGRhdGFzKSB7CiAgICAgICAgdmFyIF90aGlzNiA9IHRoaXM7CgogICAgICAgIHZhciBfZGF0YXMsIGRhdGFJbmZvLCByZW1vdmVEYXRhOwoKICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZTIkKF9jb250ZXh0MikgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgaWYgKHRoaXMucmVtb3ZlQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICBkZXNjOiAnUElNQVJDSElWRVNQaW1EYW5nYUdyaWRWaWV36KeG5Zu+6KGo5qC8cmVtb3ZlQWN0aW9u5Y+C5pWw5pyq6YWN572uJwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIF9kYXRhcyA9IFtdOwogICAgICAgICAgICAgICAgZGF0YXMuZm9yRWFjaChmdW5jdGlvbiAocmVjb3JkLCBpbmRleCkgewogICAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmlzKHJlY29yZC5zcmZ1ZiwgIjAiKSkgewogICAgICAgICAgICAgICAgICAgIF90aGlzNi5pdGVtcy5zb21lKGZ1bmN0aW9uICh2YWwsIG51bSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKEpTT04uc3RyaW5naWZ5KHZhbCkgPT0gSlNPTi5zdHJpbmdpZnkocmVjb3JkKSkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuaXRlbXMuc3BsaWNlKG51bSwgMSk7CgogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuZ3JpZEl0ZW1zTW9kZWwuc3BsaWNlKG51bSwgMSk7CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBfZGF0YXMucHVzaChkYXRhc1tpbmRleF0pOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoIShfZGF0YXMubGVuZ3RoID09PSAwKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDc7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICAgICAgZGF0YUluZm8gPSAnJzsKCiAgICAgICAgICAgICAgICBfZGF0YXMuZm9yRWFjaChmdW5jdGlvbiAocmVjb3JkLCBpbmRleCkgewogICAgICAgICAgICAgICAgICB2YXIgc3JmbWFqb3J0ZXh0ID0gcmVjb3JkLnBpbXBlcnNvbm5hbWU7CgogICAgICAgICAgICAgICAgICBpZiAoaW5kZXggPCA1KSB7CiAgICAgICAgICAgICAgICAgICAgaWYgKCFPYmplY3QuaXMoZGF0YUluZm8sICcnKSkgewogICAgICAgICAgICAgICAgICAgICAgZGF0YUluZm8gKz0gJ+OAgSc7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICBkYXRhSW5mbyArPSBzcmZtYWpvcnRleHQ7CiAgICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBpZiAoX2RhdGFzLmxlbmd0aCA8IDUpIHsKICAgICAgICAgICAgICAgICAgZGF0YUluZm8gPSBkYXRhSW5mbyArICcg5YWxJyArIF9kYXRhcy5sZW5ndGggKyAn5p2h5pWw5o2uJzsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgIGRhdGFJbmZvID0gZGF0YUluZm8gKyAnLi4uJyArICcg5YWxJyArIF9kYXRhcy5sZW5ndGggKyAn5p2h5pWw5o2uJzsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICByZW1vdmVEYXRhID0gZnVuY3Rpb24gcmVtb3ZlRGF0YSgpIHsKICAgICAgICAgICAgICAgICAgdmFyIGtleXMgPSBbXTsKCiAgICAgICAgICAgICAgICAgIF9kYXRhcy5mb3JFYWNoKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgICAgICAgICAgICAga2V5cy5wdXNoKGRhdGEuc3Jma2V5KTsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICB2YXIgX3JlbW92ZUFjdGlvbiA9IGtleXMubGVuZ3RoID4gMSA/ICdyZW1vdmVCYXRjaCcgOiBfdGhpczYucmVtb3ZlQWN0aW9uOwoKICAgICAgICAgICAgICAgICAgdmFyIF9rZXlzID0ga2V5cy5sZW5ndGggPiAxID8ga2V5cyA6IGtleXNbMF07CgogICAgICAgICAgICAgICAgICB2YXIgY29udGV4dCA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoX3RoaXM2LmNvbnRleHQpKTsKCiAgICAgICAgICAgICAgICAgIHZhciBwb3N0ID0gX3RoaXM2LnNlcnZpY2VbImRlbGV0ZSJdKF9yZW1vdmVBY3Rpb24sIE9iamVjdC5hc3NpZ24oY29udGV4dCwgewogICAgICAgICAgICAgICAgICAgIHBpbWFyY2hpdmVzOiBfa2V5cwogICAgICAgICAgICAgICAgICB9KSwgT2JqZWN0LmFzc2lnbih7CiAgICAgICAgICAgICAgICAgICAgcGltYXJjaGl2ZXM6IF9rZXlzCiAgICAgICAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgICAgICB2aWV3cGFyYW1zOiBfdGhpczYudmlld3BhcmFtcwogICAgICAgICAgICAgICAgICB9KSwgX3RoaXM2LnNob3dCdXN5SW5kaWNhdG9yKTsKCiAgICAgICAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgICAgICAgcG9zdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgaWYgKCFyZXNwb25zZSB8fCByZXNwb25zZS5zdGF0dXMgIT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICfliKDpmaTmlbDmja7lpLHotKUsJyArIHJlc3BvbnNlLmluZm8KICAgICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuJE5vdGljZS5zdWNjZXNzKHsKICAgICAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzYzogJ+WIoOmZpOaIkOWKnyEnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfSAvL+WIoOmZpGl0ZW1z5Lit5bey5Yig6Zmk55qE6aG5CgoKICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKF90aGlzNi5pdGVtcyk7CgogICAgICAgICAgICAgICAgICAgICAgX2RhdGFzLmZvckVhY2goZnVuY3Rpb24gKGRhdGEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXM2Lml0ZW1zLnNvbWUoZnVuY3Rpb24gKGl0ZW0sIGluZGV4KSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKE9iamVjdC5pcyhpdGVtLnNyZmtleSwgZGF0YS5zcmZrZXkpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuaXRlbXMuc3BsaWNlKGluZGV4LCAxKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuZ3JpZEl0ZW1zTW9kZWwuc3BsaWNlKGluZGV4LCAxKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LnRvdGFscm93IC09IF9kYXRhcy5sZW5ndGg7CgogICAgICAgICAgICAgICAgICAgICAgX3RoaXM2LiRlbWl0KCdyZW1vdmUnLCBudWxsKTsKCiAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuc2VsZWN0aW9ucyA9IFtdOwogICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UgJiYgcmVzcG9uc2Uuc3RhdHVzID09PSA0MDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIGlmICghcmVzcG9uc2UgfHwgIXJlc3BvbnNlLnN0YXR1cyB8fCAhcmVzcG9uc2UuZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICBfdGhpczYuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2M6ICfns7vnu5/lvILluLgnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICAgICAgICAgICAgcmVqZWN0KHJlc3BvbnNlKTsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgIHJlamVjdChyZXNwb25zZSk7CiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfTsKCiAgICAgICAgICAgICAgICBkYXRhSW5mbyA9IGRhdGFJbmZvLnJlcGxhY2UoL1tudWxsXS9nLCAnJykucmVwbGFjZSgvW3VuZGVmaW5lZF0vZywgJycpOwogICAgICAgICAgICAgICAgdGhpcy4kTW9kYWwuY29uZmlybSh7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6K2m5ZGKJywKICAgICAgICAgICAgICAgICAgY29udGVudDogJ+ehruiupOimgeWIoOmZpCAnICsgZGF0YUluZm8gKyAn77yM5Yig6Zmk5pON5L2c5bCG5LiN5Y+v5oGi5aSN77yfJywKICAgICAgICAgICAgICAgICAgb25PazogZnVuY3Rpb24gb25PaygpIHsKICAgICAgICAgICAgICAgICAgICByZW1vdmVEYXRhKCk7CiAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgIG9uQ2FuY2VsOiBmdW5jdGlvbiBvbkNhbmNlbCgpIHt9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iLCByZW1vdmVEYXRhKTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIHJlbW92ZShfeCkgewogICAgICAgIHJldHVybiBfcmVtb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiByZW1vdmU7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIOaJuemHj+a3u+WKoA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBbYXJnPXt9XQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImFkZEJhdGNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBhZGRCYXRjaCgpIHsKICAgICAgdmFyIGFyZyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CgogICAgICBpZiAoIXRoaXMuZmV0Y2hBY3Rpb24pIHsKICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgZGVzYzogJ1BJTUFSQ0hJVkVTUGltRGFuZ2FHcmlkVmlld+inhuWbvuihqOagvGZldGNoQWN0aW9u5Y+C5pWw5pyq6YWN572uJwogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCFhcmcpIHsKICAgICAgICBhcmcgPSB7fTsKICAgICAgfQoKICAgICAgY29uc29sZS5lcnJvcigi5om56YeP5re75Yqg5pyq5a6e546wIik7CiAgICB9CiAgICAvKioNCiAgICAgKiDmlbDmja7lr7zlhaUNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gZGF0YQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImltcG9ydEV4Y2VsIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBpbXBvcnRFeGNlbCgpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB2YXIgZGF0YSA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge307CiAgICAgIC8v5a+85YWlZXhjZWwKICAgICAgdmFyIGltcG9ydERhdGFNb2RlbCA9IHt9OwoKICAgICAgaWYgKE9iamVjdC5rZXlzKGltcG9ydERhdGFNb2RlbCkubGVuZ3RoID09IDApIHsKICAgICAgICB0aGlzLiROb3RpY2Uud2FybmluZyh7CiAgICAgICAgICAndGl0bGUnOiB0aGlzLiR0KCJhcHAudXRpbHZpZXcud2FybmluZyIpLAogICAgICAgICAgJ2Rlc2MnOiB0aGlzLiR0KCJhcHAudXRpbHZpZXcuaW5mbyIpCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgdmlldyA9IHsKICAgICAgICB2aWV3bmFtZTogJ2FwcC1kYXRhLXVwbG9hZCcsCiAgICAgICAgdGl0bGU6IHRoaXMuJHQoImFwcC51dGlsdmlldy5pbXBvcnR2aWV3IiksCiAgICAgICAgd2lkdGg6IDkwMCwKICAgICAgICBoZWlnaHQ6IDcwMAogICAgICB9OwogICAgICB2YXIgY29udGFpbmVyID0gdGhpcy4kYXBwbW9kYWwub3Blbk1vZGFsKHZpZXcsIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGltcG9ydERhdGFNb2RlbCk7CiAgICAgIGNvbnRhaW5lci5zdWJzY3JpYmUoZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIGlmIChPYmplY3QuaXMocmVzdWx0LnJldCwgJ09LJykpIHsKICAgICAgICAgIF90aGlzNy5yZWZyZXNoKHJlc3VsdC5kYXRhcyk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOaVsOaNruWvvOWHug0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSBkYXRhDQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZXhwb3J0RXhjZWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGV4cG9ydEV4Y2VsKCkgewogICAgICB2YXIgX3RoaXM4ID0gdGhpczsKCiAgICAgIHZhciBkYXRhID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiB7fTsKCiAgICAgIC8vIOWvvOWHukV4Y2VsCiAgICAgIHZhciBkb0V4cG9ydCA9CiAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfcmVmMiA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAgIC8qI19fUFVSRV9fKi8KICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMyhfZGF0YSkgewogICAgICAgICAgdmFyIHRIZWFkZXIsIGZpbHRlclZhbCwgZGF0YTsKICAgICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMyQoX2NvbnRleHQzKSB7CiAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDMucHJldiA9IF9jb250ZXh0My5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIHRIZWFkZXIgPSBbXTsKICAgICAgICAgICAgICAgICAgZmlsdGVyVmFsID0gW107CgogICAgICAgICAgICAgICAgICBfdGhpczguYWxsQ29sdW1ucy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgaXRlbS5zaG93ICYmIGl0ZW0ubGFiZWwgPyB0SGVhZGVyLnB1c2goX3RoaXM4LiR0KGl0ZW0ubGFuZ3RhZykpIDogIiI7CiAgICAgICAgICAgICAgICAgICAgaXRlbS5zaG93ICYmIGl0ZW0ubmFtZSA/IGZpbHRlclZhbC5wdXNoKGl0ZW0ubmFtZSkgOiAiIjsKICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICBfY29udGV4dDMubmV4dCA9IDU7CiAgICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczguZm9ybWF0RXhjZWxEYXRhKGZpbHRlclZhbCwgX2RhdGEpOwoKICAgICAgICAgICAgICAgIGNhc2UgNToKICAgICAgICAgICAgICAgICAgZGF0YSA9IF9jb250ZXh0My5zZW50OwoKICAgICAgICAgICAgICAgICAgX3RoaXM4LiRleHBvcnQuZXhwb3J0RXhjZWwoKS50aGVuKGZ1bmN0aW9uIChleGNlbCkgewogICAgICAgICAgICAgICAgICAgIGV4Y2VsLmV4cG9ydF9qc29uX3RvX2V4Y2VsKHsKICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcjogdEhlYWRlciwKICAgICAgICAgICAgICAgICAgICAgIGRhdGE6IGRhdGEsCiAgICAgICAgICAgICAgICAgICAgICBmaWxlbmFtZTogIuaho+ahiOS/oeaBr+ihqCIsCiAgICAgICAgICAgICAgICAgICAgICBhdXRvV2lkdGg6IHRydWUsCiAgICAgICAgICAgICAgICAgICAgICBib29rVHlwZTogInhsc3giIC8v6Z2e5b+F5aGrCgogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQzLnN0b3AoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0sIF9jYWxsZWUzKTsKICAgICAgICB9KSk7CgogICAgICAgIHJldHVybiBmdW5jdGlvbiBkb0V4cG9ydChfeDIpIHsKICAgICAgICAgIHJldHVybiBfcmVmMi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIH07CiAgICAgIH0oKTsKCiAgICAgIHZhciBwYWdlID0ge307IC8vIOiuvue9rnBhZ2XvvIxzaXplCgogICAgICBpZiAoT2JqZWN0LmlzKGRhdGEudHlwZSwgJ21heFJvd0NvdW50JykpIHsKICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsKICAgICAgICAgIHBhZ2U6IDAsCiAgICAgICAgICBzaXplOiBkYXRhLm1heFJvd0NvdW50CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmlzKGRhdGEudHlwZSwgJ2FjdGl2YXRlZFBhZ2UnKSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBkb0V4cG9ydChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuaXRlbXMpKSk7CiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOiuvue9ruaOkuW6jwoKCiAgICAgIGlmICghdGhpcy5pc05vU29ydCAmJiAhT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0RGlyLCAnJykgJiYgIU9iamVjdC5pcyh0aGlzLm1pbm9yU29ydFBTREVGLCAnJykpIHsKICAgICAgICB2YXIgc29ydCA9IHRoaXMubWlub3JTb3J0UFNERUYgKyAiLCIgKyB0aGlzLm1pbm9yU29ydERpcjsKICAgICAgICBPYmplY3QuYXNzaWduKHBhZ2UsIHsKICAgICAgICAgIHNvcnQ6IHNvcnQKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgdmFyIGFyZyA9IHt9OwogICAgICBPYmplY3QuYXNzaWduKGFyZywgcGFnZSk7IC8vIOiOt+WPlnF1ZXJ5LOaQnOe0ouihqOWNle+8jHZpZXdwYXJhbXPnrYnniLbmlbDmja4KCiAgICAgIHZhciBwYXJlbnRkYXRhID0ge307CiAgICAgIHRoaXMuJGVtaXQoJ2JlZm9yZWxvYWQnLCBwYXJlbnRkYXRhKTsKICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHBhcmVudGRhdGEpOwogICAgICB2YXIgcG9zdCA9IHRoaXMuc2VydmljZS5zZWFyY2godGhpcy5mZXRjaEFjdGlvbiwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSwgYXJnLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgcG9zdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmICghcmVzcG9uc2UgfHwgcmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHsKICAgICAgICAgIF90aGlzOC4kTm90aWNlLmVycm9yKHsKICAgICAgICAgICAgdGl0bGU6ICcnLAogICAgICAgICAgICBkZXNjOiAn5pWw5o2u5a+85Ye65aSx6LSlLCcgKyByZXNwb25zZS5pbmZvCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0cnkgewogICAgICAgICAgZG9FeHBvcnQoSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShyZXNwb25zZS5kYXRhKSkpOwogICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKTsKICAgICAgICB9CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgX3RoaXM4LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgdGl0bGU6ICcnLAogICAgICAgICAgZGVzYzogJ+aVsOaNruWvvOWHuuWksei0pScKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDlr7zlh7rmlbDmja7moLzlvI/ljJYNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gZmlsdGVyVmFsDQogICAgICogQHBhcmFtIHsqfSBqc29uRGF0YQ0KICAgICAqIEByZXR1cm5zIHtbXX0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJmb3JtYXRFeGNlbERhdGEiLAogICAgdmFsdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIF9mb3JtYXRFeGNlbERhdGEgPSBfYXN5bmNUb0dlbmVyYXRvcigKICAgICAgLyojX19QVVJFX18qLwogICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlNChmaWx0ZXJWYWwsIGpzb25EYXRhKSB7CiAgICAgICAgdmFyIGNvZGVsaXN0Q29sdW1ucywgX3RoaXMsIF9sb29wLCBfaTIsIF9jb2RlbGlzdENvbHVtbnM7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNCQoX2NvbnRleHQ1KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0NS5wcmV2ID0gX2NvbnRleHQ1Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBjb2RlbGlzdENvbHVtbnMgPSBbewogICAgICAgICAgICAgICAgICBuYW1lOiAnZWR1Y2F0aW9uJywKICAgICAgICAgICAgICAgICAgc3Jma2V5OiAnRWhyQ29kZUxpc3QwMTE3JywKICAgICAgICAgICAgICAgICAgY29kZWxpc3RUeXBlOiAnRFlOQU1JQycsCiAgICAgICAgICAgICAgICAgIHRleHRTZXBhcmF0b3I6ICfjgIEnLAogICAgICAgICAgICAgICAgICByZW5kZXJNb2RlOiAnc3RyaW5nJywKICAgICAgICAgICAgICAgICAgdmFsdWVTZXBhcmF0b3I6ICI7IgogICAgICAgICAgICAgICAgfSwgewogICAgICAgICAgICAgICAgICBuYW1lOiAnZGFzdGF0ZScsCiAgICAgICAgICAgICAgICAgIHNyZmtleTogJ0VockNvZGVMaXN0MDA1NycsCiAgICAgICAgICAgICAgICAgIGNvZGVsaXN0VHlwZTogJ1NUQVRJQycsCiAgICAgICAgICAgICAgICAgIHRleHRTZXBhcmF0b3I6ICfjgIEnLAogICAgICAgICAgICAgICAgICByZW5kZXJNb2RlOiAnc3RyaW5nJywKICAgICAgICAgICAgICAgICAgdmFsdWVTZXBhcmF0b3I6ICI7IgogICAgICAgICAgICAgICAgfV07CiAgICAgICAgICAgICAgICBfdGhpcyA9IHRoaXM7CiAgICAgICAgICAgICAgICBfbG9vcCA9CiAgICAgICAgICAgICAgICAvKiNfX1BVUkVfXyovCiAgICAgICAgICAgICAgICByZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfbG9vcCgpIHsKICAgICAgICAgICAgICAgICAgdmFyIGNvZGVsaXN0LCBpdGVtcywgX2l0ZW1zOwoKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9sb29wJChfY29udGV4dDQpIHsKICAgICAgICAgICAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dDQucHJldiA9IF9jb250ZXh0NC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlbGlzdCA9IF9jb2RlbGlzdENvbHVtbnNbX2kyXTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFPYmplY3QuaXMoY29kZWxpc3QuY29kZWxpc3RUeXBlLCAiRFlOQU1JQyIpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfY29udGV4dDQubmV4dCA9IDg7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICAgIF9jb250ZXh0NC5uZXh0ID0gNDsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuY29kZUxpc3RTZXJ2aWNlLmdldEl0ZW1zKGNvZGVsaXN0LnNyZmtleSk7CgogICAgICAgICAgICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXMgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd1tjb2RlbGlzdC5uYW1lXSA9IF90aGlzLmdldENvZGVsaXN0VmFsdWUoaXRlbXMsIHJvd1tjb2RlbGlzdC5uYW1lXSwgY29kZWxpc3QpOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0pOyAvLyDpnZnmgIHlpITnkIYKCiAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgODoKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIU9iamVjdC5pcyhjb2RlbGlzdC5jb2RlbGlzdFR5cGUsICJTVEFUSUMiKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgICAgX2NvbnRleHQ0Lm5leHQgPSAxMTsKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuJHN0b3JlLmdldHRlcnMuZ2V0Q29kZUxpc3RJdGVtcyhjb2RlbGlzdC5zcmZrZXkpOwoKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgICAgICAgICAgICBfaXRlbXMgPSBfY29udGV4dDQuc2VudDsKICAgICAgICAgICAgICAgICAgICAgICAgICBqc29uRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChyb3cpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvd1tjb2RlbGlzdC5uYW1lXSA9IF90aGlzLmdldENvZGVsaXN0VmFsdWUoX2l0ZW1zLCByb3dbY29kZWxpc3QubmFtZV0sIGNvZGVsaXN0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMTM6CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NC5zdG9wKCk7CiAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICB9LCBfbG9vcCk7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIF9pMiA9IDAsIF9jb2RlbGlzdENvbHVtbnMgPSBjb2RlbGlzdENvbHVtbnM7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICAgIGlmICghKF9pMiA8IF9jb2RlbGlzdENvbHVtbnMubGVuZ3RoKSkgewogICAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDUuZGVsZWdhdGVZaWVsZChfbG9vcCgpLCAidDAiLCA2KTsKCiAgICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgICAgX2kyKys7CiAgICAgICAgICAgICAgICBfY29udGV4dDUubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5hYnJ1cHQoInJldHVybiIsIGpzb25EYXRhLm1hcChmdW5jdGlvbiAodikgewogICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyVmFsLm1hcChmdW5jdGlvbiAoaikgewogICAgICAgICAgICAgICAgICAgIHJldHVybiB2W2pdOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pKTsKCiAgICAgICAgICAgICAgY2FzZSAxMDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0NS5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlNCwgdGhpcyk7CiAgICAgIH0pKTsKCiAgICAgIGZ1bmN0aW9uIGZvcm1hdEV4Y2VsRGF0YShfeDMsIF94NCkgewogICAgICAgIHJldHVybiBfZm9ybWF0RXhjZWxEYXRhLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBmb3JtYXRFeGNlbERhdGE7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIOino+aekOS7o+eggeihqOWSjHZsYXVl77yM6K6+572uaXRlbXMNCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0ge2FueVtdfSBpdGVtcyDku6PnoIHooajmlbDmja4NCiAgICAgKiBAcGFyYW0geyp9IHZhbHVlDQogICAgICogQHJldHVybnMgeyp9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q29kZWxpc3RWYWx1ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Q29kZWxpc3RWYWx1ZShpdGVtcywgdmFsdWUsIGNvZGVsaXN0KSB7CiAgICAgIHZhciBfdGhpczkgPSB0aGlzOwoKICAgICAgaWYgKCF2YWx1ZSkgewogICAgICAgIHJldHVybiB0aGlzLiR0KCdjb2RlbGlzdC4nICsgY29kZWxpc3Quc3Jma2V5ICsgJy5lbXB0eScpOwogICAgICB9CgogICAgICBpZiAoaXRlbXMpIHsKICAgICAgICB2YXIgcmVzdWx0ID0gW107CgogICAgICAgIGlmIChPYmplY3QuaXMoY29kZWxpc3QucmVuZGVyTW9kZSwgIm51bWJlciIpKSB7CiAgICAgICAgICBpdGVtcy5tYXAoZnVuY3Rpb24gKF9pdGVtLCBpbmRleCkgewogICAgICAgICAgICB2YXIgblZhbHVlID0gcGFyc2VJbnQodmFsdWUsIDEwKTsKICAgICAgICAgICAgdmFyIGNvZGV2YWx1ZSA9IF9pdGVtLnZhbHVlOwoKICAgICAgICAgICAgaWYgKChwYXJzZUludChjb2RldmFsdWUsIDEwKSAmIG5WYWx1ZSkgPiAwKSB7CiAgICAgICAgICAgICAgcmVzdWx0LnB1c2goX2l0ZW0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgaWYgKE9iamVjdC5pcyhjb2RlbGlzdC5yZW5kZXJNb2RlLCAic3RyaW5nIikpIHsKICAgICAgICAgIHZhciBhcnJheVZhbHVlID0gdmFsdWUuc3BsaXQoY29kZWxpc3QudmFsdWVTZXBhcmF0b3IpOwogICAgICAgICAgYXJyYXlWYWx1ZS5tYXAoZnVuY3Rpb24gKHZhbHVlLCBpbmRleCkgewogICAgICAgICAgICByZXN1bHQucHVzaChbXSk7CiAgICAgICAgICAgIHZhciB2YWx1ZXMgPSBPYmplY3QuaXMoX3RoaXM5LiR1dGlsLnR5cGVPZih2YWx1ZSksICdudW1iZXInKSA/IFt2YWx1ZV0gOiBfdG9Db25zdW1hYmxlQXJyYXkodmFsdWUuc3BsaXQoY29kZWxpc3QudmFsdWVTZXBhcmF0b3IpKTsKICAgICAgICAgICAgdmFsdWVzLm1hcChmdW5jdGlvbiAodmFsLCBudW0pIHsKICAgICAgICAgICAgICB2YXIgaXRlbSA9IF90aGlzOS5nZXRJdGVtKGl0ZW1zLCB2YWwsIGNvZGVsaXN0KTsKCiAgICAgICAgICAgICAgaWYgKGl0ZW0pIHsKICAgICAgICAgICAgICAgIHJlc3VsdFtpbmRleF0ucHVzaChpdGVtKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHZhciB2YWx1ZXMgPSBPYmplY3QuaXModGhpcy4kdXRpbC50eXBlT2YodmFsdWUpLCAnbnVtYmVyJykgPyBbdmFsdWVdIDogX3RvQ29uc3VtYWJsZUFycmF5KHZhbHVlLnNwbGl0KGNvZGVsaXN0LnZhbHVlU2VwYXJhdG9yKSk7CiAgICAgICAgICB2YWx1ZXMubWFwKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgpIHsKICAgICAgICAgICAgdmFyIGl0ZW0gPSBfdGhpczkuZ2V0SXRlbShpdGVtcywgdmFsdWUsIGNvZGVsaXN0KTsKCiAgICAgICAgICAgIGlmIChpdGVtKSB7CiAgICAgICAgICAgICAgcmVzdWx0LnB1c2goaXRlbSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0pOwogICAgICAgIH0gLy8g6K6+572uaXRlbXMKCgogICAgICAgIGlmIChyZXN1bHQubGVuZ3RoICE9IDApIHsKICAgICAgICAgIHJldHVybiByZXN1bHQuam9pbihjb2RlbGlzdC52YWx1ZVNlcGFyYXRvcik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOiOt+WPluS7o+eggemhuQ0KICAgICAqDQogICAgICogQHB1YmxpYw0KICAgICAqIEBwYXJhbSB7YW55W119IGl0ZW1zDQogICAgICogQHBhcmFtIHsqfSB2YWx1ZQ0KICAgICAqIEByZXR1cm5zIHsqfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldEl0ZW0iLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldEl0ZW0oaXRlbXMsIHZhbHVlLCBjb2RlbGlzdCkgewogICAgICB2YXIgYXJyID0gaXRlbXMuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0udmFsdWUgPT0gdmFsdWU7CiAgICAgIH0pOwoKICAgICAgaWYgKGFyci5sZW5ndGggIT09IDEpIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CgogICAgICBpZiAoT2JqZWN0LmlzKGNvZGVsaXN0LmNvZGVsaXN0VHlwZSwgJ1NUQVRJQycpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHQoJ2NvZGVsaXN0LicgKyBjb2RlbGlzdC5zcmZrZXkgKyAnLicgKyBhcnJbMF0udmFsdWUpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBhcnJbMF0udGV4dDsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog55Sf5ZG95ZGo5pyfDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJjcmVhdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgICB0aGlzLmFmdGVyQ3JlYXRlZCgpOwogICAgfQogICAgLyoqDQogICAgICog5omn6KGMY3JlYXRlZOWQjueahOmAu+i+kQ0KICAgICAqDQogICAgICogIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImFmdGVyQ3JlYXRlZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gYWZ0ZXJDcmVhdGVkKCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICB0aGlzLnNldENvbFN0YXRlKCk7CgogICAgICBpZiAodGhpcy52aWV3U3RhdGUpIHsKICAgICAgICB0aGlzLnZpZXdTdGF0ZUV2ZW50ID0gdGhpcy52aWV3U3RhdGUuc3Vic2NyaWJlKGZ1bmN0aW9uIChfcmVmMykgewogICAgICAgICAgdmFyIHRhZyA9IF9yZWYzLnRhZywKICAgICAgICAgICAgICBhY3Rpb24gPSBfcmVmMy5hY3Rpb24sCiAgICAgICAgICAgICAgZGF0YSA9IF9yZWYzLmRhdGE7CgogICAgICAgICAgaWYgKCFPYmplY3QuaXModGFnLCBfdGhpczEwLm5hbWUpKSB7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdsb2FkJywgYWN0aW9uKSkgewogICAgICAgICAgICBfdGhpczEwLmxvYWQoZGF0YSk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKE9iamVjdC5pcygncmVtb3ZlJywgYWN0aW9uKSkgewogICAgICAgICAgICBfdGhpczEwLnJlbW92ZShkYXRhKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoT2JqZWN0LmlzKCdzYXZlJywgYWN0aW9uKSkgewogICAgICAgICAgICBfdGhpczEwLnNhdmUoZGF0YSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIHZ1ZSDnlJ/lkb3lkajmnJ8NCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImRlc3Ryb3llZCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveWVkKCkgewogICAgICB0aGlzLmFmdGVyRGVzdHJveSgpOwogICAgfQogICAgLyoqDQogICAgICog5omn6KGMZGVzdHJveWVk5ZCO55qE6YC76L6RDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJhZnRlckRlc3Ryb3kiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGFmdGVyRGVzdHJveSgpIHsKICAgICAgaWYgKHRoaXMudmlld1N0YXRlRXZlbnQpIHsKICAgICAgICB0aGlzLnZpZXdTdGF0ZUV2ZW50LnVuc3Vic2NyaWJlKCk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOiOt+WPlumAieS4reihjOiDoeaVsOaNrg0KICAgICAqDQogICAgICogQHJldHVybnMge2FueVtdfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldFNlbGVjdGlvbiIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U2VsZWN0aW9uKCkgewogICAgICByZXR1cm4gdGhpcy5zZWxlY3Rpb25zOwogICAgfQogICAgLyoqDQogICAgICog6KGM5Y+M5Ye75LqL5Lu2DQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInJvd0RCTENsaWNrIiwKICAgIHZhbHVlOiBmdW5jdGlvbiByb3dEQkxDbGljaygkZXZlbnQpIHsKICAgICAgaWYgKCEkZXZlbnQgfHwgdGhpcy5hY3R1YWxJc09wZW5FZGl0IHx8IE9iamVjdC5pcyh0aGlzLmdyaWRSb3dBY3RpdmVNb2RlLCAwKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgIHRoaXMuc2VsZWN0aW9ucy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoJGV2ZW50KSkpOwogICAgICB2YXIgcmVmcyA9IHRoaXMuJHJlZnM7CgogICAgICBpZiAocmVmcy5tdWx0aXBsZVRhYmxlKSB7CiAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLnRvZ2dsZVJvd1NlbGVjdGlvbigkZXZlbnQpOwogICAgICB9CgogICAgICB0aGlzLiRlbWl0KCdyb3dkYmxjbGljaycsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGlvbmNoYW5nZScsIHRoaXMuc2VsZWN0aW9ucyk7CiAgICB9CiAgICAvKioNCiAgICAgKiDlpI3pgInmoYbmlbDmja7pgInkuK0NCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2VsZWN0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBzZWxlY3QoJGV2ZW50KSB7CiAgICAgIGlmICghJGV2ZW50KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLnNlbGVjdGlvbnMgPSBbXTsKICAgICAgdGhpcy5zZWxlY3Rpb25zID0gX3RvQ29uc3VtYWJsZUFycmF5KEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkoJGV2ZW50KSkpOwogICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgfQogICAgLyoqDQogICAgICog5aSN6YCJ5qGG5pWw5o2u5YWo6YOo6YCJ5LitDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInNlbGVjdEFsbCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2VsZWN0QWxsKCRldmVudCkgewogICAgICBpZiAoISRldmVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5zZWxlY3Rpb25zID0gW107CiAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IF90b0NvbnN1bWFibGVBcnJheShKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KCRldmVudCkpKTsKICAgICAgdGhpcy4kZW1pdCgnc2VsZWN0aW9uY2hhbmdlJywgdGhpcy5zZWxlY3Rpb25zKTsKICAgIH0KICAgIC8qKg0KICAgICAqIOihjOWNleWHu+mAieS4rQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSAkZXZlbnQNCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJyb3dDbGljayIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcm93Q2xpY2soJGV2ZW50KSB7CiAgICAgIHZhciBpZkFsd2F5cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogZmFsc2U7CgogICAgICBpZiAoIWlmQWx3YXlzICYmICghJGV2ZW50IHx8IHRoaXMuYWN0dWFsSXNPcGVuRWRpdCkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLnN0b3BSb3dDbGljaykgewogICAgICAgIHRoaXMuc3RvcFJvd0NsaWNrID0gZmFsc2U7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5pc1NpbmdsZVNlbGVjdCkgewogICAgICAgIHRoaXMuc2VsZWN0aW9ucyA9IFtdOwogICAgICB9IC8vIOW3sumAieS4reWImeWIoOmZpO+8jOayoemAieS4reWImea3u+WKoAoKCiAgICAgIHZhciBzZWxlY3RJbmRleCA9IHRoaXMuc2VsZWN0aW9ucy5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmlzKGl0ZW0ucGltYXJjaGl2ZXMsICRldmVudC5waW1hcmNoaXZlcyk7CiAgICAgIH0pOwoKICAgICAgaWYgKE9iamVjdC5pcyhzZWxlY3RJbmRleCwgLTEpKSB7CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSgkZXZlbnQpKSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zZWxlY3Rpb25zLnNwbGljZShzZWxlY3RJbmRleCwgMSk7CiAgICAgIH0KCiAgICAgIHZhciByZWZzID0gdGhpcy4kcmVmczsKCiAgICAgIGlmIChyZWZzLm11bHRpcGxlVGFibGUpIHsKICAgICAgICBpZiAodGhpcy5pc1NpbmdsZVNlbGVjdCkgewogICAgICAgICAgcmVmcy5tdWx0aXBsZVRhYmxlLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUuc2V0Q3VycmVudFJvdygkZXZlbnQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZWZzLm11bHRpcGxlVGFibGUudG9nZ2xlUm93U2VsZWN0aW9uKCRldmVudCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLiRlbWl0KCdzZWxlY3Rpb25jaGFuZ2UnLCB0aGlzLnNlbGVjdGlvbnMpOwogICAgfQogICAgLyoqDQogICAgICog6aG16Z2i5Y+Y5YyWDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInBhZ2VPbkNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGFnZU9uQ2hhbmdlKCRldmVudCkgewogICAgICBpZiAoISRldmVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCRldmVudCA9PT0gdGhpcy5jdXJQYWdlKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLmN1clBhZ2UgPSAkZXZlbnQ7CiAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDliIbpobXmnaHmlbDlj5jljJYNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQHJldHVybnMge3ZvaWR9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25QYWdlU2l6ZUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25QYWdlU2l6ZUNoYW5nZSgkZXZlbnQpIHsKICAgICAgaWYgKCEkZXZlbnQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICgkZXZlbnQgPT09IHRoaXMubGltaXQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHRoaXMubGltaXQgPSAkZXZlbnQ7CgogICAgICBpZiAodGhpcy5jdXJQYWdlID09PSAxKSB7CiAgICAgICAgdGhpcy5sb2FkKHt9KTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog5YiG6aG15Yi35pawDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJwYWdlUmVmcmVzaCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gcGFnZVJlZnJlc2goKSB7CiAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmjpLluo/lj5jljJYNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7eyBjb2x1bW46IGFueSwgcHJvcDogYW55LCBvcmRlcjogYW55IH19IHsgY29sdW1uLCBwcm9wLCBvcmRlciB9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25Tb3J0Q2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNvcnRDaGFuZ2UoX3JlZjQpIHsKICAgICAgdmFyIGNvbHVtbiA9IF9yZWY0LmNvbHVtbiwKICAgICAgICAgIHByb3AgPSBfcmVmNC5wcm9wLAogICAgICAgICAgb3JkZXIgPSBfcmVmNC5vcmRlcjsKICAgICAgdmFyIGRpciA9IE9iamVjdC5pcyhvcmRlciwgJ2FzY2VuZGluZycpID8gJ2FzYycgOiBPYmplY3QuaXMob3JkZXIsICdkZXNjZW5kaW5nJykgPyAnZGVzYycgOiAnJzsKCiAgICAgIGlmIChPYmplY3QuaXMoZGlyLCB0aGlzLm1pbm9yU29ydERpcikgJiYgT2JqZWN0LmlzKHRoaXMubWlub3JTb3J0UFNERUYsIHByb3ApKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB0aGlzLm1pbm9yU29ydERpciA9IGRpcjsKICAgICAgdGhpcy5taW5vclNvcnRQU0RFRiA9IHByb3AgPyBwcm9wIDogJyc7CiAgICAgIHRoaXMubG9hZCh7fSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDooajmoLzooYzpgInkuK3moLflvI8NCiAgICAgKg0KICAgICAqIEBwYXJhbSB7eyByb3c6IGFueSwgcm93SW5kZXg6IGFueSB9fSB7IHJvdywgcm93SW5kZXggfQ0KICAgICAqIEByZXR1cm5zIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25Sb3dDbGFzc05hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uUm93Q2xhc3NOYW1lKF9yZWY1KSB7CiAgICAgIHZhciByb3cgPSBfcmVmNS5yb3csCiAgICAgICAgICByb3dJbmRleCA9IF9yZWY1LnJvd0luZGV4OwogICAgICB2YXIgaW5kZXggPSB0aGlzLnNlbGVjdGlvbnMuZmluZEluZGV4KGZ1bmN0aW9uIChzZWxlY3QpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmlzKHNlbGVjdC5zcmZrZXksIHJvdy5zcmZrZXkpOwogICAgICB9KTsKICAgICAgcmV0dXJuIGluZGV4ICE9PSAtMSA/ICdncmlkLXJvdy1zZWxlY3QnIDogJyc7CiAgICB9CiAgICAvKioNCiAgICAgKiDnlYzpnaLooYzkuLoNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gcm93DQogICAgICogQHBhcmFtIHsqfSB0YWcNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInVpQWN0aW9uIiwKICAgIHZhbHVlOiBmdW5jdGlvbiB1aUFjdGlvbihyb3csIHRhZywgJGV2ZW50KSB7CiAgICAgIC8vIHRoaXMucm93Q2xpY2socm93LCB0cnVlKTsKICAgICAgJGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpOwogICAgfQogICAgLyoqDQogICAgICog6K6+572u5YiX54q25oCBDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJzZXRDb2xTdGF0ZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gc2V0Q29sU3RhdGUoKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIHZhciBfZGF0YSA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdwaW1hcmNoaXZlc19tYWluXzJfZ3JpZCcpOwoKICAgICAgaWYgKF9kYXRhKSB7CiAgICAgICAgdmFyIGNvbHVtbnMgPSBKU09OLnBhcnNlKF9kYXRhKTsKICAgICAgICBjb2x1bW5zLmZvckVhY2goZnVuY3Rpb24gKGNvbCkgewogICAgICAgICAgdmFyIGNvbHVtbiA9IF90aGlzMTEuYWxsQ29sdW1ucy5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiBPYmplY3QuaXMoY29sLm5hbWUsIGl0ZW0ubmFtZSk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICBpZiAoY29sdW1uKSB7CiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24oY29sdW1uLCBjb2wpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDliJflj5jljJYNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uQ29sQ2hhbmdlIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvbkNvbENoYW5nZSgpIHsKICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BpbWFyY2hpdmVzX21haW5fMl9ncmlkJywgSlNPTi5zdHJpbmdpZnkodGhpcy5hbGxDb2x1bW5zKSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5bliJfnirbmgIENCiAgICAgKg0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lDQogICAgICogQHJldHVybnMge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiZ2V0Q29sdW1uU3RhdGUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENvbHVtblN0YXRlKG5hbWUpIHsKICAgICAgdmFyIGNvbHVtbiA9IHRoaXMuYWxsQ29sdW1ucy5maW5kKGZ1bmN0aW9uIChjb2wpIHsKICAgICAgICByZXR1cm4gT2JqZWN0LmlzKG5hbWUsIGNvbC5uYW1lKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBjb2x1bW4uc2hvdyA/IHRydWUgOiBmYWxzZTsKICAgIH0KICAgIC8qKg0KICAgICAqIOihqOagvOWIl+aYr+WQpuiHqumAguW6lOW4g+WxgA0KICAgICAqDQogICAgICogQHJlYWRvbmx5DQogICAgICogQHR5cGUge2Jvb2xlYW59DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAic2F2ZSIsCgogICAgLyoqDQogICAgICog5L+d5a2YDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59DQogICAgICogQG1lbWJlcm9mIE1haW5fMkJhc2UNCiAgICAgKi8KICAgIHZhbHVlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBfc2F2ZSA9IF9hc3luY1RvR2VuZXJhdG9yKAogICAgICAvKiNfX1BVUkVfXyovCiAgICAgIHJlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWU1KGFyZ3MsIHBhcmFtcywgJGV2ZW50LCB4RGF0YSkgewogICAgICAgIHZhciBfdGhpczEyID0gdGhpczsKCiAgICAgICAgdmFyIF90aGlzLCBzdWNjZXNzSXRlbXMsIGVycm9ySXRlbXMsIGVycm9yTWVzc2FnZSwgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIsIF9kaWRJdGVyYXRvckVycm9yMiwgX2l0ZXJhdG9yRXJyb3IyLCBfaXRlcmF0b3IyLCBfc3RlcDIsIGl0ZW0sIHJlc3BvbnNlLCBfcmVzcG9uc2U7CgogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlNSQoX2NvbnRleHQ2KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0Ni5wcmV2ID0gX2NvbnRleHQ2Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBfdGhpcyA9IHRoaXM7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDM7CiAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy52YWxpZGF0ZUFsbCgpOwoKICAgICAgICAgICAgICBjYXNlIDM6CiAgICAgICAgICAgICAgICBpZiAoX2NvbnRleHQ2LnNlbnQpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA2OwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgICAgICAgIGRlc2M6ICflgLzop4TliJnmoKHpqozlvILluLgnCiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCBbXSk7CgogICAgICAgICAgICAgIGNhc2UgNjoKICAgICAgICAgICAgICAgIHN1Y2Nlc3NJdGVtcyA9IFtdOwogICAgICAgICAgICAgICAgZXJyb3JJdGVtcyA9IFtdOwogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlID0gW107CiAgICAgICAgICAgICAgICBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWU7CiAgICAgICAgICAgICAgICBfZGlkSXRlcmF0b3JFcnJvcjIgPSBmYWxzZTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yMiA9IHVuZGVmaW5lZDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gMTI7CiAgICAgICAgICAgICAgICBfaXRlcmF0b3IyID0gX3RoaXMuaXRlbXNbU3ltYm9sLml0ZXJhdG9yXSgpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgICAgaWYgKF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gKF9zdGVwMiA9IF9pdGVyYXRvcjIubmV4dCgpKS5kb25lKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNDk7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGl0ZW0gPSBfc3RlcDIudmFsdWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDE2OwoKICAgICAgICAgICAgICAgIGlmICghT2JqZWN0LmlzKGl0ZW0ucm93RGF0YVN0YXRlLCAnY3JlYXRlJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMuY3JlYXRlQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMjI7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgZGVzYzogJ1BJTUFSQ0hJVkVTUGltRGFuZ2FHcmlkVmlld+inhuWbvuihqOagvGNyZWF0ZUFjdGlvbuWPguaVsOacqumFjee9ricKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSAyNzsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDIyOgogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihpdGVtLCB7CiAgICAgICAgICAgICAgICAgIHZpZXdwYXJhbXM6IHRoaXMudmlld3BhcmFtcwogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDI1OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZS5hZGQodGhpcy5jcmVhdGVBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGl0ZW0sIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwoKICAgICAgICAgICAgICBjYXNlIDI1OgogICAgICAgICAgICAgICAgcmVzcG9uc2UgPSBfY29udGV4dDYuc2VudDsKICAgICAgICAgICAgICAgIHN1Y2Nlc3NJdGVtcy5wdXNoKEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkocmVzcG9uc2UuZGF0YSkpKTsKCiAgICAgICAgICAgICAgY2FzZSAyNzoKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNDA7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAyOToKICAgICAgICAgICAgICAgIGlmICghT2JqZWN0LmlzKGl0ZW0ucm93RGF0YVN0YXRlLCAndXBkYXRlJykpIHsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0MDsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgaWYgKHRoaXMudXBkYXRlQWN0aW9uKSB7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMzQ7CiAgICAgICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgICAgICAgZGVzYzogJ1BJTUFSQ0hJVkVTUGltRGFuZ2FHcmlkVmlld+inhuWbvuihqOagvHVwZGF0ZUFjdGlvbuWPguaVsOacqumFjee9ricKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0MDsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDM0OgogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihpdGVtLCB7CiAgICAgICAgICAgICAgICAgIHZpZXdwYXJhbXM6IHRoaXMudmlld3BhcmFtcwogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgaWYgKGl0ZW0ucGltYXJjaGl2ZXMpIHsKICAgICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih0aGlzLmNvbnRleHQsIHsKICAgICAgICAgICAgICAgICAgICBwaW1hcmNoaXZlczogaXRlbS5waW1hcmNoaXZlcwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDM4OwogICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuc2VydmljZS5hZGQodGhpcy51cGRhdGVBY3Rpb24sIEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5jb250ZXh0KSksIGl0ZW0sIHRoaXMuc2hvd0J1c3lJbmRpY2F0b3IpOwoKICAgICAgICAgICAgICBjYXNlIDM4OgogICAgICAgICAgICAgICAgX3Jlc3BvbnNlID0gX2NvbnRleHQ2LnNlbnQ7CiAgICAgICAgICAgICAgICBzdWNjZXNzSXRlbXMucHVzaChKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KF9yZXNwb25zZS5kYXRhKSkpOwoKICAgICAgICAgICAgICBjYXNlIDQwOgogICAgICAgICAgICAgICAgX2NvbnRleHQ2Lm5leHQgPSA0NjsKICAgICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgICBjYXNlIDQyOgogICAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSA0MjsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni50MCA9IF9jb250ZXh0NlsiY2F0Y2giXSgxNik7CiAgICAgICAgICAgICAgICBlcnJvckl0ZW1zLnB1c2goSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShpdGVtKSkpOwogICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlLnB1c2goX2NvbnRleHQ2LnQwKTsKCiAgICAgICAgICAgICAgY2FzZSA0NjoKICAgICAgICAgICAgICAgIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA0OToKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5uZXh0ID0gNTU7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSA1MToKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gNTE7CiAgICAgICAgICAgICAgICBfY29udGV4dDYudDEgPSBfY29udGV4dDZbImNhdGNoIl0oMTIpOwogICAgICAgICAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTsKICAgICAgICAgICAgICAgIF9pdGVyYXRvckVycm9yMiA9IF9jb250ZXh0Ni50MTsKCiAgICAgICAgICAgICAgY2FzZSA1NToKICAgICAgICAgICAgICAgIF9jb250ZXh0Ni5wcmV2ID0gNTU7CiAgICAgICAgICAgICAgICBfY29udGV4dDYucHJldiA9IDU2OwoKICAgICAgICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgJiYgX2l0ZXJhdG9yMlsicmV0dXJuIl0gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICBfaXRlcmF0b3IyWyJyZXR1cm4iXSgpOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICBjYXNlIDU4OgogICAgICAgICAgICAgICAgX2NvbnRleHQ2LnByZXYgPSA1ODsKCiAgICAgICAgICAgICAgICBpZiAoIV9kaWRJdGVyYXRvckVycm9yMikgewogICAgICAgICAgICAgICAgICBfY29udGV4dDYubmV4dCA9IDYxOwogICAgICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7CgogICAgICAgICAgICAgIGNhc2UgNjE6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmZpbmlzaCg1OCk7CgogICAgICAgICAgICAgIGNhc2UgNjI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LmZpbmlzaCg1NSk7CgogICAgICAgICAgICAgIGNhc2UgNjM6CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzYXZlJywgc3VjY2Vzc0l0ZW1zKTsKICAgICAgICAgICAgICAgIHRoaXMucmVmcmVzaChbXSk7CgogICAgICAgICAgICAgICAgaWYgKGVycm9ySXRlbXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICAgICAgICAgIHRoaXMuJE5vdGljZS5zdWNjZXNzKHsKICAgICAgICAgICAgICAgICAgICB0aXRsZTogJycsCiAgICAgICAgICAgICAgICAgICAgZGVzYzogJ+S/neWtmOaIkOWKnyEnCiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgZXJyb3JJdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkgewogICAgICAgICAgICAgICAgICAgIF90aGlzMTIuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ+S/neWtmOWksei0pScsCiAgICAgICAgICAgICAgICAgICAgICBkZXNjOiBpdGVtLm1ham9yZW50aXR5bmFtZSArICfkv53lrZjlpLHotKXvvIEnCiAgICAgICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3JNZXNzYWdlW2luZGV4XSk7CiAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dDYuYWJydXB0KCJyZXR1cm4iLCBzdWNjZXNzSXRlbXMpOwoKICAgICAgICAgICAgICBjYXNlIDY3OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQ2LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWU1LCB0aGlzLCBbWzEyLCA1MSwgNTUsIDYzXSwgWzE2LCA0Ml0sIFs1NiwsIDU4LCA2Ml1dKTsKICAgICAgfSkpOwoKICAgICAgZnVuY3Rpb24gc2F2ZShfeDUsIF94NiwgX3g3LCBfeDgpIHsKICAgICAgICByZXR1cm4gX3NhdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNhdmU7CiAgICB9KCkKICAgIC8qKg0KICAgICAqIOaWsOW7uuihjA0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSAkZXZlbnQNCiAgICAgKiBAcmV0dXJucyB7dm9pZH0NCiAgICAgKiBAbWVtYmVyb2YgTWFpbl8yQmFzZQ0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJuZXdSb3ciLAogICAgdmFsdWU6IGZ1bmN0aW9uIG5ld1JvdyhhcmdzLCBwYXJhbXMsICRldmVudCwgeERhdGEpIHsKICAgICAgdmFyIF90aGlzMTMgPSB0aGlzOwoKICAgICAgaWYgKCF0aGlzLmxvYWRkcmFmdEFjdGlvbikgewogICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICBkZXNjOiAnUElNQVJDSElWRVNQaW1EYW5nYUdyaWRWaWV36KeG5Zu+6KGo5qC8bG9hZGRyYWZ0QWN0aW9u5Y+C5pWw5pyq6YWN572uJwogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIE9iamVjdC5hc3NpZ24oYXJnc1swXSwgewogICAgICAgIHZpZXdwYXJhbXM6IHRoaXMudmlld3BhcmFtcwogICAgICB9KTsKICAgICAgdmFyIHBvc3QgPSB0aGlzLnNlcnZpY2UubG9hZERyYWZ0KHRoaXMubG9hZGRyYWZ0QWN0aW9uLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpLCBhcmdzWzBdLCB0aGlzLnNob3dCdXN5SW5kaWNhdG9yKTsKICAgICAgcG9zdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmICghcmVzcG9uc2Uuc3RhdHVzIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZXJyb3JNZXNzYWdlKSB7CiAgICAgICAgICAgIF90aGlzMTMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgdGl0bGU6ICfplJnor68nLAogICAgICAgICAgICAgIGRlc2M6IHJlc3BvbnNlLmVycm9yTWVzc2FnZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgIF90aGlzMTMuY3JlYXRlRGVmYXVsdChkYXRhKTsKCiAgICAgICAgZGF0YS5yb3dEYXRhU3RhdGUgPSAiY3JlYXRlIjsKCiAgICAgICAgX3RoaXMuaXRlbXMucHVzaChkYXRhKTsKCiAgICAgICAgX3RoaXMuZ3JpZEl0ZW1zTW9kZWwucHVzaChfdGhpcy5nZXRHcmlkUm93TW9kZWwoKSk7CiAgICAgIH0pWyJjYXRjaCJdKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGlmIChyZXNwb25zZSAmJiByZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICBfdGhpczEzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgIGRlc2M6ICfns7vnu5/lvILluLgnCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICAgIC8qKg0KICAgICAqIOihqOagvOe8lui+kemhueWAvOWPmOabtA0KICAgICAqDQogICAgICogQHBhcmFtIHJvdyDooYzmlbDmja4NCiAgICAgKiBAcGFyYW0ge3sgbmFtZTogc3RyaW5nLCB2YWx1ZTogYW55IH19ICRldmVudA0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uR3JpZEl0ZW1WYWx1ZUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25HcmlkSXRlbVZhbHVlQ2hhbmdlKHJvdywgJGV2ZW50LCByb3dJbmRleCkgewogICAgICBpZiAoISRldmVudCkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKCEkZXZlbnQubmFtZSB8fCBPYmplY3QuaXMoJGV2ZW50Lm5hbWUsICcnKSB8fCAhcm93Lmhhc093blByb3BlcnR5KCRldmVudC5uYW1lKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgcm93WyRldmVudC5uYW1lXSA9ICRldmVudC52YWx1ZTsKICAgICAgdGhpcy5ncmlkRWRpdEl0ZW1DaGFuZ2Uocm93LCAkZXZlbnQubmFtZSwgJGV2ZW50LnZhbHVlLCByb3dJbmRleCk7CiAgICB9CiAgICAvKioNCiAgICAgKiDooajmoLznvJbovpHpobnlgLzlj5jljJYNCiAgICAgKg0KICAgICAqIEBwdWJsaWMNCiAgICAgKiBAcGFyYW0gcm93IOihjOaVsOaNrg0KICAgICAqIEBwYXJhbSBwcm9wZXJ0eSDliJfnvJbovpHpobnlkI0NCiAgICAgKiBAcGFyYW0gcm93IOWIl+e8lui+kemhueWAvA0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdyaWRFZGl0SXRlbUNoYW5nZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ3JpZEVkaXRJdGVtQ2hhbmdlKHJvdywgcHJvcGVydHksIHZhbHVlLCByb3dJbmRleCkgewogICAgICByb3cucm93RGF0YVN0YXRlID0gcm93LnJvd0RhdGFTdGF0ZSA/IHJvdy5yb3dEYXRhU3RhdGUgOiAidXBkYXRlIjsKICAgICAgdGhpcy52YWxpZGF0ZShwcm9wZXJ0eSwgcm93LCByb3dJbmRleCk7CiAgICB9CiAgICAvKioNCiAgICAgKiDooajmoLznvJbovpHpobnmm7TmlrANCiAgICAgKg0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSBtb2RlIOeVjOmdouihjOS4uuWQjeensA0KICAgICAqIEBwYXJhbSB7Kn0gW2RhdGE9e31dIOivt+axguaVsOaNrg0KICAgICAqIEBwYXJhbSB7c3RyaW5nW119IHVwZGF0ZURldGFpbHMg5pu05paw6aG5DQogICAgICogQHBhcmFtIHtib29sZWFufSBbc2hvd2xvYWRpbmddIOaYr+WQpuaYvuekuuWKoOi9veeKtuaAgQ0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogInVwZGF0ZUdyaWRFZGl0SXRlbSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlR3JpZEVkaXRJdGVtKG1vZGUpIHsKICAgICAgdmFyIF90aGlzMTQgPSB0aGlzOwoKICAgICAgdmFyIGRhdGEgPSBhcmd1bWVudHMubGVuZ3RoID4gMSAmJiBhcmd1bWVudHNbMV0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1sxXSA6IHt9OwogICAgICB2YXIgdXBkYXRlRGV0YWlscyA9IGFyZ3VtZW50cy5sZW5ndGggPiAyID8gYXJndW1lbnRzWzJdIDogdW5kZWZpbmVkOwogICAgICB2YXIgc2hvd2xvYWRpbmcgPSBhcmd1bWVudHMubGVuZ3RoID4gMyA/IGFyZ3VtZW50c1szXSA6IHVuZGVmaW5lZDsKCiAgICAgIGlmICghbW9kZSB8fCBtb2RlICYmIE9iamVjdC5pcyhtb2RlLCAnJykpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBhcmcgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGRhdGEpKTsKICAgICAgT2JqZWN0LmFzc2lnbihhcmcsIHsKICAgICAgICB2aWV3cGFyYW1zOiB0aGlzLnZpZXdwYXJhbXMKICAgICAgfSk7CiAgICAgIHZhciBwb3N0ID0gdGhpcy5zZXJ2aWNlLmZyb250TG9naWMobW9kZSwgSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmNvbnRleHQpKSwgYXJnLCBzaG93bG9hZGluZyk7CiAgICAgIHBvc3QudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICBfdGhpczE0LiROb3RpY2UuZXJyb3IoewogICAgICAgICAgICB0aXRsZTogJ+mUmeivrycsCiAgICAgICAgICAgIGRlc2M6ICfooajljZXpobnmm7TmlrDlpLHotKUnCiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB2YXIgX2RhdGEgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBpZiAoIV9kYXRhKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB1cGRhdGVEZXRhaWxzLmZvckVhY2goZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgICAgIGlmICghX2RhdGEuaGFzT3duUHJvcGVydHkobmFtZSkpIHsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGRhdGFbbmFtZV0gPSBfZGF0YVtuYW1lXTsKICAgICAgICB9KTsKICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKHJlc3BvbnNlICYmIHJlc3BvbnNlLnN0YXR1cyA9PT0gNDAxKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8ICFyZXNwb25zZS5zdGF0dXMgfHwgIXJlc3BvbnNlLmRhdGEpIHsKICAgICAgICAgIF90aGlzMTQuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiAn6ZSZ6K+vJywKICAgICAgICAgICAgZGVzYzogJ+ezu+e7n+W8guW4uCcKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog6I635Y+W5a+55bqU6KGMY2xhc3MNCiAgICAgKg0KICAgICAqIEBwYXJhbSB7Kn0gJGFyZ3Mgcm93IOihjOaVsOaNru+8jHJvd0luZGV4IOihjOe0ouW8lQ0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldFJvd0NsYXNzTmFtZSIsCiAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0Um93Q2xhc3NOYW1lKGFyZ3MpIHsKICAgICAgdmFyIGlzU2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGlvbnMuc29tZShmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBPYmplY3QuaXMoaXRlbS5waW1hcmNoaXZlcywgYXJncy5yb3cucGltYXJjaGl2ZXMpOwogICAgICB9KTsKICAgICAgcmV0dXJuIGlzU2VsZWN0ZWQgPyAiZ3JpZC1zZWxlY3RlZC1yb3ciIDogIiI7CiAgICB9CiAgICAvKioNCiAgICAgKiDojrflj5blr7nlupTliJdjbGFzcw0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSAkYXJncyByb3cg6KGM5pWw5o2u77yMY29sdW1uIOWIl+aVsOaNru+8jHJvd0luZGV4IOihjOe0ouW8le+8jOWIl+e0ouW8lQ0KICAgICAqIEByZXR1cm5zIHt2b2lkfQ0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImdldENlbGxDbGFzc05hbWUiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGdldENlbGxDbGFzc05hbWUoYXJncykgewogICAgICB2YXIgaGFzUm93RWRpdCA9IHsKICAgICAgICAnZGFiaCc6IGZhbHNlLAogICAgICAgICdvcm1vcmduYW1lMyc6IGZhbHNlLAogICAgICAgICdkYWJnZCc6IGZhbHNlLAogICAgICAgICdhcmNoaXZlc2NlbnRlcm5hbWUnOiBmYWxzZSwKICAgICAgICAnZWR1Y2F0aW9uJzogZmFsc2UsCiAgICAgICAgJ2RhdGVvZmJpcnRoJzogZmFsc2UsCiAgICAgICAgJ2pvaW5wYXJ0eWRhdGUnOiBmYWxzZSwKICAgICAgICAnc3RhcnR3b3JrZGF0YWUnOiBmYWxzZSwKICAgICAgICAnZGFzdGF0ZSc6IGZhbHNlCiAgICAgIH07CiAgICAgIHJldHVybiBoYXNSb3dFZGl0W2FyZ3MuY29sdW1uLnByb3BlcnR5XSAmJiB0aGlzLmFjdHVhbElzT3BlbkVkaXQgPyAiZWRpdC1jZWxsIiA6ICJpbmZvLWNlbGwiOwogICAgfQogICAgLyoqDQogICAgICog5paw5bu66buY6K6k5YC8DQogICAgICogQHBhcmFtIHsqfSAgcm93IOihjOaVsOaNrg0KICAgICAqIEBtZW1iZXJvZiBNYWluXzJCYXNlDQogICAgICovCgogIH0sIHsKICAgIGtleTogImNyZWF0ZURlZmF1bHQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGNyZWF0ZURlZmF1bHQocm93KSB7CiAgICAgIGlmIChyb3cuaGFzT3duUHJvcGVydHkoJ3BpbXBlcnNvbmlkJykpIHsKICAgICAgICByb3dbJ3BpbXBlcnNvbmlkJ10gPSB0aGlzLnZpZXdwYXJhbXNbJ3NyZnBhcmVudGtleSddOwogICAgICB9CiAgICB9CiAgfSwgewogICAga2V5OiAiYWRhcHRpdmVTdGF0ZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgcmV0dXJuICF0aGlzLmFsbENvbHVtbnMuZmluZChmdW5jdGlvbiAoY29sdW1uKSB7CiAgICAgICAgcmV0dXJuIGNvbHVtbi5zaG93ICYmIE9iamVjdC5pcyhjb2x1bW4udXRpbCwgJ1NUQVInKTsKICAgICAgfSk7CiAgICB9CiAgfV0pOwoKICByZXR1cm4gTWFpbl8yQmFzZTsKfShWdWUpOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgIm5hbWUiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgInZpZXdTdGF0ZSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5fMkJhc2UucHJvdG90eXBlLCAiY29udGV4dCIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5fMkJhc2UucHJvdG90eXBlLCAidmlld3BhcmFtcyIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5fMkJhc2UucHJvdG90eXBlLCAibmV3ZGF0YSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5fMkJhc2UucHJvdG90eXBlLCAib3BlbmRhdGEiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKHsKICAiZGVmYXVsdCI6IHRydWUKfSldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgInNob3dCdXN5SW5kaWNhdG9yIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbl8yQmFzZS5wcm90b3R5cGUsICJ1cGRhdGVBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgImZldGNoQWN0aW9uIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbl8yQmFzZS5wcm90b3R5cGUsICJyZW1vdmVBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgImxvYWRBY3Rpb24iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgImxvYWRkcmFmdEFjdGlvbiIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIE1haW5fMkJhc2UucHJvdG90eXBlLCAiY3JlYXRlQWN0aW9uIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCh7CiAgImRlZmF1bHQiOiBmYWxzZQp9KV0sIE1haW5fMkJhc2UucHJvdG90eXBlLCAiaXNTZWxlY3RGaXJzdERlZmF1bHQiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgImlzU2luZ2xlU2VsZWN0Iiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgTWFpbl8yQmFzZS5wcm90b3R5cGUsICJzZWxlY3RlZERhdGEiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtXYXRjaCgnc2VsZWN0ZWREYXRhJyldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgIm9uVmFsdWVDaGFuZ2UiLCBudWxsKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCh7CiAgImRlZmF1bHQiOiAyCn0pXSwgTWFpbl8yQmFzZS5wcm90b3R5cGUsICJncmlkUm93QWN0aXZlTW9kZSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoewogICJkZWZhdWx0IjogZmFsc2UKfSldLCBNYWluXzJCYXNlLnByb3RvdHlwZSwgImlzT3BlbkVkaXQiLCB2b2lkIDApOwoKTWFpbl8yQmFzZSA9IHRzbGliXzEuX19kZWNvcmF0ZShbQ29tcG9uZW50KHsKICBjb21wb25lbnRzOiB7fQp9KV0sIE1haW5fMkJhc2UpOwpleHBvcnQgZGVmYXVsdCBNYWluXzJCYXNlOw=="},null]}