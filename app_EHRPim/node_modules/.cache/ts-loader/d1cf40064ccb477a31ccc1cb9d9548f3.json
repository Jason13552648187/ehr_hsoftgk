{"remainingRequest":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js??ref--13-3!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\components\\app-picker\\app-picker.vue?vue&type=script&lang=ts&","dependencies":[{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\src\\components\\app-picker\\app-picker.vue","mtime":1630509408738},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1630511853252},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\babel-loader\\lib\\index.js","mtime":1630511852747},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\ts-loader\\index.js","mtime":1630511985412},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1630511852775},{"path":"F:\\crod项目\\人事管理系统2\\iBizEHR\\app_EHRPim\\node_modules\\vue-loader\\lib\\index.js","mtime":1630512070338}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3ltYm9sIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmlsdGVyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleCI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZvci1lYWNoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaXMtYXJyYXkiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0aWVzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmRlZmluZS1wcm9wZXJ0eSI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5nZXQtb3duLXByb3BlcnR5LWRlc2NyaXB0b3IiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QuZ2V0LW93bi1wcm9wZXJ0eS1kZXNjcmlwdG9ycyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5pcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC5rZXlzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnN0YXJ0cy13aXRoIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1jb2xsZWN0aW9ucy5mb3ItZWFjaCI7CmltcG9ydCBfZGVmaW5lUHJvcGVydHkgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2RlZmluZVByb3BlcnR5IjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkiOwppbXBvcnQgX2NsYXNzQ2FsbENoZWNrIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9jbGFzc0NhbGxDaGVjayI7CmltcG9ydCBfY3JlYXRlQ2xhc3MgZnJvbSAiRjpcXGNyb2RcdTk4NzlcdTc2RUVcXFx1NEVCQVx1NEU4Qlx1N0JBMVx1NzQwNlx1N0NGQlx1N0VERjJcXGlCaXpFSFJcXGFwcF9FSFJQaW1cXG5vZGVfbW9kdWxlc1xcQGJhYmVsXFxydW50aW1lL2hlbHBlcnMvZXNtL2NyZWF0ZUNsYXNzIjsKaW1wb3J0IF9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9wb3NzaWJsZUNvbnN0cnVjdG9yUmV0dXJuIjsKaW1wb3J0IF9nZXRQcm90b3R5cGVPZiBmcm9tICJGOlxcY3JvZFx1OTg3OVx1NzZFRVxcXHU0RUJBXHU0RThCXHU3QkExXHU3NDA2XHU3Q0ZCXHU3RURGMlxcaUJpekVIUlxcYXBwX0VIUlBpbVxcbm9kZV9tb2R1bGVzXFxAYmFiZWxcXHJ1bnRpbWUvaGVscGVycy9lc20vZ2V0UHJvdG90eXBlT2YiOwppbXBvcnQgX2luaGVyaXRzIGZyb20gIkY6XFxjcm9kXHU5ODc5XHU3NkVFXFxcdTRFQkFcdTRFOEJcdTdCQTFcdTc0MDZcdTdDRkJcdTdFREYyXFxpQml6RUhSXFxhcHBfRUhSUGltXFxub2RlX21vZHVsZXNcXEBiYWJlbFxccnVudGltZS9oZWxwZXJzL2VzbS9pbmhlcml0cyI7CgpmdW5jdGlvbiBvd25LZXlzKG9iamVjdCwgZW51bWVyYWJsZU9ubHkpIHsgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhvYmplY3QpOyBpZiAoT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scykgeyB2YXIgc3ltYm9scyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eVN5bWJvbHMob2JqZWN0KTsgaWYgKGVudW1lcmFibGVPbmx5KSBzeW1ib2xzID0gc3ltYm9scy5maWx0ZXIoZnVuY3Rpb24gKHN5bSkgeyByZXR1cm4gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHN5bSkuZW51bWVyYWJsZTsgfSk7IGtleXMucHVzaC5hcHBseShrZXlzLCBzeW1ib2xzKTsgfSByZXR1cm4ga2V5czsgfQoKZnVuY3Rpb24gX29iamVjdFNwcmVhZCh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXSAhPSBudWxsID8gYXJndW1lbnRzW2ldIDoge307IGlmIChpICUgMikgeyBvd25LZXlzKE9iamVjdChzb3VyY2UpLCB0cnVlKS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHsgX2RlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCBzb3VyY2Vba2V5XSk7IH0pOyB9IGVsc2UgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3JzKSB7IE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcnMoc291cmNlKSk7IH0gZWxzZSB7IG93bktleXMoT2JqZWN0KHNvdXJjZSkpLmZvckVhY2goZnVuY3Rpb24gKGtleSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3Ioc291cmNlLCBrZXkpKTsgfSk7IH0gfSByZXR1cm4gdGFyZ2V0OyB9CgppbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gInRzbGliIjsKaW1wb3J0IHsgQ29tcG9uZW50LCBWdWUsIFByb3AsIE1vZGVsLCBXYXRjaCB9IGZyb20gJ3Z1ZS1wcm9wZXJ0eS1kZWNvcmF0b3InOwoKdmFyIEFwcFBpY2tlciA9Ci8qI19fUFVSRV9fKi8KZnVuY3Rpb24gKF9WdWUpIHsKICBfaW5oZXJpdHMoQXBwUGlja2VyLCBfVnVlKTsKCiAgZnVuY3Rpb24gQXBwUGlja2VyKCkgewogICAgdmFyIF90aGlzOwoKICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBBcHBQaWNrZXIpOwoKICAgIF90aGlzID0gX3Bvc3NpYmxlQ29uc3RydWN0b3JSZXR1cm4odGhpcywgX2dldFByb3RvdHlwZU9mKEFwcFBpY2tlcikuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgICAvKioNCiAgICAgKiDlvZPliY3lgLwNCiAgICAgKg0KICAgICAqIEB0eXBlIHtzdHJpbmd9DQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICAgIF90aGlzLmN1cnZhbHVlID0gJyc7CiAgICAvKioNCiAgICAgKiDkuIvmi4nmlbDnu4QNCiAgICAgKiBAdHlwZSB7YW55W119DQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICAgIF90aGlzLml0ZW1zID0gW107CiAgICAvKioNCiAgICAgKiDkuIvmi4nlm77moIfmjIflkJHnirbmgIHnrqHnkIYNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgQXBwUGlja2VyDQogICAgICovCgogICAgX3RoaXMub3BlbiA9IGZhbHNlOwogICAgLyoqDQogICAgICog6L6T5YWl54q25oCBDQogICAgICoNCiAgICAgKiBAdHlwZSB7Ym9vbGVhbn0NCiAgICAgKiBAbWVtYmVyb2YgQXBwQXV0b2NvbXBsZXRlDQogICAgICovCgogICAgX3RoaXMuaW5wdXRTdGF0ZSA9IGZhbHNlOwogICAgLyoqDQogICAgICAqIOW9k+WJjemAieaLqeeahOWAvA0KICAgICAgKg0KICAgICAgKiBAdHlwZSB7c3RyaW5nfQ0KICAgICAgKiBAbWVtYmVyb2YgQXBwUGlja2VyDQogICAgICAqLwoKICAgIF90aGlzLnNlbGVjdFZhbHVlID0gX3RoaXMudmFsdWU7CiAgICByZXR1cm4gX3RoaXM7CiAgfQogIC8qKg0KICAgKiDojrflj5blhbPogZTmlbDmja7pobnlgLwNCiAgICoNCiAgICogQHJlYWRvbmx5DQogICAqIEBtZW1iZXJvZiBBcHBQaWNrZXINCiAgICovCgoKICBfY3JlYXRlQ2xhc3MoQXBwUGlja2VyLCBbewogICAga2V5OiAib25WYWx1ZUNoYW5nZSIsCgogICAgLyoqDQogICAgICog5YC85Y+Y5YyWDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IG5ld1ZhbA0KICAgICAqIEBwYXJhbSB7Kn0gb2xkVmFsDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwogICAgdmFsdWU6IGZ1bmN0aW9uIG9uVmFsdWVDaGFuZ2UobmV3VmFsLCBvbGRWYWwpIHsKICAgICAgdGhpcy5jdXJ2YWx1ZSA9IG5ld1ZhbDsKCiAgICAgIGlmIChPYmplY3QuaXModGhpcy5lZGl0b3J0eXBlLCAnZHJvcGRvd24nKSAmJiB0aGlzLnZhbHVlaXRlbSkgewogICAgICAgIHZhciB2YWx1ZSA9IHRoaXMuZGF0YVt0aGlzLnZhbHVlaXRlbV07CiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5pdGVtcy5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBPYmplY3QuaXMoaXRlbS52YWx1ZSwgdmFsdWUpOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQoKICAgICAgICB0aGlzLml0ZW1zID0gW107CgogICAgICAgIGlmICh2YWx1ZSkgewogICAgICAgICAgdGhpcy5pdGVtcy5wdXNoKHsKICAgICAgICAgICAgdGV4dDogbmV3VmFsLAogICAgICAgICAgICB2YWx1ZTogdmFsdWUKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5vblNlYXJjaChuZXdWYWwsIG51bGwsIGZhbHNlKTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICogdnVlIOeUn+WRveWRqOacnw0KICAgICAqDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJjcmVhdGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgICBpZiAoT2JqZWN0LmlzKHRoaXMuZWRpdG9ydHlwZSwgJ2Ryb3Bkb3duJykpIHsKICAgICAgICB0aGlzLm9uU2VhcmNoKCIiLCBudWxsLCB0cnVlKTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICogdnVlIOeUn+WRveWRqOacnw0KICAgICAqDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJtb3VudGVkIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBtb3VudGVkKCkge30KICAgIC8qKg0KICAgICAqIOe7hOS7tumUgOavgQ0KICAgICAqDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJkZXN0cm95ZWQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGRlc3Ryb3llZCgpIHt9CiAgICAvKioNCiAgICAgKiDkuIvmi4nliIfmjaLlm57osIMNCiAgICAgKiBAcGFyYW0gZmxhZw0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvblNlbGVjdE9wZW4iLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uU2VsZWN0T3BlbihmbGFnKSB7CiAgICAgIHRoaXMub3BlbiA9IGZsYWc7CgogICAgICBpZiAodGhpcy5vcGVuKSB7CiAgICAgICAgdGhpcy5vblNlYXJjaCh0aGlzLmN1cnZhbHVlLCBudWxsLCB0cnVlKTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog5omn6KGM5pCc57Si5pWw5o2uDQogICAgICogQHBhcmFtIHF1ZXJ5DQogICAgICogQHBhcmFtIGNhbGxiYWNrDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uU2VhcmNoIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvblNlYXJjaChxdWVyeSwgY2FsbGJhY2ssIG90aGVyKSB7CiAgICAgIHZhciBfdGhpczIgPSB0aGlzOwoKICAgICAgLy8g5YWs5YWx5Y+C5pWw5aSE55CGCiAgICAgIHZhciBkYXRhID0ge307CiAgICAgIHZhciBiY2FuY2VsID0gdGhpcy5oYW5kbGVQdWJsaWNQYXJhbXMoZGF0YSk7CgogICAgICBpZiAoIWJjYW5jZWwpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0gLy8g5aSE55CG5pCc57Si5Y+C5pWwCgoKICAgICAgdmFyIF9jb250ZXh0ID0gZGF0YS5jb250ZXh0OwogICAgICB2YXIgX3BhcmFtID0gZGF0YS5wYXJhbTsKICAgICAgcXVlcnkgPSAhcXVlcnkgPyAnJyA6IHF1ZXJ5OwoKICAgICAgaWYgKCF0aGlzLmlucHV0U3RhdGUgJiYgb3RoZXIgJiYgT2JqZWN0LmlzKHF1ZXJ5LCB0aGlzLnZhbHVlKSkgewogICAgICAgIHF1ZXJ5ID0gJyc7CiAgICAgIH0KCiAgICAgIHRoaXMuaW5wdXRTdGF0ZSA9IGZhbHNlOwogICAgICBPYmplY3QuYXNzaWduKF9wYXJhbSwgewogICAgICAgIHF1ZXJ5OiBxdWVyeQogICAgICB9KTsgLy8g6ZSZ6K+v5L+h5oGv5Zu96ZmF5YyWCgogICAgICB2YXIgZXJyb3IgPSB0aGlzLiR0KCdjb21wb25lbnRzLmFwcFBpY2tlci5lcnJvcicpOwogICAgICB2YXIgbWlzcyA9IHRoaXMuJHQoJ2NvbXBvbmVudHMuYXBwUGlja2VyLm1pc3MnKTsKICAgICAgdmFyIHJlcXVlc3RFeGNlcHRpb24gPSB0aGlzLiR0KCdjb21wb25lbnRzLmFwcFBpY2tlci5yZXF1ZXN0RXhjZXB0aW9uJyk7CgogICAgICBpZiAoIXRoaXMuc2VydmljZSkgewogICAgICAgIHRoaXMuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICB0aXRsZTogZXJyb3IsCiAgICAgICAgICBkZXNjOiBtaXNzICsgJ3NlcnZpY2UnCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAoIXRoaXMuYWNQYXJhbXMuc2VydmljZU5hbWUpIHsKICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgdGl0bGU6IGVycm9yLAogICAgICAgICAgZGVzYzogbWlzcyArICdzZXJ2aWNlTmFtZScKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmICghdGhpcy5hY1BhcmFtcy5pbnRlcmZhY2VOYW1lKSB7CiAgICAgICAgdGhpcy4kTm90aWNlLmVycm9yKHsKICAgICAgICAgIHRpdGxlOiBlcnJvciwKICAgICAgICAgIGRlc2M6IG1pc3MgKyAnaW50ZXJmYWNlTmFtZScKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnNlcnZpY2UuZ2V0SXRlbXModGhpcy5hY1BhcmFtcy5zZXJ2aWNlTmFtZSwgdGhpcy5hY1BhcmFtcy5pbnRlcmZhY2VOYW1lLCBfY29udGV4dCwgX3BhcmFtKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgaWYgKCFyZXNwb25zZSkgewogICAgICAgICAgICBfdGhpczIuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgICAgdGl0bGU6IGVycm9yLAogICAgICAgICAgICAgIGRlc2M6IHJlcXVlc3RFeGNlcHRpb24KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBfdGhpczIuaXRlbXMgPSBfdG9Db25zdW1hYmxlQXJyYXkocmVzcG9uc2UpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChfdGhpczIuYWNQYXJhbXMgJiYgX3RoaXMyLmxpbmt2aWV3KSB7CiAgICAgICAgICAgIF90aGlzMi5pdGVtcy5wdXNoKHsKICAgICAgICAgICAgICBpc05ldzogdHJ1ZQogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY2FsbGJhY2spIHsKICAgICAgICAgICAgY2FsbGJhY2soX3RoaXMyLml0ZW1zKTsKICAgICAgICAgIH0KICAgICAgICB9KVsiY2F0Y2giXShmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICAgIGlmIChjYWxsYmFjaykgewogICAgICAgICAgICBjYWxsYmFjayhbXSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOmAieS4reaVsOaNruWbnuiwgw0KICAgICAqIEBwYXJhbSBpdGVtDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uQUNTZWxlY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uQUNTZWxlY3QoaXRlbSkgewogICAgICB0aGlzLnNlbGVjdFZhbHVlID0gaXRlbVt0aGlzLmRlTWFqb3JGaWVsZF07CgogICAgICBpZiAodGhpcy52YWx1ZWl0ZW0pIHsKICAgICAgICB0aGlzLiRlbWl0KCdmb3JtaXRlbXZhbHVlY2hhbmdlJywgewogICAgICAgICAgbmFtZTogdGhpcy52YWx1ZWl0ZW0sCiAgICAgICAgICB2YWx1ZTogaXRlbVt0aGlzLmRlS2V5RmllbGRdCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm5hbWUpIHsKICAgICAgICB0aGlzLiRlbWl0KCdmb3JtaXRlbXZhbHVlY2hhbmdlJywgewogICAgICAgICAgbmFtZTogdGhpcy5uYW1lLAogICAgICAgICAgdmFsdWU6IGl0ZW1bdGhpcy5kZU1ham9yRmllbGRdCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOS4i+aLiemAieS4rQ0KICAgICAqDQogICAgICogQHBhcmFtIHtzdHJpbmd9IHZhbA0KICAgICAqIEBtZW1iZXJvZiBBcHBQaWNrZXINCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25TZWxlY3QiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uU2VsZWN0KHZhbCkgewogICAgICB2YXIgX3RoaXMzID0gdGhpczsKCiAgICAgIHZhciBpbmRleCA9IHRoaXMuaXRlbXMuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIE9iamVjdC5pcyhpdGVtW190aGlzMy5kZUtleUZpZWxkXSwgdmFsKTsKICAgICAgfSk7CgogICAgICBpZiAoaW5kZXggPj0gMCkgewogICAgICAgIHRoaXMub25BQ1NlbGVjdCh0aGlzLml0ZW1zW2luZGV4XSk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOWkseWOu+eEpueCueS6i+S7tg0KICAgICAqIEBwYXJhbSBlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uQmx1ciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25CbHVyKGUpIHsKICAgICAgdGhpcy5jdXJ2YWx1ZSA9IHRoaXMudmFsdWU7CiAgICB9CiAgICAvKioNCiAgICAgKiDmuIXpmaQNCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib25DbGVhciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb25DbGVhcigkZXZlbnQpIHsKICAgICAgaWYgKHRoaXMudmFsdWVpdGVtKSB7CiAgICAgICAgdGhpcy4kZW1pdCgnZm9ybWl0ZW12YWx1ZWNoYW5nZScsIHsKICAgICAgICAgIG5hbWU6IHRoaXMudmFsdWVpdGVtLAogICAgICAgICAgdmFsdWU6ICcnCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLm5hbWUpIHsKICAgICAgICB0aGlzLiRlbWl0KCdmb3JtaXRlbXZhbHVlY2hhbmdlJywgewogICAgICAgICAgbmFtZTogdGhpcy5uYW1lLAogICAgICAgICAgdmFsdWU6ICcnCiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHRoaXMuJGZvcmNlVXBkYXRlKCk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmiZPlvIDop4blm74NCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib3BlblZpZXciLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5WaWV3KCRldmVudCkgewogICAgICBpZiAodGhpcy5kaXNhYmxlZCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDlhazlhbHlj4LmlbDlpITnkIYKCgogICAgICB2YXIgZGF0YSA9IHt9OwogICAgICB2YXIgYmNhbmNlbCA9IHRoaXMuaGFuZGxlUHVibGljUGFyYW1zKGRhdGEpOwoKICAgICAgaWYgKCFiY2FuY2VsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOWPguaVsOWkhOeQhgoKCiAgICAgIHZhciB2aWV3ID0gX29iamVjdFNwcmVhZCh7fSwgdGhpcy5waWNrdXBWaWV3KTsKCiAgICAgIHZhciBfY29udGV4dCA9IGRhdGEuY29udGV4dDsKICAgICAgdmFyIF9wYXJhbSA9IGRhdGEucGFyYW07CiAgICAgIF9wYXJhbS5zZWxlY3RlZERhdGEgPSBbewogICAgICAgIHNyZmtleTogdGhpcy5kYXRhW3RoaXMudmFsdWVpdGVtXSwKICAgICAgICBzcmZtYWpvcnRleHQ6IHRoaXMuY3VydmFsdWUKICAgICAgfV07IC8vIOWIpOaWreaJk+W8gOaWueW8jwoKICAgICAgaWYgKHZpZXcucGxhY2VtZW50ICYmICFPYmplY3QuaXModmlldy5wbGFjZW1lbnQsICcnKSkgewogICAgICAgIGlmIChPYmplY3QuaXModmlldy5wbGFjZW1lbnQsICdQT1BPVkVSJykpIHsKICAgICAgICAgIHRoaXMub3BlblBvcE92ZXIoJGV2ZW50LCB2aWV3LCBfY29udGV4dCwgX3BhcmFtKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5vcGVuRHJhd2VyKHZpZXcsIF9jb250ZXh0LCBfcGFyYW0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLm9wZW5Qb3B1cE1vZGFsKHZpZXcsIF9jb250ZXh0LCBfcGFyYW0pOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDot6/nlLHmqKHlvI/miZPlvIDop4blm74NCiAgICAgKg0KICAgICAqIEBwcml2YXRlDQogICAgICogQHBhcmFtIHtzdHJpbmd9IHZpZXdwYXRoDQogICAgICogQHBhcmFtIHsqfSBkYXRhDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvcGVuSW5kZXhWaWV3VGFiIiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuSW5kZXhWaWV3VGFiKHZpZXcsIGNvbnRleHQsIHBhcmFtKSB7CiAgICAgIHZhciByb3V0ZVBhdGggPSB0aGlzLiR2aWV3VG9vbC5idWlsZFVwUm91dGVQYXRoKHRoaXMuJHJvdXRlLCB0aGlzLmNvbnRleHQsIHZpZXcuZGVSZXNQYXJhbWV0ZXJzLCB2aWV3LnBhcmFtZXRlcnMsIFtjb250ZXh0XSwgcGFyYW0pOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaChyb3V0ZVBhdGgpOwogICAgfQogICAgLyoqDQogICAgICog5qih5oCB5qih5byP5omT5byA6KeG5Zu+DQogICAgICoNCiAgICAgKiBAcHJpdmF0ZQ0KICAgICAqIEBwYXJhbSB7Kn0gdmlldw0KICAgICAqIEBwYXJhbSB7Kn0gZGF0YQ0KICAgICAqIEBtZW1iZXJvZiBBcHBQaWNrZXINCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib3BlblBvcHVwTW9kYWwiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5Qb3B1cE1vZGFsKHZpZXcsIGNvbnRleHQsIHBhcmFtKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgdmFyIGNvbnRhaW5lciA9IHRoaXMuJGFwcG1vZGFsLm9wZW5Nb2RhbCh2aWV3LCBjb250ZXh0LCBwYXJhbSk7CiAgICAgIGNvbnRhaW5lci5zdWJzY3JpYmUoZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIGlmICghcmVzdWx0IHx8ICFPYmplY3QuaXMocmVzdWx0LnJldCwgJ09LJykpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIF90aGlzNC5vcGVuVmlld0Nsb3NlKHJlc3VsdCk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5oq95bGJ5qih5byP5omT5byA6KeG5Zu+DQogICAgICoNCiAgICAgKiBAcHJpdmF0ZQ0KICAgICAqIEBwYXJhbSB7Kn0gdmlldw0KICAgICAqIEBwYXJhbSB7Kn0gZGF0YQ0KICAgICAqIEBtZW1iZXJvZiBBcHBQaWNrZXINCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib3BlbkRyYXdlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb3BlbkRyYXdlcih2aWV3LCBjb250ZXh0LCBwYXJhbSkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLiRhcHBkcmF3ZXIub3BlbkRyYXdlcih2aWV3LCBjb250ZXh0LCBwYXJhbSk7CiAgICAgIGNvbnRhaW5lci5zdWJzY3JpYmUoZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIGlmICghcmVzdWx0IHx8ICFPYmplY3QuaXMocmVzdWx0LnJldCwgJ09LJykpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIF90aGlzNS5vcGVuVmlld0Nsb3NlKHJlc3VsdCk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog5rCU5rOh5Y2h54mH5qih5byP5omT5byADQogICAgICoNCiAgICAgKiBAcHJpdmF0ZQ0KICAgICAqIEBwYXJhbSB7Kn0gJGV2ZW50DQogICAgICogQHBhcmFtIHsqfSB2aWV3DQogICAgICogQHBhcmFtIHsqfSBkYXRhDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvcGVuUG9wT3ZlciIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb3BlblBvcE92ZXIoJGV2ZW50LCB2aWV3LCBjb250ZXh0LCBwYXJhbSkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHZhciBjb250YWluZXIgPSB0aGlzLiRhcHBwb3BvdmVyLm9wZW5Qb3AoJGV2ZW50LCB2aWV3LCBjb250ZXh0LCBwYXJhbSk7CiAgICAgIGNvbnRhaW5lci5zdWJzY3JpYmUoZnVuY3Rpb24gKHJlc3VsdCkgewogICAgICAgIGlmICghcmVzdWx0IHx8ICFPYmplY3QuaXMocmVzdWx0LnJldCwgJ09LJykpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIF90aGlzNi5vcGVuVmlld0Nsb3NlKHJlc3VsdCk7CiAgICAgIH0pOwogICAgfQogICAgLyoqDQogICAgICog54us56uL6YeM6Z2i5by55Ye6DQogICAgICoNCiAgICAgKiBAcHJpdmF0ZQ0KICAgICAqIEBwYXJhbSB7c3RyaW5nfSB1cmwNCiAgICAgKiBAbWVtYmVyb2YgQXBwUGlja2VyDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9wZW5Qb3B1cEFwcCIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb3BlblBvcHVwQXBwKHVybCkgewogICAgICB3aW5kb3cub3Blbih1cmwsICdfYmxhbmsnKTsKICAgIH0KICAgIC8qKg0KICAgICAqIOaJk+W8gOmHjeWumuWQkeinhuWbvg0KICAgICAqDQogICAgICogQHByaXZhdGUNCiAgICAgKiBAcGFyYW0geyp9ICRldmVudA0KICAgICAqIEBwYXJhbSB7Kn0gdmlldw0KICAgICAqIEBwYXJhbSB7Kn0gZGF0YQ0KICAgICAqIEBtZW1iZXJvZiBBcHBQaWNrZXINCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib3BlblJlZGlyZWN0VmlldyIsCiAgICB2YWx1ZTogZnVuY3Rpb24gb3BlblJlZGlyZWN0VmlldygkZXZlbnQsIHZpZXcsIGRhdGEpIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICB0aGlzLiRodHRwLmdldCh2aWV3LnVybCwgZGF0YSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBpZiAoIXJlc3BvbnNlIHx8IHJlc3BvbnNlLnN0YXR1cyAhPT0gMjAwKSB7CiAgICAgICAgICBfdGhpczcuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiBfdGhpczcuJHQoJ2NvbXBvbmVudHMuYXBwUGlja2VyLmVycm9yJyksCiAgICAgICAgICAgIGRlc2M6IF90aGlzNy4kdCgnY29tcG9uZW50cy5hcHBQaWNrZXIucmVxdWVzdEV4Y2VwdGlvbicpCiAgICAgICAgICB9KTsKICAgICAgICB9CgogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgdmFyIHJlc3VsdCA9IHJlc3BvbnNlLmRhdGE7CgogICAgICAgIGlmIChyZXN1bHQudmlld3BhcmFtcyAmJiAhT2JqZWN0LmlzKHJlc3VsdC52aWV3cGFyYW1zLnNyZmtleSwgJycpKSB7CiAgICAgICAgICBPYmplY3QuYXNzaWduKGRhdGEsIHsKICAgICAgICAgICAgc3Jma2V5OiByZXN1bHQudmlld3BhcmFtcy5zcmZrZXkKICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICAgICAgaWYgKE9iamVjdC5pcyhyZXN1bHQub3Blbm1vZGUsICdQT1BVUEFQUCcpICYmIHJlc3VsdC51cmwgJiYgIU9iamVjdC5pcyhyZXN1bHQudXJsLCAnJykpIHsKICAgICAgICAgIF90aGlzNy5vcGVuUG9wdXBBcHAocmVzdWx0LnVybCk7CiAgICAgICAgfSBlbHNlIGlmIChPYmplY3QuaXMocmVzdWx0Lm9wZW5tb2RlLCAnSU5ERVhWSUVXVEFCJykgfHwgT2JqZWN0LmlzKHJlc3VsdC5vcGVubW9kZSwgJycpKSB7CiAgICAgICAgICAvLyDmiYDmnInmlbDmja7kv53mjIHlnKjlkIzkuIDnuqcKICAgICAgICAgIGlmIChkYXRhLnNyZnBhcmVudGRhdGEpIHsKICAgICAgICAgICAgT2JqZWN0LmFzc2lnbihkYXRhLCBkYXRhLnNyZnBhcmVudGRhdGEpOwogICAgICAgICAgICBkZWxldGUgZGF0YS5zcmZwYXJlbnRkYXRhOwogICAgICAgICAgfQoKICAgICAgICAgIF90aGlzNy5vcGVuSW5kZXhWaWV3VGFiKHZpZXcsIG51bGwsIGRhdGEpOwogICAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmlzKHJlc3VsdC5vcGVubW9kZSwgJ1BPUFVQTU9EQUwnKSkgewogICAgICAgICAgdmFyIHZpZXduYW1lID0gX3RoaXM3LiR1dGlsLnNyZkZpbGVQYXRoMihyZXN1bHQudmlld25hbWUpOwoKICAgICAgICAgIHZhciBfdmlldyA9IHsKICAgICAgICAgICAgdmlld25hbWU6IHZpZXduYW1lLAogICAgICAgICAgICB0aXRsZTogcmVzdWx0LnRpdGxlLAogICAgICAgICAgICB3aWR0aDogcmVzdWx0LndpZHRoLAogICAgICAgICAgICBoZWlnaHQ6IHJlc3VsdC5oZWlnaHQKICAgICAgICAgIH07CgogICAgICAgICAgX3RoaXM3Lm9wZW5Qb3B1cE1vZGFsKF92aWV3LCBudWxsLCBkYXRhKTsKICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC5vcGVubW9kZS5zdGFydHNXaXRoKCdEUkFXRVInKSkgewogICAgICAgICAgdmFyIF92aWV3bmFtZSA9IF90aGlzNy4kdXRpbC5zcmZGaWxlUGF0aDIocmVzdWx0LnZpZXduYW1lKTsKCiAgICAgICAgICB2YXIgX3ZpZXcyID0gewogICAgICAgICAgICB2aWV3bmFtZTogX3ZpZXduYW1lLAogICAgICAgICAgICB0aXRsZTogcmVzdWx0LnRpdGxlLAogICAgICAgICAgICB3aWR0aDogcmVzdWx0LndpZHRoLAogICAgICAgICAgICBoZWlnaHQ6IHJlc3VsdC5oZWlnaHQsCiAgICAgICAgICAgIHBsYWNlbWVudDogcmVzdWx0Lm9wZW5tb2RlCiAgICAgICAgICB9OwoKICAgICAgICAgIF90aGlzNy5vcGVuRHJhd2VyKF92aWV3MiwgbnVsbCwgZGF0YSk7CiAgICAgICAgfSBlbHNlIGlmIChPYmplY3QuaXMocmVzdWx0Lm9wZW5tb2RlLCAnUE9QT1ZFUicpKSB7CiAgICAgICAgICB2YXIgX3ZpZXduYW1lMiA9IF90aGlzNy4kdXRpbC5zcmZGaWxlUGF0aDIocmVzdWx0LnZpZXduYW1lKTsKCiAgICAgICAgICB2YXIgX3ZpZXczID0gewogICAgICAgICAgICB2aWV3bmFtZTogX3ZpZXduYW1lMiwKICAgICAgICAgICAgdGl0bGU6IHJlc3VsdC50aXRsZSwKICAgICAgICAgICAgd2lkdGg6IHJlc3VsdC53aWR0aCwKICAgICAgICAgICAgaGVpZ2h0OiByZXN1bHQuaGVpZ2h0LAogICAgICAgICAgICBwbGFjZW1lbnQ6IHJlc3VsdC5vcGVubW9kZQogICAgICAgICAgfTsKCiAgICAgICAgICBfdGhpczcub3BlblBvcE92ZXIoJGV2ZW50LCBfdmlldzMsIG51bGwsIGRhdGEpOwogICAgICAgIH0KICAgICAgfSlbImNhdGNoIl0oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgaWYgKCFyZXNwb25zZSB8fCAhcmVzcG9uc2Uuc3RhdHVzIHx8ICFyZXNwb25zZS5kYXRhKSB7CiAgICAgICAgICBfdGhpczcuJE5vdGljZS5lcnJvcih7CiAgICAgICAgICAgIHRpdGxlOiBfdGhpczcuJHQoJ2NvbXBvbmVudHMuYXBwUGlja2VyLmVycm9yJyksCiAgICAgICAgICAgIGRlc2M6IF90aGlzNy4kdCgnY29tcG9uZW50cy5hcHBQaWNrZXIuc3lzdGVtRXhjZXB0aW9uJykKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9CiAgICAvKioNCiAgICAgKiDmiZPlvIDpk77mjqXop4blm74NCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBBcHBQaWNrZXINCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAib3BlbkxpbmtWaWV3IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBvcGVuTGlua1ZpZXcoJGV2ZW50KSB7CiAgICAgIGlmICghdGhpcy5kYXRhIHx8ICF0aGlzLnZhbHVlaXRlbSB8fCAhdGhpcy5kYXRhW3RoaXMudmFsdWVpdGVtXSkgewogICAgICAgIGNvbnNvbGUuZXJyb3IoewogICAgICAgICAgdGl0bGU6IHRoaXMuJHQoJ2NvbXBvbmVudHMuYXBwUGlja2VyLmVycm9yJyksCiAgICAgICAgICBkZXNjOiB0aGlzLiR0KCdjb21wb25lbnRzLmFwcFBpY2tlci52YWx1ZWl0ZW1FeGNlcHRpb24nKQogICAgICAgIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDlhazlhbHlj4LmlbDlpITnkIYKCgogICAgICB2YXIgZGF0YSA9IHt9OwogICAgICB2YXIgYmNhbmNlbCA9IHRoaXMuaGFuZGxlUHVibGljUGFyYW1zKGRhdGEpOwoKICAgICAgaWYgKCFiY2FuY2VsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOWPguaVsOWkhOeQhgoKCiAgICAgIHZhciBfY29udGV4dCA9IGRhdGEuY29udGV4dDsKICAgICAgdmFyIF9wYXJhbSA9IGRhdGEucGFyYW07CiAgICAgIE9iamVjdC5hc3NpZ24oX2NvbnRleHQsIF9kZWZpbmVQcm9wZXJ0eSh7fSwgdGhpcy5kZUtleUZpZWxkLCB0aGlzLmRhdGFbdGhpcy52YWx1ZWl0ZW1dKSk7CiAgICAgIHZhciB2aWV3ID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeSh0aGlzLmxpbmt2aWV3KSk7CiAgICAgIHZhciB2aWV3bmFtZTIgPSB0aGlzLiR1dGlsLnNyZkZpbGVQYXRoMih2aWV3LnZpZXduYW1lKTsKICAgICAgdmlldy52aWV3bmFtZSA9IHZpZXduYW1lMjsKCiAgICAgIGlmICh2aWV3LmlzUmVkaXJlY3RWaWV3KSB7CiAgICAgICAgdGhpcy5vcGVuUmVkaXJlY3RWaWV3KCRldmVudCwgdmlldywgZGF0YSk7CiAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmlzKHZpZXcucGxhY2VtZW50LCAnSU5ERVhWSUVXVEFCJykgfHwgT2JqZWN0LmlzKHZpZXcucGxhY2VtZW50LCAnJykpIHsKICAgICAgICB0aGlzLm9wZW5JbmRleFZpZXdUYWIodmlldywgX2NvbnRleHQsIF9wYXJhbSk7CiAgICAgIH0gZWxzZSBpZiAoT2JqZWN0LmlzKHZpZXcucGxhY2VtZW50LCAnUE9QT1ZFUicpKSB7CiAgICAgICAgdGhpcy5vcGVuUG9wT3ZlcigkZXZlbnQsIHZpZXcsIF9jb250ZXh0LCBfcGFyYW0pOwogICAgICB9IGVsc2UgaWYgKE9iamVjdC5pcyh2aWV3LnBsYWNlbWVudCwgJ1BPUFVQTU9EQUwnKSkgewogICAgICAgIHRoaXMub3BlblBvcHVwTW9kYWwodmlldywgX2NvbnRleHQsIF9wYXJhbSk7CiAgICAgIH0gZWxzZSBpZiAodmlldy5wbGFjZW1lbnQuc3RhcnRzV2l0aCgnRFJBV0VSJykpIHsKICAgICAgICB0aGlzLm9wZW5EcmF3ZXIodmlldywgX2NvbnRleHQsIF9wYXJhbSk7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOaJk+W8gOmhtemdouWFs+mXrQ0KICAgICAqDQogICAgICogQHBhcmFtIHsqfSByZXN1bHQNCiAgICAgKiBAbWVtYmVyb2YgQXBwUGlja2VyDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9wZW5WaWV3Q2xvc2UiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5WaWV3Q2xvc2UocmVzdWx0KSB7CiAgICAgIHZhciBpdGVtID0ge307CgogICAgICBpZiAocmVzdWx0LmRhdGFzICYmIEFycmF5LmlzQXJyYXkocmVzdWx0LmRhdGFzKSkgewogICAgICAgIE9iamVjdC5hc3NpZ24oaXRlbSwgcmVzdWx0LmRhdGFzWzBdKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZGF0YSkgewogICAgICAgIGlmICh0aGlzLnZhbHVlaXRlbSkgewogICAgICAgICAgdGhpcy4kZW1pdCgnZm9ybWl0ZW12YWx1ZWNoYW5nZScsIHsKICAgICAgICAgICAgbmFtZTogdGhpcy52YWx1ZWl0ZW0sCiAgICAgICAgICAgIHZhbHVlOiBpdGVtW3RoaXMuZGVLZXlGaWVsZF0gPyBpdGVtW3RoaXMuZGVLZXlGaWVsZF0gOiBpdGVtWyJzcmZrZXkiXQogICAgICAgICAgfSk7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5uYW1lKSB7CiAgICAgICAgICB0aGlzLiRlbWl0KCdmb3JtaXRlbXZhbHVlY2hhbmdlJywgewogICAgICAgICAgICBuYW1lOiB0aGlzLm5hbWUsCiAgICAgICAgICAgIHZhbHVlOiBpdGVtW3RoaXMuZGVNYWpvckZpZWxkXSA/IGl0ZW1bdGhpcy5kZU1ham9yRmllbGRdIDogaXRlbVsic3JmbWFqb3J0ZXh0Il0KICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog5YWs5YWx5Y+C5pWw5aSE55CGDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IGFyZw0KICAgICAqIEByZXR1cm5zDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJoYW5kbGVQdWJsaWNQYXJhbXMiLAogICAgdmFsdWU6IGZ1bmN0aW9uIGhhbmRsZVB1YmxpY1BhcmFtcyhhcmcpIHsKICAgICAgaWYgKCF0aGlzLmRhdGEpIHsKICAgICAgICB0aGlzLiROb3RpY2UuZXJyb3IoewogICAgICAgICAgdGl0bGU6IHRoaXMuJHQoJ2NvbXBvbmVudHMuYXBwUGlja2VyLmVycm9yJyksCiAgICAgICAgICBkZXNjOiB0aGlzLiR0KCdjb21wb25lbnRzLmFwcFBpY2tlci5mb3JtZGF0YUV4Y2VwdGlvbicpCiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vIOWQiOW5tuihqOWNleWPguaVsAoKCiAgICAgIGFyZy5wYXJhbSA9IHRoaXMudmlld3BhcmFtcyA/IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy52aWV3cGFyYW1zKSkgOiB7fTsKICAgICAgYXJnLmNvbnRleHQgPSB0aGlzLmNvbnRleHQgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMuY29udGV4dCkpIDoge307IC8vIOmZhOWKoOWPguaVsOWkhOeQhgoKICAgICAgaWYgKHRoaXMubG9jYWxDb250ZXh0ICYmIE9iamVjdC5rZXlzKHRoaXMubG9jYWxDb250ZXh0KS5sZW5ndGggPiAwKSB7CiAgICAgICAgdmFyIF9jb250ZXh0ID0gdGhpcy4kdXRpbC5jb21wdXRlZE5hdkRhdGEodGhpcy5kYXRhLCBhcmcuY29udGV4dCwgYXJnLnBhcmFtLCB0aGlzLmxvY2FsQ29udGV4dCk7CgogICAgICAgIE9iamVjdC5hc3NpZ24oYXJnLmNvbnRleHQsIF9jb250ZXh0KTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubG9jYWxQYXJhbSAmJiBPYmplY3Qua2V5cyh0aGlzLmxvY2FsUGFyYW0pLmxlbmd0aCA+IDApIHsKICAgICAgICB2YXIgX3BhcmFtID0gdGhpcy4kdXRpbC5jb21wdXRlZE5hdkRhdGEodGhpcy5kYXRhLCBhcmcucGFyYW0sIGFyZy5wYXJhbSwgdGhpcy5sb2NhbFBhcmFtKTsKCiAgICAgICAgT2JqZWN0LmFzc2lnbihhcmcucGFyYW0sIF9wYXJhbSk7CiAgICAgIH0KCiAgICAgIHJldHVybiB0cnVlOwogICAgfQogICAgLyoqDQogICAgICog5Yib5bu65bm257yW6L6RDQogICAgICoNCiAgICAgKiBAcGFyYW0geyp9IGFyZw0KICAgICAqIEByZXR1cm5zDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJuZXdBbmRFZGl0IiwKICAgIHZhbHVlOiBmdW5jdGlvbiBuZXdBbmRFZGl0KCRldmVudCkgewogICAgICBpZiAodGhpcy5kaXNhYmxlZCkgewogICAgICAgIHJldHVybjsKICAgICAgfSAvLyDlhazlhbHlj4LmlbDlpITnkIYKCgogICAgICB2YXIgZGF0YSA9IHt9OwogICAgICB2YXIgYmNhbmNlbCA9IHRoaXMuaGFuZGxlUHVibGljUGFyYW1zKGRhdGEpOwoKICAgICAgaWYgKCFiY2FuY2VsKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9IC8vIOWPguaVsOWkhOeQhgoKCiAgICAgIHZhciB2aWV3ID0gX29iamVjdFNwcmVhZCh7fSwgdGhpcy5saW5rdmlldyk7CgogICAgICB2aWV3LnZpZXduYW1lID0gdGhpcy4kdXRpbC5zcmZGaWxlUGF0aDIodmlldy52aWV3bmFtZSk7CiAgICAgIHZhciBfY29udGV4dCA9IGRhdGEuY29udGV4dDsKICAgICAgZGVsZXRlIF9jb250ZXh0W3RoaXMuZGVLZXlGaWVsZF07CiAgICAgIHZhciBfcGFyYW0gPSBkYXRhLnBhcmFtOyAvLyDliKTmlq3miZPlvIDmlrnlvI8KCiAgICAgIGlmICh2aWV3LnBsYWNlbWVudCAmJiAhT2JqZWN0LmlzKHZpZXcucGxhY2VtZW50LCAnJykpIHsKICAgICAgICBpZiAoT2JqZWN0LmlzKHZpZXcucGxhY2VtZW50LCAnUE9QT1ZFUicpKSB7CiAgICAgICAgICB0aGlzLm9wZW5Qb3BPdmVyKCRldmVudCwgdmlldywgX2NvbnRleHQsIF9wYXJhbSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRoaXMub3BlbkRyYXdlcih2aWV3LCBfY29udGV4dCwgX3BhcmFtKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5vcGVuUG9wdXBNb2RhbCh2aWV3LCBfY29udGV4dCwgX3BhcmFtKTsKICAgICAgfQogICAgfQogICAgLyoqDQogICAgICog6L6T5YWl6L+H56iL5LitDQogICAgICoNCiAgICAgKiBAbWVtYmVyb2YgQXBwQXV0b2NvbXBsZXRlDQogICAgICovCgogIH0sIHsKICAgIGtleTogIm9uSW5wdXQiLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9uSW5wdXQoJGV2ZW50KSB7CiAgICAgIGlmIChPYmplY3QuaXMoJGV2ZW50LCB0aGlzLnZhbHVlKSkgewogICAgICAgIHRoaXMuaW5wdXRTdGF0ZSA9IHRydWU7CiAgICAgIH0KICAgIH0KICAgIC8qKg0KICAgICAqIOWxleW8gOS4i+aLiQ0KICAgICAqDQogICAgICogQG1lbWJlcm9mIEFwcFBpY2tlcg0KICAgICAqLwoKICB9LCB7CiAgICBrZXk6ICJvcGVuRHJvcGRvd24iLAogICAgdmFsdWU6IGZ1bmN0aW9uIG9wZW5Ecm9wZG93bigpIHsKICAgICAgdmFyIGFwcFBpY2tlciA9IHRoaXMuJHJlZnMuYXBwUGlja2VyOwoKICAgICAgaWYgKGFwcFBpY2tlcikgewogICAgICAgIGFwcFBpY2tlci5mb2N1cygpOwogICAgICB9CiAgICB9CiAgICAvKioNCiAgICAgKiDmlLbotbfkuIvmi4kNCiAgICAgKg0KICAgICAqIEBtZW1iZXJvZiBBcHBQaWNrZXINCiAgICAgKi8KCiAgfSwgewogICAga2V5OiAiY2xvc2VEcm9wZG93biIsCiAgICB2YWx1ZTogZnVuY3Rpb24gY2xvc2VEcm9wZG93bigpIHsKICAgICAgdmFyIGFwcFBpY2tlciA9IHRoaXMuJHJlZnMuYXBwUGlja2VyOwoKICAgICAgaWYgKGFwcFBpY2tlcikgewogICAgICAgIGFwcFBpY2tlci5ibHVyKCk7CiAgICAgIH0KICAgIH0KICB9LCB7CiAgICBrZXk6ICJyZWZ2YWx1ZSIsCiAgICBnZXQ6IGZ1bmN0aW9uIGdldCgpIHsKICAgICAgaWYgKHRoaXMudmFsdWVpdGVtICYmIHRoaXMuZGF0YSkgewogICAgICAgIHJldHVybiB0aGlzLmRhdGFbdGhpcy52YWx1ZWl0ZW1dOwogICAgICB9CgogICAgICByZXR1cm4gdGhpcy5jdXJ2YWx1ZTsKICAgIH0KICB9XSk7CgogIHJldHVybiBBcHBQaWNrZXI7Cn0oVnVlKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgQXBwUGlja2VyLnByb3RvdHlwZSwgImNvbnRleHQiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBBcHBQaWNrZXIucHJvdG90eXBlLCAidmlld3BhcmFtcyIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoewogICJkZWZhdWx0IjogZnVuY3Rpb24gX2RlZmF1bHQoKSB7fQp9KV0sIEFwcFBpY2tlci5wcm90b3R5cGUsICJhY1BhcmFtcyIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIEFwcFBpY2tlci5wcm90b3R5cGUsICJzZXJ2aWNlIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCh7CiAgImRlZmF1bHQiOiAnc3JmbWFqb3J0ZXh0Jwp9KV0sIEFwcFBpY2tlci5wcm90b3R5cGUsICJkZU1ham9yRmllbGQiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKHsKICAiZGVmYXVsdCI6ICdzcmZrZXknCn0pXSwgQXBwUGlja2VyLnByb3RvdHlwZSwgImRlS2V5RmllbGQiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBBcHBQaWNrZXIucHJvdG90eXBlLCAiZGF0YSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIEFwcFBpY2tlci5wcm90b3R5cGUsICJuYW1lIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgQXBwUGlja2VyLnByb3RvdHlwZSwgImRpc2FibGVkIiwgdm9pZCAwKTsKCnRzbGliXzEuX19kZWNvcmF0ZShbUHJvcCgpXSwgQXBwUGlja2VyLnByb3RvdHlwZSwgImVkaXRvcnR5cGUiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBBcHBQaWNrZXIucHJvdG90eXBlLCAicGlja3VwVmlldyIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIEFwcFBpY2tlci5wcm90b3R5cGUsICJsaW5rdmlldyIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIEFwcFBpY2tlci5wcm90b3R5cGUsICJsb2NhbENvbnRleHQiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtQcm9wKCldLCBBcHBQaWNrZXIucHJvdG90eXBlLCAibG9jYWxQYXJhbSIsIHZvaWQgMCk7Cgp0c2xpYl8xLl9fZGVjb3JhdGUoW1Byb3AoKV0sIEFwcFBpY2tlci5wcm90b3R5cGUsICJ2YWx1ZWl0ZW0iLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtNb2RlbCgnY2hhbmdlJyldLCBBcHBQaWNrZXIucHJvdG90eXBlLCAidmFsdWUiLCB2b2lkIDApOwoKdHNsaWJfMS5fX2RlY29yYXRlKFtXYXRjaCgndmFsdWUnLCB7CiAgaW1tZWRpYXRlOiB0cnVlCn0pXSwgQXBwUGlja2VyLnByb3RvdHlwZSwgIm9uVmFsdWVDaGFuZ2UiLCBudWxsKTsKCkFwcFBpY2tlciA9IHRzbGliXzEuX19kZWNvcmF0ZShbQ29tcG9uZW50KHt9KV0sIEFwcFBpY2tlcik7CmV4cG9ydCBkZWZhdWx0IEFwcFBpY2tlcjs="},null]}